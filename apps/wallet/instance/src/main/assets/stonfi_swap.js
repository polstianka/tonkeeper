(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){'use strict'
exports.byteLength=byteLength
exports.toByteArray=toByteArray
exports.fromByteArray=fromByteArray
var lookup=[]
var revLookup=[]
var Arr=typeof Uint8Array!=='undefined'?Uint8Array:Array
var code='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i]
revLookup[code.charCodeAt(i)]=i}
revLookup['-'.charCodeAt(0)]=62
revLookup['_'.charCodeAt(0)]=63
function getLens(b64){var len=b64.length
if(len%4>0){throw new Error('Invalid string. Length must be a multiple of 4')}
var validLen=b64.indexOf('=')
if(validLen===-1)validLen=len
var placeHoldersLen=validLen===len?0:4-(validLen%4)
return[validLen,placeHoldersLen]}
function byteLength(b64){var lens=getLens(b64)
var validLen=lens[0]
var placeHoldersLen=lens[1]
return((validLen+placeHoldersLen)*3/4)-placeHoldersLen}
function _byteLength(b64,validLen,placeHoldersLen){return((validLen+placeHoldersLen)*3/4)-placeHoldersLen}
function toByteArray(b64){var tmp
var lens=getLens(b64)
var validLen=lens[0]
var placeHoldersLen=lens[1]
var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen))
var curByte=0
var len=placeHoldersLen>0?validLen-4:validLen
var i
for(i=0;i<len;i+=4){tmp=(revLookup[b64.charCodeAt(i)]<<18)|(revLookup[b64.charCodeAt(i+1)]<<12)|(revLookup[b64.charCodeAt(i+2)]<<6)|revLookup[b64.charCodeAt(i+3)]
arr[curByte++]=(tmp>>16)&0xFF
arr[curByte++]=(tmp>>8)&0xFF
arr[curByte++]=tmp&0xFF}
if(placeHoldersLen===2){tmp=(revLookup[b64.charCodeAt(i)]<<2)|(revLookup[b64.charCodeAt(i+1)]>>4)
arr[curByte++]=tmp&0xFF}
if(placeHoldersLen===1){tmp=(revLookup[b64.charCodeAt(i)]<<10)|(revLookup[b64.charCodeAt(i+1)]<<4)|(revLookup[b64.charCodeAt(i+2)]>>2)
arr[curByte++]=(tmp>>8)&0xFF
arr[curByte++]=tmp&0xFF}
return arr}
function tripletToBase64(num){return lookup[num>>18&0x3F]+lookup[num>>12&0x3F]+lookup[num>>6&0x3F]+lookup[num&0x3F]}
function encodeChunk(uint8,start,end){var tmp
var output=[]
for(var i=start;i<end;i+=3){tmp=((uint8[i]<<16)&0xFF0000)+((uint8[i+1]<<8)&0xFF00)+(uint8[i+2]&0xFF)
output.push(tripletToBase64(tmp))}
return output.join('')}
function fromByteArray(uint8){var tmp
var len=uint8.length
var extraBytes=len%3
var parts=[]
var maxChunkLength=16383
for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,(i+maxChunkLength)>len2?len2:(i+maxChunkLength)))}
if(extraBytes===1){tmp=uint8[len-1]
parts.push(lookup[tmp>>2]+lookup[(tmp<<4)&0x3F]+'==')}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1]
parts.push(lookup[tmp>>10]+lookup[(tmp>>4)&0x3F]+lookup[(tmp<<2)&0x3F]+'=')}
return parts.join('')}},{}],2:[function(require,module,exports){},{}],3:[function(require,module,exports){(function(Buffer){(function(){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
'use strict'
var base64=require('base64-js')
var ieee754=require('ieee754')
exports.Buffer=Buffer
exports.SlowBuffer=SlowBuffer
exports.INSPECT_MAX_BYTES=50
var K_MAX_LENGTH=0x7fffffff
exports.kMaxLength=K_MAX_LENGTH
Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport()
if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=='undefined'&&typeof console.error==='function'){console.error('This browser lacks typed array (Uint8Array) support which is required by '+'`buffer` v5.x. Use `buffer` v4.x if you require old browser support.')}
function typedArraySupport(){try{var arr=new Uint8Array(1)
arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}}
return arr.foo()===42}catch(e){return!1}}
Object.defineProperty(Buffer.prototype,'parent',{enumerable:!0,get:function(){if(!Buffer.isBuffer(this))return undefined
return this.buffer}})
Object.defineProperty(Buffer.prototype,'offset',{enumerable:!0,get:function(){if(!Buffer.isBuffer(this))return undefined
return this.byteOffset}})
function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}
var buf=new Uint8Array(length)
buf.__proto__=Buffer.prototype
return buf}
function Buffer(arg,encodingOrOffset,length){if(typeof arg==='number'){if(typeof encodingOrOffset==='string'){throw new TypeError('The "string" argument must be of type string. Received type number')}
return allocUnsafe(arg)}
return from(arg,encodingOrOffset,length)}
if(typeof Symbol!=='undefined'&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})}
Buffer.poolSize=8192
function from(value,encodingOrOffset,length){if(typeof value==='string'){return fromString(value,encodingOrOffset)}
if(ArrayBuffer.isView(value)){return fromArrayLike(value)}
if(value==null){throw TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, '+'or Array-like Object. Received type '+(typeof value))}
if(isInstance(value,ArrayBuffer)||(value&&isInstance(value.buffer,ArrayBuffer))){return fromArrayBuffer(value,encodingOrOffset,length)}
if(typeof value==='number'){throw new TypeError('The "value" argument must not be of type number. Received type number')}
var valueOf=value.valueOf&&value.valueOf()
if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}
var b=fromObject(value)
if(b)return b
if(typeof Symbol!=='undefined'&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==='function'){return Buffer.from(value[Symbol.toPrimitive]('string'),encodingOrOffset,length)}
throw new TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, '+'or Array-like Object. Received type '+(typeof value))}
Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)}
Buffer.prototype.__proto__=Uint8Array.prototype
Buffer.__proto__=Uint8Array
function assertSize(size){if(typeof size!=='number'){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}
function alloc(size,fill,encoding){assertSize(size)
if(size<=0){return createBuffer(size)}
if(fill!==undefined){return typeof encoding==='string'?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}
return createBuffer(size)}
Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)}
function allocUnsafe(size){assertSize(size)
return createBuffer(size<0?0:checked(size)|0)}
Buffer.allocUnsafe=function(size){return allocUnsafe(size)}
Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)}
function fromString(string,encoding){if(typeof encoding!=='string'||encoding===''){encoding='utf8'}
if(!Buffer.isEncoding(encoding)){throw new TypeError('Unknown encoding: '+encoding)}
var length=byteLength(string,encoding)|0
var buf=createBuffer(length)
var actual=buf.write(string,encoding)
if(actual!==length){buf=buf.slice(0,actual)}
return buf}
function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0
var buf=createBuffer(length)
for(var i=0;i<length;i+=1){buf[i]=array[i]&255}
return buf}
function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}
if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}
var buf
if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}
buf.__proto__=Buffer.prototype
return buf}
function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0
var buf=createBuffer(len)
if(buf.length===0){return buf}
obj.copy(buf,0,0,len)
return buf}
if(obj.length!==undefined){if(typeof obj.length!=='number'||numberIsNaN(obj.length)){return createBuffer(0)}
return fromArrayLike(obj)}
if(obj.type==='Buffer'&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}
function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError('Attempt to allocate Buffer larger than maximum '+'size: 0x'+K_MAX_LENGTH.toString(16)+' bytes')}
return length|0}
function SlowBuffer(length){if(+length!=length){length=0}
return Buffer.alloc(+length)}
Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===!0&&b!==Buffer.prototype}
Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength)
if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength)
if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}
if(a===b)return 0
var x=a.length
var y=b.length
for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i]
y=b[i]
break}}
if(x<y)return-1
if(y<x)return 1
return 0}
Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case 'hex':case 'utf8':case 'utf-8':case 'ascii':case 'latin1':case 'binary':case 'base64':case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':return!0
default:return!1}}
Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}
if(list.length===0){return Buffer.alloc(0)}
var i
if(length===undefined){length=0
for(i=0;i<list.length;++i){length+=list[i].length}}
var buffer=Buffer.allocUnsafe(length)
var pos=0
for(i=0;i<list.length;++i){var buf=list[i]
if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}
if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}
buf.copy(buffer,pos)
pos+=buf.length}
return buffer}
function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}
if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}
if(typeof string!=='string'){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+'Received type '+typeof string)}
var len=string.length
var mustMatch=(arguments.length>2&&arguments[2]===!0)
if(!mustMatch&&len===0)return 0
var loweredCase=!1
for(;;){switch(encoding){case 'ascii':case 'latin1':case 'binary':return len
case 'utf8':case 'utf-8':return utf8ToBytes(string).length
case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':return len*2
case 'hex':return len>>>1
case 'base64':return base64ToBytes(string).length
default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}
encoding=(''+encoding).toLowerCase()
loweredCase=!0}}}
Buffer.byteLength=byteLength
function slowToString(encoding,start,end){var loweredCase=!1
if(start===undefined||start<0){start=0}
if(start>this.length){return''}
if(end===undefined||end>this.length){end=this.length}
if(end<=0){return''}
end>>>=0
start>>>=0
if(end<=start){return''}
if(!encoding)encoding='utf8'
while(!0){switch(encoding){case 'hex':return hexSlice(this,start,end)
case 'utf8':case 'utf-8':return utf8Slice(this,start,end)
case 'ascii':return asciiSlice(this,start,end)
case 'latin1':case 'binary':return latin1Slice(this,start,end)
case 'base64':return base64Slice(this,start,end)
case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':return utf16leSlice(this,start,end)
default:if(loweredCase)throw new TypeError('Unknown encoding: '+encoding)
encoding=(encoding+'').toLowerCase()
loweredCase=!0}}}
Buffer.prototype._isBuffer=!0
function swap(b,n,m){var i=b[n]
b[n]=b[m]
b[m]=i}
Buffer.prototype.swap16=function swap16(){var len=this.length
if(len%2!==0){throw new RangeError('Buffer size must be a multiple of 16-bits')}
for(var i=0;i<len;i+=2){swap(this,i,i+1)}
return this}
Buffer.prototype.swap32=function swap32(){var len=this.length
if(len%4!==0){throw new RangeError('Buffer size must be a multiple of 32-bits')}
for(var i=0;i<len;i+=4){swap(this,i,i+3)
swap(this,i+1,i+2)}
return this}
Buffer.prototype.swap64=function swap64(){var len=this.length
if(len%8!==0){throw new RangeError('Buffer size must be a multiple of 64-bits')}
for(var i=0;i<len;i+=8){swap(this,i,i+7)
swap(this,i+1,i+6)
swap(this,i+2,i+5)
swap(this,i+3,i+4)}
return this}
Buffer.prototype.toString=function toString(){var length=this.length
if(length===0)return''
if(arguments.length===0)return utf8Slice(this,0,length)
return slowToString.apply(this,arguments)}
Buffer.prototype.toLocaleString=Buffer.prototype.toString
Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError('Argument must be a Buffer')
if(this===b)return!0
return Buffer.compare(this,b)===0}
Buffer.prototype.inspect=function inspect(){var str=''
var max=exports.INSPECT_MAX_BYTES
str=this.toString('hex',0,max).replace(/(.{2})/g,'$1 ').trim()
if(this.length>max)str+=' ... '
return'<Buffer '+str+'>'}
Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}
if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+'Received type '+(typeof target))}
if(start===undefined){start=0}
if(end===undefined){end=target?target.length:0}
if(thisStart===undefined){thisStart=0}
if(thisEnd===undefined){thisEnd=this.length}
if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError('out of range index')}
if(thisStart>=thisEnd&&start>=end){return 0}
if(thisStart>=thisEnd){return-1}
if(start>=end){return 1}
start>>>=0
end>>>=0
thisStart>>>=0
thisEnd>>>=0
if(this===target)return 0
var x=thisEnd-thisStart
var y=end-start
var len=Math.min(x,y)
var thisCopy=this.slice(thisStart,thisEnd)
var targetCopy=target.slice(start,end)
for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i]
y=targetCopy[i]
break}}
if(x<y)return-1
if(y<x)return 1
return 0}
function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1
if(typeof byteOffset==='string'){encoding=byteOffset
byteOffset=0}else if(byteOffset>0x7fffffff){byteOffset=0x7fffffff}else if(byteOffset<-0x80000000){byteOffset=-0x80000000}
byteOffset=+byteOffset
if(numberIsNaN(byteOffset)){byteOffset=dir?0:(buffer.length-1)}
if(byteOffset<0)byteOffset=buffer.length+byteOffset
if(byteOffset>=buffer.length){if(dir)return-1
else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0
else return-1}
if(typeof val==='string'){val=Buffer.from(val,encoding)}
if(Buffer.isBuffer(val)){if(val.length===0){return-1}
return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==='number'){val=val&0xFF
if(typeof Uint8Array.prototype.indexOf==='function'){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}
return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}
throw new TypeError('val must be string, number or Buffer')}
function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1
var arrLength=arr.length
var valLength=val.length
if(encoding!==undefined){encoding=String(encoding).toLowerCase()
if(encoding==='ucs2'||encoding==='ucs-2'||encoding==='utf16le'||encoding==='utf-16le'){if(arr.length<2||val.length<2){return-1}
indexSize=2
arrLength/=2
valLength/=2
byteOffset/=2}}
function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}
var i
if(dir){var foundIndex=-1
for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i
if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex
foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength
for(i=byteOffset;i>=0;i--){var found=!0
for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=!1
break}}
if(found)return i}}
return-1}
Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1}
Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)}
Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)}
function hexWrite(buf,string,offset,length){offset=Number(offset)||0
var remaining=buf.length-offset
if(!length){length=remaining}else{length=Number(length)
if(length>remaining){length=remaining}}
var strLen=string.length
if(length>strLen/2){length=strLen/2}
for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16)
if(numberIsNaN(parsed))return i
buf[offset+i]=parsed}
return i}
function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}
function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}
function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}
function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}
function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}
Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding='utf8'
length=this.length
offset=0}else if(length===undefined&&typeof offset==='string'){encoding=offset
length=this.length
offset=0}else if(isFinite(offset)){offset=offset>>>0
if(isFinite(length)){length=length>>>0
if(encoding===undefined)encoding='utf8'}else{encoding=length
length=undefined}}else{throw new Error('Buffer.write(string, encoding, offset[, length]) is no longer supported')}
var remaining=this.length-offset
if(length===undefined||length>remaining)length=remaining
if((string.length>0&&(length<0||offset<0))||offset>this.length){throw new RangeError('Attempt to write outside buffer bounds')}
if(!encoding)encoding='utf8'
var loweredCase=!1
for(;;){switch(encoding){case 'hex':return hexWrite(this,string,offset,length)
case 'utf8':case 'utf-8':return utf8Write(this,string,offset,length)
case 'ascii':return asciiWrite(this,string,offset,length)
case 'latin1':case 'binary':return latin1Write(this,string,offset,length)
case 'base64':return base64Write(this,string,offset,length)
case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':return ucs2Write(this,string,offset,length)
default:if(loweredCase)throw new TypeError('Unknown encoding: '+encoding)
encoding=(''+encoding).toLowerCase()
loweredCase=!0}}}
Buffer.prototype.toJSON=function toJSON(){return{type:'Buffer',data:Array.prototype.slice.call(this._arr||this,0)}}
function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}
function utf8Slice(buf,start,end){end=Math.min(buf.length,end)
var res=[]
var i=start
while(i<end){var firstByte=buf[i]
var codePoint=null
var bytesPerSequence=(firstByte>0xEF)?4:(firstByte>0xDF)?3:(firstByte>0xBF)?2:1
if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint
switch(bytesPerSequence){case 1:if(firstByte<0x80){codePoint=firstByte}
break
case 2:secondByte=buf[i+1]
if((secondByte&0xC0)===0x80){tempCodePoint=(firstByte&0x1F)<<0x6|(secondByte&0x3F)
if(tempCodePoint>0x7F){codePoint=tempCodePoint}}
break
case 3:secondByte=buf[i+1]
thirdByte=buf[i+2]
if((secondByte&0xC0)===0x80&&(thirdByte&0xC0)===0x80){tempCodePoint=(firstByte&0xF)<<0xC|(secondByte&0x3F)<<0x6|(thirdByte&0x3F)
if(tempCodePoint>0x7FF&&(tempCodePoint<0xD800||tempCodePoint>0xDFFF)){codePoint=tempCodePoint}}
break
case 4:secondByte=buf[i+1]
thirdByte=buf[i+2]
fourthByte=buf[i+3]
if((secondByte&0xC0)===0x80&&(thirdByte&0xC0)===0x80&&(fourthByte&0xC0)===0x80){tempCodePoint=(firstByte&0xF)<<0x12|(secondByte&0x3F)<<0xC|(thirdByte&0x3F)<<0x6|(fourthByte&0x3F)
if(tempCodePoint>0xFFFF&&tempCodePoint<0x110000){codePoint=tempCodePoint}}}}
if(codePoint===null){codePoint=0xFFFD
bytesPerSequence=1}else if(codePoint>0xFFFF){codePoint-=0x10000
res.push(codePoint>>>10&0x3FF|0xD800)
codePoint=0xDC00|codePoint&0x3FF}
res.push(codePoint)
i+=bytesPerSequence}
return decodeCodePointsArray(res)}
var MAX_ARGUMENTS_LENGTH=0x1000
function decodeCodePointsArray(codePoints){var len=codePoints.length
if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}
var res=''
var i=0
while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}
return res}
function asciiSlice(buf,start,end){var ret=''
end=Math.min(buf.length,end)
for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&0x7F)}
return ret}
function latin1Slice(buf,start,end){var ret=''
end=Math.min(buf.length,end)
for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}
return ret}
function hexSlice(buf,start,end){var len=buf.length
if(!start||start<0)start=0
if(!end||end<0||end>len)end=len
var out=''
for(var i=start;i<end;++i){out+=toHex(buf[i])}
return out}
function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end)
var res=''
for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+(bytes[i+1]*256))}
return res}
Buffer.prototype.slice=function slice(start,end){var len=this.length
start=~~start
end=end===undefined?len:~~end
if(start<0){start+=len
if(start<0)start=0}else if(start>len){start=len}
if(end<0){end+=len
if(end<0)end=0}else if(end>len){end=len}
if(end<start)end=start
var newBuf=this.subarray(start,end)
newBuf.__proto__=Buffer.prototype
return newBuf}
function checkOffset(offset,ext,length){if((offset%1)!==0||offset<0)throw new RangeError('offset is not uint')
if(offset+ext>length)throw new RangeError('Trying to access beyond buffer length')}
Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0
byteLength=byteLength>>>0
if(!noAssert)checkOffset(offset,byteLength,this.length)
var val=this[offset]
var mul=1
var i=0
while(++i<byteLength&&(mul*=0x100)){val+=this[offset+i]*mul}
return val}
Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0
byteLength=byteLength>>>0
if(!noAssert){checkOffset(offset,byteLength,this.length)}
var val=this[offset+ --byteLength]
var mul=1
while(byteLength>0&&(mul*=0x100)){val+=this[offset+ --byteLength]*mul}
return val}
Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,1,this.length)
return this[offset]}
Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,2,this.length)
return this[offset]|(this[offset+1]<<8)}
Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,2,this.length)
return(this[offset]<<8)|this[offset+1]}
Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,4,this.length)
return((this[offset])|(this[offset+1]<<8)|(this[offset+2]<<16))+(this[offset+3]*0x1000000)}
Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,4,this.length)
return(this[offset]*0x1000000)+((this[offset+1]<<16)|(this[offset+2]<<8)|this[offset+3])}
Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0
byteLength=byteLength>>>0
if(!noAssert)checkOffset(offset,byteLength,this.length)
var val=this[offset]
var mul=1
var i=0
while(++i<byteLength&&(mul*=0x100)){val+=this[offset+i]*mul}
mul*=0x80
if(val>=mul)val-=Math.pow(2,8*byteLength)
return val}
Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0
byteLength=byteLength>>>0
if(!noAssert)checkOffset(offset,byteLength,this.length)
var i=byteLength
var mul=1
var val=this[offset+ --i]
while(i>0&&(mul*=0x100)){val+=this[offset+ --i]*mul}
mul*=0x80
if(val>=mul)val-=Math.pow(2,8*byteLength)
return val}
Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,1,this.length)
if(!(this[offset]&0x80))return(this[offset])
return((0xff-this[offset]+1)*-1)}
Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,2,this.length)
var val=this[offset]|(this[offset+1]<<8)
return(val&0x8000)?val|0xFFFF0000:val}
Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,2,this.length)
var val=this[offset+1]|(this[offset]<<8)
return(val&0x8000)?val|0xFFFF0000:val}
Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,4,this.length)
return(this[offset])|(this[offset+1]<<8)|(this[offset+2]<<16)|(this[offset+3]<<24)}
Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,4,this.length)
return(this[offset]<<24)|(this[offset+1]<<16)|(this[offset+2]<<8)|(this[offset+3])}
Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,4,this.length)
return ieee754.read(this,offset,!0,23,4)}
Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,4,this.length)
return ieee754.read(this,offset,!1,23,4)}
Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,8,this.length)
return ieee754.read(this,offset,!0,52,8)}
Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0
if(!noAssert)checkOffset(offset,8,this.length)
return ieee754.read(this,offset,!1,52,8)}
function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance')
if(value>max||value<min)throw new RangeError('"value" argument is out of bounds')
if(offset+ext>buf.length)throw new RangeError('Index out of range')}
Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value
offset=offset>>>0
byteLength=byteLength>>>0
if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1
checkInt(this,value,offset,byteLength,maxBytes,0)}
var mul=1
var i=0
this[offset]=value&0xFF
while(++i<byteLength&&(mul*=0x100)){this[offset+i]=(value/mul)&0xFF}
return offset+byteLength}
Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value
offset=offset>>>0
byteLength=byteLength>>>0
if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1
checkInt(this,value,offset,byteLength,maxBytes,0)}
var i=byteLength-1
var mul=1
this[offset+i]=value&0xFF
while(--i>=0&&(mul*=0x100)){this[offset+i]=(value/mul)&0xFF}
return offset+byteLength}
Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,1,0xff,0)
this[offset]=(value&0xff)
return offset+1}
Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,2,0xffff,0)
this[offset]=(value&0xff)
this[offset+1]=(value>>>8)
return offset+2}
Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,2,0xffff,0)
this[offset]=(value>>>8)
this[offset+1]=(value&0xff)
return offset+2}
Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,4,0xffffffff,0)
this[offset+3]=(value>>>24)
this[offset+2]=(value>>>16)
this[offset+1]=(value>>>8)
this[offset]=(value&0xff)
return offset+4}
Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,4,0xffffffff,0)
this[offset]=(value>>>24)
this[offset+1]=(value>>>16)
this[offset+2]=(value>>>8)
this[offset+3]=(value&0xff)
return offset+4}
Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value
offset=offset>>>0
if(!noAssert){var limit=Math.pow(2,(8*byteLength)-1)
checkInt(this,value,offset,byteLength,limit-1,-limit)}
var i=0
var mul=1
var sub=0
this[offset]=value&0xFF
while(++i<byteLength&&(mul*=0x100)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}
this[offset+i]=((value/mul)>>0)-sub&0xFF}
return offset+byteLength}
Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value
offset=offset>>>0
if(!noAssert){var limit=Math.pow(2,(8*byteLength)-1)
checkInt(this,value,offset,byteLength,limit-1,-limit)}
var i=byteLength-1
var mul=1
var sub=0
this[offset+i]=value&0xFF
while(--i>=0&&(mul*=0x100)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}
this[offset+i]=((value/mul)>>0)-sub&0xFF}
return offset+byteLength}
Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,1,0x7f,-0x80)
if(value<0)value=0xff+value+1
this[offset]=(value&0xff)
return offset+1}
Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,2,0x7fff,-0x8000)
this[offset]=(value&0xff)
this[offset+1]=(value>>>8)
return offset+2}
Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,2,0x7fff,-0x8000)
this[offset]=(value>>>8)
this[offset+1]=(value&0xff)
return offset+2}
Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,4,0x7fffffff,-0x80000000)
this[offset]=(value&0xff)
this[offset+1]=(value>>>8)
this[offset+2]=(value>>>16)
this[offset+3]=(value>>>24)
return offset+4}
Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value
offset=offset>>>0
if(!noAssert)checkInt(this,value,offset,4,0x7fffffff,-0x80000000)
if(value<0)value=0xffffffff+value+1
this[offset]=(value>>>24)
this[offset+1]=(value>>>16)
this[offset+2]=(value>>>8)
this[offset+3]=(value&0xff)
return offset+4}
function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError('Index out of range')
if(offset<0)throw new RangeError('Index out of range')}
function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value
offset=offset>>>0
if(!noAssert){checkIEEE754(buf,value,offset,4,3.4028234663852886e+38,-3.4028234663852886e+38)}
ieee754.write(buf,value,offset,littleEndian,23,4)
return offset+4}
Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)}
Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)}
function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value
offset=offset>>>0
if(!noAssert){checkIEEE754(buf,value,offset,8,1.7976931348623157E+308,-1.7976931348623157E+308)}
ieee754.write(buf,value,offset,littleEndian,52,8)
return offset+8}
Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)}
Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)}
Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError('argument should be a Buffer')
if(!start)start=0
if(!end&&end!==0)end=this.length
if(targetStart>=target.length)targetStart=target.length
if(!targetStart)targetStart=0
if(end>0&&end<start)end=start
if(end===start)return 0
if(target.length===0||this.length===0)return 0
if(targetStart<0){throw new RangeError('targetStart out of bounds')}
if(start<0||start>=this.length)throw new RangeError('Index out of range')
if(end<0)throw new RangeError('sourceEnd out of bounds')
if(end>this.length)end=this.length
if(target.length-targetStart<end-start){end=target.length-targetStart+start}
var len=end-start
if(this===target&&typeof Uint8Array.prototype.copyWithin==='function'){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}
return len}
Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==='string'){if(typeof start==='string'){encoding=start
start=0
end=this.length}else if(typeof end==='string'){encoding=end
end=this.length}
if(encoding!==undefined&&typeof encoding!=='string'){throw new TypeError('encoding must be a string')}
if(typeof encoding==='string'&&!Buffer.isEncoding(encoding)){throw new TypeError('Unknown encoding: '+encoding)}
if(val.length===1){var code=val.charCodeAt(0)
if((encoding==='utf8'&&code<128)||encoding==='latin1'){val=code}}}else if(typeof val==='number'){val=val&255}
if(start<0||this.length<start||this.length<end){throw new RangeError('Out of range index')}
if(end<=start){return this}
start=start>>>0
end=end===undefined?this.length:end>>>0
if(!val)val=0
var i
if(typeof val==='number'){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding)
var len=bytes.length
if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}
for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}
return this}
var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g
function base64clean(str){str=str.split('=')[0]
str=str.trim().replace(INVALID_BASE64_RE,'')
if(str.length<2)return''
while(str.length%4!==0){str=str+'='}
return str}
function toHex(n){if(n<16)return'0'+n.toString(16)
return n.toString(16)}
function utf8ToBytes(string,units){units=units||Infinity
var codePoint
var length=string.length
var leadSurrogate=null
var bytes=[]
for(var i=0;i<length;++i){codePoint=string.charCodeAt(i)
if(codePoint>0xD7FF&&codePoint<0xE000){if(!leadSurrogate){if(codePoint>0xDBFF){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)
continue}else if(i+1===length){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)
continue}
leadSurrogate=codePoint
continue}
if(codePoint<0xDC00){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)
leadSurrogate=codePoint
continue}
codePoint=(leadSurrogate-0xD800<<10|codePoint-0xDC00)+0x10000}else if(leadSurrogate){if((units-=3)>-1)bytes.push(0xEF,0xBF,0xBD)}
leadSurrogate=null
if(codePoint<0x80){if((units-=1)<0)break
bytes.push(codePoint)}else if(codePoint<0x800){if((units-=2)<0)break
bytes.push(codePoint>>0x6|0xC0,codePoint&0x3F|0x80)}else if(codePoint<0x10000){if((units-=3)<0)break
bytes.push(codePoint>>0xC|0xE0,codePoint>>0x6&0x3F|0x80,codePoint&0x3F|0x80)}else if(codePoint<0x110000){if((units-=4)<0)break
bytes.push(codePoint>>0x12|0xF0,codePoint>>0xC&0x3F|0x80,codePoint>>0x6&0x3F|0x80,codePoint&0x3F|0x80)}else{throw new Error('Invalid code point')}}
return bytes}
function asciiToBytes(str){var byteArray=[]
for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&0xFF)}
return byteArray}
function utf16leToBytes(str,units){var c,hi,lo
var byteArray=[]
for(var i=0;i<str.length;++i){if((units-=2)<0)break
c=str.charCodeAt(i)
hi=c>>8
lo=c%256
byteArray.push(lo)
byteArray.push(hi)}
return byteArray}
function base64ToBytes(str){return base64.toByteArray(base64clean(str))}
function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if((i+offset>=dst.length)||(i>=src.length))break
dst[i+offset]=src[i]}
return i}
function isInstance(obj,type){return obj instanceof type||(obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name)}
function numberIsNaN(obj){return obj!==obj}}).call(this)}).call(this,require("buffer").Buffer)},{"base64-js":1,"buffer":3,"ieee754":5}],4:[function(require,module,exports){'use strict';var R=typeof Reflect==='object'?Reflect:null
var ReflectApply=R&&typeof R.apply==='function'?R.apply:function ReflectApply(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)}
var ReflectOwnKeys
if(R&&typeof R.ownKeys==='function'){ReflectOwnKeys=R.ownKeys}else if(Object.getOwnPropertySymbols){ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}}else{ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target)}}
function ProcessEmitWarning(warning){if(console&&console.warn)console.warn(warning);}
var NumberIsNaN=Number.isNaN||function NumberIsNaN(value){return value!==value}
function EventEmitter(){EventEmitter.init.call(this)}
module.exports=EventEmitter;module.exports.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;function checkListener(listener){if(typeof listener!=='function'){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}}
Object.defineProperty(EventEmitter,'defaultMaxListeners',{enumerable:!0,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=='number'||arg<0||NumberIsNaN(arg)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+'.')}
defaultMaxListeners=arg}});EventEmitter.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}
this._maxListeners=this._maxListeners||undefined};EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=='number'||n<0||NumberIsNaN(n)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+'.')}
this._maxListeners=n;return this};function _getMaxListeners(that){if(that._maxListeners===undefined)
return EventEmitter.defaultMaxListeners;return that._maxListeners}
EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function emit(type){var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);var doError=(type==='error');var events=this._events;if(events!==undefined)
doError=(doError&&events.error===undefined);else if(!doError)
return!1;if(doError){var er;if(args.length>0)
er=args[0];if(er instanceof Error){throw er}
var err=new Error('Unhandled error.'+(er?' ('+er.message+')':''));err.context=er;throw err}
var handler=events[type];if(handler===undefined)
return!1;if(typeof handler==='function'){ReflectApply(handler,this,args)}else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)
ReflectApply(listeners[i],this,args);}
return!0};function _addListener(target,type,listener,prepend){var m;var events;var existing;checkListener(listener);events=target._events;if(events===undefined){events=target._events=Object.create(null);target._eventsCount=0}else{if(events.newListener!==undefined){target.emit('newListener',type,listener.listener?listener.listener:listener);events=target._events}
existing=events[type]}
if(existing===undefined){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==='function'){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else if(prepend){existing.unshift(listener)}else{existing.push(listener)}
m=_getMaxListeners(target);if(m>0&&existing.length>m&&!existing.warned){existing.warned=!0;var w=new Error('Possible EventEmitter memory leak detected. '+existing.length+' '+String(type)+' listeners '+'added. Use emitter.setMaxListeners() to '+'increase limit');w.name='MaxListenersExceededWarning';w.emitter=target;w.type=type;w.count=existing.length;ProcessEmitWarning(w)}}
return target}
EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,!1)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,!0)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=!0;if(arguments.length===0)
return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}
function _onceWrap(target,type,listener){var state={fired:!1,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=onceWrapper.bind(state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}
EventEmitter.prototype.once=function once(type,listener){checkListener(listener);this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){checkListener(listener);this.prependListener(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;checkListener(listener);events=this._events;if(events===undefined)
return this;list=events[type];if(list===undefined)
return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)
this._events=Object.create(null);else{delete events[type];if(events.removeListener)
this.emit('removeListener',type,list.listener||listener);}}else if(typeof list!=='function'){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}
if(position<0)
return this;if(position===0)
list.shift();else{spliceOne(list,position)}
if(list.length===1)
events[type]=list[0];if(events.removeListener!==undefined)
this.emit('removeListener',type,originalListener||listener);}
return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(events===undefined)
return this;if(events.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(events[type]!==undefined){if(--this._eventsCount===0)
this._events=Object.create(null);else delete events[type]}
return this}
if(arguments.length===0){var keys=Object.keys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==='removeListener')continue;this.removeAllListeners(key)}
this.removeAllListeners('removeListener');this._events=Object.create(null);this._eventsCount=0;return this}
listeners=events[type];if(typeof listeners==='function'){this.removeListener(type,listeners)}else if(listeners!==undefined){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}
return this};function _listeners(target,type,unwrap){var events=target._events;if(events===undefined)
return[];var evlistener=events[type];if(evlistener===undefined)
return[];if(typeof evlistener==='function')
return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}
EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,!0)};EventEmitter.prototype.rawListeners=function rawListeners(type){return _listeners(this,type,!1)};EventEmitter.listenerCount=function(emitter,type){if(typeof emitter.listenerCount==='function'){return emitter.listenerCount(type)}else{return listenerCount.call(emitter,type)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(type){var events=this._events;if(events!==undefined){var evlistener=events[type];if(typeof evlistener==='function'){return 1}else if(evlistener!==undefined){return evlistener.length}}
return 0}
EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)
copy[i]=arr[i];return copy}
function spliceOne(list,index){for(;index+1<list.length;index++)
list[index]=list[index+1];list.pop()}
function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i){ret[i]=arr[i].listener||arr[i]}
return ret}
function once(emitter,name){return new Promise(function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver);reject(err)}
function resolver(){if(typeof emitter.removeListener==='function'){emitter.removeListener('error',errorListener)}
resolve([].slice.call(arguments))};eventTargetAgnosticAddListener(emitter,name,resolver,{once:!0});if(name!=='error'){addErrorHandlerIfEventEmitter(emitter,errorListener,{once:!0})}})}
function addErrorHandlerIfEventEmitter(emitter,handler,flags){if(typeof emitter.on==='function'){eventTargetAgnosticAddListener(emitter,'error',handler,flags)}}
function eventTargetAgnosticAddListener(emitter,name,listener,flags){if(typeof emitter.on==='function'){if(flags.once){emitter.once(name,listener)}else{emitter.on(name,listener)}}else if(typeof emitter.addEventListener==='function'){emitter.addEventListener(name,function wrapListener(arg){if(flags.once){emitter.removeEventListener(name,wrapListener)}
listener(arg)})}else{throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter)}}},{}],5:[function(require,module,exports){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m
var eLen=(nBytes*8)-mLen-1
var eMax=(1<<eLen)-1
var eBias=eMax>>1
var nBits=-7
var i=isLE?(nBytes-1):0
var d=isLE?-1:1
var s=buffer[offset+i]
i+=d
e=s&((1<<(-nBits))-1)
s>>=(-nBits)
nBits+=eLen
for(;nBits>0;e=(e*256)+buffer[offset+i],i+=d,nBits-=8){}
m=e&((1<<(-nBits))-1)
e>>=(-nBits)
nBits+=mLen
for(;nBits>0;m=(m*256)+buffer[offset+i],i+=d,nBits-=8){}
if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:((s?-1:1)*Infinity)}else{m=m+Math.pow(2,mLen)
e=e-eBias}
return(s?-1:1)*m*Math.pow(2,e-mLen)}
exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c
var eLen=(nBytes*8)-mLen-1
var eMax=(1<<eLen)-1
var eBias=eMax>>1
var rt=(mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0)
var i=isLE?0:(nBytes-1)
var d=isLE?1:-1
var s=value<0||(value===0&&1/value<0)?1:0
value=Math.abs(value)
if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0
e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2)
if(value*(c=Math.pow(2,-e))<1){e--
c*=2}
if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}
if(value*c>=2){e++
c/=2}
if(e+eBias>=eMax){m=0
e=eMax}else if(e+eBias>=1){m=((value*c)-1)*Math.pow(2,mLen)
e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen)
e=0}}
for(;mLen>=8;buffer[offset+i]=m&0xff,i+=d,m/=256,mLen-=8){}
e=(e<<mLen)|m
eLen+=mLen
for(;eLen>0;buffer[offset+i]=e&0xff,i+=d,e/=256,eLen-=8){}
buffer[offset+i-d]|=s*128}},{}],6:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error('setTimeout has not been defined')}
function defaultClearTimeout(){throw new Error('clearTimeout has not been defined')}(function(){try{if(typeof setTimeout==='function'){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}
try{if(typeof clearTimeout==='function'){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}}())
function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}
if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}
try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}
function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}
if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}
try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}
var queue=[];var draining=!1;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}
draining=!1;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}
if(queue.length){drainQueue()}}
function drainQueue(){if(draining){return}
var timeout=runTimeout(cleanUpNextTick);draining=!0;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}
queueIndex=-1;len=queue.length}
currentQueue=null;draining=!1;runClearTimeout(timeout)}
process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}
queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}
Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title='browser';process.browser=!0;process.env={};process.argv=[];process.version='';process.versions={};function noop(){}
process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]}
process.binding=function(name){throw new Error('process.binding is not supported')};process.cwd=function(){return'/'};process.chdir=function(dir){throw new Error('process.chdir is not supported')};process.umask=function(){return 0}},{}],7:[function(require,module,exports){(function(global){(function(){var tonWeb=require("tonweb");var dex=require("@ston-fi/sdk").DEX
var pTON=require("@ston-fi/sdk").pTON
global.window.TonWeb=tonWeb
global.window.DEX=dex
global.window.pTON=pTON}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"@ston-fi/sdk":20,"tonweb":340}],8:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.receiveAPDU=void 0;var _errors=require("@ledgerhq/errors");var _rxjs=require("rxjs");var _logs=require("@ledgerhq/logs");const TagId=0x05;const receiveAPDU=rawStream=>_rxjs.Observable.create(o=>{let notifiedIndex=0;let notifiedDataLength=0;let notifiedData=Buffer.alloc(0);const sub=rawStream.subscribe({complete:()=>{o.error(new _errors.DisconnectedDevice());sub.unsubscribe()},error:e=>{(0,_logs.log)("ble-error","in receiveAPDU "+String(e));o.error(e);sub.unsubscribe()},next:value=>{const tag=value.readUInt8(0);const index=value.readUInt16BE(1);let data=value.slice(3);if(tag!==TagId){o.error(new _errors.TransportError("Invalid tag "+tag.toString(16),"InvalidTag"));return}
if(notifiedIndex!==index){o.error(new _errors.TransportError("BLE: Invalid sequence number. discontinued chunk. Received "+index+" but expected "+notifiedIndex,"InvalidSequence"));return}
if(index===0){notifiedDataLength=data.readUInt16BE(0);data=data.slice(2)}
notifiedIndex++;notifiedData=Buffer.concat([notifiedData,data]);if(notifiedData.length>notifiedDataLength){o.error(new _errors.TransportError("BLE: received too much data. discontinued chunk. Received "+notifiedData.length+" but expected "+notifiedDataLength,"BLETooMuchData"));return}
if(notifiedData.length===notifiedDataLength){o.next(notifiedData);o.complete();sub.unsubscribe()}}});return()=>{sub.unsubscribe()}});exports.receiveAPDU=receiveAPDU}).call(this)}).call(this,require("buffer").Buffer)},{"@ledgerhq/errors":12,"@ledgerhq/logs":19,"buffer":3,"rxjs":56}],9:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.sendAPDU=void 0;var _rxjs=require("rxjs");var _logs=require("@ledgerhq/logs");const TagId=0x05;function chunkBuffer(buffer,sizeForIndex){const chunks=[];for(let i=0,size=sizeForIndex(0);i<buffer.length;i+=size,size=sizeForIndex(i)){chunks.push(buffer.slice(i,i+size))}
return chunks}
const sendAPDU=(write,apdu,mtuSize)=>{const chunks=chunkBuffer(apdu,i=>mtuSize-(i===0?5:3)).map((buffer,i)=>{const head=Buffer.alloc(i===0?5:3);head.writeUInt8(TagId,0);head.writeUInt16BE(i,1);if(i===0){head.writeUInt16BE(apdu.length,3)}
return Buffer.concat([head,buffer])});return _rxjs.Observable.create(o=>{let terminated=!1;async function main(){for(const chunk of chunks){if(terminated)return;await write(chunk)}}
main().then(()=>{terminated=!0;o.complete()},e=>{terminated=!0;(0,_logs.log)("ble-error","sendAPDU failure "+String(e));o.error(e)});const unsubscribe=()=>{if(!terminated){(0,_logs.log)("ble-verbose","sendAPDU interruption");terminated=!0}};return unsubscribe})};exports.sendAPDU=sendAPDU}).call(this)}).call(this,require("buffer").Buffer)},{"@ledgerhq/logs":19,"buffer":3,"rxjs":56}],10:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _errors=require("@ledgerhq/errors");const Tag=0x05;function asUInt16BE(value){const b=Buffer.alloc(2);b.writeUInt16BE(value,0);return b}
const initialAcc={data:Buffer.alloc(0),dataLength:0,sequence:0};const createHIDframing=(channel,packetSize)=>{return{makeBlocks(apdu){let data=Buffer.concat([asUInt16BE(apdu.length),apdu]);const blockSize=packetSize-5;const nbBlocks=Math.ceil(data.length/blockSize);data=Buffer.concat([data,Buffer.alloc(nbBlocks*blockSize-data.length+1).fill(0)]);const blocks=[];for(let i=0;i<nbBlocks;i++){const head=Buffer.alloc(5);head.writeUInt16BE(channel,0);head.writeUInt8(Tag,2);head.writeUInt16BE(i,3);const chunk=data.slice(i*blockSize,(i+1)*blockSize);blocks.push(Buffer.concat([head,chunk]))}
return blocks},reduceResponse(acc,chunk){let{data,dataLength,sequence}=acc||initialAcc;if(chunk.readUInt16BE(0)!==channel){throw new _errors.TransportError("Invalid channel","InvalidChannel")}
if(chunk.readUInt8(2)!==Tag){throw new _errors.TransportError("Invalid tag","InvalidTag")}
if(chunk.readUInt16BE(3)!==sequence){throw new _errors.TransportError("Invalid sequence","InvalidSequence")}
if(!acc){dataLength=chunk.readUInt16BE(5)}
sequence++;const chunkData=chunk.slice(acc?5:7);data=Buffer.concat([data,chunkData]);if(data.length>dataLength){data=data.slice(0,dataLength)}
return{data,dataLength,sequence}},getReducedResult(acc){if(acc&&acc.dataLength===acc.data.length){return acc.data}}}};var _default=createHIDframing;exports.default=_default}).call(this)}).call(this,require("buffer").Buffer)},{"@ledgerhq/errors":12,"buffer":3}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.getInfosForServiceUuid=exports.getBluetoothServiceUuids=exports.identifyProductName=exports.identifyUSBProductId=exports.getDeviceModel=exports.ledgerUSBVendorId=exports.IIWebUSB=exports.IICCID=exports.IIU2F=exports.IIKeyboardHID=exports.IIGenericHID=void 0;var _semver=_interopRequireDefault(require("semver"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0})}else{obj[key]=value}return obj}
const IIGenericHID=0x01;exports.IIGenericHID=IIGenericHID;const IIKeyboardHID=0x02;exports.IIKeyboardHID=IIKeyboardHID;const IIU2F=0x04;exports.IIU2F=IIU2F;const IICCID=0x08;exports.IICCID=IICCID;const IIWebUSB=0x10;exports.IIWebUSB=IIWebUSB;const devices={blue:{id:"blue",productName:"LedgerBlue",productIdMM:0x00,legacyUsbProductId:0x0000,usbOnly:!0,memorySize:480*1024,blockSize:4*1024,getBlockSize:_firwareVersion=>4*1024},nanoS:{id:"nanoS",productName:"LedgerNanoS",productIdMM:0x10,legacyUsbProductId:0x0001,usbOnly:!0,memorySize:320*1024,blockSize:4*1024,getBlockSize:firmwareVersion=>_semver.default.lt(_semver.default.coerce(firmwareVersion),"2.0.0")?4*1024:2*1024},nanoX:{id:"nanoX",productName:"LedgerNanoX",productIdMM:0x40,legacyUsbProductId:0x0004,usbOnly:!1,memorySize:2*1024*1024,blockSize:4*1024,getBlockSize:_firwareVersion=>4*1024,bluetoothSpec:[{serviceUuid:"d973f2e0-b19e-11e2-9e96-0800200c9a66",notifyUuid:"d973f2e1-b19e-11e2-9e96-0800200c9a66",writeUuid:"d973f2e2-b19e-11e2-9e96-0800200c9a66"},{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572"}]}};const productMap={Blue:"blue","Nano S":"nanoS","Nano X":"nanoX"};const devicesList=Object.values(devices);const ledgerUSBVendorId=0x2c97;exports.ledgerUSBVendorId=ledgerUSBVendorId;const getDeviceModel=id=>{const info=devices[id];if(!info)throw new Error("device '"+id+"' does not exist");return info};exports.getDeviceModel=getDeviceModel;const identifyUSBProductId=usbProductId=>{const legacy=devicesList.find(d=>d.legacyUsbProductId===usbProductId);if(legacy)return legacy;const mm=usbProductId>>8;const deviceModel=devicesList.find(d=>d.productIdMM===mm);return deviceModel};exports.identifyUSBProductId=identifyUSBProductId;const identifyProductName=productName=>{const productId=productMap[productName];const deviceModel=devicesList.find(d=>d.id===productId);return deviceModel};exports.identifyProductName=identifyProductName;const bluetoothServices=[];const serviceUuidToInfos={};for(let id in devices){const deviceModel=devices[id];const{bluetoothSpec}=deviceModel;if(bluetoothSpec){for(let i=0;i<bluetoothSpec.length;i++){const spec=bluetoothSpec[i];bluetoothServices.push(spec.serviceUuid);serviceUuidToInfos[spec.serviceUuid]=serviceUuidToInfos[spec.serviceUuid.replace(/-/g,"")]=_objectSpread({deviceModel},spec)}}}
const getBluetoothServiceUuids=()=>bluetoothServices;exports.getBluetoothServiceUuids=getBluetoothServiceUuids;const getInfosForServiceUuid=uuid=>serviceUuidToInfos[uuid.toLowerCase()];exports.getInfosForServiceUuid=getInfosForServiceUuid},{"semver":283}],12:[function(require,module,exports){'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var errorClasses={};var deserializers={};var addCustomErrorDeserializer=function(name,deserializer){deserializers[name]=deserializer};var createCustomErrorClass=function(name){var C=function CustomError(message,fields){Object.assign(this,fields);this.name=name;this.message=message||name;this.stack=new Error().stack};C.prototype=new Error();errorClasses[name]=C;return C};var deserializeError=function(object){if(typeof object==="object"&&object){try{var msg=JSON.parse(object.message);if(msg.message&&msg.name){object=msg}}catch(e){}
var error=void 0;if(typeof object.name==="string"){var name_1=object.name;var des=deserializers[name_1];if(des){error=des(object)}else{var constructor=name_1==="Error"?Error:errorClasses[name_1];if(!constructor){console.warn("deserializing an unknown class '"+name_1+"'");constructor=createCustomErrorClass(name_1)}
error=Object.create(constructor.prototype);try{for(var prop in object){if(object.hasOwnProperty(prop)){error[prop]=object[prop]}}}catch(e){}}}else{error=new Error(object.message)}
if(!error.stack&&Error.captureStackTrace){Error.captureStackTrace(error,deserializeError)}
return error}
return new Error(String(object))};var serializeError=function(value){if(!value)
return value;if(typeof value==="object"){return destroyCircular(value,[])}
if(typeof value==="function"){return"[Function: "+(value.name||"anonymous")+"]"}
return value};function destroyCircular(from,seen){var to={};seen.push(from);for(var _i=0,_a=Object.keys(from);_i<_a.length;_i++){var key=_a[_i];var value=from[key];if(typeof value==="function"){continue}
if(!value||typeof value!=="object"){to[key]=value;continue}
if(seen.indexOf(from[key])===-1){to[key]=destroyCircular(from[key],seen.slice(0));continue}
to[key]="[Circular]"}
if(typeof from.name==="string"){to.name=from.name}
if(typeof from.message==="string"){to.message=from.message}
if(typeof from.stack==="string"){to.stack=from.stack}
return to}
var AccountNameRequiredError=createCustomErrorClass("AccountNameRequired");var AccountNotSupported=createCustomErrorClass("AccountNotSupported");var AmountRequired=createCustomErrorClass("AmountRequired");var BluetoothRequired=createCustomErrorClass("BluetoothRequired");var BtcUnmatchedApp=createCustomErrorClass("BtcUnmatchedApp");var CantOpenDevice=createCustomErrorClass("CantOpenDevice");var CashAddrNotSupported=createCustomErrorClass("CashAddrNotSupported");var CurrencyNotSupported=createCustomErrorClass("CurrencyNotSupported");var DeviceAppVerifyNotSupported=createCustomErrorClass("DeviceAppVerifyNotSupported");var DeviceGenuineSocketEarlyClose=createCustomErrorClass("DeviceGenuineSocketEarlyClose");var DeviceNotGenuineError=createCustomErrorClass("DeviceNotGenuine");var DeviceOnDashboardExpected=createCustomErrorClass("DeviceOnDashboardExpected");var DeviceOnDashboardUnexpected=createCustomErrorClass("DeviceOnDashboardUnexpected");var DeviceInOSUExpected=createCustomErrorClass("DeviceInOSUExpected");var DeviceHalted=createCustomErrorClass("DeviceHalted");var DeviceNameInvalid=createCustomErrorClass("DeviceNameInvalid");var DeviceSocketFail=createCustomErrorClass("DeviceSocketFail");var DeviceSocketNoBulkStatus=createCustomErrorClass("DeviceSocketNoBulkStatus");var DisconnectedDevice=createCustomErrorClass("DisconnectedDevice");var DisconnectedDeviceDuringOperation=createCustomErrorClass("DisconnectedDeviceDuringOperation");var EnpointConfigError=createCustomErrorClass("EnpointConfig");var EthAppPleaseEnableContractData=createCustomErrorClass("EthAppPleaseEnableContractData");var FeeEstimationFailed=createCustomErrorClass("FeeEstimationFailed");var FirmwareNotRecognized=createCustomErrorClass("FirmwareNotRecognized");var HardResetFail=createCustomErrorClass("HardResetFail");var InvalidXRPTag=createCustomErrorClass("InvalidXRPTag");var InvalidAddress=createCustomErrorClass("InvalidAddress");var InvalidAddressBecauseDestinationIsAlsoSource=createCustomErrorClass("InvalidAddressBecauseDestinationIsAlsoSource");var LatestMCUInstalledError=createCustomErrorClass("LatestMCUInstalledError");var UnknownMCU=createCustomErrorClass("UnknownMCU");var LedgerAPIError=createCustomErrorClass("LedgerAPIError");var LedgerAPIErrorWithMessage=createCustomErrorClass("LedgerAPIErrorWithMessage");var LedgerAPINotAvailable=createCustomErrorClass("LedgerAPINotAvailable");var ManagerAppAlreadyInstalledError=createCustomErrorClass("ManagerAppAlreadyInstalled");var ManagerAppRelyOnBTCError=createCustomErrorClass("ManagerAppRelyOnBTC");var ManagerAppDepInstallRequired=createCustomErrorClass("ManagerAppDepInstallRequired");var ManagerAppDepUninstallRequired=createCustomErrorClass("ManagerAppDepUninstallRequired");var ManagerDeviceLockedError=createCustomErrorClass("ManagerDeviceLocked");var ManagerFirmwareNotEnoughSpaceError=createCustomErrorClass("ManagerFirmwareNotEnoughSpace");var ManagerNotEnoughSpaceError=createCustomErrorClass("ManagerNotEnoughSpace");var ManagerUninstallBTCDep=createCustomErrorClass("ManagerUninstallBTCDep");var NetworkDown=createCustomErrorClass("NetworkDown");var NoAddressesFound=createCustomErrorClass("NoAddressesFound");var NotEnoughBalance=createCustomErrorClass("NotEnoughBalance");var NotEnoughBalanceToDelegate=createCustomErrorClass("NotEnoughBalanceToDelegate");var NotEnoughBalanceInParentAccount=createCustomErrorClass("NotEnoughBalanceInParentAccount");var NotEnoughSpendableBalance=createCustomErrorClass("NotEnoughSpendableBalance");var NotEnoughBalanceBecauseDestinationNotCreated=createCustomErrorClass("NotEnoughBalanceBecauseDestinationNotCreated");var NoAccessToCamera=createCustomErrorClass("NoAccessToCamera");var NotEnoughGas=createCustomErrorClass("NotEnoughGas");var NotSupportedLegacyAddress=createCustomErrorClass("NotSupportedLegacyAddress");var GasLessThanEstimate=createCustomErrorClass("GasLessThanEstimate");var PasswordsDontMatchError=createCustomErrorClass("PasswordsDontMatch");var PasswordIncorrectError=createCustomErrorClass("PasswordIncorrect");var RecommendSubAccountsToEmpty=createCustomErrorClass("RecommendSubAccountsToEmpty");var RecommendUndelegation=createCustomErrorClass("RecommendUndelegation");var TimeoutTagged=createCustomErrorClass("TimeoutTagged");var UnexpectedBootloader=createCustomErrorClass("UnexpectedBootloader");var MCUNotGenuineToDashboard=createCustomErrorClass("MCUNotGenuineToDashboard");var RecipientRequired=createCustomErrorClass("RecipientRequired");var UnavailableTezosOriginatedAccountReceive=createCustomErrorClass("UnavailableTezosOriginatedAccountReceive");var UnavailableTezosOriginatedAccountSend=createCustomErrorClass("UnavailableTezosOriginatedAccountSend");var UpdateFetchFileFail=createCustomErrorClass("UpdateFetchFileFail");var UpdateIncorrectHash=createCustomErrorClass("UpdateIncorrectHash");var UpdateIncorrectSig=createCustomErrorClass("UpdateIncorrectSig");var UpdateYourApp=createCustomErrorClass("UpdateYourApp");var UserRefusedDeviceNameChange=createCustomErrorClass("UserRefusedDeviceNameChange");var UserRefusedAddress=createCustomErrorClass("UserRefusedAddress");var UserRefusedFirmwareUpdate=createCustomErrorClass("UserRefusedFirmwareUpdate");var UserRefusedAllowManager=createCustomErrorClass("UserRefusedAllowManager");var UserRefusedOnDevice=createCustomErrorClass("UserRefusedOnDevice");var TransportOpenUserCancelled=createCustomErrorClass("TransportOpenUserCancelled");var TransportInterfaceNotAvailable=createCustomErrorClass("TransportInterfaceNotAvailable");var TransportRaceCondition=createCustomErrorClass("TransportRaceCondition");var TransportWebUSBGestureRequired=createCustomErrorClass("TransportWebUSBGestureRequired");var DeviceShouldStayInApp=createCustomErrorClass("DeviceShouldStayInApp");var WebsocketConnectionError=createCustomErrorClass("WebsocketConnectionError");var WebsocketConnectionFailed=createCustomErrorClass("WebsocketConnectionFailed");var WrongDeviceForAccount=createCustomErrorClass("WrongDeviceForAccount");var WrongAppForCurrency=createCustomErrorClass("WrongAppForCurrency");var ETHAddressNonEIP=createCustomErrorClass("ETHAddressNonEIP");var CantScanQRCode=createCustomErrorClass("CantScanQRCode");var FeeNotLoaded=createCustomErrorClass("FeeNotLoaded");var FeeRequired=createCustomErrorClass("FeeRequired");var FeeTooHigh=createCustomErrorClass("FeeTooHigh");var SyncError=createCustomErrorClass("SyncError");var PairingFailed=createCustomErrorClass("PairingFailed");var GenuineCheckFailed=createCustomErrorClass("GenuineCheckFailed");var LedgerAPI4xx=createCustomErrorClass("LedgerAPI4xx");var LedgerAPI5xx=createCustomErrorClass("LedgerAPI5xx");var FirmwareOrAppUpdateRequired=createCustomErrorClass("FirmwareOrAppUpdateRequired");var NoDBPathGiven=createCustomErrorClass("NoDBPathGiven");var DBWrongPassword=createCustomErrorClass("DBWrongPassword");var DBNotReset=createCustomErrorClass("DBNotReset");function TransportError(message,id){this.name="TransportError";this.message=message;this.stack=new Error().stack;this.id=id}
TransportError.prototype=new Error();addCustomErrorDeserializer("TransportError",function(e){return new TransportError(e.message,e.id)});var StatusCodes={PIN_REMAINING_ATTEMPTS:0x63c0,INCORRECT_LENGTH:0x6700,MISSING_CRITICAL_PARAMETER:0x6800,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:0x6981,SECURITY_STATUS_NOT_SATISFIED:0x6982,CONDITIONS_OF_USE_NOT_SATISFIED:0x6985,INCORRECT_DATA:0x6a80,NOT_ENOUGH_MEMORY_SPACE:0x6a84,REFERENCED_DATA_NOT_FOUND:0x6a88,FILE_ALREADY_EXISTS:0x6a89,INCORRECT_P1_P2:0x6b00,INS_NOT_SUPPORTED:0x6d00,CLA_NOT_SUPPORTED:0x6e00,TECHNICAL_PROBLEM:0x6f00,OK:0x9000,MEMORY_PROBLEM:0x9240,NO_EF_SELECTED:0x9400,INVALID_OFFSET:0x9402,FILE_NOT_FOUND:0x9404,INCONSISTENT_FILE:0x9408,ALGORITHM_NOT_SUPPORTED:0x9484,INVALID_KCV:0x9485,CODE_NOT_INITIALIZED:0x9802,ACCESS_CONDITION_NOT_FULFILLED:0x9804,CONTRADICTION_SECRET_CODE_STATUS:0x9808,CONTRADICTION_INVALIDATION:0x9810,CODE_BLOCKED:0x9840,MAX_VALUE_REACHED:0x9850,GP_AUTH_FAILED:0x6300,LICENSING:0x6f42,HALTED:0x6faa,};function getAltStatusMessage(code){switch(code){case 0x6700:return"Incorrect length";case 0x6800:return"Missing critical parameter";case 0x6982:return"Security not satisfied (dongle locked or have invalid access rights)";case 0x6985:return"Condition of use not satisfied (denied by the user?)";case 0x6a80:return"Invalid data received";case 0x6b00:return"Invalid parameter received"}
if(0x6f00<=code&&code<=0x6fff){return"Internal error, please report"}}
function TransportStatusError(statusCode){this.name="TransportStatusError";var statusText=Object.keys(StatusCodes).find(function(k){return StatusCodes[k]===statusCode})||"UNKNOWN_ERROR";var smsg=getAltStatusMessage(statusCode)||statusText;var statusCodeStr=statusCode.toString(16);this.message="Ledger device: "+smsg+" (0x"+statusCodeStr+")";this.stack=new Error().stack;this.statusCode=statusCode;this.statusText=statusText}
TransportStatusError.prototype=new Error();addCustomErrorDeserializer("TransportStatusError",function(e){return new TransportStatusError(e.statusCode)});exports.AccountNameRequiredError=AccountNameRequiredError;exports.AccountNotSupported=AccountNotSupported;exports.AmountRequired=AmountRequired;exports.BluetoothRequired=BluetoothRequired;exports.BtcUnmatchedApp=BtcUnmatchedApp;exports.CantOpenDevice=CantOpenDevice;exports.CantScanQRCode=CantScanQRCode;exports.CashAddrNotSupported=CashAddrNotSupported;exports.CurrencyNotSupported=CurrencyNotSupported;exports.DBNotReset=DBNotReset;exports.DBWrongPassword=DBWrongPassword;exports.DeviceAppVerifyNotSupported=DeviceAppVerifyNotSupported;exports.DeviceGenuineSocketEarlyClose=DeviceGenuineSocketEarlyClose;exports.DeviceHalted=DeviceHalted;exports.DeviceInOSUExpected=DeviceInOSUExpected;exports.DeviceNameInvalid=DeviceNameInvalid;exports.DeviceNotGenuineError=DeviceNotGenuineError;exports.DeviceOnDashboardExpected=DeviceOnDashboardExpected;exports.DeviceOnDashboardUnexpected=DeviceOnDashboardUnexpected;exports.DeviceShouldStayInApp=DeviceShouldStayInApp;exports.DeviceSocketFail=DeviceSocketFail;exports.DeviceSocketNoBulkStatus=DeviceSocketNoBulkStatus;exports.DisconnectedDevice=DisconnectedDevice;exports.DisconnectedDeviceDuringOperation=DisconnectedDeviceDuringOperation;exports.ETHAddressNonEIP=ETHAddressNonEIP;exports.EnpointConfigError=EnpointConfigError;exports.EthAppPleaseEnableContractData=EthAppPleaseEnableContractData;exports.FeeEstimationFailed=FeeEstimationFailed;exports.FeeNotLoaded=FeeNotLoaded;exports.FeeRequired=FeeRequired;exports.FeeTooHigh=FeeTooHigh;exports.FirmwareNotRecognized=FirmwareNotRecognized;exports.FirmwareOrAppUpdateRequired=FirmwareOrAppUpdateRequired;exports.GasLessThanEstimate=GasLessThanEstimate;exports.GenuineCheckFailed=GenuineCheckFailed;exports.HardResetFail=HardResetFail;exports.InvalidAddress=InvalidAddress;exports.InvalidAddressBecauseDestinationIsAlsoSource=InvalidAddressBecauseDestinationIsAlsoSource;exports.InvalidXRPTag=InvalidXRPTag;exports.LatestMCUInstalledError=LatestMCUInstalledError;exports.LedgerAPI4xx=LedgerAPI4xx;exports.LedgerAPI5xx=LedgerAPI5xx;exports.LedgerAPIError=LedgerAPIError;exports.LedgerAPIErrorWithMessage=LedgerAPIErrorWithMessage;exports.LedgerAPINotAvailable=LedgerAPINotAvailable;exports.MCUNotGenuineToDashboard=MCUNotGenuineToDashboard;exports.ManagerAppAlreadyInstalledError=ManagerAppAlreadyInstalledError;exports.ManagerAppDepInstallRequired=ManagerAppDepInstallRequired;exports.ManagerAppDepUninstallRequired=ManagerAppDepUninstallRequired;exports.ManagerAppRelyOnBTCError=ManagerAppRelyOnBTCError;exports.ManagerDeviceLockedError=ManagerDeviceLockedError;exports.ManagerFirmwareNotEnoughSpaceError=ManagerFirmwareNotEnoughSpaceError;exports.ManagerNotEnoughSpaceError=ManagerNotEnoughSpaceError;exports.ManagerUninstallBTCDep=ManagerUninstallBTCDep;exports.NetworkDown=NetworkDown;exports.NoAccessToCamera=NoAccessToCamera;exports.NoAddressesFound=NoAddressesFound;exports.NoDBPathGiven=NoDBPathGiven;exports.NotEnoughBalance=NotEnoughBalance;exports.NotEnoughBalanceBecauseDestinationNotCreated=NotEnoughBalanceBecauseDestinationNotCreated;exports.NotEnoughBalanceInParentAccount=NotEnoughBalanceInParentAccount;exports.NotEnoughBalanceToDelegate=NotEnoughBalanceToDelegate;exports.NotEnoughGas=NotEnoughGas;exports.NotEnoughSpendableBalance=NotEnoughSpendableBalance;exports.NotSupportedLegacyAddress=NotSupportedLegacyAddress;exports.PairingFailed=PairingFailed;exports.PasswordIncorrectError=PasswordIncorrectError;exports.PasswordsDontMatchError=PasswordsDontMatchError;exports.RecipientRequired=RecipientRequired;exports.RecommendSubAccountsToEmpty=RecommendSubAccountsToEmpty;exports.RecommendUndelegation=RecommendUndelegation;exports.StatusCodes=StatusCodes;exports.SyncError=SyncError;exports.TimeoutTagged=TimeoutTagged;exports.TransportError=TransportError;exports.TransportInterfaceNotAvailable=TransportInterfaceNotAvailable;exports.TransportOpenUserCancelled=TransportOpenUserCancelled;exports.TransportRaceCondition=TransportRaceCondition;exports.TransportStatusError=TransportStatusError;exports.TransportWebUSBGestureRequired=TransportWebUSBGestureRequired;exports.UnavailableTezosOriginatedAccountReceive=UnavailableTezosOriginatedAccountReceive;exports.UnavailableTezosOriginatedAccountSend=UnavailableTezosOriginatedAccountSend;exports.UnexpectedBootloader=UnexpectedBootloader;exports.UnknownMCU=UnknownMCU;exports.UpdateFetchFileFail=UpdateFetchFileFail;exports.UpdateIncorrectHash=UpdateIncorrectHash;exports.UpdateIncorrectSig=UpdateIncorrectSig;exports.UpdateYourApp=UpdateYourApp;exports.UserRefusedAddress=UserRefusedAddress;exports.UserRefusedAllowManager=UserRefusedAllowManager;exports.UserRefusedDeviceNameChange=UserRefusedDeviceNameChange;exports.UserRefusedFirmwareUpdate=UserRefusedFirmwareUpdate;exports.UserRefusedOnDevice=UserRefusedOnDevice;exports.WebsocketConnectionError=WebsocketConnectionError;exports.WebsocketConnectionFailed=WebsocketConnectionFailed;exports.WrongAppForCurrency=WrongAppForCurrency;exports.WrongDeviceForAccount=WrongDeviceForAccount;exports.addCustomErrorDeserializer=addCustomErrorDeserializer;exports.createCustomErrorClass=createCustomErrorClass;exports.deserializeError=deserializeError;exports.getAltStatusMessage=getAltStatusMessage;exports.serializeError=serializeError},{}],13:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _hwTransport=_interopRequireDefault(require("@ledgerhq/hw-transport"));var _errors=require("@ledgerhq/errors");var _devices=require("@ledgerhq/devices");var _sendAPDU=require("@ledgerhq/devices/lib/ble/sendAPDU");var _receiveAPDU=require("@ledgerhq/devices/lib/ble/receiveAPDU");var _logs=require("@ledgerhq/logs");var _rxjs=require("rxjs");var _operators=require("rxjs/operators");var _monitorCharacteristic=require("./monitorCharacteristic");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
const requiresBluetooth=()=>{const{bluetooth}=navigator;if(typeof bluetooth==="undefined"){throw new Error("web bluetooth not supported")}
return bluetooth};const availability=()=>_rxjs.Observable.create(observer=>{const bluetooth=requiresBluetooth();const onAvailabilityChanged=e=>{observer.next(e.value)};bluetooth.addEventListener("availabilitychanged",onAvailabilityChanged);let unsubscribed=!1;bluetooth.getAvailability().then(available=>{if(!unsubscribed){observer.next(available)}});return()=>{unsubscribed=!0;bluetooth.removeEventListener("availabilitychanged",onAvailabilityChanged)}});const transportsCache={};const requestDeviceParam=()=>({filters:(0,_devices.getBluetoothServiceUuids)().map(uuid=>({services:[uuid]}))});const retrieveService=async device=>{if(!device.gatt)throw new Error("bluetooth gatt not found");const[service]=await device.gatt.getPrimaryServices();if(!service)throw new Error("bluetooth service not found");const infos=(0,_devices.getInfosForServiceUuid)(service.uuid);if(!infos)throw new Error("bluetooth service infos not found");return[service,infos]};async function open(deviceOrId,needsReconnect){let device;if(typeof deviceOrId==="string"){if(transportsCache[deviceOrId]){(0,_logs.log)("ble-verbose","Transport in cache, using that.");return transportsCache[deviceOrId]}
const bluetooth=requiresBluetooth();device=await bluetooth.requestDevice(requestDeviceParam())}else{device=deviceOrId}
if(!device.gatt.connected){(0,_logs.log)("ble-verbose","not connected. connecting...");await device.gatt.connect()}
const[service,infos]=await retrieveService(device);const{deviceModel,writeUuid,notifyUuid}=infos;const[writeC,notifyC]=await Promise.all([service.getCharacteristic(writeUuid),service.getCharacteristic(notifyUuid)]);const notifyObservable=(0,_monitorCharacteristic.monitorCharacteristic)(notifyC).pipe((0,_operators.tap)(value=>{(0,_logs.log)("ble-frame","<= "+value.toString("hex"))}),(0,_operators.share)());const notif=notifyObservable.subscribe();const transport=new BluetoothTransport(device,writeC,notifyObservable,deviceModel);if(!device.gatt.connected){throw new _errors.DisconnectedDevice()}
transportsCache[transport.id]=transport;const onDisconnect=e=>{console.log("onDisconnect!",e);delete transportsCache[transport.id];transport.notYetDisconnected=!1;notif.unsubscribe();device.removeEventListener("gattserverdisconnected",onDisconnect);(0,_logs.log)("ble-verbose",`BleTransport(${transport.id}) disconnected`);transport.emit("disconnect",e)};device.addEventListener("gattserverdisconnected",onDisconnect);let beforeMTUTime=Date.now();try{await transport.inferMTU()}finally{let afterMTUTime=Date.now();if(afterMTUTime-beforeMTUTime<1000){needsReconnect=!1}
if(needsReconnect){await device.gatt.disconnect();await new Promise(s=>setTimeout(s,4000))}}
if(needsReconnect){return open(device,!1)}
return transport}
class BluetoothTransport extends _hwTransport.default{static listen(observer){(0,_logs.log)("ble-verbose","listen...");let unsubscribed;const bluetooth=requiresBluetooth();bluetooth.requestDevice(requestDeviceParam()).then(async device=>{if(!unsubscribed){observer.next({type:"add",descriptor:device});observer.complete()}},error=>{observer.error(new _errors.TransportOpenUserCancelled(error.message))});function unsubscribe(){unsubscribed=!0}
return{unsubscribe}}
static async open(deviceOrId){return open(deviceOrId,!0)}
constructor(device,writeCharacteristic,notifyObservable,deviceModel){super();this.id=void 0;this.device=void 0;this.mtuSize=20;this.writeCharacteristic=void 0;this.notifyObservable=void 0;this.notYetDisconnected=!0;this.deviceModel=void 0;this.exchange=apdu=>this.exchangeAtomicImpl(async()=>{try{const msgIn=apdu.toString("hex");(0,_logs.log)("apdu",`=> ${msgIn}`);const data=await(0,_rxjs.merge)(this.notifyObservable.pipe(_receiveAPDU.receiveAPDU),(0,_sendAPDU.sendAPDU)(this.write,apdu,this.mtuSize)).toPromise();const msgOut=data.toString("hex");(0,_logs.log)("apdu",`<= ${msgOut}`);return data}catch(e){(0,_logs.log)("ble-error","exchange got "+String(e));if(this.notYetDisconnected){this.device.gatt.disconnect()}
throw e}});this.write=async buffer=>{(0,_logs.log)("ble-frame","=> "+buffer.toString("hex"));await this.writeCharacteristic.writeValue(buffer)};this.id=device.id;this.device=device;this.writeCharacteristic=writeCharacteristic;this.notifyObservable=notifyObservable;this.deviceModel=deviceModel;(0,_logs.log)("ble-verbose",`BleTransport(${String(this.id)}) new instance`)}
async inferMTU(){let mtu=23;await this.exchangeAtomicImpl(async()=>{try{mtu=(await(0,_rxjs.merge)(this.notifyObservable.pipe((0,_operators.first)(buffer=>buffer.readUInt8(0)===0x08),(0,_operators.map)(buffer=>buffer.readUInt8(5))),(0,_rxjs.defer)(()=>(0,_rxjs.from)(this.write(Buffer.from([0x08,0,0,0,0])))).pipe((0,_operators.ignoreElements)())).toPromise())+3}catch(e){(0,_logs.log)("ble-error","inferMTU got "+String(e));this.device.gatt.disconnect();throw e}});if(mtu>23){const mtuSize=mtu-3;(0,_logs.log)("ble-verbose",`BleTransport(${String(this.id)}) mtu set to ${String(mtuSize)}`);this.mtuSize=mtuSize}
return this.mtuSize}
setScrambleKey(){}
async close(){if(this.exchangeBusyPromise){await this.exchangeBusyPromise}}}
exports.default=BluetoothTransport;BluetoothTransport.isSupported=()=>Promise.resolve().then(requiresBluetooth).then(()=>!0,()=>!1);BluetoothTransport.observeAvailability=observer=>availability.subscribe(observer);BluetoothTransport.list=()=>Promise.resolve([]);BluetoothTransport.disconnect=async id=>{(0,_logs.log)("ble-verbose",`user disconnect(${id})`);const transport=transportsCache[id];if(transport){transport.device.gatt.disconnect()}}}).call(this)}).call(this,require("buffer").Buffer)},{"./monitorCharacteristic":14,"@ledgerhq/devices":11,"@ledgerhq/devices/lib/ble/receiveAPDU":8,"@ledgerhq/devices/lib/ble/sendAPDU":9,"@ledgerhq/errors":12,"@ledgerhq/hw-transport":18,"@ledgerhq/logs":19,"buffer":3,"rxjs":56,"rxjs/operators":255}],14:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.monitorCharacteristic=void 0;var _rxjs=require("rxjs");var _logs=require("@ledgerhq/logs");const monitorCharacteristic=characteristic=>_rxjs.Observable.create(o=>{(0,_logs.log)("ble-verbose","start monitor "+characteristic.uuid);function onCharacteristicValueChanged(event){const characteristic=event.target;if(characteristic.value){o.next(Buffer.from(characteristic.value.buffer))}}
characteristic.startNotifications().then(()=>{characteristic.addEventListener("characteristicvaluechanged",onCharacteristicValueChanged)});return()=>{(0,_logs.log)("ble-verbose","end monitor "+characteristic.uuid);characteristic.stopNotifications()}});exports.monitorCharacteristic=monitorCharacteristic}).call(this)}).call(this,require("buffer").Buffer)},{"@ledgerhq/logs":19,"buffer":3,"rxjs":56}],15:[function(require,module,exports){(function(global,Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _hwTransport=_interopRequireDefault(require("@ledgerhq/hw-transport"));var _hidFraming=_interopRequireDefault(require("@ledgerhq/devices/lib/hid-framing"));var _devices=require("@ledgerhq/devices");var _logs=require("@ledgerhq/logs");var _errors=require("@ledgerhq/errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
const ledgerDevices=[{vendorId:_devices.ledgerUSBVendorId}];const isSupported=()=>Promise.resolve(!!(global.navigator&&global.navigator.hid));const getHID=()=>{const{hid}=navigator;if(!hid)throw new _errors.TransportError("navigator.hid is not supported","HIDNotSupported");return hid};async function requestLedgerDevices(){const device=await getHID().requestDevice({filters:ledgerDevices});if(Array.isArray(device))return device;return[device]}
async function getLedgerDevices(){const devices=await getHID().getDevices();return devices.filter(d=>d.vendorId===_devices.ledgerUSBVendorId)}
async function getFirstLedgerDevice(){const existingDevices=await getLedgerDevices();if(existingDevices.length>0)return existingDevices[0];const devices=await requestLedgerDevices();return devices[0]}
class TransportWebHID extends _hwTransport.default{constructor(device){super();this.device=void 0;this.deviceModel=void 0;this.channel=Math.floor(Math.random()*0xffff);this.packetSize=64;this.inputs=[];this.inputCallback=void 0;this.read=()=>{if(this.inputs.length){return Promise.resolve(this.inputs.shift())}
return new Promise(success=>{this.inputCallback=success})};this.onInputReport=e=>{const buffer=Buffer.from(e.data.buffer);if(this.inputCallback){this.inputCallback(buffer);this.inputCallback=null}else{this.inputs.push(buffer)}};this._disconnectEmitted=!1;this._emitDisconnect=e=>{if(this._disconnectEmitted)return;this._disconnectEmitted=!0;this.emit("disconnect",e)};this.exchange=apdu=>this.exchangeAtomicImpl(async()=>{const{channel,packetSize}=this;(0,_logs.log)("apdu","=> "+apdu.toString("hex"));const framing=(0,_hidFraming.default)(channel,packetSize);const blocks=framing.makeBlocks(apdu);for(let i=0;i<blocks.length;i++){await this.device.sendReport(0,blocks[i])}
let result;let acc;while(!(result=framing.getReducedResult(acc))){const buffer=await this.read();acc=framing.reduceResponse(acc,buffer)}(0,_logs.log)("apdu","<= "+result.toString("hex"));return result}).catch(e=>{if(e&&e.message&&e.message.includes("write")){this._emitDisconnect(e);throw new _errors.DisconnectedDeviceDuringOperation(e.message)}
throw e});this.device=device;this.deviceModel=(0,_devices.identifyUSBProductId)(device.productId);device.addEventListener("inputreport",this.onInputReport)}
static async request(){const[device]=await requestLedgerDevices();return TransportWebHID.open(device)}
static async openConnected(){const devices=await getLedgerDevices();if(devices.length===0)return null;return TransportWebHID.open(devices[0])}
static async open(device){await device.open();const transport=new TransportWebHID(device);const onDisconnect=e=>{if(device===e.device){getHID().removeEventListener("disconnect",onDisconnect);transport._emitDisconnect(new _errors.DisconnectedDevice())}};getHID().addEventListener("disconnect",onDisconnect);return transport}
async close(){await this.exchangeBusyPromise;this.device.removeEventListener("inputreport",this.onInputReport);await this.device.close()}
setScrambleKey(){}}
exports.default=TransportWebHID;TransportWebHID.isSupported=isSupported;TransportWebHID.list=getLedgerDevices;TransportWebHID.listen=observer=>{let unsubscribed=!1;getFirstLedgerDevice().then(device=>{if(!device){observer.error(new _errors.TransportOpenUserCancelled("Access denied to use Ledger device"))}else if(!unsubscribed){const deviceModel=(0,_devices.identifyUSBProductId)(device.productId);observer.next({type:"add",descriptor:device,deviceModel});observer.complete()}},error=>{observer.error(new _errors.TransportOpenUserCancelled(error.message))});function unsubscribe(){unsubscribed=!0}
return{unsubscribe}}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"@ledgerhq/devices":11,"@ledgerhq/devices/lib/hid-framing":10,"@ledgerhq/errors":12,"@ledgerhq/hw-transport":18,"@ledgerhq/logs":19,"buffer":3}],16:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _hwTransport=_interopRequireDefault(require("@ledgerhq/hw-transport"));var _hidFraming=_interopRequireDefault(require("@ledgerhq/devices/lib/hid-framing"));var _devices=require("@ledgerhq/devices");var _logs=require("@ledgerhq/logs");var _errors=require("@ledgerhq/errors");var _webusb=require("./webusb");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
const configurationValue=1;const endpointNumber=3;class TransportWebUSB extends _hwTransport.default{constructor(device,interfaceNumber){super();this.device=void 0;this.deviceModel=void 0;this.channel=Math.floor(Math.random()*0xffff);this.packetSize=64;this.interfaceNumber=void 0;this._disconnectEmitted=!1;this._emitDisconnect=e=>{if(this._disconnectEmitted)return;this._disconnectEmitted=!0;this.emit("disconnect",e)};this.exchange=apdu=>this.exchangeAtomicImpl(async()=>{const{channel,packetSize}=this;(0,_logs.log)("apdu","=> "+apdu.toString("hex"));const framing=(0,_hidFraming.default)(channel,packetSize);const blocks=framing.makeBlocks(apdu);for(let i=0;i<blocks.length;i++){await this.device.transferOut(endpointNumber,blocks[i])}
let result;let acc;while(!(result=framing.getReducedResult(acc))){const r=await this.device.transferIn(endpointNumber,packetSize);const buffer=Buffer.from(r.data.buffer);acc=framing.reduceResponse(acc,buffer)}(0,_logs.log)("apdu","<= "+result.toString("hex"));return result}).catch(e=>{if(e&&e.message&&e.message.includes("disconnected")){this._emitDisconnect(e);throw new _errors.DisconnectedDeviceDuringOperation(e.message)}
throw e});this.device=device;this.interfaceNumber=interfaceNumber;this.deviceModel=(0,_devices.identifyUSBProductId)(device.productId)}
static async request(){const device=await(0,_webusb.requestLedgerDevice)();return TransportWebUSB.open(device)}
static async openConnected(){const devices=await(0,_webusb.getLedgerDevices)();if(devices.length===0)return null;return TransportWebUSB.open(devices[0])}
static async open(device){await device.open();if(device.configuration===null){await device.selectConfiguration(configurationValue)}
await gracefullyResetDevice(device);const iface=device.configurations[0].interfaces.find(({alternates})=>alternates.some(a=>a.interfaceClass===255));if(!iface){throw new _errors.TransportInterfaceNotAvailable("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.")}
const interfaceNumber=iface.interfaceNumber;try{await device.claimInterface(interfaceNumber)}catch(e){await device.close();throw new _errors.TransportInterfaceNotAvailable(e.message)}
const transport=new TransportWebUSB(device,interfaceNumber);const onDisconnect=e=>{if(device===e.device){navigator.usb.removeEventListener("disconnect",onDisconnect);transport._emitDisconnect(new _errors.DisconnectedDevice())}};navigator.usb.addEventListener("disconnect",onDisconnect);return transport}
async close(){await this.exchangeBusyPromise;await this.device.releaseInterface(this.interfaceNumber);await gracefullyResetDevice(this.device);await this.device.close()}
setScrambleKey(){}}
exports.default=TransportWebUSB;TransportWebUSB.isSupported=_webusb.isSupported;TransportWebUSB.list=_webusb.getLedgerDevices;TransportWebUSB.listen=observer=>{let unsubscribed=!1;(0,_webusb.getFirstLedgerDevice)().then(device=>{if(!unsubscribed){const deviceModel=(0,_devices.identifyUSBProductId)(device.productId);observer.next({type:"add",descriptor:device,deviceModel});observer.complete()}},error=>{if(window.DOMException&&error instanceof window.DOMException&&error.code===18){observer.error(new _errors.TransportWebUSBGestureRequired(error.message))}else{observer.error(new _errors.TransportOpenUserCancelled(error.message))}});function unsubscribe(){unsubscribed=!0}
return{unsubscribe}};async function gracefullyResetDevice(device){try{await device.reset()}catch(err){console.warn(err)}}}).call(this)}).call(this,require("buffer").Buffer)},{"./webusb":17,"@ledgerhq/devices":11,"@ledgerhq/devices/lib/hid-framing":10,"@ledgerhq/errors":12,"@ledgerhq/hw-transport":18,"@ledgerhq/logs":19,"buffer":3}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.requestLedgerDevice=requestLedgerDevice;exports.getLedgerDevices=getLedgerDevices;exports.getFirstLedgerDevice=getFirstLedgerDevice;exports.isSupported=void 0;var _devices=require("@ledgerhq/devices");const ledgerDevices=[{vendorId:_devices.ledgerUSBVendorId}];async function requestLedgerDevice(){const device=await navigator.usb.requestDevice({filters:ledgerDevices});return device}
async function getLedgerDevices(){const devices=await navigator.usb.getDevices();return devices.filter(d=>d.vendorId===_devices.ledgerUSBVendorId)}
async function getFirstLedgerDevice(){const existingDevices=await getLedgerDevices();if(existingDevices.length>0)return existingDevices[0];return requestLedgerDevice()}
const isSupported=()=>Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices==="function");exports.isSupported=isSupported},{"@ledgerhq/devices":11}],18:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});Object.defineProperty(exports,"TransportError",{enumerable:!0,get:function(){return _errors.TransportError}});Object.defineProperty(exports,"StatusCodes",{enumerable:!0,get:function(){return _errors.StatusCodes}});Object.defineProperty(exports,"getAltStatusMessage",{enumerable:!0,get:function(){return _errors.getAltStatusMessage}});Object.defineProperty(exports,"TransportStatusError",{enumerable:!0,get:function(){return _errors.TransportStatusError}});exports.default=void 0;var _events=_interopRequireDefault(require("events"));var _errors=require("@ledgerhq/errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
class Transport{constructor(){this.exchangeTimeout=30000;this.unresponsiveTimeout=15000;this.deviceModel=null;this._events=new _events.default();this.send=async(cla,ins,p1,p2,data=Buffer.alloc(0),statusList=[_errors.StatusCodes.OK])=>{if(data.length>=256){throw new _errors.TransportError("data.length exceed 256 bytes limit. Got: "+data.length,"DataLengthTooBig")}
const response=await this.exchange(Buffer.concat([Buffer.from([cla,ins,p1,p2]),Buffer.from([data.length]),data]));const sw=response.readUInt16BE(response.length-2);if(!statusList.some(s=>s===sw)){throw new _errors.TransportStatusError(sw)}
return response};this.exchangeBusyPromise=void 0;this.exchangeAtomicImpl=async f=>{if(this.exchangeBusyPromise){throw new _errors.TransportRaceCondition("An action was already pending on the Ledger device. Please deny or reconnect.")}
let resolveBusy;const busyPromise=new Promise(r=>{resolveBusy=r});this.exchangeBusyPromise=busyPromise;let unresponsiveReached=!1;const timeout=setTimeout(()=>{unresponsiveReached=!0;this.emit("unresponsive")},this.unresponsiveTimeout);try{const res=await f();if(unresponsiveReached){this.emit("responsive")}
return res}finally{clearTimeout(timeout);if(resolveBusy)resolveBusy();this.exchangeBusyPromise=null}};this._appAPIlock=null}
exchange(_apdu){throw new Error("exchange not implemented")}
setScrambleKey(_key){}
close(){return Promise.resolve()}
on(eventName,cb){this._events.on(eventName,cb)}
off(eventName,cb){this._events.removeListener(eventName,cb)}
emit(event,...args){this._events.emit(event,...args)}
setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}
setExchangeTimeout(exchangeTimeout){this.exchangeTimeout=exchangeTimeout}
setExchangeUnresponsiveTimeout(unresponsiveTimeout){this.unresponsiveTimeout=unresponsiveTimeout}
static create(openTimeout=3000,listenTimeout){return new Promise((resolve,reject)=>{let found=!1;const sub=this.listen({next:e=>{found=!0;if(sub)sub.unsubscribe();if(listenTimeoutId)clearTimeout(listenTimeoutId);this.open(e.descriptor,openTimeout).then(resolve,reject)},error:e=>{if(listenTimeoutId)clearTimeout(listenTimeoutId);reject(e)},complete:()=>{if(listenTimeoutId)clearTimeout(listenTimeoutId);if(!found){reject(new _errors.TransportError(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}});const listenTimeoutId=listenTimeout?setTimeout(()=>{sub.unsubscribe();reject(new _errors.TransportError(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},listenTimeout):null})}
decorateAppAPIMethods(self,methods,scrambleKey){for(let methodName of methods){self[methodName]=this.decorateAppAPIMethod(methodName,self[methodName],self,scrambleKey)}}
decorateAppAPIMethod(methodName,f,ctx,scrambleKey){return async(...args)=>{const{_appAPIlock}=this;if(_appAPIlock){return Promise.reject(new _errors.TransportError("Ledger Device is busy (lock "+_appAPIlock+")","TransportLocked"))}
try{this._appAPIlock=methodName;this.setScrambleKey(scrambleKey);return await f.apply(ctx,args)}finally{this._appAPIlock=null}}}}
exports.default=Transport;Transport.isSupported=void 0;Transport.list=void 0;Transport.listen=void 0;Transport.open=void 0;Transport.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";Transport.ErrorMessage_NoDeviceFound="No Ledger device found"}).call(this)}).call(this,require("buffer").Buffer)},{"@ledgerhq/errors":12,"buffer":3,"events":4}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.listen=exports.log=void 0;let id=0;const subscribers=[];const log=(type,message,data)=>{const obj={type,id:String(++id),date:new Date()};if(message)obj.message=message;if(data)obj.data=data;dispatch(obj)};exports.log=log;const listen=cb=>{subscribers.push(cb);return()=>{const i=subscribers.indexOf(cb);if(i!==-1){subscribers[i]=subscribers[subscribers.length-1];subscribers.pop()}}};exports.listen=listen;function dispatch(log){for(let i=0;i<subscribers.length;i++){try{subscribers[i](log)}catch(e){console.error(e)}}}
if(typeof window!=="undefined"){window.__ledgerLogsListen=listen}},{}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("./index2.cjs"),a=require("./index3.cjs"),n=require("./index4.cjs"),o=require("./index5.cjs"),c=require("./index6.cjs"),e=require("./index7.cjs"),i=require("./index8.cjs"),O=require("./index9.cjs"),r=require("./index10.cjs"),s=require("./index11.cjs"),S=require("./index12.cjs");exports.DEX=t.DEX;exports.FARM=a.FARM;exports.pTON=n.pTON;exports.createJettonTransferMessage=o.createJettonTransferMessage;exports.createSbtDestroyMessage=c.createSbtDestroyMessage;exports.parseAddress=e.parseAddress;exports.parseAddressNotNull=e.parseAddressNotNull;exports.parseBoolean=i.parseBoolean;exports.parseString=O.parseString;exports.DEX_OP_CODES=r.DEX_OP_CODES;exports.DEX_VERSION=r.DEX_VERSION;exports.FARM_OP_CODES=s.FARM_OP_CODES;exports.FARM_VERSION=s.FARM_VERSION;exports.pTON_VERSION=S.pTON_VERSION},{"./index10.cjs":21,"./index11.cjs":22,"./index12.cjs":23,"./index2.cjs":31,"./index3.cjs":40,"./index4.cjs":41,"./index5.cjs":42,"./index6.cjs":43,"./index7.cjs":44,"./index8.cjs":45,"./index9.cjs":46}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const E={ADD_LIQUIDITY:1935855772,SWAP:630424929,PROVIDE_LIQUIDITY:4244235663,DIRECT_ADD_LIQUIDITY:1291331587,REFUND:200537159,RESET_GAS:1117846339,COLLECT_FEES:533429565,REQUEST_BURN:1499400124},D={v1:"v1"};exports.DEX_OP_CODES=E;exports.DEX_VERSION=D},{}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const S={STAKE:1858722917,CLAIM_REWARDS:2027548937,UNSTAKE:3106497952},t={v1:"v1",v2:"v2",v3:"v3"};exports.FARM_OP_CODES=S;exports.FARM_VERSION=t},{}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e={v1:"v1"};exports.pTON_VERSION=e},{}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const J=require("tonweb"),S=require("./index23.cjs"),l=require("./index5.cjs"),y=require("./index7.cjs"),h=require("./index8.cjs"),c=require("./index10.cjs"),C=require("./index14.cjs"),{utils:{BN:n,bytesToBase64:T},boc:{Cell:w},Address:s,Contract:p,token:{jetton:{JettonMinter:f}}}=J,u=class g extends p{constructor({tonApiClient:t,stonApiClient:e,gasConstants:r,...o}){super(t,{...o,address:o.address??g.address}),this.stonApiClient=e??new S.StonApiClient(t),this.gasConstants={...g.gasConstants,...r}}async createSwapBody(t){const e=new w;return e.bits.writeUint(c.DEX_OP_CODES.SWAP,32),e.bits.writeAddress(new s(t.askJettonWalletAddress)),e.bits.writeCoins(new n(t.minAskAmount)),e.bits.writeAddress(new s(t.userWalletAddress)),t.referralAddress?(e.bits.writeUint(1,1),e.bits.writeAddress(new s(t.referralAddress))):e.bits.writeUint(0,1),e}async buildSwapJettonToJettonTxParams(t){const e=await this.getAddress(),[r,o]=await Promise.all([(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.offerJettonAddress.toString(),ownerAddress:t.userWalletAddress.toString()})))(),(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.askJettonAddress.toString(),ownerAddress:e.toString()})))()]),i=await this.createSwapBody({userWalletAddress:t.userWalletAddress,minAskAmount:t.minAskAmount,askJettonWalletAddress:o,referralAddress:t.referralAddress}),d=new n(t.forwardGasAmount??this.gasConstants.swapJettonToJetton.forwardGasAmount),a=l.createJettonTransferMessage({queryId:t.queryId??0,amount:t.offerAmount,destination:e,responseDestination:t.userWalletAddress,forwardTonAmount:d,forwardPayload:i}),A=new n(t.gasAmount??this.gasConstants.swapJettonToJetton.gasAmount);return{to:new s(r.toString(!0,!0,!0)),payload:a,gasAmount:A}}async buildSwapJettonToTonTxParams(t){return await this.buildSwapJettonToJettonTxParams({...t,askJettonAddress:t.proxyTonAddress,gasAmount:t.gasAmount??this.gasConstants.swapJettonToTon.gasAmount,forwardGasAmount:t.forwardGasAmount??this.gasConstants.swapJettonToTon.forwardGasAmount})}async buildSwapTonToJettonTxParams(t){const e=await this.getAddress(),[r,o]=await Promise.all([(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.proxyTonAddress.toString(),ownerAddress:e.toString()})))(),(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.askJettonAddress.toString(),ownerAddress:e.toString()})))()]),i=await this.createSwapBody({userWalletAddress:t.userWalletAddress,minAskAmount:t.minAskAmount,askJettonWalletAddress:o,referralAddress:t.referralAddress}),d=new n(t.forwardGasAmount??this.gasConstants.swapTonToJetton.forwardGasAmount),a=l.createJettonTransferMessage({queryId:t.queryId??0,amount:t.offerAmount,destination:e,forwardTonAmount:d,forwardPayload:i}),A=new n(t.offerAmount).add(d);return{to:new s(r.toString(!0,!0,!0)),payload:a,gasAmount:A}}async createProvideLiquidityBody(t){const e=new w;return e.bits.writeUint(c.DEX_OP_CODES.PROVIDE_LIQUIDITY,32),e.bits.writeAddress(new s(t.routerWalletAddress)),e.bits.writeCoins(new n(t.minLpOut)),e}async buildProvideLiquidityJettonTxParams(t){const e=await this.getAddress(),[r,o]=await Promise.all([(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.sendTokenAddress.toString(),ownerAddress:t.userWalletAddress.toString()})))(),(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.otherTokenAddress.toString(),ownerAddress:e.toString()})))()]),i=await this.createProvideLiquidityBody({routerWalletAddress:o,minLpOut:t.minLpOut}),d=new n(t.forwardGasAmount??this.gasConstants.provideLpJetton.forwardGasAmount),a=l.createJettonTransferMessage({queryId:t.queryId??0,amount:t.sendAmount,destination:e,responseDestination:t.userWalletAddress,forwardTonAmount:d,forwardPayload:i}),A=new n(t.gasAmount??this.gasConstants.provideLpJetton.gasAmount);return{to:new s(r.toString(!0,!0,!0)),payload:a,gasAmount:A}}async buildProvideLiquidityTonTxParams(t){const e=await this.getAddress(),[r,o]=await Promise.all([(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.proxyTonAddress.toString(),ownerAddress:e.toString()})))(),(async()=>new s(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.otherTokenAddress.toString(),ownerAddress:e.toString()})))()]),i=await this.createProvideLiquidityBody({routerWalletAddress:o,minLpOut:t.minLpOut}),d=new n(t.forwardGasAmount??this.gasConstants.provideLpTon.forwardGasAmount),a=l.createJettonTransferMessage({queryId:t.queryId??0,amount:t.sendAmount,destination:e,forwardTonAmount:d,forwardPayload:i}),A=new n(t.sendAmount).add(d);return{to:new s(r.toString(!0,!0,!0)),payload:a,gasAmount:A}}async getPoolAddress(t){const e=new w;e.bits.writeAddress(new s(t.token0));const r=new w;r.bits.writeAddress(new s(t.token1));const o=T(await e.toBoc(!1)),i=T(await r.toBoc(!1)),d=await this.getAddress(),a=await this.provider.call2(d.toString(),"get_pool_address",[["tvm.Slice",o],["tvm.Slice",i]]);return y.parseAddress(a)}async getPool(t){const e=new f(this.provider,{address:t.token0}),r=new f(this.provider,{address:t.token1}),o=await this.getAddress(),[i,d]=await Promise.all([this.stonApiClient.getJettonWalletAddress({jettonAddress:(await e.getAddress()).toString(),ownerAddress:o.toString()}),this.stonApiClient.getJettonWalletAddress({jettonAddress:(await r.getAddress()).toString(),ownerAddress:o.toString()})]),a=await this.getPoolAddress({token0:i,token1:d});return a?new C.PoolV1({tonApiClient:this.provider,stonApiClient:this.stonApiClient,address:a}):null}async getData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_router_data",[]);return{isLocked:h.parseBoolean(e[0]),adminAddress:y.parseAddressNotNull(e[1]),tempUpgrade:e[2],poolCode:e[3],jettonLpWalletCode:e[4],lpAccountCode:e[5]}}};u.version=c.DEX_VERSION.v1;u.address=new s("EQB3ncyBUTjZUA5EnFKR5_EnOMI9V1tTEAAPaiU71gc4TiUt");u.gasConstants={swapJettonToJetton:{gasAmount:new n("265000000"),forwardGasAmount:new n("205000000")},swapJettonToTon:{gasAmount:new n("185000000"),forwardGasAmount:new n("125000000")},swapTonToJetton:{forwardGasAmount:new n("215000000")},provideLpJetton:{gasAmount:new n("300000000"),forwardGasAmount:new n("240000000")},provideLpTon:{forwardGasAmount:new n("260000000")}};let W=u;exports.RouterV1=W},{"./index10.cjs":21,"./index14.cjs":25,"./index23.cjs":35,"./index5.cjs":42,"./index7.cjs":44,"./index8.cjs":45,"tonweb":340}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const g=require("tonweb"),w=require("./index23.cjs"),d=require("./index7.cjs"),l=require("./index10.cjs"),p=require("./index15.cjs"),{utils:{BN:i,bytesToBase64:u},boc:{Cell:c},Address:r,token:{jetton:{JettonMinter:y,JettonWallet:S}}}=g,a=class A extends y{constructor({tonApiClient:e,stonApiClient:t,gasConstants:s,...o}){super(e,o),this.stonApiClient=t??new w.StonApiClient(e),this.gasConstants={...A.gasConstants,...s}}async createCollectFeesBody(e){const t=new c;return t.bits.writeUint(l.DEX_OP_CODES.COLLECT_FEES,32),t.bits.writeUint((e==null?void 0:e.queryId)??0,64),t}async buildCollectFeeTxParams(e){const t=await this.getAddress(),s=await this.createCollectFeesBody({queryId:e==null?void 0:e.queryId}),o=new i((e==null?void 0:e.gasAmount)??this.gasConstants.collectFees);return{to:new r(t.toString(!0,!0,!0)),payload:s,gasAmount:o}}async createBurnBody(e){const t=new c;return t.bits.writeUint(l.DEX_OP_CODES.REQUEST_BURN,32),t.bits.writeUint(e.queryId??0,64),t.bits.writeCoins(new i(e.amount)),t.bits.writeAddress(new r(e.responseAddress)),t}async buildBurnTxParams(e){const t=await this.getAddress(),[s,o]=await Promise.all([(async()=>new r(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.toString(),ownerAddress:e.responseAddress.toString()})))(),this.createBurnBody({amount:e.amount,responseAddress:e.responseAddress,queryId:e.queryId})]),n=new i(e.gasAmount??this.gasConstants.burn);return{to:new r(s.toString(!0,!0,!0)),payload:o,gasAmount:n}}async getExpectedOutputs(e){const t=new c;t.bits.writeAddress(new r(e.jettonWallet));const s=u(await t.toBoc(!1)),o=await this.getAddress(),n=await this.provider.call2(o.toString(),"get_expected_outputs",[["int",e.amount.toString()],["tvm.Slice",s]]);return{jettonToReceive:n[0],protocolFeePaid:n[1],refFeePaid:n[2]}}async getExpectedTokens(e){const t=await this.getAddress();return await this.provider.call2(t.toString(),"get_expected_tokens",[["int",e.amount0.toString()],["int",e.amount1.toString()]])}async getExpectedLiquidity(e){const t=await this.getAddress(),s=await this.provider.call2(t.toString(),"get_expected_liquidity",[["int",e.jettonAmount.toString()]]);return{amount0:s[0],amount1:s[1]}}async getLpAccountAddress(e){const t=new c;t.bits.writeAddress(new r(e.ownerAddress));const s=u(await t.toBoc(!1)),o=await this.getAddress(),n=await this.provider.call2(o.toString(),"get_lp_account_address",[["tvm.Slice",s]]);return d.parseAddress(n)}async getJettonWallet(e){const t=await this.stonApiClient.getJettonWalletAddress({jettonAddress:(await this.getAddress()).toString(),ownerAddress:e.ownerAddress.toString()});return new S(this.provider,{address:t})}async getData(){const e=await this.getAddress(),t=await this.provider.call2(e.toString(),"get_pool_data");return{reserve0:t[0],reserve1:t[1],token0WalletAddress:d.parseAddressNotNull(t[2]),token1WalletAddress:d.parseAddressNotNull(t[3]),lpFee:t[4],protocolFee:t[5],refFee:t[6],protocolFeeAddress:d.parseAddress(t[7]),collectedToken0ProtocolFee:t[8],collectedToken1ProtocolFee:t[9]}}async getLpAccount(e){const t=await this.getLpAccountAddress(e);return t?new p.LpAccountV1({tonApiClient:this.provider,stonApiClient:this.stonApiClient,address:t}):null}};a.version=l.DEX_VERSION.v1;a.gasConstants={collectFees:new i("1100000000"),burn:new i("500000000")};let h=a;exports.PoolV1=h},{"./index10.cjs":21,"./index15.cjs":26,"./index23.cjs":35,"./index7.cjs":44,"tonweb":340}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("tonweb"),A=require("./index23.cjs"),c=require("./index7.cjs"),o=require("./index10.cjs"),{utils:{BN:n},boc:{Cell:u},Contract:g,Address:d}=y,r=class w extends g{constructor({tonApiClient:t,stonApiClient:e,gasConstants:s,...i}){super(t,i),this.stonApiClient=e??new A.StonApiClient(t),this.gasConstants={...w.gasConstants,...s}}async createRefundBody(t){const e=new u;return e.bits.writeUint(o.DEX_OP_CODES.REFUND,32),e.bits.writeUint((t==null?void 0:t.queryId)??0,64),e}async buildRefundTxParams(t){const e=await this.getAddress(),s=await this.createRefundBody({queryId:t==null?void 0:t.queryId}),i=new n((t==null?void 0:t.gasAmount)??this.gasConstants.refund);return{to:new d(e.toString(!0,!0,!0)),payload:s,gasAmount:i}}async createDirectAddLiquidityBody(t){const e=new u;return e.bits.writeUint(o.DEX_OP_CODES.DIRECT_ADD_LIQUIDITY,32),e.bits.writeUint(t.queryId??0,64),e.bits.writeCoins(new n(t.amount0)),e.bits.writeCoins(new n(t.amount1)),e.bits.writeCoins(new n(t.minimumLpToMint??1)),e}async buildDirectAddLiquidityTxParams(t){const e=await this.getAddress(),s=await this.createDirectAddLiquidityBody({amount0:t.amount0,amount1:t.amount1,minimumLpToMint:t.minimumLpToMint,queryId:t.queryId}),i=new n(t.gasAmount??this.gasConstants.directAddLp);return{to:new d(e.toString(!0,!0,!0)),payload:s,gasAmount:i}}async createResetGasBody(t){const e=new u;return e.bits.writeUint(o.DEX_OP_CODES.RESET_GAS,32),e.bits.writeUint((t==null?void 0:t.queryId)??0,64),e}async buildResetGasTxParams(t){const e=await this.getAddress(),s=await this.createResetGasBody({queryId:t==null?void 0:t.queryId}),i=new n((t==null?void 0:t.gasAmount)??this.gasConstants.resetGas);return{to:new d(e.toString(!0,!0,!0)),payload:s,gasAmount:i}}async getData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_lp_account_data");return{userAddress:c.parseAddressNotNull(e[0]),poolAddress:c.parseAddressNotNull(e[1]),amount0:e[2],amount1:e[3]}}};r.version=o.DEX_VERSION.v1;r.gasConstants={refund:new n("300000000"),directAddLp:new n("300000000"),resetGas:new n("300000000")};let l=r;exports.LpAccountV1=l},{"./index10.cjs":21,"./index23.cjs":35,"./index7.cjs":44,"tonweb":340}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const w=require("tonweb"),A=require("./index23.cjs"),a=require("./index7.cjs"),k=require("./index8.cjs"),S=require("./index5.cjs"),d=require("./index11.cjs"),{boc:{Cell:m},utils:{Address:o,BN:n},token:{nft:{NftCollection:N},jetton:{JettonWallet:y}}}=w,r=class i extends N{constructor({tonApiClient:e,stonApiClient:t,...s}){super(e,s),this.stonApiClient=t??new A.StonApiClient(e),this.gasConstants={...i.gasConstants,...s.gasConstants}}async createStakeBody(){const e=new m;return e.bits.writeUint(d.FARM_OP_CODES.STAKE,32),e}async buildStakeTxParams(e){const[t,s,l]=await Promise.all([(async()=>new o(await this.stonApiClient.getJettonWalletAddress({jettonAddress:e.jettonAddress.toString(),ownerAddress:e.userWalletAddress.toString()})))(),this.createStakeBody(),this.getAddress()]),c=new n(e.forwardGasAmount??this.gasConstants.stakeForward),u=S.createJettonTransferMessage({queryId:e.queryId??0,amount:e.jettonAmount,destination:l,responseDestination:e.userWalletAddress,forwardTonAmount:c,forwardPayload:s}),g=new n(e.gasAmount??this.gasConstants.stake);return{to:new o(t.toString(!0,!0,!0)),payload:u,gasAmount:g}}async getData(){const e=await this.getAddress(),t=await this.provider.call2(e.toString(),"get_farming_minter_data");return{nextItemIndex:t[0],lastUpdateTime:t[1],status:t[2].toNumber(),depositedNanorewards:t[3],currentStakedTokens:t[4],accruedPerUnitNanorewards:t[5],accruedNanorewards:t[6],claimedNanorewards:t[7],contractUniqueId:t[8],nanorewardsPer24h:t[9],soulboundItems:k.parseBoolean(t[10]),minStakeTime:t[11],stakingTokenWallet:a.parseAddressNotNull(t[12]),rewardTokenWallet:a.parseAddressNotNull(t[13])}}async getStakingJettonAddress(){const{stakingTokenWallet:e}=await this.getData(),t=new y(this.provider,{address:e}),{jettonMinterAddress:s}=await t.getData();return s}};r.version=d.FARM_VERSION.v1;r.gasConstants={stake:new n("300000000"),stakeForward:new n("250000000")};let f=r;exports.FarmNftMinterV1=f},{"./index11.cjs":22,"./index23.cjs":35,"./index5.cjs":42,"./index7.cjs":44,"./index8.cjs":45,"tonweb":340}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const a=require("tonweb"),l=require("./index23.cjs"),w=require("./index8.cjs"),i=require("./index11.cjs"),{boc:{Cell:u},utils:{BN:o,Address:d},token:{nft:{NftItem:g}}}=a,r=class c extends g{constructor({tonApiClient:t,stonApiClient:e,gasConstants:n,...s}){super(t,s),this.stonApiClient=e??new l.StonApiClient(t),this.gasConstants={...c.gasConstants,...n}}async createClaimRewardsBody(t){const e=new u;return e.bits.writeUint(i.FARM_OP_CODES.CLAIM_REWARDS,32),e.bits.writeUint((t==null?void 0:t.queryId)??0,64),e}async buildClaimRewardsTxParams(t){const e=await this.getAddress(),n=await this.createClaimRewardsBody({queryId:t==null?void 0:t.queryId}),s=new o((t==null?void 0:t.gasAmount)??this.gasConstants.claimRewards);return{to:new d(e.toString(!0,!0,!0)),payload:n,gasAmount:s}}async createUnstakeBody(t){const e=new u;return e.bits.writeUint(i.FARM_OP_CODES.UNSTAKE,32),e.bits.writeUint((t==null?void 0:t.queryId)??0,64),e}async buildUnstakeTxParams(t){const e=await this.getAddress(),n=await this.createUnstakeBody({queryId:t==null?void 0:t.queryId}),s=new o((t==null?void 0:t.gasAmount)??this.gasConstants.unstake);return{to:new d(e.toString(!0,!0,!0)),payload:n,gasAmount:s}}async getFarmingData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_farming_data");return{status:e[0].toNumber(),isSoulbound:w.parseBoolean(e[1]),stakedTokens:e[2],claimedPerUnitNanorewards:e[3]}}};r.version=i.FARM_VERSION.v1;r.gasConstants={claimRewards:new o("300000000"),unstake:new o("400000000"),destroy:new o("50000000")};let y=r;exports.FarmNftItemV1=y},{"./index11.cjs":22,"./index23.cjs":35,"./index8.cjs":45,"tonweb":340}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});require("tonweb");const t=require("./index7.cjs"),a=require("./index8.cjs"),n=require("./index9.cjs"),d=require("./index11.cjs"),o=require("./index16.cjs");class s extends o.FarmNftMinterV1{async getPendingData(){const r=await this.getAddress(),e=await this.provider.call2(r.toString(),"get_pending_data");return{changeCustodianTs:e[0],sendMsgTs:e[1],codeUpgradeTs:e[2],newCustodian:t.parseAddress(e[3]),pendingMsg:e[4],newCode:e[5],newStorage:e[6]}}async getVersion(){const r=await this.getAddress(),e=await this.provider.call2(r.toString(),"get_version");return{major:e[0].toNumber(),minor:e[1].toNumber(),development:n.parseString(e[2])}}async getData(){const r=await this.getAddress(),e=await this.provider.call2(r.toString(),"get_farming_minter_data");return{nextItemIndex:e[0],lastUpdateTime:e[1],status:e[2].toNumber(),depositedNanorewards:e[3],currentStakedTokens:e[4],accruedPerUnitNanorewards:e[5],claimedFeeNanorewards:e[6],accruedFeeNanorewards:e[7],accruedNanorewards:e[8],claimedNanorewards:e[9],contractUniqueId:e[10],nanorewardsPer24h:e[11],adminFee:e[12],minStakeTime:e[13],stakingTokenWallet:t.parseAddressNotNull(e[14]),rewardTokenWallet:t.parseAddressNotNull(e[15]),custodianAddress:t.parseAddress(e[16]),canChangeCustodian:a.parseBoolean(e[17]),canSendRawMsg:a.parseBoolean(e[18]),canChangeFee:a.parseBoolean(e[19]),unrestrictedDepositRewards:a.parseBoolean(e[20]),soulboundItems:!0}}}s.version=d.FARM_VERSION.v2;exports.FarmNftMinterV2=s},{"./index11.cjs":22,"./index16.cjs":27,"./index7.cjs":44,"./index8.cjs":45,"./index9.cjs":46,"tonweb":340}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("tonweb"),i=require("./index6.cjs"),u=require("./index11.cjs"),c=require("./index17.cjs"),{boc:{Cell:g},utils:{BN:d,Address:a}}=n;class r extends c.FarmNftItemV1{async createDestroyBody(t){return i.createSbtDestroyMessage({queryId:(t==null?void 0:t.queryId)??0})}async buildDestroyTxParams(t){const e=await this.getAddress(),s=await this.createDestroyBody({queryId:t==null?void 0:t.queryId}),o=new d((t==null?void 0:t.gasAmount)??this.gasConstants.destroy);return{to:new a(e.toString(!0,!0,!0)),payload:s,gasAmount:o}}async getFarmingData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_farming_data");return{status:e[0].toNumber(),revokeTime:e[1],stakedTokens:e[2],claimedPerUnitNanorewards:e[3],stakeDate:e[4],isSoulbound:!0}}}r.version=u.FARM_VERSION.v2;exports.FarmNftItemV2=r},{"./index11.cjs":22,"./index17.cjs":28,"./index6.cjs":43,"tonweb":340}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("./index13.cjs"),e=require("./index14.cjs"),r=require("./index15.cjs"),o=require("./index10.cjs"),c={[o.DEX_VERSION.v1]:{Router:t.RouterV1,Pool:e.PoolV1,LpAccount:r.LpAccountV1}};exports.DEX_OP_CODES=o.DEX_OP_CODES;exports.DEX_VERSION=o.DEX_VERSION;exports.DEX=c},{"./index10.cjs":21,"./index13.cjs":24,"./index14.cjs":25,"./index15.cjs":26}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("tonweb"),S=require("./index23.cjs"),l=require("./index7.cjs"),A=require("./index8.cjs"),k=require("./index9.cjs"),y=require("./index5.cjs"),p=require("./index24.cjs"),m=require("./index25.cjs"),C=require("./index11.cjs"),{boc:{Cell:f},utils:{Address:u,BN:g},token:{nft:{NftCollection:D},jetton:{JettonWallet:T}}}=h,w=class N extends D{constructor({tonApiClient:t,stonApiClient:e,gasConstants:n,...a}){super(t,a),this.stonApiClient=e??new S.StonApiClient(t),this.gasConstants={...N.gasConstants,...n}}async createStakeBody(t){const e=new f;return e.bits.writeUint(C.FARM_OP_CODES.STAKE,32),e.bits.writeAddress(t!=null&&t.ownerAddress?new u(t.ownerAddress):void 0),e}async buildStakeTxParams(t){const[e,n,a,i]=await Promise.all([(async()=>new u(await this.stonApiClient.getJettonWalletAddress({jettonAddress:t.jettonAddress.toString(),ownerAddress:t.userWalletAddress.toString()})))(),this.createStakeBody({ownerAddress:t.ownerAddress}),this.getAddress(),(async()=>t.poolCount??(await this.getData()).poolCount)()]),r=this.gasConstants.stakeFwdBase.add(this.gasConstants.stakeFwdPerPool.muln(i+1)),o=y.createJettonTransferMessage({queryId:t.queryId??0,amount:t.jettonAmount,destination:a,responseDestination:t.userWalletAddress,forwardTonAmount:r,forwardPayload:n}),d=r.add(this.gasConstants.stake);return{to:new u(e.toString(!0,!0,!0)),payload:o,gasAmount:d}}async getStakingJettonAddress(){const{stakingTokenWallet:t}=await this.getData(),e=new T(this.provider,{address:t}),{jettonMinterAddress:n}=await e.getData();return n}async getPendingData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_pending_data");return{changeCustodianTs:e[0],sendMsgTs:e[1],codeUpgradeTs:e[2],newCustodian:l.parseAddress(e[3]),pendingMsg:e[4],newCode:e[5],newStorage:e[6]}}async getVersion(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_version");return{major:e[0].toNumber(),minor:e[1].toNumber(),development:k.parseString(e[2])}}async getData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_farming_minter_data"),n=p.parseDictionaryCell(e[10],8),a=new Map;n.forEach((o,d)=>{const s=m.parseCell(o),c={depositedNanorewards:s.loadUint(150),accruedPerUnitNanorewards:s.loadUint(150),accruedFeeNanorewards:s.loadUint(150),claimedNanorewards:s.loadUint(150),claimedFeeNanorewards:s.loadUint(150),accruedNanorewards:s.loadUint(150),lastUpdateTime:s.loadUint(64)};a.set(Number(d),c)});const i=p.parseDictionaryCell(e[11],8),r=new Map;return i.forEach((o,d)=>{const s=m.parseCell(o),c={adminFee:s.loadUint(16),nanorewardsPer24h:s.loadUint(150),unrestrictedDepositRewards:s.loadBit(),rewardTokenWallet:s.loadAddress(),canChangeFee:s.loadBit(),status:s.loadUint(8).toNumber()};r.set(Number(d),c)}),{nextItemIndex:e[0],status:e[1].toNumber(),poolCount:e[2].toNumber(),currentStakedTokens:e[3],contractUniqueId:e[4],minStakeTime:e[5],stakingTokenWallet:l.parseAddressNotNull(e[6]),custodianAddress:l.parseAddressNotNull(e[7]),canChangeCustodian:A.parseBoolean(e[8]),canSendRawMsg:A.parseBoolean(e[9]),farmDataAccrued:a,farmDataParameters:r}}};w.version=C.FARM_VERSION.v3;w.gasConstants={stakeFwdBase:new g("210000000"),stakeFwdPerPool:new g("15000000"),stake:new g("100000000")};let M=w;exports.FarmNftMinterV3=M},{"./index11.cjs":22,"./index23.cjs":35,"./index24.cjs":36,"./index25.cjs":37,"./index5.cjs":42,"./index7.cjs":44,"./index8.cjs":45,"./index9.cjs":46,"tonweb":340}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const w=require("tonweb"),y=require("./index23.cjs"),g=require("./index6.cjs"),C=require("./index7.cjs"),A=require("./index24.cjs"),a=require("./index11.cjs"),m=require("./index20.cjs"),{boc:{Cell:c},utils:{BN:r,Address:i},token:{nft:{NftItem:h}}}=w,d=class u extends h{constructor({tonApiClient:t,stonApiClient:e,gasConstants:s,...n}){super(t,n),this.stonApiClient=e??new y.StonApiClient(t),this.gasConstants={...u.gasConstants,...s}}async createClaimRewardsBody(t){const e=new c;return e.bits.writeUint(a.FARM_OP_CODES.CLAIM_REWARDS,32),e.bits.writeUint(t.queryId??0,64),t.claimAll?(e.bits.writeUint(1,1),e.bits.writeUint(0,8)):(e.bits.writeUint(0,1),e.bits.writeUint(t.poolIndex,8)),e}async buildClaimRewardsTxParams(t){const e=await this.getAddress(),s=await this.createClaimRewardsBody({queryId:t.queryId,claimAll:t.poolIndex===void 0,poolIndex:t.poolIndex??0}),n=t.poolCount??await this.getPoolCount(),o=this.gasConstants.claimRewardsBase.add(this.gasConstants.claimRewardsPerPool.muln(n-1));return{to:new i(e.toString(!0,!0,!0)),payload:s,gasAmount:o}}async createUnstakeBody(t){const e=new c;return e.bits.writeUint(a.FARM_OP_CODES.UNSTAKE,32),e.bits.writeUint((t==null?void 0:t.queryId)??0,64),e}async buildUnstakeTxParams(t){const e=await this.getAddress(),s=await this.createUnstakeBody({queryId:t.queryId}),n=t.poolCount??await this.getPoolCount(),o=this.gasConstants.unstakeBase.add(this.gasConstants.unstakePerPool.muln(n-1));return{to:new i(e.toString(!0,!0,!0)),payload:s,gasAmount:o}}async createDestroyBody(t){return g.createSbtDestroyMessage({queryId:(t==null?void 0:t.queryId)??0})}async buildDestroyTxParams(t){const e=await this.getAddress(),s=await this.createDestroyBody({queryId:t==null?void 0:t.queryId}),n=this.gasConstants.destroy;return{to:new i(e.toString(!0,!0,!0)),payload:s,gasAmount:n}}async getFarmingData(){const t=await this.getAddress(),e=await this.provider.call2(t.toString(),"get_farming_data"),s=A.parseDictionaryUint(e[4],8,150),n=new Map;return s.forEach((o,l)=>{n.set(Number(l),o)}),{status:e[0].toNumber(),revokeTime:e[1],stakedTokens:e[2],stakeDate:e[3],claimedPerUnit:n,ownerAddress:C.parseAddressNotNull(e[5])}}async getPoolCount(){const{collectionAddress:t}=await this.getData(),e=new m.FarmNftMinterV3({tonApiClient:this.provider,stonApiClient:this.stonApiClient,address:t}),{poolCount:s}=await e.getData();return s}};d.version=a.FARM_VERSION.v3;d.gasConstants={claimRewardsBase:new r("350000000"),claimRewardsPerPool:new r("130000000"),unstakeBase:new r("450000000"),unstakePerPool:new r("130000000"),destroy:new r("50000000")};let I=d;exports.FarmNftItemV3=I},{"./index11.cjs":22,"./index20.cjs":32,"./index23.cjs":35,"./index24.cjs":36,"./index6.cjs":43,"./index7.cjs":44,"tonweb":340}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("tonweb"),o=require("./index12.cjs"),{Address:d,Contract:c}=r,e=class t extends c{constructor({tonApiClient:n,stonApiClient:i,...s}){super(n,{...s,address:s.address??t.address})}};e.version=o.pTON_VERSION.v1;e.address=new d("EQCM3B12QK1e4yZSf8GtBRT0aLMNyEsBc_DhVfRRtOEffLez");let a=e;exports.PtonV1=a},{"./index12.cjs":23,"tonweb":340}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("tonweb"),{HttpProvider:a,Address:o,token:{jetton:{JettonMinter:r}}}=n;class s{constructor(t){this.tonApiProvider=t}async getJettonWalletAddress({jettonAddress:t,ownerAddress:e}){return(await new r(this.tonApiProvider,{address:t}).getJettonWalletAddress(new o(e))).toString()}}exports.StonApiClient=s},{"tonweb":340}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("./index26.cjs"),a=require("./index27.cjs");function s(e,r){const i=t=>t.loadRef();return a.parseDict(n.beginParse(e),r,i)}function c(e,r,i){const t=o=>o.loadUintBN(i);return a.parseDict(n.beginParse(e),r,t)}exports.parseDictionaryCell=s;exports.parseDictionaryUint=c},{"./index26.cjs":38,"./index27.cjs":39}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function r(e){return e.beginParse()}exports.parseCell=r},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const i=require("./index25.cjs");class r{constructor(e){this.slice=i.parseCell(e),this.refs=[...e.refs]}loadBit(){return this.slice.loadBit()}loadUint(e){return this.slice.loadUint(e).toNumber()}loadUintBN(e){return this.slice.loadUint(e)}loadRef(){return this.refs.shift()}}function s(t){return new r(t)}exports.SliceAdapter=r;exports.beginParse=s},{"./index25.cjs":37}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const b=require("./index26.cjs");function u(a){let t=0;for(;a.loadBit();)t++;return t}function d(a,t,i,l,f){const s=t.loadBit()?1:0;let e=0,n=a;if(s===0){e=u(t);for(let r=0;r<e;r++)n+=t.loadBit()?"1":"0"}else if((t.loadBit()?1:0)===0){e=t.loadUint(Math.ceil(Math.log2(i+1)));for(let o=0;o<e;o++)n+=t.loadBit()?"1":"0"}else{const o=t.loadBit()?"1":"0";e=t.loadUint(Math.ceil(Math.log2(i+1)));for(let g=0;g<e;g++)n+=o}if(i-e===0)l.set(BigInt(`0b${n}`),f(t));else{const r=t.loadRef(),o=t.loadRef();r.isExotic||d(`${n}0`,b.beginParse(r),i-e-1,l,f),o.isExotic||d(`${n}1`,b.beginParse(o),i-e-1,l,f)}}function h(a,t,i){const l=new Map;return a&&d("",a,t,l,i),l}exports.parseDict=h},{"./index26.cjs":38}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./index16.cjs"),r=require("./index17.cjs"),N=require("./index18.cjs"),m=require("./index19.cjs"),n=require("./index20.cjs"),F=require("./index21.cjs"),t=require("./index11.cjs"),f={[t.FARM_VERSION.v1]:{NftMinter:e.FarmNftMinterV1,NftItem:r.FarmNftItemV1},[t.FARM_VERSION.v2]:{NftMinter:N.FarmNftMinterV2,NftItem:m.FarmNftItemV2},[t.FARM_VERSION.v3]:{NftMinter:n.FarmNftMinterV3,NftItem:F.FarmNftItemV3}};exports.FARM_OP_CODES=t.FARM_OP_CODES;exports.FARM_VERSION=t.FARM_VERSION;exports.FARM=f},{"./index11.cjs":22,"./index16.cjs":27,"./index17.cjs":28,"./index18.cjs":29,"./index19.cjs":30,"./index20.cjs":32,"./index21.cjs":33}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./index22.cjs"),t=require("./index12.cjs"),o={[t.pTON_VERSION.v1]:e.PtonV1};exports.pTON_VERSION=t.pTON_VERSION;exports.pTON=o},{"./index12.cjs":23,"./index22.cjs":34}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("tonweb"),{utils:{BN:i},boc:{Cell:o},Address:s}=n;function r(t){const e=new o;return e.bits.writeUint(260734629,32),e.bits.writeUint(t.queryId,64),e.bits.writeCoins(new i(t.amount)),e.bits.writeAddress(new s(t.destination)),e.bits.writeAddress(t.responseDestination?new s(t.responseDestination):void 0),t.customPayload?(e.refs.push(t.customPayload),e.bits.writeBit(!0)):e.bits.writeBit(!1),e.bits.writeCoins(new i(t.forwardTonAmount)),t.forwardPayload?(e.refs.push(t.forwardPayload),e.bits.writeBit(!0)):e.bits.writeBit(!1),e}exports.createJettonTransferMessage=r},{"tonweb":340}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("tonweb"),{boc:{Cell:o}}=n;function i(e){const t=new o;return t.bits.writeUint(520377210,32),t.bits.writeUint((e==null?void 0:e.queryId)??0,64),t}exports.createSbtDestroyMessage=i},{"tonweb":340}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("tonweb"),{Address:a}=d,o=(r,t,n)=>{let e=BigInt(0);for(let s=0;s<n;s++)e*=BigInt(2),e+=BigInt(r.get(t+s));return e},i=r=>{try{let t=o(r.bits,3,8);t>BigInt(127)&&(t=t-BigInt(256));const n=o(r.bits,3+8,256);if(`${t.toString(10)}:${n.toString(16)}`=="0:0")return null;const e=`${t.toString(10)}:${n.toString(16).padStart(64,"0")}`;return new a(e)}catch{return null}},g=r=>{const t=i(r);if(!t)throw new Error(`Failed to parse address from cell: ${r}`);return t};exports.parseAddress=i;exports.parseAddressNotNull=g},{"tonweb":340}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function o(e){return!e.isZero()}exports.parseBoolean=o},{}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function r(e){return new TextDecoder().decode(e.bits.getTopUppedArray())}exports.parseString=r},{}],47:[function(require,module,exports){exports.toBinaryString=function(e){return function(e){return window.atob(e)}(e.replace(/-/g,"+").replace(/_/g,"/"))},exports.fromBinaryString=function(e,r){return(n=e,window.btoa(n)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,r?"=":"");var n},exports.toBase64Url=function(e,r){return function(e){if("string"==typeof e)return window.btoa(unescape(encodeURIComponent(e)));for(var r=new Uint8Array(e),n="",t=0;t<r.byteLength;t++)n+=String.fromCharCode(r[t]);return window.btoa(n)}(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,r?"=":"")},exports.fromBase64Url=function(e){return r=e.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(escape(window.atob(r)));var r},exports.toBuffer=function(e){return function(e){for(var r=window.atob(e),n=new Uint8Array(r.length),t=0;t<r.length;t++)n[t]=r.charCodeAt(t);return n}(e.replace(/-/g,"+").replace(/_/g,"/"))}},{}],48:[function(require,module,exports){(function(module,exports){'use strict';function assert(val,msg){if(!val)throw new Error(msg||'Assertion failed');}
function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor();ctor.prototype.constructor=ctor}
function BN(number,base,endian){if(BN.isBN(number)){return number}
this.negative=0;this.words=null;this.length=0;this.red=null;if(number!==null){if(base==='le'||base==='be'){endian=base;base=10}
this._init(number||0,base||10,endian||'be')}}
if(typeof module==='object'){module.exports=BN}else{exports.BN=BN}
BN.BN=BN;BN.wordSize=26;var Buffer;try{Buffer=require('buffer').Buffer}catch(e){}
BN.isBN=function isBN(num){if(num instanceof BN){return!0}
return num!==null&&typeof num==='object'&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)};BN.max=function max(left,right){if(left.cmp(right)>0)return left;return right};BN.min=function min(left,right){if(left.cmp(right)<0)return left;return right};BN.prototype._init=function init(number,base,endian){if(typeof number==='number'){return this._initNumber(number,base,endian)}
if(typeof number==='object'){return this._initArray(number,base,endian)}
if(base==='hex'){base=16}
assert(base===(base|0)&&base>=2&&base<=36);number=number.toString().replace(/\s+/g,'');var start=0;if(number[0]==='-'){start++}
if(base===16){this._parseHex(number,start)}else{this._parseBase(number,base,start)}
if(number[0]==='-'){this.negative=1}
this._strip();if(endian!=='le')return;this._initArray(this.toArray(),base,endian)};BN.prototype._initNumber=function _initNumber(number,base,endian){if(number<0){this.negative=1;number=-number}
if(number<0x4000000){this.words=[number&0x3ffffff];this.length=1}else if(number<0x10000000000000){this.words=[number&0x3ffffff,(number/0x4000000)&0x3ffffff];this.length=2}else{assert(number<0x20000000000000);this.words=[number&0x3ffffff,(number/0x4000000)&0x3ffffff,1];this.length=3}
if(endian!=='le')return;this._initArray(this.toArray(),base,endian)};BN.prototype._initArray=function _initArray(number,base,endian){assert(typeof number.length==='number');if(number.length<=0){this.words=[0];this.length=1;return this}
this.length=Math.ceil(number.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}
var j,w;var off=0;if(endian==='be'){for(i=number.length-1,j=0;i>=0;i-=3){w=number[i]|(number[i-1]<<8)|(number[i-2]<<16);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]=(w>>>(26-off))&0x3ffffff;off+=24;if(off>=26){off-=26;j++}}}else if(endian==='le'){for(i=0,j=0;i<number.length;i+=3){w=number[i]|(number[i+1]<<8)|(number[i+2]<<16);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]=(w>>>(26-off))&0x3ffffff;off+=24;if(off>=26){off-=26;j++}}}
return this._strip()};function parseHex(str,start,end){var r=0;var len=Math.min(str.length,end);var z=0;for(var i=start;i<len;i++){var c=str.charCodeAt(i)-48;r<<=4;var b;if(c>=49&&c<=54){b=c-49+0xa}else if(c>=17&&c<=22){b=c-17+0xa}else{b=c}
r|=b;z|=b}
assert(!(z&0xf0),'Invalid character in '+str);return r}
BN.prototype._parseHex=function _parseHex(number,start){this.length=Math.ceil((number.length-start)/6);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}
var j,w;var off=0;for(i=number.length-6,j=0;i>=start;i-=6){w=parseHex(number,i,i+6);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]|=w>>>(26-off)&0x3fffff;off+=24;if(off>=26){off-=26;j++}}
if(i+6!==start){w=parseHex(number,start,i+6);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]|=w>>>(26-off)&0x3fffff}
this._strip()};function parseBase(str,start,end,mul){var r=0;var b=0;var len=Math.min(str.length,end);for(var i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul;if(c>=49){b=c-49+0xa}else if(c>=17){b=c-17+0xa}else{b=c}
assert(c>=0&&b<mul,'Invalid character');r+=b}
return r}
BN.prototype._parseBase=function _parseBase(number,base,start){this.words=[0];this.length=1;for(var limbLen=0,limbPow=1;limbPow<=0x3ffffff;limbPow*=base){limbLen++}
limbLen--;limbPow=(limbPow/base)|0;var total=number.length-start;var mod=total%limbLen;var end=Math.min(total,total-mod)+start;var word=0;for(var i=start;i<end;i+=limbLen){word=parseBase(number,i,i+limbLen,base);this.imuln(limbPow);if(this.words[0]+word<0x4000000){this.words[0]+=word}else{this._iaddn(word)}}
if(mod!==0){var pow=1;word=parseBase(number,i,number.length,base);for(i=0;i<mod;i++){pow*=base}
this.imuln(pow);if(this.words[0]+word<0x4000000){this.words[0]+=word}else{this._iaddn(word)}}};BN.prototype.copy=function copy(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++){dest.words[i]=this.words[i]}
dest.length=this.length;dest.negative=this.negative;dest.red=this.red};function move(dest,src){dest.words=src.words;dest.length=src.length;dest.negative=src.negative;dest.red=src.red}
BN.prototype._move=function _move(dest){move(dest,this)};BN.prototype.clone=function clone(){var r=new BN(null);this.copy(r);return r};BN.prototype._expand=function _expand(size){while(this.length<size){this.words[this.length++]=0}
return this};BN.prototype._strip=function strip(){while(this.length>1&&this.words[this.length-1]===0){this.length--}
return this._normSign()};BN.prototype._normSign=function _normSign(){if(this.length===1&&this.words[0]===0){this.negative=0}
return this};if(typeof Symbol!=='undefined'&&typeof Symbol.for==='function'){BN.prototype[Symbol.for('nodejs.util.inspect.custom')]=inspect}else{BN.prototype.inspect=inspect}
function inspect(){return(this.red?'<BN-R: ':'<BN: ')+this.toString(16)+'>'}
var zeros=['','0','00','000','0000','00000','000000','0000000','00000000','000000000','0000000000','00000000000','000000000000','0000000000000','00000000000000','000000000000000','0000000000000000','00000000000000000','000000000000000000','0000000000000000000','00000000000000000000','000000000000000000000','0000000000000000000000','00000000000000000000000','000000000000000000000000','0000000000000000000000000'];var groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,10000000,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64000000,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,24300000,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function toString(base,padding){base=base||10;padding=padding|0||1;var out;if(base===16||base==='hex'){out='';var off=0;var carry=0;for(var i=0;i<this.length;i++){var w=this.words[i];var word=(((w<<off)|carry)&0xffffff).toString(16);carry=(w>>>(24-off))&0xffffff;if(carry!==0||i!==this.length-1){out=zeros[6-word.length]+word+out}else{out=word+out}
off+=2;if(off>=26){off-=26;i--}}
if(carry!==0){out=carry.toString(16)+out}
while(out.length%padding!==0){out='0'+out}
if(this.negative!==0){out='-'+out}
return out}
if(base===(base|0)&&base>=2&&base<=36){var groupSize=groupSizes[base];var groupBase=groupBases[base];out='';var c=this.clone();c.negative=0;while(!c.isZero()){var r=c.modrn(groupBase).toString(base);c=c.idivn(groupBase);if(!c.isZero()){out=zeros[groupSize-r.length]+r+out}else{out=r+out}}
if(this.isZero()){out='0'+out}
while(out.length%padding!==0){out='0'+out}
if(this.negative!==0){out='-'+out}
return out}
assert(!1,'Base should be between 2 and 36')};BN.prototype.toNumber=function toNumber(){var ret=this.words[0];if(this.length===2){ret+=this.words[1]*0x4000000}else if(this.length===3&&this.words[2]===0x01){ret+=0x10000000000000+(this.words[1]*0x4000000)}else if(this.length>2){assert(!1,'Number can only safely store up to 53 bits')}
return(this.negative!==0)?-ret:ret};BN.prototype.toJSON=function toJSON(){return this.toString(16,2)};if(Buffer){BN.prototype.toBuffer=function toBuffer(endian,length){return this.toArrayLike(Buffer,endian,length)}}
BN.prototype.toArray=function toArray(endian,length){return this.toArrayLike(Array,endian,length)};var allocate=function allocate(ArrayType,size){if(ArrayType.allocUnsafe){return ArrayType.allocUnsafe(size)}
return new ArrayType(size)};BN.prototype.toArrayLike=function toArrayLike(ArrayType,endian,length){this._strip();var byteLength=this.byteLength();var reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,'byte array longer than desired length');assert(reqLength>0,'Requested array length <= 0');var res=allocate(ArrayType,reqLength);var postfix=endian==='le'?'LE':'BE';this['_toArrayLike'+postfix](res,byteLength);return res};BN.prototype._toArrayLikeLE=function _toArrayLikeLE(res,byteLength){var position=0;var carry=0;for(var i=0,shift=0;i<this.length;i++){var word=(this.words[i]<<shift)|carry;res[position++]=word&0xff;if(position<res.length){res[position++]=(word>>8)&0xff}
if(position<res.length){res[position++]=(word>>16)&0xff}
if(shift===6){if(position<res.length){res[position++]=(word>>24)&0xff}
carry=0;shift=0}else{carry=word>>>24;shift+=2}}
if(position<res.length){res[position++]=carry;while(position<res.length){res[position++]=0}}};BN.prototype._toArrayLikeBE=function _toArrayLikeBE(res,byteLength){var position=res.length-1;var carry=0;for(var i=0,shift=0;i<this.length;i++){var word=(this.words[i]<<shift)|carry;res[position--]=word&0xff;if(position>=0){res[position--]=(word>>8)&0xff}
if(position>=0){res[position--]=(word>>16)&0xff}
if(shift===6){if(position>=0){res[position--]=(word>>24)&0xff}
carry=0;shift=0}else{carry=word>>>24;shift+=2}}
if(position>=0){res[position--]=carry;while(position>=0){res[position--]=0}}};if(Math.clz32){BN.prototype._countBits=function _countBits(w){return 32-Math.clz32(w)}}else{BN.prototype._countBits=function _countBits(w){var t=w;var r=0;if(t>=0x1000){r+=13;t>>>=13}
if(t>=0x40){r+=7;t>>>=7}
if(t>=0x8){r+=4;t>>>=4}
if(t>=0x02){r+=2;t>>>=2}
return r+t}}
BN.prototype._zeroBits=function _zeroBits(w){if(w===0)return 26;var t=w;var r=0;if((t&0x1fff)===0){r+=13;t>>>=13}
if((t&0x7f)===0){r+=7;t>>>=7}
if((t&0xf)===0){r+=4;t>>>=4}
if((t&0x3)===0){r+=2;t>>>=2}
if((t&0x1)===0){r++}
return r};BN.prototype.bitLength=function bitLength(){var w=this.words[this.length-1];var hi=this._countBits(w);return(this.length-1)*26+hi};function toBitArray(num){var w=new Array(num.bitLength());for(var bit=0;bit<w.length;bit++){var off=(bit/26)|0;var wbit=bit%26;w[bit]=(num.words[off]>>>wbit)&0x01}
return w}
BN.prototype.zeroBits=function zeroBits(){if(this.isZero())return 0;var r=0;for(var i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);r+=b;if(b!==26)break}
return r};BN.prototype.byteLength=function byteLength(){return Math.ceil(this.bitLength()/8)};BN.prototype.toTwos=function toTwos(width){if(this.negative!==0){return this.abs().inotn(width).iaddn(1)}
return this.clone()};BN.prototype.fromTwos=function fromTwos(width){if(this.testn(width-1)){return this.notn(width).iaddn(1).ineg()}
return this.clone()};BN.prototype.isNeg=function isNeg(){return this.negative!==0};BN.prototype.neg=function neg(){return this.clone().ineg()};BN.prototype.ineg=function ineg(){if(!this.isZero()){this.negative^=1}
return this};BN.prototype.iuor=function iuor(num){while(this.length<num.length){this.words[this.length++]=0}
for(var i=0;i<num.length;i++){this.words[i]=this.words[i]|num.words[i]}
return this._strip()};BN.prototype.ior=function ior(num){assert((this.negative|num.negative)===0);return this.iuor(num)};BN.prototype.or=function or(num){if(this.length>num.length)return this.clone().ior(num);return num.clone().ior(this)};BN.prototype.uor=function uor(num){if(this.length>num.length)return this.clone().iuor(num);return num.clone().iuor(this)};BN.prototype.iuand=function iuand(num){var b;if(this.length>num.length){b=num}else{b=this}
for(var i=0;i<b.length;i++){this.words[i]=this.words[i]&num.words[i]}
this.length=b.length;return this._strip()};BN.prototype.iand=function iand(num){assert((this.negative|num.negative)===0);return this.iuand(num)};BN.prototype.and=function and(num){if(this.length>num.length)return this.clone().iand(num);return num.clone().iand(this)};BN.prototype.uand=function uand(num){if(this.length>num.length)return this.clone().iuand(num);return num.clone().iuand(this)};BN.prototype.iuxor=function iuxor(num){var a;var b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}
for(var i=0;i<b.length;i++){this.words[i]=a.words[i]^b.words[i]}
if(this!==a){for(;i<a.length;i++){this.words[i]=a.words[i]}}
this.length=a.length;return this._strip()};BN.prototype.ixor=function ixor(num){assert((this.negative|num.negative)===0);return this.iuxor(num)};BN.prototype.xor=function xor(num){if(this.length>num.length)return this.clone().ixor(num);return num.clone().ixor(this)};BN.prototype.uxor=function uxor(num){if(this.length>num.length)return this.clone().iuxor(num);return num.clone().iuxor(this)};BN.prototype.inotn=function inotn(width){assert(typeof width==='number'&&width>=0);var bytesNeeded=Math.ceil(width/26)|0;var bitsLeft=width%26;this._expand(bytesNeeded);if(bitsLeft>0){bytesNeeded--}
for(var i=0;i<bytesNeeded;i++){this.words[i]=~this.words[i]&0x3ffffff}
if(bitsLeft>0){this.words[i]=~this.words[i]&(0x3ffffff>>(26-bitsLeft))}
return this._strip()};BN.prototype.notn=function notn(width){return this.clone().inotn(width)};BN.prototype.setn=function setn(bit,val){assert(typeof bit==='number'&&bit>=0);var off=(bit/26)|0;var wbit=bit%26;this._expand(off+1);if(val){this.words[off]=this.words[off]|(1<<wbit)}else{this.words[off]=this.words[off]&~(1<<wbit)}
return this._strip()};BN.prototype.iadd=function iadd(num){var r;if(this.negative!==0&&num.negative===0){this.negative=0;r=this.isub(num);this.negative^=1;return this._normSign()}else if(this.negative===0&&num.negative!==0){num.negative=0;r=this.isub(num);num.negative=1;return r._normSign()}
var a,b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}
var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)+(b.words[i]|0)+carry;this.words[i]=r&0x3ffffff;carry=r>>>26}
for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;this.words[i]=r&0x3ffffff;carry=r>>>26}
this.length=a.length;if(carry!==0){this.words[this.length]=carry;this.length++}else if(a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}
return this};BN.prototype.add=function add(num){var res;if(num.negative!==0&&this.negative===0){num.negative=0;res=this.sub(num);num.negative^=1;return res}else if(num.negative===0&&this.negative!==0){this.negative=0;res=num.sub(this);this.negative=1;return res}
if(this.length>num.length)return this.clone().iadd(num);return num.clone().iadd(this)};BN.prototype.isub=function isub(num){if(num.negative!==0){num.negative=0;var r=this.iadd(num);num.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(num);this.negative=1;return this._normSign()}
var cmp=this.cmp(num);if(cmp===0){this.negative=0;this.length=1;this.words[0]=0;return this}
var a,b;if(cmp>0){a=this;b=num}else{a=num;b=this}
var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)-(b.words[i]|0)+carry;carry=r>>26;this.words[i]=r&0x3ffffff}
for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;carry=r>>26;this.words[i]=r&0x3ffffff}
if(carry===0&&i<a.length&&a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}
this.length=Math.max(this.length,i);if(a!==this){this.negative=1}
return this._strip()};BN.prototype.sub=function sub(num){return this.clone().isub(num)};function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=(self.length+num.length)|0;out.length=len;len=(len-1)|0;var a=self.words[0]|0;var b=num.words[0]|0;var r=a*b;var lo=r&0x3ffffff;var carry=(r/0x4000000)|0;out.words[0]=lo;for(var k=1;k<len;k++){var ncarry=carry>>>26;var rword=carry&0x3ffffff;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=(k-j)|0;a=self.words[i]|0;b=num.words[j]|0;r=a*b+rword;ncarry+=(r/0x4000000)|0;rword=r&0x3ffffff}
out.words[k]=rword|0;carry=ncarry|0}
if(carry!==0){out.words[k]=carry|0}else{out.length--}
return out._strip()}
var comb10MulTo=function comb10MulTo(self,num,out){var a=self.words;var b=num.words;var o=out.words;var c=0;var lo;var mid;var hi;var a0=a[0]|0;var al0=a0&0x1fff;var ah0=a0>>>13;var a1=a[1]|0;var al1=a1&0x1fff;var ah1=a1>>>13;var a2=a[2]|0;var al2=a2&0x1fff;var ah2=a2>>>13;var a3=a[3]|0;var al3=a3&0x1fff;var ah3=a3>>>13;var a4=a[4]|0;var al4=a4&0x1fff;var ah4=a4>>>13;var a5=a[5]|0;var al5=a5&0x1fff;var ah5=a5>>>13;var a6=a[6]|0;var al6=a6&0x1fff;var ah6=a6>>>13;var a7=a[7]|0;var al7=a7&0x1fff;var ah7=a7>>>13;var a8=a[8]|0;var al8=a8&0x1fff;var ah8=a8>>>13;var a9=a[9]|0;var al9=a9&0x1fff;var ah9=a9>>>13;var b0=b[0]|0;var bl0=b0&0x1fff;var bh0=b0>>>13;var b1=b[1]|0;var bl1=b1&0x1fff;var bh1=b1>>>13;var b2=b[2]|0;var bl2=b2&0x1fff;var bh2=b2>>>13;var b3=b[3]|0;var bl3=b3&0x1fff;var bh3=b3>>>13;var b4=b[4]|0;var bl4=b4&0x1fff;var bh4=b4>>>13;var b5=b[5]|0;var bl5=b5&0x1fff;var bh5=b5>>>13;var b6=b[6]|0;var bl6=b6&0x1fff;var bh6=b6>>>13;var b7=b[7]|0;var bl7=b7&0x1fff;var bh7=b7>>>13;var b8=b[8]|0;var bl8=b8&0x1fff;var bh8=b8>>>13;var b9=b[9]|0;var bl9=b9&0x1fff;var bh9=b9>>>13;out.negative=self.negative^num.negative;out.length=19;lo=Math.imul(al0,bl0);mid=Math.imul(al0,bh0);mid=(mid+Math.imul(ah0,bl0))|0;hi=Math.imul(ah0,bh0);var w0=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w0>>>26))|0;w0&=0x3ffffff;lo=Math.imul(al1,bl0);mid=Math.imul(al1,bh0);mid=(mid+Math.imul(ah1,bl0))|0;hi=Math.imul(ah1,bh0);lo=(lo+Math.imul(al0,bl1))|0;mid=(mid+Math.imul(al0,bh1))|0;mid=(mid+Math.imul(ah0,bl1))|0;hi=(hi+Math.imul(ah0,bh1))|0;var w1=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w1>>>26))|0;w1&=0x3ffffff;lo=Math.imul(al2,bl0);mid=Math.imul(al2,bh0);mid=(mid+Math.imul(ah2,bl0))|0;hi=Math.imul(ah2,bh0);lo=(lo+Math.imul(al1,bl1))|0;mid=(mid+Math.imul(al1,bh1))|0;mid=(mid+Math.imul(ah1,bl1))|0;hi=(hi+Math.imul(ah1,bh1))|0;lo=(lo+Math.imul(al0,bl2))|0;mid=(mid+Math.imul(al0,bh2))|0;mid=(mid+Math.imul(ah0,bl2))|0;hi=(hi+Math.imul(ah0,bh2))|0;var w2=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w2>>>26))|0;w2&=0x3ffffff;lo=Math.imul(al3,bl0);mid=Math.imul(al3,bh0);mid=(mid+Math.imul(ah3,bl0))|0;hi=Math.imul(ah3,bh0);lo=(lo+Math.imul(al2,bl1))|0;mid=(mid+Math.imul(al2,bh1))|0;mid=(mid+Math.imul(ah2,bl1))|0;hi=(hi+Math.imul(ah2,bh1))|0;lo=(lo+Math.imul(al1,bl2))|0;mid=(mid+Math.imul(al1,bh2))|0;mid=(mid+Math.imul(ah1,bl2))|0;hi=(hi+Math.imul(ah1,bh2))|0;lo=(lo+Math.imul(al0,bl3))|0;mid=(mid+Math.imul(al0,bh3))|0;mid=(mid+Math.imul(ah0,bl3))|0;hi=(hi+Math.imul(ah0,bh3))|0;var w3=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w3>>>26))|0;w3&=0x3ffffff;lo=Math.imul(al4,bl0);mid=Math.imul(al4,bh0);mid=(mid+Math.imul(ah4,bl0))|0;hi=Math.imul(ah4,bh0);lo=(lo+Math.imul(al3,bl1))|0;mid=(mid+Math.imul(al3,bh1))|0;mid=(mid+Math.imul(ah3,bl1))|0;hi=(hi+Math.imul(ah3,bh1))|0;lo=(lo+Math.imul(al2,bl2))|0;mid=(mid+Math.imul(al2,bh2))|0;mid=(mid+Math.imul(ah2,bl2))|0;hi=(hi+Math.imul(ah2,bh2))|0;lo=(lo+Math.imul(al1,bl3))|0;mid=(mid+Math.imul(al1,bh3))|0;mid=(mid+Math.imul(ah1,bl3))|0;hi=(hi+Math.imul(ah1,bh3))|0;lo=(lo+Math.imul(al0,bl4))|0;mid=(mid+Math.imul(al0,bh4))|0;mid=(mid+Math.imul(ah0,bl4))|0;hi=(hi+Math.imul(ah0,bh4))|0;var w4=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w4>>>26))|0;w4&=0x3ffffff;lo=Math.imul(al5,bl0);mid=Math.imul(al5,bh0);mid=(mid+Math.imul(ah5,bl0))|0;hi=Math.imul(ah5,bh0);lo=(lo+Math.imul(al4,bl1))|0;mid=(mid+Math.imul(al4,bh1))|0;mid=(mid+Math.imul(ah4,bl1))|0;hi=(hi+Math.imul(ah4,bh1))|0;lo=(lo+Math.imul(al3,bl2))|0;mid=(mid+Math.imul(al3,bh2))|0;mid=(mid+Math.imul(ah3,bl2))|0;hi=(hi+Math.imul(ah3,bh2))|0;lo=(lo+Math.imul(al2,bl3))|0;mid=(mid+Math.imul(al2,bh3))|0;mid=(mid+Math.imul(ah2,bl3))|0;hi=(hi+Math.imul(ah2,bh3))|0;lo=(lo+Math.imul(al1,bl4))|0;mid=(mid+Math.imul(al1,bh4))|0;mid=(mid+Math.imul(ah1,bl4))|0;hi=(hi+Math.imul(ah1,bh4))|0;lo=(lo+Math.imul(al0,bl5))|0;mid=(mid+Math.imul(al0,bh5))|0;mid=(mid+Math.imul(ah0,bl5))|0;hi=(hi+Math.imul(ah0,bh5))|0;var w5=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w5>>>26))|0;w5&=0x3ffffff;lo=Math.imul(al6,bl0);mid=Math.imul(al6,bh0);mid=(mid+Math.imul(ah6,bl0))|0;hi=Math.imul(ah6,bh0);lo=(lo+Math.imul(al5,bl1))|0;mid=(mid+Math.imul(al5,bh1))|0;mid=(mid+Math.imul(ah5,bl1))|0;hi=(hi+Math.imul(ah5,bh1))|0;lo=(lo+Math.imul(al4,bl2))|0;mid=(mid+Math.imul(al4,bh2))|0;mid=(mid+Math.imul(ah4,bl2))|0;hi=(hi+Math.imul(ah4,bh2))|0;lo=(lo+Math.imul(al3,bl3))|0;mid=(mid+Math.imul(al3,bh3))|0;mid=(mid+Math.imul(ah3,bl3))|0;hi=(hi+Math.imul(ah3,bh3))|0;lo=(lo+Math.imul(al2,bl4))|0;mid=(mid+Math.imul(al2,bh4))|0;mid=(mid+Math.imul(ah2,bl4))|0;hi=(hi+Math.imul(ah2,bh4))|0;lo=(lo+Math.imul(al1,bl5))|0;mid=(mid+Math.imul(al1,bh5))|0;mid=(mid+Math.imul(ah1,bl5))|0;hi=(hi+Math.imul(ah1,bh5))|0;lo=(lo+Math.imul(al0,bl6))|0;mid=(mid+Math.imul(al0,bh6))|0;mid=(mid+Math.imul(ah0,bl6))|0;hi=(hi+Math.imul(ah0,bh6))|0;var w6=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w6>>>26))|0;w6&=0x3ffffff;lo=Math.imul(al7,bl0);mid=Math.imul(al7,bh0);mid=(mid+Math.imul(ah7,bl0))|0;hi=Math.imul(ah7,bh0);lo=(lo+Math.imul(al6,bl1))|0;mid=(mid+Math.imul(al6,bh1))|0;mid=(mid+Math.imul(ah6,bl1))|0;hi=(hi+Math.imul(ah6,bh1))|0;lo=(lo+Math.imul(al5,bl2))|0;mid=(mid+Math.imul(al5,bh2))|0;mid=(mid+Math.imul(ah5,bl2))|0;hi=(hi+Math.imul(ah5,bh2))|0;lo=(lo+Math.imul(al4,bl3))|0;mid=(mid+Math.imul(al4,bh3))|0;mid=(mid+Math.imul(ah4,bl3))|0;hi=(hi+Math.imul(ah4,bh3))|0;lo=(lo+Math.imul(al3,bl4))|0;mid=(mid+Math.imul(al3,bh4))|0;mid=(mid+Math.imul(ah3,bl4))|0;hi=(hi+Math.imul(ah3,bh4))|0;lo=(lo+Math.imul(al2,bl5))|0;mid=(mid+Math.imul(al2,bh5))|0;mid=(mid+Math.imul(ah2,bl5))|0;hi=(hi+Math.imul(ah2,bh5))|0;lo=(lo+Math.imul(al1,bl6))|0;mid=(mid+Math.imul(al1,bh6))|0;mid=(mid+Math.imul(ah1,bl6))|0;hi=(hi+Math.imul(ah1,bh6))|0;lo=(lo+Math.imul(al0,bl7))|0;mid=(mid+Math.imul(al0,bh7))|0;mid=(mid+Math.imul(ah0,bl7))|0;hi=(hi+Math.imul(ah0,bh7))|0;var w7=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w7>>>26))|0;w7&=0x3ffffff;lo=Math.imul(al8,bl0);mid=Math.imul(al8,bh0);mid=(mid+Math.imul(ah8,bl0))|0;hi=Math.imul(ah8,bh0);lo=(lo+Math.imul(al7,bl1))|0;mid=(mid+Math.imul(al7,bh1))|0;mid=(mid+Math.imul(ah7,bl1))|0;hi=(hi+Math.imul(ah7,bh1))|0;lo=(lo+Math.imul(al6,bl2))|0;mid=(mid+Math.imul(al6,bh2))|0;mid=(mid+Math.imul(ah6,bl2))|0;hi=(hi+Math.imul(ah6,bh2))|0;lo=(lo+Math.imul(al5,bl3))|0;mid=(mid+Math.imul(al5,bh3))|0;mid=(mid+Math.imul(ah5,bl3))|0;hi=(hi+Math.imul(ah5,bh3))|0;lo=(lo+Math.imul(al4,bl4))|0;mid=(mid+Math.imul(al4,bh4))|0;mid=(mid+Math.imul(ah4,bl4))|0;hi=(hi+Math.imul(ah4,bh4))|0;lo=(lo+Math.imul(al3,bl5))|0;mid=(mid+Math.imul(al3,bh5))|0;mid=(mid+Math.imul(ah3,bl5))|0;hi=(hi+Math.imul(ah3,bh5))|0;lo=(lo+Math.imul(al2,bl6))|0;mid=(mid+Math.imul(al2,bh6))|0;mid=(mid+Math.imul(ah2,bl6))|0;hi=(hi+Math.imul(ah2,bh6))|0;lo=(lo+Math.imul(al1,bl7))|0;mid=(mid+Math.imul(al1,bh7))|0;mid=(mid+Math.imul(ah1,bl7))|0;hi=(hi+Math.imul(ah1,bh7))|0;lo=(lo+Math.imul(al0,bl8))|0;mid=(mid+Math.imul(al0,bh8))|0;mid=(mid+Math.imul(ah0,bl8))|0;hi=(hi+Math.imul(ah0,bh8))|0;var w8=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w8>>>26))|0;w8&=0x3ffffff;lo=Math.imul(al9,bl0);mid=Math.imul(al9,bh0);mid=(mid+Math.imul(ah9,bl0))|0;hi=Math.imul(ah9,bh0);lo=(lo+Math.imul(al8,bl1))|0;mid=(mid+Math.imul(al8,bh1))|0;mid=(mid+Math.imul(ah8,bl1))|0;hi=(hi+Math.imul(ah8,bh1))|0;lo=(lo+Math.imul(al7,bl2))|0;mid=(mid+Math.imul(al7,bh2))|0;mid=(mid+Math.imul(ah7,bl2))|0;hi=(hi+Math.imul(ah7,bh2))|0;lo=(lo+Math.imul(al6,bl3))|0;mid=(mid+Math.imul(al6,bh3))|0;mid=(mid+Math.imul(ah6,bl3))|0;hi=(hi+Math.imul(ah6,bh3))|0;lo=(lo+Math.imul(al5,bl4))|0;mid=(mid+Math.imul(al5,bh4))|0;mid=(mid+Math.imul(ah5,bl4))|0;hi=(hi+Math.imul(ah5,bh4))|0;lo=(lo+Math.imul(al4,bl5))|0;mid=(mid+Math.imul(al4,bh5))|0;mid=(mid+Math.imul(ah4,bl5))|0;hi=(hi+Math.imul(ah4,bh5))|0;lo=(lo+Math.imul(al3,bl6))|0;mid=(mid+Math.imul(al3,bh6))|0;mid=(mid+Math.imul(ah3,bl6))|0;hi=(hi+Math.imul(ah3,bh6))|0;lo=(lo+Math.imul(al2,bl7))|0;mid=(mid+Math.imul(al2,bh7))|0;mid=(mid+Math.imul(ah2,bl7))|0;hi=(hi+Math.imul(ah2,bh7))|0;lo=(lo+Math.imul(al1,bl8))|0;mid=(mid+Math.imul(al1,bh8))|0;mid=(mid+Math.imul(ah1,bl8))|0;hi=(hi+Math.imul(ah1,bh8))|0;lo=(lo+Math.imul(al0,bl9))|0;mid=(mid+Math.imul(al0,bh9))|0;mid=(mid+Math.imul(ah0,bl9))|0;hi=(hi+Math.imul(ah0,bh9))|0;var w9=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w9>>>26))|0;w9&=0x3ffffff;lo=Math.imul(al9,bl1);mid=Math.imul(al9,bh1);mid=(mid+Math.imul(ah9,bl1))|0;hi=Math.imul(ah9,bh1);lo=(lo+Math.imul(al8,bl2))|0;mid=(mid+Math.imul(al8,bh2))|0;mid=(mid+Math.imul(ah8,bl2))|0;hi=(hi+Math.imul(ah8,bh2))|0;lo=(lo+Math.imul(al7,bl3))|0;mid=(mid+Math.imul(al7,bh3))|0;mid=(mid+Math.imul(ah7,bl3))|0;hi=(hi+Math.imul(ah7,bh3))|0;lo=(lo+Math.imul(al6,bl4))|0;mid=(mid+Math.imul(al6,bh4))|0;mid=(mid+Math.imul(ah6,bl4))|0;hi=(hi+Math.imul(ah6,bh4))|0;lo=(lo+Math.imul(al5,bl5))|0;mid=(mid+Math.imul(al5,bh5))|0;mid=(mid+Math.imul(ah5,bl5))|0;hi=(hi+Math.imul(ah5,bh5))|0;lo=(lo+Math.imul(al4,bl6))|0;mid=(mid+Math.imul(al4,bh6))|0;mid=(mid+Math.imul(ah4,bl6))|0;hi=(hi+Math.imul(ah4,bh6))|0;lo=(lo+Math.imul(al3,bl7))|0;mid=(mid+Math.imul(al3,bh7))|0;mid=(mid+Math.imul(ah3,bl7))|0;hi=(hi+Math.imul(ah3,bh7))|0;lo=(lo+Math.imul(al2,bl8))|0;mid=(mid+Math.imul(al2,bh8))|0;mid=(mid+Math.imul(ah2,bl8))|0;hi=(hi+Math.imul(ah2,bh8))|0;lo=(lo+Math.imul(al1,bl9))|0;mid=(mid+Math.imul(al1,bh9))|0;mid=(mid+Math.imul(ah1,bl9))|0;hi=(hi+Math.imul(ah1,bh9))|0;var w10=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w10>>>26))|0;w10&=0x3ffffff;lo=Math.imul(al9,bl2);mid=Math.imul(al9,bh2);mid=(mid+Math.imul(ah9,bl2))|0;hi=Math.imul(ah9,bh2);lo=(lo+Math.imul(al8,bl3))|0;mid=(mid+Math.imul(al8,bh3))|0;mid=(mid+Math.imul(ah8,bl3))|0;hi=(hi+Math.imul(ah8,bh3))|0;lo=(lo+Math.imul(al7,bl4))|0;mid=(mid+Math.imul(al7,bh4))|0;mid=(mid+Math.imul(ah7,bl4))|0;hi=(hi+Math.imul(ah7,bh4))|0;lo=(lo+Math.imul(al6,bl5))|0;mid=(mid+Math.imul(al6,bh5))|0;mid=(mid+Math.imul(ah6,bl5))|0;hi=(hi+Math.imul(ah6,bh5))|0;lo=(lo+Math.imul(al5,bl6))|0;mid=(mid+Math.imul(al5,bh6))|0;mid=(mid+Math.imul(ah5,bl6))|0;hi=(hi+Math.imul(ah5,bh6))|0;lo=(lo+Math.imul(al4,bl7))|0;mid=(mid+Math.imul(al4,bh7))|0;mid=(mid+Math.imul(ah4,bl7))|0;hi=(hi+Math.imul(ah4,bh7))|0;lo=(lo+Math.imul(al3,bl8))|0;mid=(mid+Math.imul(al3,bh8))|0;mid=(mid+Math.imul(ah3,bl8))|0;hi=(hi+Math.imul(ah3,bh8))|0;lo=(lo+Math.imul(al2,bl9))|0;mid=(mid+Math.imul(al2,bh9))|0;mid=(mid+Math.imul(ah2,bl9))|0;hi=(hi+Math.imul(ah2,bh9))|0;var w11=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w11>>>26))|0;w11&=0x3ffffff;lo=Math.imul(al9,bl3);mid=Math.imul(al9,bh3);mid=(mid+Math.imul(ah9,bl3))|0;hi=Math.imul(ah9,bh3);lo=(lo+Math.imul(al8,bl4))|0;mid=(mid+Math.imul(al8,bh4))|0;mid=(mid+Math.imul(ah8,bl4))|0;hi=(hi+Math.imul(ah8,bh4))|0;lo=(lo+Math.imul(al7,bl5))|0;mid=(mid+Math.imul(al7,bh5))|0;mid=(mid+Math.imul(ah7,bl5))|0;hi=(hi+Math.imul(ah7,bh5))|0;lo=(lo+Math.imul(al6,bl6))|0;mid=(mid+Math.imul(al6,bh6))|0;mid=(mid+Math.imul(ah6,bl6))|0;hi=(hi+Math.imul(ah6,bh6))|0;lo=(lo+Math.imul(al5,bl7))|0;mid=(mid+Math.imul(al5,bh7))|0;mid=(mid+Math.imul(ah5,bl7))|0;hi=(hi+Math.imul(ah5,bh7))|0;lo=(lo+Math.imul(al4,bl8))|0;mid=(mid+Math.imul(al4,bh8))|0;mid=(mid+Math.imul(ah4,bl8))|0;hi=(hi+Math.imul(ah4,bh8))|0;lo=(lo+Math.imul(al3,bl9))|0;mid=(mid+Math.imul(al3,bh9))|0;mid=(mid+Math.imul(ah3,bl9))|0;hi=(hi+Math.imul(ah3,bh9))|0;var w12=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w12>>>26))|0;w12&=0x3ffffff;lo=Math.imul(al9,bl4);mid=Math.imul(al9,bh4);mid=(mid+Math.imul(ah9,bl4))|0;hi=Math.imul(ah9,bh4);lo=(lo+Math.imul(al8,bl5))|0;mid=(mid+Math.imul(al8,bh5))|0;mid=(mid+Math.imul(ah8,bl5))|0;hi=(hi+Math.imul(ah8,bh5))|0;lo=(lo+Math.imul(al7,bl6))|0;mid=(mid+Math.imul(al7,bh6))|0;mid=(mid+Math.imul(ah7,bl6))|0;hi=(hi+Math.imul(ah7,bh6))|0;lo=(lo+Math.imul(al6,bl7))|0;mid=(mid+Math.imul(al6,bh7))|0;mid=(mid+Math.imul(ah6,bl7))|0;hi=(hi+Math.imul(ah6,bh7))|0;lo=(lo+Math.imul(al5,bl8))|0;mid=(mid+Math.imul(al5,bh8))|0;mid=(mid+Math.imul(ah5,bl8))|0;hi=(hi+Math.imul(ah5,bh8))|0;lo=(lo+Math.imul(al4,bl9))|0;mid=(mid+Math.imul(al4,bh9))|0;mid=(mid+Math.imul(ah4,bl9))|0;hi=(hi+Math.imul(ah4,bh9))|0;var w13=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w13>>>26))|0;w13&=0x3ffffff;lo=Math.imul(al9,bl5);mid=Math.imul(al9,bh5);mid=(mid+Math.imul(ah9,bl5))|0;hi=Math.imul(ah9,bh5);lo=(lo+Math.imul(al8,bl6))|0;mid=(mid+Math.imul(al8,bh6))|0;mid=(mid+Math.imul(ah8,bl6))|0;hi=(hi+Math.imul(ah8,bh6))|0;lo=(lo+Math.imul(al7,bl7))|0;mid=(mid+Math.imul(al7,bh7))|0;mid=(mid+Math.imul(ah7,bl7))|0;hi=(hi+Math.imul(ah7,bh7))|0;lo=(lo+Math.imul(al6,bl8))|0;mid=(mid+Math.imul(al6,bh8))|0;mid=(mid+Math.imul(ah6,bl8))|0;hi=(hi+Math.imul(ah6,bh8))|0;lo=(lo+Math.imul(al5,bl9))|0;mid=(mid+Math.imul(al5,bh9))|0;mid=(mid+Math.imul(ah5,bl9))|0;hi=(hi+Math.imul(ah5,bh9))|0;var w14=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w14>>>26))|0;w14&=0x3ffffff;lo=Math.imul(al9,bl6);mid=Math.imul(al9,bh6);mid=(mid+Math.imul(ah9,bl6))|0;hi=Math.imul(ah9,bh6);lo=(lo+Math.imul(al8,bl7))|0;mid=(mid+Math.imul(al8,bh7))|0;mid=(mid+Math.imul(ah8,bl7))|0;hi=(hi+Math.imul(ah8,bh7))|0;lo=(lo+Math.imul(al7,bl8))|0;mid=(mid+Math.imul(al7,bh8))|0;mid=(mid+Math.imul(ah7,bl8))|0;hi=(hi+Math.imul(ah7,bh8))|0;lo=(lo+Math.imul(al6,bl9))|0;mid=(mid+Math.imul(al6,bh9))|0;mid=(mid+Math.imul(ah6,bl9))|0;hi=(hi+Math.imul(ah6,bh9))|0;var w15=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w15>>>26))|0;w15&=0x3ffffff;lo=Math.imul(al9,bl7);mid=Math.imul(al9,bh7);mid=(mid+Math.imul(ah9,bl7))|0;hi=Math.imul(ah9,bh7);lo=(lo+Math.imul(al8,bl8))|0;mid=(mid+Math.imul(al8,bh8))|0;mid=(mid+Math.imul(ah8,bl8))|0;hi=(hi+Math.imul(ah8,bh8))|0;lo=(lo+Math.imul(al7,bl9))|0;mid=(mid+Math.imul(al7,bh9))|0;mid=(mid+Math.imul(ah7,bl9))|0;hi=(hi+Math.imul(ah7,bh9))|0;var w16=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w16>>>26))|0;w16&=0x3ffffff;lo=Math.imul(al9,bl8);mid=Math.imul(al9,bh8);mid=(mid+Math.imul(ah9,bl8))|0;hi=Math.imul(ah9,bh8);lo=(lo+Math.imul(al8,bl9))|0;mid=(mid+Math.imul(al8,bh9))|0;mid=(mid+Math.imul(ah8,bl9))|0;hi=(hi+Math.imul(ah8,bh9))|0;var w17=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w17>>>26))|0;w17&=0x3ffffff;lo=Math.imul(al9,bl9);mid=Math.imul(al9,bh9);mid=(mid+Math.imul(ah9,bl9))|0;hi=Math.imul(ah9,bh9);var w18=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w18>>>26))|0;w18&=0x3ffffff;o[0]=w0;o[1]=w1;o[2]=w2;o[3]=w3;o[4]=w4;o[5]=w5;o[6]=w6;o[7]=w7;o[8]=w8;o[9]=w9;o[10]=w10;o[11]=w11;o[12]=w12;o[13]=w13;o[14]=w14;o[15]=w15;o[16]=w16;o[17]=w17;o[18]=w18;if(c!==0){o[19]=c;out.length++}
return out};if(!Math.imul){comb10MulTo=smallMulTo}
function bigMulTo(self,num,out){out.negative=num.negative^self.negative;out.length=self.length+num.length;var carry=0;var hncarry=0;for(var k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;var rword=carry&0x3ffffff;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j;var a=self.words[i]|0;var b=num.words[j]|0;var r=a*b;var lo=r&0x3ffffff;ncarry=(ncarry+((r/0x4000000)|0))|0;lo=(lo+rword)|0;rword=lo&0x3ffffff;ncarry=(ncarry+(lo>>>26))|0;hncarry+=ncarry>>>26;ncarry&=0x3ffffff}
out.words[k]=rword;carry=ncarry;ncarry=hncarry}
if(carry!==0){out.words[k]=carry}else{out.length--}
return out._strip()}
function jumboMulTo(self,num,out){return bigMulTo(self,num,out)}
BN.prototype.mulTo=function mulTo(num,out){var res;var len=this.length+num.length;if(this.length===10&&num.length===10){res=comb10MulTo(this,num,out)}else if(len<63){res=smallMulTo(this,num,out)}else if(len<1024){res=bigMulTo(this,num,out)}else{res=jumboMulTo(this,num,out)}
return res};function FFTM(x,y){this.x=x;this.y=y}
FFTM.prototype.makeRBT=function makeRBT(N){var t=new Array(N);var l=BN.prototype._countBits(N)-1;for(var i=0;i<N;i++){t[i]=this.revBin(i,l,N)}
return t};FFTM.prototype.revBin=function revBin(x,l,N){if(x===0||x===N-1)return x;var rb=0;for(var i=0;i<l;i++){rb|=(x&1)<<(l-i-1);x>>=1}
return rb};FFTM.prototype.permute=function permute(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++){rtws[i]=rws[rbt[i]];itws[i]=iws[rbt[i]]}};FFTM.prototype.transform=function transform(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1){var l=s<<1;var rtwdf=Math.cos(2*Math.PI/l);var itwdf=Math.sin(2*Math.PI/l);for(var p=0;p<N;p+=l){var rtwdf_=rtwdf;var itwdf_=itwdf;for(var j=0;j<s;j++){var re=rtws[p+j];var ie=itws[p+j];var ro=rtws[p+j+s];var io=itws[p+j+s];var rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro;ro=rx;rtws[p+j]=re+ro;itws[p+j]=ie+io;rtws[p+j+s]=re-ro;itws[p+j+s]=ie-io;if(j!==l){rx=rtwdf*rtwdf_-itwdf*itwdf_;itwdf_=rtwdf*itwdf_+itwdf*rtwdf_;rtwdf_=rx}}}}};FFTM.prototype.guessLen13b=function guessLen13b(n,m){var N=Math.max(m,n)|1;var odd=N&1;var i=0;for(N=N/2|0;N;N=N>>>1){i++}
return 1<<i+1+odd};FFTM.prototype.conjugate=function conjugate(rws,iws,N){if(N<=1)return;for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1];rws[N-i-1]=t;t=iws[i];iws[i]=-iws[N-i-1];iws[N-i-1]=-t}};FFTM.prototype.normalize13b=function normalize13b(ws,N){var carry=0;for(var i=0;i<N/2;i++){var w=Math.round(ws[2*i+1]/N)*0x2000+Math.round(ws[2*i]/N)+carry;ws[i]=w&0x3ffffff;if(w<0x4000000){carry=0}else{carry=w/0x4000000|0}}
return ws};FFTM.prototype.convert13b=function convert13b(ws,len,rws,N){var carry=0;for(var i=0;i<len;i++){carry=carry+(ws[i]|0);rws[2*i]=carry&0x1fff;carry=carry>>>13;rws[2*i+1]=carry&0x1fff;carry=carry>>>13}
for(i=2*len;i<N;++i){rws[i]=0}
assert(carry===0);assert((carry&~0x1fff)===0)};FFTM.prototype.stub=function stub(N){var ph=new Array(N);for(var i=0;i<N;i++){ph[i]=0}
return ph};FFTM.prototype.mulp=function mulp(x,y,out){var N=2*this.guessLen13b(x.length,y.length);var rbt=this.makeRBT(N);var _=this.stub(N);var rws=new Array(N);var rwst=new Array(N);var iwst=new Array(N);var nrws=new Array(N);var nrwst=new Array(N);var niwst=new Array(N);var rmws=out.words;rmws.length=N;this.convert13b(x.words,x.length,rws,N);this.convert13b(y.words,y.length,nrws,N);this.transform(rws,_,rwst,iwst,N,rbt);this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i];rwst[i]=rx}
this.conjugate(rwst,iwst,N);this.transform(rwst,iwst,rmws,_,N,rbt);this.conjugate(rmws,_,N);this.normalize13b(rmws,N);out.negative=x.negative^y.negative;out.length=x.length+y.length;return out._strip()};BN.prototype.mul=function mul(num){var out=new BN(null);out.words=new Array(this.length+num.length);return this.mulTo(num,out)};BN.prototype.mulf=function mulf(num){var out=new BN(null);out.words=new Array(this.length+num.length);return jumboMulTo(this,num,out)};BN.prototype.imul=function imul(num){return this.clone().mulTo(num,this)};BN.prototype.imuln=function imuln(num){var isNegNum=num<0;if(isNegNum)num=-num;assert(typeof num==='number');assert(num<0x4000000);var carry=0;for(var i=0;i<this.length;i++){var w=(this.words[i]|0)*num;var lo=(w&0x3ffffff)+(carry&0x3ffffff);carry>>=26;carry+=(w/0x4000000)|0;carry+=lo>>>26;this.words[i]=lo&0x3ffffff}
if(carry!==0){this.words[i]=carry;this.length++}
return isNegNum?this.ineg():this};BN.prototype.muln=function muln(num){return this.clone().imuln(num)};BN.prototype.sqr=function sqr(){return this.mul(this)};BN.prototype.isqr=function isqr(){return this.imul(this.clone())};BN.prototype.pow=function pow(num){var w=toBitArray(num);if(w.length===0)return new BN(1);var res=this;for(var i=0;i<w.length;i++,res=res.sqr()){if(w[i]!==0)break}
if(++i<w.length){for(var q=res.sqr();i<w.length;i++,q=q.sqr()){if(w[i]===0)continue;res=res.mul(q)}}
return res};BN.prototype.iushln=function iushln(bits){assert(typeof bits==='number'&&bits>=0);var r=bits%26;var s=(bits-r)/26;var carryMask=(0x3ffffff>>>(26-r))<<(26-r);var i;if(r!==0){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask;var c=((this.words[i]|0)-newCarry)<<r;this.words[i]=c|carry;carry=newCarry>>>(26-r)}
if(carry){this.words[i]=carry;this.length++}}
if(s!==0){for(i=this.length-1;i>=0;i--){this.words[i+s]=this.words[i]}
for(i=0;i<s;i++){this.words[i]=0}
this.length+=s}
return this._strip()};BN.prototype.ishln=function ishln(bits){assert(this.negative===0);return this.iushln(bits)};BN.prototype.iushrn=function iushrn(bits,hint,extended){assert(typeof bits==='number'&&bits>=0);var h;if(hint){h=(hint-(hint%26))/26}else{h=0}
var r=bits%26;var s=Math.min((bits-r)/26,this.length);var mask=0x3ffffff^((0x3ffffff>>>r)<<r);var maskedWords=extended;h-=s;h=Math.max(0,h);if(maskedWords){for(var i=0;i<s;i++){maskedWords.words[i]=this.words[i]}
maskedWords.length=s}
if(s===0){}else if(this.length>s){this.length-=s;for(i=0;i<this.length;i++){this.words[i]=this.words[i+s]}}else{this.words[0]=0;this.length=1}
var carry=0;for(i=this.length-1;i>=0&&(carry!==0||i>=h);i--){var word=this.words[i]|0;this.words[i]=(carry<<(26-r))|(word>>>r);carry=word&mask}
if(maskedWords&&carry!==0){maskedWords.words[maskedWords.length++]=carry}
if(this.length===0){this.words[0]=0;this.length=1}
return this._strip()};BN.prototype.ishrn=function ishrn(bits,hint,extended){assert(this.negative===0);return this.iushrn(bits,hint,extended)};BN.prototype.shln=function shln(bits){return this.clone().ishln(bits)};BN.prototype.ushln=function ushln(bits){return this.clone().iushln(bits)};BN.prototype.shrn=function shrn(bits){return this.clone().ishrn(bits)};BN.prototype.ushrn=function ushrn(bits){return this.clone().iushrn(bits)};BN.prototype.testn=function testn(bit){assert(typeof bit==='number'&&bit>=0);var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s)return!1;var w=this.words[s];return!!(w&q)};BN.prototype.imaskn=function imaskn(bits){assert(typeof bits==='number'&&bits>=0);var r=bits%26;var s=(bits-r)/26;assert(this.negative===0,'imaskn works only with positive numbers');if(this.length<=s){return this}
if(r!==0){s++}
this.length=Math.min(s,this.length);if(r!==0){var mask=0x3ffffff^((0x3ffffff>>>r)<<r);this.words[this.length-1]&=mask}
return this._strip()};BN.prototype.maskn=function maskn(bits){return this.clone().imaskn(bits)};BN.prototype.iaddn=function iaddn(num){assert(typeof num==='number');assert(num<0x4000000);if(num<0)return this.isubn(-num);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<=num){this.words[0]=num-(this.words[0]|0);this.negative=0;return this}
this.negative=0;this.isubn(num);this.negative=1;return this}
return this._iaddn(num)};BN.prototype._iaddn=function _iaddn(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=0x4000000;i++){this.words[i]-=0x4000000;if(i===this.length-1){this.words[i+1]=1}else{this.words[i+1]++}}
this.length=Math.max(this.length,i+1);return this};BN.prototype.isubn=function isubn(num){assert(typeof num==='number');assert(num<0x4000000);if(num<0)return this.iaddn(-num);if(this.negative!==0){this.negative=0;this.iaddn(num);this.negative=1;return this}
this.words[0]-=num;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var i=0;i<this.length&&this.words[i]<0;i++){this.words[i]+=0x4000000;this.words[i+1]-=1}}
return this._strip()};BN.prototype.addn=function addn(num){return this.clone().iaddn(num)};BN.prototype.subn=function subn(num){return this.clone().isubn(num)};BN.prototype.iabs=function iabs(){this.negative=0;return this};BN.prototype.abs=function abs(){return this.clone().iabs()};BN.prototype._ishlnsubmul=function _ishlnsubmul(num,mul,shift){var len=num.length+shift;var i;this._expand(len);var w;var carry=0;for(i=0;i<num.length;i++){w=(this.words[i+shift]|0)+carry;var right=(num.words[i]|0)*mul;w-=right&0x3ffffff;carry=(w>>26)-((right/0x4000000)|0);this.words[i+shift]=w&0x3ffffff}
for(;i<this.length-shift;i++){w=(this.words[i+shift]|0)+carry;carry=w>>26;this.words[i+shift]=w&0x3ffffff}
if(carry===0)return this._strip();assert(carry===-1);carry=0;for(i=0;i<this.length;i++){w=-(this.words[i]|0)+carry;carry=w>>26;this.words[i]=w&0x3ffffff}
this.negative=1;return this._strip()};BN.prototype._wordDiv=function _wordDiv(num,mode){var shift=this.length-num.length;var a=this.clone();var b=num;var bhi=b.words[b.length-1]|0;var bhiBits=this._countBits(bhi);shift=26-bhiBits;if(shift!==0){b=b.ushln(shift);a.iushln(shift);bhi=b.words[b.length-1]|0}
var m=a.length-b.length;var q;if(mode!=='mod'){q=new BN(null);q.length=m+1;q.words=new Array(q.length);for(var i=0;i<q.length;i++){q.words[i]=0}}
var diff=a.clone()._ishlnsubmul(b,1,m);if(diff.negative===0){a=diff;if(q){q.words[m]=1}}
for(var j=m-1;j>=0;j--){var qj=(a.words[b.length+j]|0)*0x4000000+(a.words[b.length+j-1]|0);qj=Math.min((qj/bhi)|0,0x3ffffff);a._ishlnsubmul(b,qj,j);while(a.negative!==0){qj--;a.negative=0;a._ishlnsubmul(b,1,j);if(!a.isZero()){a.negative^=1}}
if(q){q.words[j]=qj}}
if(q){q._strip()}
a._strip();if(mode!=='div'&&shift!==0){a.iushrn(shift)}
return{div:q||null,mod:a}};BN.prototype.divmod=function divmod(num,mode,positive){assert(!num.isZero());if(this.isZero()){return{div:new BN(0),mod:new BN(0)}}
var div,mod,res;if(this.negative!==0&&num.negative===0){res=this.neg().divmod(num,mode);if(mode!=='mod'){div=res.div.neg()}
if(mode!=='div'){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.iadd(num)}}
return{div:div,mod:mod}}
if(this.negative===0&&num.negative!==0){res=this.divmod(num.neg(),mode);if(mode!=='mod'){div=res.div.neg()}
return{div:div,mod:res.mod}}
if((this.negative&num.negative)!==0){res=this.neg().divmod(num.neg(),mode);if(mode!=='div'){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.isub(num)}}
return{div:res.div,mod:mod}}
if(num.length>this.length||this.cmp(num)<0){return{div:new BN(0),mod:this}}
if(num.length===1){if(mode==='div'){return{div:this.divn(num.words[0]),mod:null}}
if(mode==='mod'){return{div:null,mod:new BN(this.modrn(num.words[0]))}}
return{div:this.divn(num.words[0]),mod:new BN(this.modrn(num.words[0]))}}
return this._wordDiv(num,mode)};BN.prototype.div=function div(num){return this.divmod(num,'div',!1).div};BN.prototype.mod=function mod(num){return this.divmod(num,'mod',!1).mod};BN.prototype.umod=function umod(num){return this.divmod(num,'mod',!0).mod};BN.prototype.divRound=function divRound(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=dm.div.negative!==0?dm.mod.isub(num):dm.mod;var half=num.ushrn(1);var r2=num.andln(1);var cmp=mod.cmp(half);if(cmp<0||(r2===1&&cmp===0))return dm.div;return dm.div.negative!==0?dm.div.isubn(1):dm.div.iaddn(1)};BN.prototype.modrn=function modrn(num){var isNegNum=num<0;if(isNegNum)num=-num;assert(num<=0x3ffffff);var p=(1<<26)%num;var acc=0;for(var i=this.length-1;i>=0;i--){acc=(p*acc+(this.words[i]|0))%num}
return isNegNum?-acc:acc};BN.prototype.modn=function modn(num){return this.modrn(num)};BN.prototype.idivn=function idivn(num){var isNegNum=num<0;if(isNegNum)num=-num;assert(num<=0x3ffffff);var carry=0;for(var i=this.length-1;i>=0;i--){var w=(this.words[i]|0)+carry*0x4000000;this.words[i]=(w/num)|0;carry=w%num}
this._strip();return isNegNum?this.ineg():this};BN.prototype.divn=function divn(num){return this.clone().idivn(num)};BN.prototype.egcd=function egcd(p){assert(p.negative===0);assert(!p.isZero());var x=this;var y=p.clone();if(x.negative!==0){x=x.umod(p)}else{x=x.clone()}
var A=new BN(1);var B=new BN(0);var C=new BN(0);var D=new BN(1);var g=0;while(x.isEven()&&y.isEven()){x.iushrn(1);y.iushrn(1);++g}
var yp=y.clone();var xp=x.clone();while(!x.isZero()){for(var i=0,im=1;(x.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){x.iushrn(i);while(i-->0){if(A.isOdd()||B.isOdd()){A.iadd(yp);B.isub(xp)}
A.iushrn(1);B.iushrn(1)}}
for(var j=0,jm=1;(y.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){y.iushrn(j);while(j-->0){if(C.isOdd()||D.isOdd()){C.iadd(yp);D.isub(xp)}
C.iushrn(1);D.iushrn(1)}}
if(x.cmp(y)>=0){x.isub(y);A.isub(C);B.isub(D)}else{y.isub(x);C.isub(A);D.isub(B)}}
return{a:C,b:D,gcd:y.iushln(g)}};BN.prototype._invmp=function _invmp(p){assert(p.negative===0);assert(!p.isZero());var a=this;var b=p.clone();if(a.negative!==0){a=a.umod(p)}else{a=a.clone()}
var x1=new BN(1);var x2=new BN(0);var delta=b.clone();while(a.cmpn(1)>0&&b.cmpn(1)>0){for(var i=0,im=1;(a.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){a.iushrn(i);while(i-->0){if(x1.isOdd()){x1.iadd(delta)}
x1.iushrn(1)}}
for(var j=0,jm=1;(b.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){b.iushrn(j);while(j-->0){if(x2.isOdd()){x2.iadd(delta)}
x2.iushrn(1)}}
if(a.cmp(b)>=0){a.isub(b);x1.isub(x2)}else{b.isub(a);x2.isub(x1)}}
var res;if(a.cmpn(1)===0){res=x1}else{res=x2}
if(res.cmpn(0)<0){res.iadd(p)}
return res};BN.prototype.gcd=function gcd(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone();var b=num.clone();a.negative=0;b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++){a.iushrn(1);b.iushrn(1)}
do{while(a.isEven()){a.iushrn(1)}
while(b.isEven()){b.iushrn(1)}
var r=a.cmp(b);if(r<0){var t=a;a=b;b=t}else if(r===0||b.cmpn(1)===0){break}
a.isub(b)}while(!0);return b.iushln(shift)};BN.prototype.invm=function invm(num){return this.egcd(num).a.umod(num)};BN.prototype.isEven=function isEven(){return(this.words[0]&1)===0};BN.prototype.isOdd=function isOdd(){return(this.words[0]&1)===1};BN.prototype.andln=function andln(num){return this.words[0]&num};BN.prototype.bincn=function bincn(bit){assert(typeof bit==='number');var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s){this._expand(s+1);this.words[s]|=q;return this}
var carry=q;for(var i=s;carry!==0&&i<this.length;i++){var w=this.words[i]|0;w+=carry;carry=w>>>26;w&=0x3ffffff;this.words[i]=w}
if(carry!==0){this.words[i]=carry;this.length++}
return this};BN.prototype.isZero=function isZero(){return this.length===1&&this.words[0]===0};BN.prototype.cmpn=function cmpn(num){var negative=num<0;if(this.negative!==0&&!negative)return-1;if(this.negative===0&&negative)return 1;this._strip();var res;if(this.length>1){res=1}else{if(negative){num=-num}
assert(num<=0x3ffffff,'Number is too big');var w=this.words[0]|0;res=w===num?0:w<num?-1:1}
if(this.negative!==0)return-res|0;return res};BN.prototype.cmp=function cmp(num){if(this.negative!==0&&num.negative===0)return-1;if(this.negative===0&&num.negative!==0)return 1;var res=this.ucmp(num);if(this.negative!==0)return-res|0;return res};BN.prototype.ucmp=function ucmp(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;var res=0;for(var i=this.length-1;i>=0;i--){var a=this.words[i]|0;var b=num.words[i]|0;if(a===b)continue;if(a<b){res=-1}else if(a>b){res=1}
break}
return res};BN.prototype.gtn=function gtn(num){return this.cmpn(num)===1};BN.prototype.gt=function gt(num){return this.cmp(num)===1};BN.prototype.gten=function gten(num){return this.cmpn(num)>=0};BN.prototype.gte=function gte(num){return this.cmp(num)>=0};BN.prototype.ltn=function ltn(num){return this.cmpn(num)===-1};BN.prototype.lt=function lt(num){return this.cmp(num)===-1};BN.prototype.lten=function lten(num){return this.cmpn(num)<=0};BN.prototype.lte=function lte(num){return this.cmp(num)<=0};BN.prototype.eqn=function eqn(num){return this.cmpn(num)===0};BN.prototype.eq=function eq(num){return this.cmp(num)===0};BN.red=function red(num){return new Red(num)};BN.prototype.toRed=function toRed(ctx){assert(!this.red,'Already a number in reduction context');assert(this.negative===0,'red works only with positives');return ctx.convertTo(this)._forceRed(ctx)};BN.prototype.fromRed=function fromRed(){assert(this.red,'fromRed works only with numbers in reduction context');return this.red.convertFrom(this)};BN.prototype._forceRed=function _forceRed(ctx){this.red=ctx;return this};BN.prototype.forceRed=function forceRed(ctx){assert(!this.red,'Already a number in reduction context');return this._forceRed(ctx)};BN.prototype.redAdd=function redAdd(num){assert(this.red,'redAdd works only with red numbers');return this.red.add(this,num)};BN.prototype.redIAdd=function redIAdd(num){assert(this.red,'redIAdd works only with red numbers');return this.red.iadd(this,num)};BN.prototype.redSub=function redSub(num){assert(this.red,'redSub works only with red numbers');return this.red.sub(this,num)};BN.prototype.redISub=function redISub(num){assert(this.red,'redISub works only with red numbers');return this.red.isub(this,num)};BN.prototype.redShl=function redShl(num){assert(this.red,'redShl works only with red numbers');return this.red.shl(this,num)};BN.prototype.redMul=function redMul(num){assert(this.red,'redMul works only with red numbers');this.red._verify2(this,num);return this.red.mul(this,num)};BN.prototype.redIMul=function redIMul(num){assert(this.red,'redMul works only with red numbers');this.red._verify2(this,num);return this.red.imul(this,num)};BN.prototype.redSqr=function redSqr(){assert(this.red,'redSqr works only with red numbers');this.red._verify1(this);return this.red.sqr(this)};BN.prototype.redISqr=function redISqr(){assert(this.red,'redISqr works only with red numbers');this.red._verify1(this);return this.red.isqr(this)};BN.prototype.redSqrt=function redSqrt(){assert(this.red,'redSqrt works only with red numbers');this.red._verify1(this);return this.red.sqrt(this)};BN.prototype.redInvm=function redInvm(){assert(this.red,'redInvm works only with red numbers');this.red._verify1(this);return this.red.invm(this)};BN.prototype.redNeg=function redNeg(){assert(this.red,'redNeg works only with red numbers');this.red._verify1(this);return this.red.neg(this)};BN.prototype.redPow=function redPow(num){assert(this.red&&!num.red,'redPow(normalNum)');this.red._verify1(this);return this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name;this.p=new BN(p,16);this.n=this.p.bitLength();this.k=new BN(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}
MPrime.prototype._tmp=function _tmp(){var tmp=new BN(null);tmp.words=new Array(Math.ceil(this.n/13));return tmp};MPrime.prototype.ireduce=function ireduce(num){var r=num;var rlen;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);rlen=r.bitLength()}while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);if(cmp===0){r.words[0]=0;r.length=1}else if(cmp>0){r.isub(this.p)}else{r._strip()}
return r};MPrime.prototype.split=function split(input,out){input.iushrn(this.n,0,out)};MPrime.prototype.imulK=function imulK(num){return num.imul(this.k)};function K256(){MPrime.call(this,'k256','ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f')}
inherits(K256,MPrime);K256.prototype.split=function split(input,output){var mask=0x3fffff;var outLen=Math.min(input.length,9);for(var i=0;i<outLen;i++){output.words[i]=input.words[i]}
output.length=outLen;if(input.length<=9){input.words[0]=0;input.length=1;return}
var prev=input.words[9];output.words[output.length++]=prev&mask;for(i=10;i<input.length;i++){var next=input.words[i]|0;input.words[i-10]=((next&mask)<<4)|(prev>>>22);prev=next}
prev>>>=22;input.words[i-10]=prev;if(prev===0&&input.length>10){input.length-=10}else{input.length-=9}};K256.prototype.imulK=function imulK(num){num.words[num.length]=0;num.words[num.length+1]=0;num.length+=2;var lo=0;for(var i=0;i<num.length;i++){var w=num.words[i]|0;lo+=w*0x3d1;num.words[i]=lo&0x3ffffff;lo=w*0x40+((lo/0x4000000)|0)}
if(num.words[num.length-1]===0){num.length--;if(num.words[num.length-1]===0){num.length--}}
return num};function P224(){MPrime.call(this,'p224','ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001')}
inherits(P224,MPrime);function P192(){MPrime.call(this,'p192','ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff')}
inherits(P192,MPrime);function P25519(){MPrime.call(this,'25519','7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed')}
inherits(P25519,MPrime);P25519.prototype.imulK=function imulK(num){var carry=0;for(var i=0;i<num.length;i++){var hi=(num.words[i]|0)*0x13+carry;var lo=hi&0x3ffffff;hi>>>=26;num.words[i]=lo;carry=hi}
if(carry!==0){num.words[num.length++]=carry}
return num};BN._prime=function prime(name){if(primes[name])return primes[name];var prime;if(name==='k256'){prime=new K256()}else if(name==='p224'){prime=new P224()}else if(name==='p192'){prime=new P192()}else if(name==='p25519'){prime=new P25519()}else{throw new Error('Unknown prime '+name)}
primes[name]=prime;return prime};function Red(m){if(typeof m==='string'){var prime=BN._prime(m);this.m=prime.p;this.prime=prime}else{assert(m.gtn(1),'modulus must be greater than 1');this.m=m;this.prime=null}}
Red.prototype._verify1=function _verify1(a){assert(a.negative===0,'red works only with positives');assert(a.red,'red works only with red numbers')};Red.prototype._verify2=function _verify2(a,b){assert((a.negative|b.negative)===0,'red works only with positives');assert(a.red&&a.red===b.red,'red works only with red numbers')};Red.prototype.imod=function imod(a){if(this.prime)return this.prime.ireduce(a)._forceRed(this);move(a,a.umod(this.m)._forceRed(this));return a};Red.prototype.neg=function neg(a){if(a.isZero()){return a.clone()}
return this.m.sub(a)._forceRed(this)};Red.prototype.add=function add(a,b){this._verify2(a,b);var res=a.add(b);if(res.cmp(this.m)>=0){res.isub(this.m)}
return res._forceRed(this)};Red.prototype.iadd=function iadd(a,b){this._verify2(a,b);var res=a.iadd(b);if(res.cmp(this.m)>=0){res.isub(this.m)}
return res};Red.prototype.sub=function sub(a,b){this._verify2(a,b);var res=a.sub(b);if(res.cmpn(0)<0){res.iadd(this.m)}
return res._forceRed(this)};Red.prototype.isub=function isub(a,b){this._verify2(a,b);var res=a.isub(b);if(res.cmpn(0)<0){res.iadd(this.m)}
return res};Red.prototype.shl=function shl(a,num){this._verify1(a);return this.imod(a.ushln(num))};Red.prototype.imul=function imul(a,b){this._verify2(a,b);return this.imod(a.imul(b))};Red.prototype.mul=function mul(a,b){this._verify2(a,b);return this.imod(a.mul(b))};Red.prototype.isqr=function isqr(a){return this.imul(a,a.clone())};Red.prototype.sqr=function sqr(a){return this.mul(a,a)};Red.prototype.sqrt=function sqrt(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);assert(mod3%2===1);if(mod3===3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}
var q=this.m.subn(1);var s=0;while(!q.isZero()&&q.andln(1)===0){s++;q.iushrn(1)}
assert(!q.isZero());var one=new BN(1).toRed(this);var nOne=one.redNeg();var lpow=this.m.subn(1).iushrn(1);var z=this.m.bitLength();z=new BN(2*z*z).toRed(this);while(this.pow(z,lpow).cmp(nOne)!==0){z.redIAdd(nOne)}
var c=this.pow(z,q);var r=this.pow(a,q.addn(1).iushrn(1));var t=this.pow(a,q);var m=s;while(t.cmp(one)!==0){var tmp=t;for(var i=0;tmp.cmp(one)!==0;i++){tmp=tmp.redSqr()}
assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b);c=b.redSqr();t=t.redMul(c);m=i}
return r};Red.prototype.invm=function invm(a){var inv=a._invmp(this.m);if(inv.negative!==0){inv.negative=0;return this.imod(inv).redNeg()}else{return this.imod(inv)}};Red.prototype.pow=function pow(a,num){if(num.isZero())return new BN(1).toRed(this);if(num.cmpn(1)===0)return a.clone();var windowSize=4;var wnd=new Array(1<<windowSize);wnd[0]=new BN(1).toRed(this);wnd[1]=a;for(var i=2;i<wnd.length;i++){wnd[i]=this.mul(wnd[i-1],a)}
var res=wnd[0];var current=0;var currentLen=0;var start=num.bitLength()%26;if(start===0){start=26}
for(i=num.length-1;i>=0;i--){var word=num.words[i];for(var j=start-1;j>=0;j--){var bit=(word>>j)&1;if(res!==wnd[0]){res=this.sqr(res)}
if(bit===0&&current===0){currentLen=0;continue}
current<<=1;current|=bit;currentLen++;if(currentLen!==windowSize&&(i!==0||j!==0))continue;res=this.mul(res,wnd[current]);currentLen=0;current=0}
start=26}
return res};Red.prototype.convertTo=function convertTo(num){var r=num.umod(this.m);return r===num?r.clone():r};Red.prototype.convertFrom=function convertFrom(num){var res=num.clone();res.red=null;return res};BN.mont=function mont(num){return new Mont(num)};function Mont(m){Red.call(this,m);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-(this.shift%26)}
this.r=new BN(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}
inherits(Mont,Red);Mont.prototype.convertTo=function convertTo(num){return this.imod(num.ushln(this.shift))};Mont.prototype.convertFrom=function convertFrom(num){var r=this.imod(num.mul(this.rinv));r.red=null;return r};Mont.prototype.imul=function imul(a,b){if(a.isZero()||b.isZero()){a.words[0]=0;a.length=1;return a}
var t=a.imul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}
return res._forceRed(this)};Mont.prototype.mul=function mul(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}
return res._forceRed(this)};Mont.prototype.invm=function invm(a){var res=this.imod(a._invmp(this.m).mul(this.r2));return res._forceRed(this)}})(typeof module==='undefined'||module,this)},{"buffer":2}],49:[function(require,module,exports){'use strict';var BN=require('bn.js');var numberToBN=require('number-to-bn');var zero=new BN(0);var negative1=new BN(-1);var unitMap={'noether':'0','wei':'1','kwei':'1000','Kwei':'1000','babbage':'1000','femtoether':'1000','mwei':'1000000','Mwei':'1000000','lovelace':'1000000','picoether':'1000000','gwei':'1000000000','Gwei':'1000000000','shannon':'1000000000','nanoether':'1000000000','nano':'1000000000','szabo':'1000000000000','microether':'1000000000000','micro':'1000000000000','finney':'1000000000000000','milliether':'1000000000000000','milli':'1000000000000000','ether':'1000000000000000000','kether':'1000000000000000000000','grand':'1000000000000000000000','mether':'1000000000000000000000000','gether':'1000000000000000000000000000','tether':'1000000000000000000000000000000'};function getValueOfUnit(unitInput){var unit=unitInput?unitInput.toLowerCase():'ether';var unitValue=unitMap[unit];if(typeof unitValue!=='string'){throw new Error('[ethjs-unit] the unit provided '+unitInput+' doesn\'t exists, please use the one of the following units '+JSON.stringify(unitMap,null,2))}
return new BN(unitValue,10)}
function numberToString(arg){if(typeof arg==='string'){if(!arg.match(/^-?[0-9.]+$/)){throw new Error('while converting number to string, invalid number value \''+arg+'\', should be a number matching (^-?[0-9.]+).')}
return arg}else if(typeof arg==='number'){return String(arg)}else if(typeof arg==='object'&&arg.toString&&(arg.toTwos||arg.dividedToIntegerBy)){if(arg.toPrecision){return String(arg.toPrecision())}else{return arg.toString(10)}}
throw new Error('while converting number to string, invalid number value \''+arg+'\' type '+typeof arg+'.')}
function fromWei(weiInput,unit,optionsInput){var wei=numberToBN(weiInput);var negative=wei.lt(zero);var base=getValueOfUnit(unit);var baseLength=unitMap[unit].length-1||1;var options=optionsInput||{};if(negative){wei=wei.mul(negative1)}
var fraction=wei.mod(base).toString(10);while(fraction.length<baseLength){fraction='0'+fraction}
if(!options.pad){fraction=fraction.match(/^([0-9]*[1-9]|0)(0*)/)[1]}
var whole=wei.div(base).toString(10);if(options.commify){whole=whole.replace(/\B(?=(\d{3})+(?!\d))/g,',')}
var value=''+whole+(fraction=='0'?'':'.'+fraction);if(negative){value='-'+value}
return value}
function toWei(etherInput,unit){var ether=numberToString(etherInput);var base=getValueOfUnit(unit);var baseLength=unitMap[unit].length-1||1;var negative=ether.substring(0,1)==='-';if(negative){ether=ether.substring(1)}
if(ether==='.'){throw new Error('[ethjs-unit] while converting number '+etherInput+' to wei, invalid value')}
var comps=ether.split('.');if(comps.length>2){throw new Error('[ethjs-unit] while converting number '+etherInput+' to wei,  too many decimal points')}
var whole=comps[0],fraction=comps[1];if(!whole){whole='0'}
if(!fraction){fraction='0'}
if(fraction.length>baseLength){throw new Error('[ethjs-unit] while converting number '+etherInput+' to wei, too many decimal places')}
while(fraction.length<baseLength){fraction+='0'}
whole=new BN(whole);fraction=new BN(fraction);var wei=whole.mul(base).add(fraction);if(negative){wei=wei.mul(negative1)}
return new BN(wei.toString(10),10)}
module.exports={unitMap:unitMap,numberToString:numberToString,getValueOfUnit:getValueOfUnit,fromWei:fromWei,toWei:toWei}},{"bn.js":50,"number-to-bn":55}],50:[function(require,module,exports){(function(module,exports){'use strict';function assert(val,msg){if(!val)throw new Error(msg||'Assertion failed');}
function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor();ctor.prototype.constructor=ctor}
function BN(number,base,endian){if(BN.isBN(number)){return number}
this.negative=0;this.words=null;this.length=0;this.red=null;if(number!==null){if(base==='le'||base==='be'){endian=base;base=10}
this._init(number||0,base||10,endian||'be')}}
if(typeof module==='object'){module.exports=BN}else{exports.BN=BN}
BN.BN=BN;BN.wordSize=26;var Buffer;try{Buffer=require('buf'+'fer').Buffer}catch(e){}
BN.isBN=function isBN(num){if(num instanceof BN){return!0}
return num!==null&&typeof num==='object'&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)};BN.max=function max(left,right){if(left.cmp(right)>0)return left;return right};BN.min=function min(left,right){if(left.cmp(right)<0)return left;return right};BN.prototype._init=function init(number,base,endian){if(typeof number==='number'){return this._initNumber(number,base,endian)}
if(typeof number==='object'){return this._initArray(number,base,endian)}
if(base==='hex'){base=16}
assert(base===(base|0)&&base>=2&&base<=36);number=number.toString().replace(/\s+/g,'');var start=0;if(number[0]==='-'){start++}
if(base===16){this._parseHex(number,start)}else{this._parseBase(number,base,start)}
if(number[0]==='-'){this.negative=1}
this.strip();if(endian!=='le')return;this._initArray(this.toArray(),base,endian)};BN.prototype._initNumber=function _initNumber(number,base,endian){if(number<0){this.negative=1;number=-number}
if(number<0x4000000){this.words=[number&0x3ffffff];this.length=1}else if(number<0x10000000000000){this.words=[number&0x3ffffff,(number/0x4000000)&0x3ffffff];this.length=2}else{assert(number<0x20000000000000);this.words=[number&0x3ffffff,(number/0x4000000)&0x3ffffff,1];this.length=3}
if(endian!=='le')return;this._initArray(this.toArray(),base,endian)};BN.prototype._initArray=function _initArray(number,base,endian){assert(typeof number.length==='number');if(number.length<=0){this.words=[0];this.length=1;return this}
this.length=Math.ceil(number.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}
var j,w;var off=0;if(endian==='be'){for(i=number.length-1,j=0;i>=0;i-=3){w=number[i]|(number[i-1]<<8)|(number[i-2]<<16);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]=(w>>>(26-off))&0x3ffffff;off+=24;if(off>=26){off-=26;j++}}}else if(endian==='le'){for(i=0,j=0;i<number.length;i+=3){w=number[i]|(number[i+1]<<8)|(number[i+2]<<16);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]=(w>>>(26-off))&0x3ffffff;off+=24;if(off>=26){off-=26;j++}}}
return this.strip()};function parseHex(str,start,end){var r=0;var len=Math.min(str.length,end);for(var i=start;i<len;i++){var c=str.charCodeAt(i)-48;r<<=4;if(c>=49&&c<=54){r|=c-49+0xa}else if(c>=17&&c<=22){r|=c-17+0xa}else{r|=c&0xf}}
return r}
BN.prototype._parseHex=function _parseHex(number,start){this.length=Math.ceil((number.length-start)/6);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}
var j,w;var off=0;for(i=number.length-6,j=0;i>=start;i-=6){w=parseHex(number,i,i+6);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]|=w>>>(26-off)&0x3fffff;off+=24;if(off>=26){off-=26;j++}}
if(i+6!==start){w=parseHex(number,start,i+6);this.words[j]|=(w<<off)&0x3ffffff;this.words[j+1]|=w>>>(26-off)&0x3fffff}
this.strip()};function parseBase(str,start,end,mul){var r=0;var len=Math.min(str.length,end);for(var i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul;if(c>=49){r+=c-49+0xa}else if(c>=17){r+=c-17+0xa}else{r+=c}}
return r}
BN.prototype._parseBase=function _parseBase(number,base,start){this.words=[0];this.length=1;for(var limbLen=0,limbPow=1;limbPow<=0x3ffffff;limbPow*=base){limbLen++}
limbLen--;limbPow=(limbPow/base)|0;var total=number.length-start;var mod=total%limbLen;var end=Math.min(total,total-mod)+start;var word=0;for(var i=start;i<end;i+=limbLen){word=parseBase(number,i,i+limbLen,base);this.imuln(limbPow);if(this.words[0]+word<0x4000000){this.words[0]+=word}else{this._iaddn(word)}}
if(mod!==0){var pow=1;word=parseBase(number,i,number.length,base);for(i=0;i<mod;i++){pow*=base}
this.imuln(pow);if(this.words[0]+word<0x4000000){this.words[0]+=word}else{this._iaddn(word)}}};BN.prototype.copy=function copy(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++){dest.words[i]=this.words[i]}
dest.length=this.length;dest.negative=this.negative;dest.red=this.red};BN.prototype.clone=function clone(){var r=new BN(null);this.copy(r);return r};BN.prototype._expand=function _expand(size){while(this.length<size){this.words[this.length++]=0}
return this};BN.prototype.strip=function strip(){while(this.length>1&&this.words[this.length-1]===0){this.length--}
return this._normSign()};BN.prototype._normSign=function _normSign(){if(this.length===1&&this.words[0]===0){this.negative=0}
return this};BN.prototype.inspect=function inspect(){return(this.red?'<BN-R: ':'<BN: ')+this.toString(16)+'>'};var zeros=['','0','00','000','0000','00000','000000','0000000','00000000','000000000','0000000000','00000000000','000000000000','0000000000000','00000000000000','000000000000000','0000000000000000','00000000000000000','000000000000000000','0000000000000000000','00000000000000000000','000000000000000000000','0000000000000000000000','00000000000000000000000','000000000000000000000000','0000000000000000000000000'];var groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,10000000,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64000000,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,24300000,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function toString(base,padding){base=base||10;padding=padding|0||1;var out;if(base===16||base==='hex'){out='';var off=0;var carry=0;for(var i=0;i<this.length;i++){var w=this.words[i];var word=(((w<<off)|carry)&0xffffff).toString(16);carry=(w>>>(24-off))&0xffffff;if(carry!==0||i!==this.length-1){out=zeros[6-word.length]+word+out}else{out=word+out}
off+=2;if(off>=26){off-=26;i--}}
if(carry!==0){out=carry.toString(16)+out}
while(out.length%padding!==0){out='0'+out}
if(this.negative!==0){out='-'+out}
return out}
if(base===(base|0)&&base>=2&&base<=36){var groupSize=groupSizes[base];var groupBase=groupBases[base];out='';var c=this.clone();c.negative=0;while(!c.isZero()){var r=c.modn(groupBase).toString(base);c=c.idivn(groupBase);if(!c.isZero()){out=zeros[groupSize-r.length]+r+out}else{out=r+out}}
if(this.isZero()){out='0'+out}
while(out.length%padding!==0){out='0'+out}
if(this.negative!==0){out='-'+out}
return out}
assert(!1,'Base should be between 2 and 36')};BN.prototype.toNumber=function toNumber(){var ret=this.words[0];if(this.length===2){ret+=this.words[1]*0x4000000}else if(this.length===3&&this.words[2]===0x01){ret+=0x10000000000000+(this.words[1]*0x4000000)}else if(this.length>2){assert(!1,'Number can only safely store up to 53 bits')}
return(this.negative!==0)?-ret:ret};BN.prototype.toJSON=function toJSON(){return this.toString(16)};BN.prototype.toBuffer=function toBuffer(endian,length){assert(typeof Buffer!=='undefined');return this.toArrayLike(Buffer,endian,length)};BN.prototype.toArray=function toArray(endian,length){return this.toArrayLike(Array,endian,length)};BN.prototype.toArrayLike=function toArrayLike(ArrayType,endian,length){var byteLength=this.byteLength();var reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,'byte array longer than desired length');assert(reqLength>0,'Requested array length <= 0');this.strip();var littleEndian=endian==='le';var res=new ArrayType(reqLength);var b,i;var q=this.clone();if(!littleEndian){for(i=0;i<reqLength-byteLength;i++){res[i]=0}
for(i=0;!q.isZero();i++){b=q.andln(0xff);q.iushrn(8);res[reqLength-i-1]=b}}else{for(i=0;!q.isZero();i++){b=q.andln(0xff);q.iushrn(8);res[i]=b}
for(;i<reqLength;i++){res[i]=0}}
return res};if(Math.clz32){BN.prototype._countBits=function _countBits(w){return 32-Math.clz32(w)}}else{BN.prototype._countBits=function _countBits(w){var t=w;var r=0;if(t>=0x1000){r+=13;t>>>=13}
if(t>=0x40){r+=7;t>>>=7}
if(t>=0x8){r+=4;t>>>=4}
if(t>=0x02){r+=2;t>>>=2}
return r+t}}
BN.prototype._zeroBits=function _zeroBits(w){if(w===0)return 26;var t=w;var r=0;if((t&0x1fff)===0){r+=13;t>>>=13}
if((t&0x7f)===0){r+=7;t>>>=7}
if((t&0xf)===0){r+=4;t>>>=4}
if((t&0x3)===0){r+=2;t>>>=2}
if((t&0x1)===0){r++}
return r};BN.prototype.bitLength=function bitLength(){var w=this.words[this.length-1];var hi=this._countBits(w);return(this.length-1)*26+hi};function toBitArray(num){var w=new Array(num.bitLength());for(var bit=0;bit<w.length;bit++){var off=(bit/26)|0;var wbit=bit%26;w[bit]=(num.words[off]&(1<<wbit))>>>wbit}
return w}
BN.prototype.zeroBits=function zeroBits(){if(this.isZero())return 0;var r=0;for(var i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);r+=b;if(b!==26)break}
return r};BN.prototype.byteLength=function byteLength(){return Math.ceil(this.bitLength()/8)};BN.prototype.toTwos=function toTwos(width){if(this.negative!==0){return this.abs().inotn(width).iaddn(1)}
return this.clone()};BN.prototype.fromTwos=function fromTwos(width){if(this.testn(width-1)){return this.notn(width).iaddn(1).ineg()}
return this.clone()};BN.prototype.isNeg=function isNeg(){return this.negative!==0};BN.prototype.neg=function neg(){return this.clone().ineg()};BN.prototype.ineg=function ineg(){if(!this.isZero()){this.negative^=1}
return this};BN.prototype.iuor=function iuor(num){while(this.length<num.length){this.words[this.length++]=0}
for(var i=0;i<num.length;i++){this.words[i]=this.words[i]|num.words[i]}
return this.strip()};BN.prototype.ior=function ior(num){assert((this.negative|num.negative)===0);return this.iuor(num)};BN.prototype.or=function or(num){if(this.length>num.length)return this.clone().ior(num);return num.clone().ior(this)};BN.prototype.uor=function uor(num){if(this.length>num.length)return this.clone().iuor(num);return num.clone().iuor(this)};BN.prototype.iuand=function iuand(num){var b;if(this.length>num.length){b=num}else{b=this}
for(var i=0;i<b.length;i++){this.words[i]=this.words[i]&num.words[i]}
this.length=b.length;return this.strip()};BN.prototype.iand=function iand(num){assert((this.negative|num.negative)===0);return this.iuand(num)};BN.prototype.and=function and(num){if(this.length>num.length)return this.clone().iand(num);return num.clone().iand(this)};BN.prototype.uand=function uand(num){if(this.length>num.length)return this.clone().iuand(num);return num.clone().iuand(this)};BN.prototype.iuxor=function iuxor(num){var a;var b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}
for(var i=0;i<b.length;i++){this.words[i]=a.words[i]^b.words[i]}
if(this!==a){for(;i<a.length;i++){this.words[i]=a.words[i]}}
this.length=a.length;return this.strip()};BN.prototype.ixor=function ixor(num){assert((this.negative|num.negative)===0);return this.iuxor(num)};BN.prototype.xor=function xor(num){if(this.length>num.length)return this.clone().ixor(num);return num.clone().ixor(this)};BN.prototype.uxor=function uxor(num){if(this.length>num.length)return this.clone().iuxor(num);return num.clone().iuxor(this)};BN.prototype.inotn=function inotn(width){assert(typeof width==='number'&&width>=0);var bytesNeeded=Math.ceil(width/26)|0;var bitsLeft=width%26;this._expand(bytesNeeded);if(bitsLeft>0){bytesNeeded--}
for(var i=0;i<bytesNeeded;i++){this.words[i]=~this.words[i]&0x3ffffff}
if(bitsLeft>0){this.words[i]=~this.words[i]&(0x3ffffff>>(26-bitsLeft))}
return this.strip()};BN.prototype.notn=function notn(width){return this.clone().inotn(width)};BN.prototype.setn=function setn(bit,val){assert(typeof bit==='number'&&bit>=0);var off=(bit/26)|0;var wbit=bit%26;this._expand(off+1);if(val){this.words[off]=this.words[off]|(1<<wbit)}else{this.words[off]=this.words[off]&~(1<<wbit)}
return this.strip()};BN.prototype.iadd=function iadd(num){var r;if(this.negative!==0&&num.negative===0){this.negative=0;r=this.isub(num);this.negative^=1;return this._normSign()}else if(this.negative===0&&num.negative!==0){num.negative=0;r=this.isub(num);num.negative=1;return r._normSign()}
var a,b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}
var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)+(b.words[i]|0)+carry;this.words[i]=r&0x3ffffff;carry=r>>>26}
for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;this.words[i]=r&0x3ffffff;carry=r>>>26}
this.length=a.length;if(carry!==0){this.words[this.length]=carry;this.length++}else if(a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}
return this};BN.prototype.add=function add(num){var res;if(num.negative!==0&&this.negative===0){num.negative=0;res=this.sub(num);num.negative^=1;return res}else if(num.negative===0&&this.negative!==0){this.negative=0;res=num.sub(this);this.negative=1;return res}
if(this.length>num.length)return this.clone().iadd(num);return num.clone().iadd(this)};BN.prototype.isub=function isub(num){if(num.negative!==0){num.negative=0;var r=this.iadd(num);num.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(num);this.negative=1;return this._normSign()}
var cmp=this.cmp(num);if(cmp===0){this.negative=0;this.length=1;this.words[0]=0;return this}
var a,b;if(cmp>0){a=this;b=num}else{a=num;b=this}
var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)-(b.words[i]|0)+carry;carry=r>>26;this.words[i]=r&0x3ffffff}
for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;carry=r>>26;this.words[i]=r&0x3ffffff}
if(carry===0&&i<a.length&&a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}
this.length=Math.max(this.length,i);if(a!==this){this.negative=1}
return this.strip()};BN.prototype.sub=function sub(num){return this.clone().isub(num)};function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=(self.length+num.length)|0;out.length=len;len=(len-1)|0;var a=self.words[0]|0;var b=num.words[0]|0;var r=a*b;var lo=r&0x3ffffff;var carry=(r/0x4000000)|0;out.words[0]=lo;for(var k=1;k<len;k++){var ncarry=carry>>>26;var rword=carry&0x3ffffff;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=(k-j)|0;a=self.words[i]|0;b=num.words[j]|0;r=a*b+rword;ncarry+=(r/0x4000000)|0;rword=r&0x3ffffff}
out.words[k]=rword|0;carry=ncarry|0}
if(carry!==0){out.words[k]=carry|0}else{out.length--}
return out.strip()}
var comb10MulTo=function comb10MulTo(self,num,out){var a=self.words;var b=num.words;var o=out.words;var c=0;var lo;var mid;var hi;var a0=a[0]|0;var al0=a0&0x1fff;var ah0=a0>>>13;var a1=a[1]|0;var al1=a1&0x1fff;var ah1=a1>>>13;var a2=a[2]|0;var al2=a2&0x1fff;var ah2=a2>>>13;var a3=a[3]|0;var al3=a3&0x1fff;var ah3=a3>>>13;var a4=a[4]|0;var al4=a4&0x1fff;var ah4=a4>>>13;var a5=a[5]|0;var al5=a5&0x1fff;var ah5=a5>>>13;var a6=a[6]|0;var al6=a6&0x1fff;var ah6=a6>>>13;var a7=a[7]|0;var al7=a7&0x1fff;var ah7=a7>>>13;var a8=a[8]|0;var al8=a8&0x1fff;var ah8=a8>>>13;var a9=a[9]|0;var al9=a9&0x1fff;var ah9=a9>>>13;var b0=b[0]|0;var bl0=b0&0x1fff;var bh0=b0>>>13;var b1=b[1]|0;var bl1=b1&0x1fff;var bh1=b1>>>13;var b2=b[2]|0;var bl2=b2&0x1fff;var bh2=b2>>>13;var b3=b[3]|0;var bl3=b3&0x1fff;var bh3=b3>>>13;var b4=b[4]|0;var bl4=b4&0x1fff;var bh4=b4>>>13;var b5=b[5]|0;var bl5=b5&0x1fff;var bh5=b5>>>13;var b6=b[6]|0;var bl6=b6&0x1fff;var bh6=b6>>>13;var b7=b[7]|0;var bl7=b7&0x1fff;var bh7=b7>>>13;var b8=b[8]|0;var bl8=b8&0x1fff;var bh8=b8>>>13;var b9=b[9]|0;var bl9=b9&0x1fff;var bh9=b9>>>13;out.negative=self.negative^num.negative;out.length=19;lo=Math.imul(al0,bl0);mid=Math.imul(al0,bh0);mid=(mid+Math.imul(ah0,bl0))|0;hi=Math.imul(ah0,bh0);var w0=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w0>>>26))|0;w0&=0x3ffffff;lo=Math.imul(al1,bl0);mid=Math.imul(al1,bh0);mid=(mid+Math.imul(ah1,bl0))|0;hi=Math.imul(ah1,bh0);lo=(lo+Math.imul(al0,bl1))|0;mid=(mid+Math.imul(al0,bh1))|0;mid=(mid+Math.imul(ah0,bl1))|0;hi=(hi+Math.imul(ah0,bh1))|0;var w1=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w1>>>26))|0;w1&=0x3ffffff;lo=Math.imul(al2,bl0);mid=Math.imul(al2,bh0);mid=(mid+Math.imul(ah2,bl0))|0;hi=Math.imul(ah2,bh0);lo=(lo+Math.imul(al1,bl1))|0;mid=(mid+Math.imul(al1,bh1))|0;mid=(mid+Math.imul(ah1,bl1))|0;hi=(hi+Math.imul(ah1,bh1))|0;lo=(lo+Math.imul(al0,bl2))|0;mid=(mid+Math.imul(al0,bh2))|0;mid=(mid+Math.imul(ah0,bl2))|0;hi=(hi+Math.imul(ah0,bh2))|0;var w2=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w2>>>26))|0;w2&=0x3ffffff;lo=Math.imul(al3,bl0);mid=Math.imul(al3,bh0);mid=(mid+Math.imul(ah3,bl0))|0;hi=Math.imul(ah3,bh0);lo=(lo+Math.imul(al2,bl1))|0;mid=(mid+Math.imul(al2,bh1))|0;mid=(mid+Math.imul(ah2,bl1))|0;hi=(hi+Math.imul(ah2,bh1))|0;lo=(lo+Math.imul(al1,bl2))|0;mid=(mid+Math.imul(al1,bh2))|0;mid=(mid+Math.imul(ah1,bl2))|0;hi=(hi+Math.imul(ah1,bh2))|0;lo=(lo+Math.imul(al0,bl3))|0;mid=(mid+Math.imul(al0,bh3))|0;mid=(mid+Math.imul(ah0,bl3))|0;hi=(hi+Math.imul(ah0,bh3))|0;var w3=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w3>>>26))|0;w3&=0x3ffffff;lo=Math.imul(al4,bl0);mid=Math.imul(al4,bh0);mid=(mid+Math.imul(ah4,bl0))|0;hi=Math.imul(ah4,bh0);lo=(lo+Math.imul(al3,bl1))|0;mid=(mid+Math.imul(al3,bh1))|0;mid=(mid+Math.imul(ah3,bl1))|0;hi=(hi+Math.imul(ah3,bh1))|0;lo=(lo+Math.imul(al2,bl2))|0;mid=(mid+Math.imul(al2,bh2))|0;mid=(mid+Math.imul(ah2,bl2))|0;hi=(hi+Math.imul(ah2,bh2))|0;lo=(lo+Math.imul(al1,bl3))|0;mid=(mid+Math.imul(al1,bh3))|0;mid=(mid+Math.imul(ah1,bl3))|0;hi=(hi+Math.imul(ah1,bh3))|0;lo=(lo+Math.imul(al0,bl4))|0;mid=(mid+Math.imul(al0,bh4))|0;mid=(mid+Math.imul(ah0,bl4))|0;hi=(hi+Math.imul(ah0,bh4))|0;var w4=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w4>>>26))|0;w4&=0x3ffffff;lo=Math.imul(al5,bl0);mid=Math.imul(al5,bh0);mid=(mid+Math.imul(ah5,bl0))|0;hi=Math.imul(ah5,bh0);lo=(lo+Math.imul(al4,bl1))|0;mid=(mid+Math.imul(al4,bh1))|0;mid=(mid+Math.imul(ah4,bl1))|0;hi=(hi+Math.imul(ah4,bh1))|0;lo=(lo+Math.imul(al3,bl2))|0;mid=(mid+Math.imul(al3,bh2))|0;mid=(mid+Math.imul(ah3,bl2))|0;hi=(hi+Math.imul(ah3,bh2))|0;lo=(lo+Math.imul(al2,bl3))|0;mid=(mid+Math.imul(al2,bh3))|0;mid=(mid+Math.imul(ah2,bl3))|0;hi=(hi+Math.imul(ah2,bh3))|0;lo=(lo+Math.imul(al1,bl4))|0;mid=(mid+Math.imul(al1,bh4))|0;mid=(mid+Math.imul(ah1,bl4))|0;hi=(hi+Math.imul(ah1,bh4))|0;lo=(lo+Math.imul(al0,bl5))|0;mid=(mid+Math.imul(al0,bh5))|0;mid=(mid+Math.imul(ah0,bl5))|0;hi=(hi+Math.imul(ah0,bh5))|0;var w5=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w5>>>26))|0;w5&=0x3ffffff;lo=Math.imul(al6,bl0);mid=Math.imul(al6,bh0);mid=(mid+Math.imul(ah6,bl0))|0;hi=Math.imul(ah6,bh0);lo=(lo+Math.imul(al5,bl1))|0;mid=(mid+Math.imul(al5,bh1))|0;mid=(mid+Math.imul(ah5,bl1))|0;hi=(hi+Math.imul(ah5,bh1))|0;lo=(lo+Math.imul(al4,bl2))|0;mid=(mid+Math.imul(al4,bh2))|0;mid=(mid+Math.imul(ah4,bl2))|0;hi=(hi+Math.imul(ah4,bh2))|0;lo=(lo+Math.imul(al3,bl3))|0;mid=(mid+Math.imul(al3,bh3))|0;mid=(mid+Math.imul(ah3,bl3))|0;hi=(hi+Math.imul(ah3,bh3))|0;lo=(lo+Math.imul(al2,bl4))|0;mid=(mid+Math.imul(al2,bh4))|0;mid=(mid+Math.imul(ah2,bl4))|0;hi=(hi+Math.imul(ah2,bh4))|0;lo=(lo+Math.imul(al1,bl5))|0;mid=(mid+Math.imul(al1,bh5))|0;mid=(mid+Math.imul(ah1,bl5))|0;hi=(hi+Math.imul(ah1,bh5))|0;lo=(lo+Math.imul(al0,bl6))|0;mid=(mid+Math.imul(al0,bh6))|0;mid=(mid+Math.imul(ah0,bl6))|0;hi=(hi+Math.imul(ah0,bh6))|0;var w6=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w6>>>26))|0;w6&=0x3ffffff;lo=Math.imul(al7,bl0);mid=Math.imul(al7,bh0);mid=(mid+Math.imul(ah7,bl0))|0;hi=Math.imul(ah7,bh0);lo=(lo+Math.imul(al6,bl1))|0;mid=(mid+Math.imul(al6,bh1))|0;mid=(mid+Math.imul(ah6,bl1))|0;hi=(hi+Math.imul(ah6,bh1))|0;lo=(lo+Math.imul(al5,bl2))|0;mid=(mid+Math.imul(al5,bh2))|0;mid=(mid+Math.imul(ah5,bl2))|0;hi=(hi+Math.imul(ah5,bh2))|0;lo=(lo+Math.imul(al4,bl3))|0;mid=(mid+Math.imul(al4,bh3))|0;mid=(mid+Math.imul(ah4,bl3))|0;hi=(hi+Math.imul(ah4,bh3))|0;lo=(lo+Math.imul(al3,bl4))|0;mid=(mid+Math.imul(al3,bh4))|0;mid=(mid+Math.imul(ah3,bl4))|0;hi=(hi+Math.imul(ah3,bh4))|0;lo=(lo+Math.imul(al2,bl5))|0;mid=(mid+Math.imul(al2,bh5))|0;mid=(mid+Math.imul(ah2,bl5))|0;hi=(hi+Math.imul(ah2,bh5))|0;lo=(lo+Math.imul(al1,bl6))|0;mid=(mid+Math.imul(al1,bh6))|0;mid=(mid+Math.imul(ah1,bl6))|0;hi=(hi+Math.imul(ah1,bh6))|0;lo=(lo+Math.imul(al0,bl7))|0;mid=(mid+Math.imul(al0,bh7))|0;mid=(mid+Math.imul(ah0,bl7))|0;hi=(hi+Math.imul(ah0,bh7))|0;var w7=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w7>>>26))|0;w7&=0x3ffffff;lo=Math.imul(al8,bl0);mid=Math.imul(al8,bh0);mid=(mid+Math.imul(ah8,bl0))|0;hi=Math.imul(ah8,bh0);lo=(lo+Math.imul(al7,bl1))|0;mid=(mid+Math.imul(al7,bh1))|0;mid=(mid+Math.imul(ah7,bl1))|0;hi=(hi+Math.imul(ah7,bh1))|0;lo=(lo+Math.imul(al6,bl2))|0;mid=(mid+Math.imul(al6,bh2))|0;mid=(mid+Math.imul(ah6,bl2))|0;hi=(hi+Math.imul(ah6,bh2))|0;lo=(lo+Math.imul(al5,bl3))|0;mid=(mid+Math.imul(al5,bh3))|0;mid=(mid+Math.imul(ah5,bl3))|0;hi=(hi+Math.imul(ah5,bh3))|0;lo=(lo+Math.imul(al4,bl4))|0;mid=(mid+Math.imul(al4,bh4))|0;mid=(mid+Math.imul(ah4,bl4))|0;hi=(hi+Math.imul(ah4,bh4))|0;lo=(lo+Math.imul(al3,bl5))|0;mid=(mid+Math.imul(al3,bh5))|0;mid=(mid+Math.imul(ah3,bl5))|0;hi=(hi+Math.imul(ah3,bh5))|0;lo=(lo+Math.imul(al2,bl6))|0;mid=(mid+Math.imul(al2,bh6))|0;mid=(mid+Math.imul(ah2,bl6))|0;hi=(hi+Math.imul(ah2,bh6))|0;lo=(lo+Math.imul(al1,bl7))|0;mid=(mid+Math.imul(al1,bh7))|0;mid=(mid+Math.imul(ah1,bl7))|0;hi=(hi+Math.imul(ah1,bh7))|0;lo=(lo+Math.imul(al0,bl8))|0;mid=(mid+Math.imul(al0,bh8))|0;mid=(mid+Math.imul(ah0,bl8))|0;hi=(hi+Math.imul(ah0,bh8))|0;var w8=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w8>>>26))|0;w8&=0x3ffffff;lo=Math.imul(al9,bl0);mid=Math.imul(al9,bh0);mid=(mid+Math.imul(ah9,bl0))|0;hi=Math.imul(ah9,bh0);lo=(lo+Math.imul(al8,bl1))|0;mid=(mid+Math.imul(al8,bh1))|0;mid=(mid+Math.imul(ah8,bl1))|0;hi=(hi+Math.imul(ah8,bh1))|0;lo=(lo+Math.imul(al7,bl2))|0;mid=(mid+Math.imul(al7,bh2))|0;mid=(mid+Math.imul(ah7,bl2))|0;hi=(hi+Math.imul(ah7,bh2))|0;lo=(lo+Math.imul(al6,bl3))|0;mid=(mid+Math.imul(al6,bh3))|0;mid=(mid+Math.imul(ah6,bl3))|0;hi=(hi+Math.imul(ah6,bh3))|0;lo=(lo+Math.imul(al5,bl4))|0;mid=(mid+Math.imul(al5,bh4))|0;mid=(mid+Math.imul(ah5,bl4))|0;hi=(hi+Math.imul(ah5,bh4))|0;lo=(lo+Math.imul(al4,bl5))|0;mid=(mid+Math.imul(al4,bh5))|0;mid=(mid+Math.imul(ah4,bl5))|0;hi=(hi+Math.imul(ah4,bh5))|0;lo=(lo+Math.imul(al3,bl6))|0;mid=(mid+Math.imul(al3,bh6))|0;mid=(mid+Math.imul(ah3,bl6))|0;hi=(hi+Math.imul(ah3,bh6))|0;lo=(lo+Math.imul(al2,bl7))|0;mid=(mid+Math.imul(al2,bh7))|0;mid=(mid+Math.imul(ah2,bl7))|0;hi=(hi+Math.imul(ah2,bh7))|0;lo=(lo+Math.imul(al1,bl8))|0;mid=(mid+Math.imul(al1,bh8))|0;mid=(mid+Math.imul(ah1,bl8))|0;hi=(hi+Math.imul(ah1,bh8))|0;lo=(lo+Math.imul(al0,bl9))|0;mid=(mid+Math.imul(al0,bh9))|0;mid=(mid+Math.imul(ah0,bl9))|0;hi=(hi+Math.imul(ah0,bh9))|0;var w9=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w9>>>26))|0;w9&=0x3ffffff;lo=Math.imul(al9,bl1);mid=Math.imul(al9,bh1);mid=(mid+Math.imul(ah9,bl1))|0;hi=Math.imul(ah9,bh1);lo=(lo+Math.imul(al8,bl2))|0;mid=(mid+Math.imul(al8,bh2))|0;mid=(mid+Math.imul(ah8,bl2))|0;hi=(hi+Math.imul(ah8,bh2))|0;lo=(lo+Math.imul(al7,bl3))|0;mid=(mid+Math.imul(al7,bh3))|0;mid=(mid+Math.imul(ah7,bl3))|0;hi=(hi+Math.imul(ah7,bh3))|0;lo=(lo+Math.imul(al6,bl4))|0;mid=(mid+Math.imul(al6,bh4))|0;mid=(mid+Math.imul(ah6,bl4))|0;hi=(hi+Math.imul(ah6,bh4))|0;lo=(lo+Math.imul(al5,bl5))|0;mid=(mid+Math.imul(al5,bh5))|0;mid=(mid+Math.imul(ah5,bl5))|0;hi=(hi+Math.imul(ah5,bh5))|0;lo=(lo+Math.imul(al4,bl6))|0;mid=(mid+Math.imul(al4,bh6))|0;mid=(mid+Math.imul(ah4,bl6))|0;hi=(hi+Math.imul(ah4,bh6))|0;lo=(lo+Math.imul(al3,bl7))|0;mid=(mid+Math.imul(al3,bh7))|0;mid=(mid+Math.imul(ah3,bl7))|0;hi=(hi+Math.imul(ah3,bh7))|0;lo=(lo+Math.imul(al2,bl8))|0;mid=(mid+Math.imul(al2,bh8))|0;mid=(mid+Math.imul(ah2,bl8))|0;hi=(hi+Math.imul(ah2,bh8))|0;lo=(lo+Math.imul(al1,bl9))|0;mid=(mid+Math.imul(al1,bh9))|0;mid=(mid+Math.imul(ah1,bl9))|0;hi=(hi+Math.imul(ah1,bh9))|0;var w10=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w10>>>26))|0;w10&=0x3ffffff;lo=Math.imul(al9,bl2);mid=Math.imul(al9,bh2);mid=(mid+Math.imul(ah9,bl2))|0;hi=Math.imul(ah9,bh2);lo=(lo+Math.imul(al8,bl3))|0;mid=(mid+Math.imul(al8,bh3))|0;mid=(mid+Math.imul(ah8,bl3))|0;hi=(hi+Math.imul(ah8,bh3))|0;lo=(lo+Math.imul(al7,bl4))|0;mid=(mid+Math.imul(al7,bh4))|0;mid=(mid+Math.imul(ah7,bl4))|0;hi=(hi+Math.imul(ah7,bh4))|0;lo=(lo+Math.imul(al6,bl5))|0;mid=(mid+Math.imul(al6,bh5))|0;mid=(mid+Math.imul(ah6,bl5))|0;hi=(hi+Math.imul(ah6,bh5))|0;lo=(lo+Math.imul(al5,bl6))|0;mid=(mid+Math.imul(al5,bh6))|0;mid=(mid+Math.imul(ah5,bl6))|0;hi=(hi+Math.imul(ah5,bh6))|0;lo=(lo+Math.imul(al4,bl7))|0;mid=(mid+Math.imul(al4,bh7))|0;mid=(mid+Math.imul(ah4,bl7))|0;hi=(hi+Math.imul(ah4,bh7))|0;lo=(lo+Math.imul(al3,bl8))|0;mid=(mid+Math.imul(al3,bh8))|0;mid=(mid+Math.imul(ah3,bl8))|0;hi=(hi+Math.imul(ah3,bh8))|0;lo=(lo+Math.imul(al2,bl9))|0;mid=(mid+Math.imul(al2,bh9))|0;mid=(mid+Math.imul(ah2,bl9))|0;hi=(hi+Math.imul(ah2,bh9))|0;var w11=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w11>>>26))|0;w11&=0x3ffffff;lo=Math.imul(al9,bl3);mid=Math.imul(al9,bh3);mid=(mid+Math.imul(ah9,bl3))|0;hi=Math.imul(ah9,bh3);lo=(lo+Math.imul(al8,bl4))|0;mid=(mid+Math.imul(al8,bh4))|0;mid=(mid+Math.imul(ah8,bl4))|0;hi=(hi+Math.imul(ah8,bh4))|0;lo=(lo+Math.imul(al7,bl5))|0;mid=(mid+Math.imul(al7,bh5))|0;mid=(mid+Math.imul(ah7,bl5))|0;hi=(hi+Math.imul(ah7,bh5))|0;lo=(lo+Math.imul(al6,bl6))|0;mid=(mid+Math.imul(al6,bh6))|0;mid=(mid+Math.imul(ah6,bl6))|0;hi=(hi+Math.imul(ah6,bh6))|0;lo=(lo+Math.imul(al5,bl7))|0;mid=(mid+Math.imul(al5,bh7))|0;mid=(mid+Math.imul(ah5,bl7))|0;hi=(hi+Math.imul(ah5,bh7))|0;lo=(lo+Math.imul(al4,bl8))|0;mid=(mid+Math.imul(al4,bh8))|0;mid=(mid+Math.imul(ah4,bl8))|0;hi=(hi+Math.imul(ah4,bh8))|0;lo=(lo+Math.imul(al3,bl9))|0;mid=(mid+Math.imul(al3,bh9))|0;mid=(mid+Math.imul(ah3,bl9))|0;hi=(hi+Math.imul(ah3,bh9))|0;var w12=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w12>>>26))|0;w12&=0x3ffffff;lo=Math.imul(al9,bl4);mid=Math.imul(al9,bh4);mid=(mid+Math.imul(ah9,bl4))|0;hi=Math.imul(ah9,bh4);lo=(lo+Math.imul(al8,bl5))|0;mid=(mid+Math.imul(al8,bh5))|0;mid=(mid+Math.imul(ah8,bl5))|0;hi=(hi+Math.imul(ah8,bh5))|0;lo=(lo+Math.imul(al7,bl6))|0;mid=(mid+Math.imul(al7,bh6))|0;mid=(mid+Math.imul(ah7,bl6))|0;hi=(hi+Math.imul(ah7,bh6))|0;lo=(lo+Math.imul(al6,bl7))|0;mid=(mid+Math.imul(al6,bh7))|0;mid=(mid+Math.imul(ah6,bl7))|0;hi=(hi+Math.imul(ah6,bh7))|0;lo=(lo+Math.imul(al5,bl8))|0;mid=(mid+Math.imul(al5,bh8))|0;mid=(mid+Math.imul(ah5,bl8))|0;hi=(hi+Math.imul(ah5,bh8))|0;lo=(lo+Math.imul(al4,bl9))|0;mid=(mid+Math.imul(al4,bh9))|0;mid=(mid+Math.imul(ah4,bl9))|0;hi=(hi+Math.imul(ah4,bh9))|0;var w13=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w13>>>26))|0;w13&=0x3ffffff;lo=Math.imul(al9,bl5);mid=Math.imul(al9,bh5);mid=(mid+Math.imul(ah9,bl5))|0;hi=Math.imul(ah9,bh5);lo=(lo+Math.imul(al8,bl6))|0;mid=(mid+Math.imul(al8,bh6))|0;mid=(mid+Math.imul(ah8,bl6))|0;hi=(hi+Math.imul(ah8,bh6))|0;lo=(lo+Math.imul(al7,bl7))|0;mid=(mid+Math.imul(al7,bh7))|0;mid=(mid+Math.imul(ah7,bl7))|0;hi=(hi+Math.imul(ah7,bh7))|0;lo=(lo+Math.imul(al6,bl8))|0;mid=(mid+Math.imul(al6,bh8))|0;mid=(mid+Math.imul(ah6,bl8))|0;hi=(hi+Math.imul(ah6,bh8))|0;lo=(lo+Math.imul(al5,bl9))|0;mid=(mid+Math.imul(al5,bh9))|0;mid=(mid+Math.imul(ah5,bl9))|0;hi=(hi+Math.imul(ah5,bh9))|0;var w14=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w14>>>26))|0;w14&=0x3ffffff;lo=Math.imul(al9,bl6);mid=Math.imul(al9,bh6);mid=(mid+Math.imul(ah9,bl6))|0;hi=Math.imul(ah9,bh6);lo=(lo+Math.imul(al8,bl7))|0;mid=(mid+Math.imul(al8,bh7))|0;mid=(mid+Math.imul(ah8,bl7))|0;hi=(hi+Math.imul(ah8,bh7))|0;lo=(lo+Math.imul(al7,bl8))|0;mid=(mid+Math.imul(al7,bh8))|0;mid=(mid+Math.imul(ah7,bl8))|0;hi=(hi+Math.imul(ah7,bh8))|0;lo=(lo+Math.imul(al6,bl9))|0;mid=(mid+Math.imul(al6,bh9))|0;mid=(mid+Math.imul(ah6,bl9))|0;hi=(hi+Math.imul(ah6,bh9))|0;var w15=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w15>>>26))|0;w15&=0x3ffffff;lo=Math.imul(al9,bl7);mid=Math.imul(al9,bh7);mid=(mid+Math.imul(ah9,bl7))|0;hi=Math.imul(ah9,bh7);lo=(lo+Math.imul(al8,bl8))|0;mid=(mid+Math.imul(al8,bh8))|0;mid=(mid+Math.imul(ah8,bl8))|0;hi=(hi+Math.imul(ah8,bh8))|0;lo=(lo+Math.imul(al7,bl9))|0;mid=(mid+Math.imul(al7,bh9))|0;mid=(mid+Math.imul(ah7,bl9))|0;hi=(hi+Math.imul(ah7,bh9))|0;var w16=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w16>>>26))|0;w16&=0x3ffffff;lo=Math.imul(al9,bl8);mid=Math.imul(al9,bh8);mid=(mid+Math.imul(ah9,bl8))|0;hi=Math.imul(ah9,bh8);lo=(lo+Math.imul(al8,bl9))|0;mid=(mid+Math.imul(al8,bh9))|0;mid=(mid+Math.imul(ah8,bl9))|0;hi=(hi+Math.imul(ah8,bh9))|0;var w17=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w17>>>26))|0;w17&=0x3ffffff;lo=Math.imul(al9,bl9);mid=Math.imul(al9,bh9);mid=(mid+Math.imul(ah9,bl9))|0;hi=Math.imul(ah9,bh9);var w18=(((c+lo)|0)+((mid&0x1fff)<<13))|0;c=(((hi+(mid>>>13))|0)+(w18>>>26))|0;w18&=0x3ffffff;o[0]=w0;o[1]=w1;o[2]=w2;o[3]=w3;o[4]=w4;o[5]=w5;o[6]=w6;o[7]=w7;o[8]=w8;o[9]=w9;o[10]=w10;o[11]=w11;o[12]=w12;o[13]=w13;o[14]=w14;o[15]=w15;o[16]=w16;o[17]=w17;o[18]=w18;if(c!==0){o[19]=c;out.length++}
return out};if(!Math.imul){comb10MulTo=smallMulTo}
function bigMulTo(self,num,out){out.negative=num.negative^self.negative;out.length=self.length+num.length;var carry=0;var hncarry=0;for(var k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;var rword=carry&0x3ffffff;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j;var a=self.words[i]|0;var b=num.words[j]|0;var r=a*b;var lo=r&0x3ffffff;ncarry=(ncarry+((r/0x4000000)|0))|0;lo=(lo+rword)|0;rword=lo&0x3ffffff;ncarry=(ncarry+(lo>>>26))|0;hncarry+=ncarry>>>26;ncarry&=0x3ffffff}
out.words[k]=rword;carry=ncarry;ncarry=hncarry}
if(carry!==0){out.words[k]=carry}else{out.length--}
return out.strip()}
function jumboMulTo(self,num,out){var fftm=new FFTM();return fftm.mulp(self,num,out)}
BN.prototype.mulTo=function mulTo(num,out){var res;var len=this.length+num.length;if(this.length===10&&num.length===10){res=comb10MulTo(this,num,out)}else if(len<63){res=smallMulTo(this,num,out)}else if(len<1024){res=bigMulTo(this,num,out)}else{res=jumboMulTo(this,num,out)}
return res};function FFTM(x,y){this.x=x;this.y=y}
FFTM.prototype.makeRBT=function makeRBT(N){var t=new Array(N);var l=BN.prototype._countBits(N)-1;for(var i=0;i<N;i++){t[i]=this.revBin(i,l,N)}
return t};FFTM.prototype.revBin=function revBin(x,l,N){if(x===0||x===N-1)return x;var rb=0;for(var i=0;i<l;i++){rb|=(x&1)<<(l-i-1);x>>=1}
return rb};FFTM.prototype.permute=function permute(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++){rtws[i]=rws[rbt[i]];itws[i]=iws[rbt[i]]}};FFTM.prototype.transform=function transform(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1){var l=s<<1;var rtwdf=Math.cos(2*Math.PI/l);var itwdf=Math.sin(2*Math.PI/l);for(var p=0;p<N;p+=l){var rtwdf_=rtwdf;var itwdf_=itwdf;for(var j=0;j<s;j++){var re=rtws[p+j];var ie=itws[p+j];var ro=rtws[p+j+s];var io=itws[p+j+s];var rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro;ro=rx;rtws[p+j]=re+ro;itws[p+j]=ie+io;rtws[p+j+s]=re-ro;itws[p+j+s]=ie-io;if(j!==l){rx=rtwdf*rtwdf_-itwdf*itwdf_;itwdf_=rtwdf*itwdf_+itwdf*rtwdf_;rtwdf_=rx}}}}};FFTM.prototype.guessLen13b=function guessLen13b(n,m){var N=Math.max(m,n)|1;var odd=N&1;var i=0;for(N=N/2|0;N;N=N>>>1){i++}
return 1<<i+1+odd};FFTM.prototype.conjugate=function conjugate(rws,iws,N){if(N<=1)return;for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1];rws[N-i-1]=t;t=iws[i];iws[i]=-iws[N-i-1];iws[N-i-1]=-t}};FFTM.prototype.normalize13b=function normalize13b(ws,N){var carry=0;for(var i=0;i<N/2;i++){var w=Math.round(ws[2*i+1]/N)*0x2000+Math.round(ws[2*i]/N)+carry;ws[i]=w&0x3ffffff;if(w<0x4000000){carry=0}else{carry=w/0x4000000|0}}
return ws};FFTM.prototype.convert13b=function convert13b(ws,len,rws,N){var carry=0;for(var i=0;i<len;i++){carry=carry+(ws[i]|0);rws[2*i]=carry&0x1fff;carry=carry>>>13;rws[2*i+1]=carry&0x1fff;carry=carry>>>13}
for(i=2*len;i<N;++i){rws[i]=0}
assert(carry===0);assert((carry&~0x1fff)===0)};FFTM.prototype.stub=function stub(N){var ph=new Array(N);for(var i=0;i<N;i++){ph[i]=0}
return ph};FFTM.prototype.mulp=function mulp(x,y,out){var N=2*this.guessLen13b(x.length,y.length);var rbt=this.makeRBT(N);var _=this.stub(N);var rws=new Array(N);var rwst=new Array(N);var iwst=new Array(N);var nrws=new Array(N);var nrwst=new Array(N);var niwst=new Array(N);var rmws=out.words;rmws.length=N;this.convert13b(x.words,x.length,rws,N);this.convert13b(y.words,y.length,nrws,N);this.transform(rws,_,rwst,iwst,N,rbt);this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i];rwst[i]=rx}
this.conjugate(rwst,iwst,N);this.transform(rwst,iwst,rmws,_,N,rbt);this.conjugate(rmws,_,N);this.normalize13b(rmws,N);out.negative=x.negative^y.negative;out.length=x.length+y.length;return out.strip()};BN.prototype.mul=function mul(num){var out=new BN(null);out.words=new Array(this.length+num.length);return this.mulTo(num,out)};BN.prototype.mulf=function mulf(num){var out=new BN(null);out.words=new Array(this.length+num.length);return jumboMulTo(this,num,out)};BN.prototype.imul=function imul(num){return this.clone().mulTo(num,this)};BN.prototype.imuln=function imuln(num){assert(typeof num==='number');assert(num<0x4000000);var carry=0;for(var i=0;i<this.length;i++){var w=(this.words[i]|0)*num;var lo=(w&0x3ffffff)+(carry&0x3ffffff);carry>>=26;carry+=(w/0x4000000)|0;carry+=lo>>>26;this.words[i]=lo&0x3ffffff}
if(carry!==0){this.words[i]=carry;this.length++}
return this};BN.prototype.muln=function muln(num){return this.clone().imuln(num)};BN.prototype.sqr=function sqr(){return this.mul(this)};BN.prototype.isqr=function isqr(){return this.imul(this.clone())};BN.prototype.pow=function pow(num){var w=toBitArray(num);if(w.length===0)return new BN(1);var res=this;for(var i=0;i<w.length;i++,res=res.sqr()){if(w[i]!==0)break}
if(++i<w.length){for(var q=res.sqr();i<w.length;i++,q=q.sqr()){if(w[i]===0)continue;res=res.mul(q)}}
return res};BN.prototype.iushln=function iushln(bits){assert(typeof bits==='number'&&bits>=0);var r=bits%26;var s=(bits-r)/26;var carryMask=(0x3ffffff>>>(26-r))<<(26-r);var i;if(r!==0){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask;var c=((this.words[i]|0)-newCarry)<<r;this.words[i]=c|carry;carry=newCarry>>>(26-r)}
if(carry){this.words[i]=carry;this.length++}}
if(s!==0){for(i=this.length-1;i>=0;i--){this.words[i+s]=this.words[i]}
for(i=0;i<s;i++){this.words[i]=0}
this.length+=s}
return this.strip()};BN.prototype.ishln=function ishln(bits){assert(this.negative===0);return this.iushln(bits)};BN.prototype.iushrn=function iushrn(bits,hint,extended){assert(typeof bits==='number'&&bits>=0);var h;if(hint){h=(hint-(hint%26))/26}else{h=0}
var r=bits%26;var s=Math.min((bits-r)/26,this.length);var mask=0x3ffffff^((0x3ffffff>>>r)<<r);var maskedWords=extended;h-=s;h=Math.max(0,h);if(maskedWords){for(var i=0;i<s;i++){maskedWords.words[i]=this.words[i]}
maskedWords.length=s}
if(s===0){}else if(this.length>s){this.length-=s;for(i=0;i<this.length;i++){this.words[i]=this.words[i+s]}}else{this.words[0]=0;this.length=1}
var carry=0;for(i=this.length-1;i>=0&&(carry!==0||i>=h);i--){var word=this.words[i]|0;this.words[i]=(carry<<(26-r))|(word>>>r);carry=word&mask}
if(maskedWords&&carry!==0){maskedWords.words[maskedWords.length++]=carry}
if(this.length===0){this.words[0]=0;this.length=1}
return this.strip()};BN.prototype.ishrn=function ishrn(bits,hint,extended){assert(this.negative===0);return this.iushrn(bits,hint,extended)};BN.prototype.shln=function shln(bits){return this.clone().ishln(bits)};BN.prototype.ushln=function ushln(bits){return this.clone().iushln(bits)};BN.prototype.shrn=function shrn(bits){return this.clone().ishrn(bits)};BN.prototype.ushrn=function ushrn(bits){return this.clone().iushrn(bits)};BN.prototype.testn=function testn(bit){assert(typeof bit==='number'&&bit>=0);var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s)return!1;var w=this.words[s];return!!(w&q)};BN.prototype.imaskn=function imaskn(bits){assert(typeof bits==='number'&&bits>=0);var r=bits%26;var s=(bits-r)/26;assert(this.negative===0,'imaskn works only with positive numbers');if(this.length<=s){return this}
if(r!==0){s++}
this.length=Math.min(s,this.length);if(r!==0){var mask=0x3ffffff^((0x3ffffff>>>r)<<r);this.words[this.length-1]&=mask}
return this.strip()};BN.prototype.maskn=function maskn(bits){return this.clone().imaskn(bits)};BN.prototype.iaddn=function iaddn(num){assert(typeof num==='number');assert(num<0x4000000);if(num<0)return this.isubn(-num);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<num){this.words[0]=num-(this.words[0]|0);this.negative=0;return this}
this.negative=0;this.isubn(num);this.negative=1;return this}
return this._iaddn(num)};BN.prototype._iaddn=function _iaddn(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=0x4000000;i++){this.words[i]-=0x4000000;if(i===this.length-1){this.words[i+1]=1}else{this.words[i+1]++}}
this.length=Math.max(this.length,i+1);return this};BN.prototype.isubn=function isubn(num){assert(typeof num==='number');assert(num<0x4000000);if(num<0)return this.iaddn(-num);if(this.negative!==0){this.negative=0;this.iaddn(num);this.negative=1;return this}
this.words[0]-=num;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var i=0;i<this.length&&this.words[i]<0;i++){this.words[i]+=0x4000000;this.words[i+1]-=1}}
return this.strip()};BN.prototype.addn=function addn(num){return this.clone().iaddn(num)};BN.prototype.subn=function subn(num){return this.clone().isubn(num)};BN.prototype.iabs=function iabs(){this.negative=0;return this};BN.prototype.abs=function abs(){return this.clone().iabs()};BN.prototype._ishlnsubmul=function _ishlnsubmul(num,mul,shift){var len=num.length+shift;var i;this._expand(len);var w;var carry=0;for(i=0;i<num.length;i++){w=(this.words[i+shift]|0)+carry;var right=(num.words[i]|0)*mul;w-=right&0x3ffffff;carry=(w>>26)-((right/0x4000000)|0);this.words[i+shift]=w&0x3ffffff}
for(;i<this.length-shift;i++){w=(this.words[i+shift]|0)+carry;carry=w>>26;this.words[i+shift]=w&0x3ffffff}
if(carry===0)return this.strip();assert(carry===-1);carry=0;for(i=0;i<this.length;i++){w=-(this.words[i]|0)+carry;carry=w>>26;this.words[i]=w&0x3ffffff}
this.negative=1;return this.strip()};BN.prototype._wordDiv=function _wordDiv(num,mode){var shift=this.length-num.length;var a=this.clone();var b=num;var bhi=b.words[b.length-1]|0;var bhiBits=this._countBits(bhi);shift=26-bhiBits;if(shift!==0){b=b.ushln(shift);a.iushln(shift);bhi=b.words[b.length-1]|0}
var m=a.length-b.length;var q;if(mode!=='mod'){q=new BN(null);q.length=m+1;q.words=new Array(q.length);for(var i=0;i<q.length;i++){q.words[i]=0}}
var diff=a.clone()._ishlnsubmul(b,1,m);if(diff.negative===0){a=diff;if(q){q.words[m]=1}}
for(var j=m-1;j>=0;j--){var qj=(a.words[b.length+j]|0)*0x4000000+(a.words[b.length+j-1]|0);qj=Math.min((qj/bhi)|0,0x3ffffff);a._ishlnsubmul(b,qj,j);while(a.negative!==0){qj--;a.negative=0;a._ishlnsubmul(b,1,j);if(!a.isZero()){a.negative^=1}}
if(q){q.words[j]=qj}}
if(q){q.strip()}
a.strip();if(mode!=='div'&&shift!==0){a.iushrn(shift)}
return{div:q||null,mod:a}};BN.prototype.divmod=function divmod(num,mode,positive){assert(!num.isZero());if(this.isZero()){return{div:new BN(0),mod:new BN(0)}}
var div,mod,res;if(this.negative!==0&&num.negative===0){res=this.neg().divmod(num,mode);if(mode!=='mod'){div=res.div.neg()}
if(mode!=='div'){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.iadd(num)}}
return{div:div,mod:mod}}
if(this.negative===0&&num.negative!==0){res=this.divmod(num.neg(),mode);if(mode!=='mod'){div=res.div.neg()}
return{div:div,mod:res.mod}}
if((this.negative&num.negative)!==0){res=this.neg().divmod(num.neg(),mode);if(mode!=='div'){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.isub(num)}}
return{div:res.div,mod:mod}}
if(num.length>this.length||this.cmp(num)<0){return{div:new BN(0),mod:this}}
if(num.length===1){if(mode==='div'){return{div:this.divn(num.words[0]),mod:null}}
if(mode==='mod'){return{div:null,mod:new BN(this.modn(num.words[0]))}}
return{div:this.divn(num.words[0]),mod:new BN(this.modn(num.words[0]))}}
return this._wordDiv(num,mode)};BN.prototype.div=function div(num){return this.divmod(num,'div',!1).div};BN.prototype.mod=function mod(num){return this.divmod(num,'mod',!1).mod};BN.prototype.umod=function umod(num){return this.divmod(num,'mod',!0).mod};BN.prototype.divRound=function divRound(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=dm.div.negative!==0?dm.mod.isub(num):dm.mod;var half=num.ushrn(1);var r2=num.andln(1);var cmp=mod.cmp(half);if(cmp<0||r2===1&&cmp===0)return dm.div;return dm.div.negative!==0?dm.div.isubn(1):dm.div.iaddn(1)};BN.prototype.modn=function modn(num){assert(num<=0x3ffffff);var p=(1<<26)%num;var acc=0;for(var i=this.length-1;i>=0;i--){acc=(p*acc+(this.words[i]|0))%num}
return acc};BN.prototype.idivn=function idivn(num){assert(num<=0x3ffffff);var carry=0;for(var i=this.length-1;i>=0;i--){var w=(this.words[i]|0)+carry*0x4000000;this.words[i]=(w/num)|0;carry=w%num}
return this.strip()};BN.prototype.divn=function divn(num){return this.clone().idivn(num)};BN.prototype.egcd=function egcd(p){assert(p.negative===0);assert(!p.isZero());var x=this;var y=p.clone();if(x.negative!==0){x=x.umod(p)}else{x=x.clone()}
var A=new BN(1);var B=new BN(0);var C=new BN(0);var D=new BN(1);var g=0;while(x.isEven()&&y.isEven()){x.iushrn(1);y.iushrn(1);++g}
var yp=y.clone();var xp=x.clone();while(!x.isZero()){for(var i=0,im=1;(x.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){x.iushrn(i);while(i-->0){if(A.isOdd()||B.isOdd()){A.iadd(yp);B.isub(xp)}
A.iushrn(1);B.iushrn(1)}}
for(var j=0,jm=1;(y.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){y.iushrn(j);while(j-->0){if(C.isOdd()||D.isOdd()){C.iadd(yp);D.isub(xp)}
C.iushrn(1);D.iushrn(1)}}
if(x.cmp(y)>=0){x.isub(y);A.isub(C);B.isub(D)}else{y.isub(x);C.isub(A);D.isub(B)}}
return{a:C,b:D,gcd:y.iushln(g)}};BN.prototype._invmp=function _invmp(p){assert(p.negative===0);assert(!p.isZero());var a=this;var b=p.clone();if(a.negative!==0){a=a.umod(p)}else{a=a.clone()}
var x1=new BN(1);var x2=new BN(0);var delta=b.clone();while(a.cmpn(1)>0&&b.cmpn(1)>0){for(var i=0,im=1;(a.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){a.iushrn(i);while(i-->0){if(x1.isOdd()){x1.iadd(delta)}
x1.iushrn(1)}}
for(var j=0,jm=1;(b.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){b.iushrn(j);while(j-->0){if(x2.isOdd()){x2.iadd(delta)}
x2.iushrn(1)}}
if(a.cmp(b)>=0){a.isub(b);x1.isub(x2)}else{b.isub(a);x2.isub(x1)}}
var res;if(a.cmpn(1)===0){res=x1}else{res=x2}
if(res.cmpn(0)<0){res.iadd(p)}
return res};BN.prototype.gcd=function gcd(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone();var b=num.clone();a.negative=0;b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++){a.iushrn(1);b.iushrn(1)}
do{while(a.isEven()){a.iushrn(1)}
while(b.isEven()){b.iushrn(1)}
var r=a.cmp(b);if(r<0){var t=a;a=b;b=t}else if(r===0||b.cmpn(1)===0){break}
a.isub(b)}while(!0);return b.iushln(shift)};BN.prototype.invm=function invm(num){return this.egcd(num).a.umod(num)};BN.prototype.isEven=function isEven(){return(this.words[0]&1)===0};BN.prototype.isOdd=function isOdd(){return(this.words[0]&1)===1};BN.prototype.andln=function andln(num){return this.words[0]&num};BN.prototype.bincn=function bincn(bit){assert(typeof bit==='number');var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s){this._expand(s+1);this.words[s]|=q;return this}
var carry=q;for(var i=s;carry!==0&&i<this.length;i++){var w=this.words[i]|0;w+=carry;carry=w>>>26;w&=0x3ffffff;this.words[i]=w}
if(carry!==0){this.words[i]=carry;this.length++}
return this};BN.prototype.isZero=function isZero(){return this.length===1&&this.words[0]===0};BN.prototype.cmpn=function cmpn(num){var negative=num<0;if(this.negative!==0&&!negative)return-1;if(this.negative===0&&negative)return 1;this.strip();var res;if(this.length>1){res=1}else{if(negative){num=-num}
assert(num<=0x3ffffff,'Number is too big');var w=this.words[0]|0;res=w===num?0:w<num?-1:1}
if(this.negative!==0)return-res|0;return res};BN.prototype.cmp=function cmp(num){if(this.negative!==0&&num.negative===0)return-1;if(this.negative===0&&num.negative!==0)return 1;var res=this.ucmp(num);if(this.negative!==0)return-res|0;return res};BN.prototype.ucmp=function ucmp(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;var res=0;for(var i=this.length-1;i>=0;i--){var a=this.words[i]|0;var b=num.words[i]|0;if(a===b)continue;if(a<b){res=-1}else if(a>b){res=1}
break}
return res};BN.prototype.gtn=function gtn(num){return this.cmpn(num)===1};BN.prototype.gt=function gt(num){return this.cmp(num)===1};BN.prototype.gten=function gten(num){return this.cmpn(num)>=0};BN.prototype.gte=function gte(num){return this.cmp(num)>=0};BN.prototype.ltn=function ltn(num){return this.cmpn(num)===-1};BN.prototype.lt=function lt(num){return this.cmp(num)===-1};BN.prototype.lten=function lten(num){return this.cmpn(num)<=0};BN.prototype.lte=function lte(num){return this.cmp(num)<=0};BN.prototype.eqn=function eqn(num){return this.cmpn(num)===0};BN.prototype.eq=function eq(num){return this.cmp(num)===0};BN.red=function red(num){return new Red(num)};BN.prototype.toRed=function toRed(ctx){assert(!this.red,'Already a number in reduction context');assert(this.negative===0,'red works only with positives');return ctx.convertTo(this)._forceRed(ctx)};BN.prototype.fromRed=function fromRed(){assert(this.red,'fromRed works only with numbers in reduction context');return this.red.convertFrom(this)};BN.prototype._forceRed=function _forceRed(ctx){this.red=ctx;return this};BN.prototype.forceRed=function forceRed(ctx){assert(!this.red,'Already a number in reduction context');return this._forceRed(ctx)};BN.prototype.redAdd=function redAdd(num){assert(this.red,'redAdd works only with red numbers');return this.red.add(this,num)};BN.prototype.redIAdd=function redIAdd(num){assert(this.red,'redIAdd works only with red numbers');return this.red.iadd(this,num)};BN.prototype.redSub=function redSub(num){assert(this.red,'redSub works only with red numbers');return this.red.sub(this,num)};BN.prototype.redISub=function redISub(num){assert(this.red,'redISub works only with red numbers');return this.red.isub(this,num)};BN.prototype.redShl=function redShl(num){assert(this.red,'redShl works only with red numbers');return this.red.shl(this,num)};BN.prototype.redMul=function redMul(num){assert(this.red,'redMul works only with red numbers');this.red._verify2(this,num);return this.red.mul(this,num)};BN.prototype.redIMul=function redIMul(num){assert(this.red,'redMul works only with red numbers');this.red._verify2(this,num);return this.red.imul(this,num)};BN.prototype.redSqr=function redSqr(){assert(this.red,'redSqr works only with red numbers');this.red._verify1(this);return this.red.sqr(this)};BN.prototype.redISqr=function redISqr(){assert(this.red,'redISqr works only with red numbers');this.red._verify1(this);return this.red.isqr(this)};BN.prototype.redSqrt=function redSqrt(){assert(this.red,'redSqrt works only with red numbers');this.red._verify1(this);return this.red.sqrt(this)};BN.prototype.redInvm=function redInvm(){assert(this.red,'redInvm works only with red numbers');this.red._verify1(this);return this.red.invm(this)};BN.prototype.redNeg=function redNeg(){assert(this.red,'redNeg works only with red numbers');this.red._verify1(this);return this.red.neg(this)};BN.prototype.redPow=function redPow(num){assert(this.red&&!num.red,'redPow(normalNum)');this.red._verify1(this);return this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name;this.p=new BN(p,16);this.n=this.p.bitLength();this.k=new BN(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}
MPrime.prototype._tmp=function _tmp(){var tmp=new BN(null);tmp.words=new Array(Math.ceil(this.n/13));return tmp};MPrime.prototype.ireduce=function ireduce(num){var r=num;var rlen;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);rlen=r.bitLength()}while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);if(cmp===0){r.words[0]=0;r.length=1}else if(cmp>0){r.isub(this.p)}else{r.strip()}
return r};MPrime.prototype.split=function split(input,out){input.iushrn(this.n,0,out)};MPrime.prototype.imulK=function imulK(num){return num.imul(this.k)};function K256(){MPrime.call(this,'k256','ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f')}
inherits(K256,MPrime);K256.prototype.split=function split(input,output){var mask=0x3fffff;var outLen=Math.min(input.length,9);for(var i=0;i<outLen;i++){output.words[i]=input.words[i]}
output.length=outLen;if(input.length<=9){input.words[0]=0;input.length=1;return}
var prev=input.words[9];output.words[output.length++]=prev&mask;for(i=10;i<input.length;i++){var next=input.words[i]|0;input.words[i-10]=((next&mask)<<4)|(prev>>>22);prev=next}
prev>>>=22;input.words[i-10]=prev;if(prev===0&&input.length>10){input.length-=10}else{input.length-=9}};K256.prototype.imulK=function imulK(num){num.words[num.length]=0;num.words[num.length+1]=0;num.length+=2;var lo=0;for(var i=0;i<num.length;i++){var w=num.words[i]|0;lo+=w*0x3d1;num.words[i]=lo&0x3ffffff;lo=w*0x40+((lo/0x4000000)|0)}
if(num.words[num.length-1]===0){num.length--;if(num.words[num.length-1]===0){num.length--}}
return num};function P224(){MPrime.call(this,'p224','ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001')}
inherits(P224,MPrime);function P192(){MPrime.call(this,'p192','ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff')}
inherits(P192,MPrime);function P25519(){MPrime.call(this,'25519','7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed')}
inherits(P25519,MPrime);P25519.prototype.imulK=function imulK(num){var carry=0;for(var i=0;i<num.length;i++){var hi=(num.words[i]|0)*0x13+carry;var lo=hi&0x3ffffff;hi>>>=26;num.words[i]=lo;carry=hi}
if(carry!==0){num.words[num.length++]=carry}
return num};BN._prime=function prime(name){if(primes[name])return primes[name];var prime;if(name==='k256'){prime=new K256()}else if(name==='p224'){prime=new P224()}else if(name==='p192'){prime=new P192()}else if(name==='p25519'){prime=new P25519()}else{throw new Error('Unknown prime '+name)}
primes[name]=prime;return prime};function Red(m){if(typeof m==='string'){var prime=BN._prime(m);this.m=prime.p;this.prime=prime}else{assert(m.gtn(1),'modulus must be greater than 1');this.m=m;this.prime=null}}
Red.prototype._verify1=function _verify1(a){assert(a.negative===0,'red works only with positives');assert(a.red,'red works only with red numbers')};Red.prototype._verify2=function _verify2(a,b){assert((a.negative|b.negative)===0,'red works only with positives');assert(a.red&&a.red===b.red,'red works only with red numbers')};Red.prototype.imod=function imod(a){if(this.prime)return this.prime.ireduce(a)._forceRed(this);return a.umod(this.m)._forceRed(this)};Red.prototype.neg=function neg(a){if(a.isZero()){return a.clone()}
return this.m.sub(a)._forceRed(this)};Red.prototype.add=function add(a,b){this._verify2(a,b);var res=a.add(b);if(res.cmp(this.m)>=0){res.isub(this.m)}
return res._forceRed(this)};Red.prototype.iadd=function iadd(a,b){this._verify2(a,b);var res=a.iadd(b);if(res.cmp(this.m)>=0){res.isub(this.m)}
return res};Red.prototype.sub=function sub(a,b){this._verify2(a,b);var res=a.sub(b);if(res.cmpn(0)<0){res.iadd(this.m)}
return res._forceRed(this)};Red.prototype.isub=function isub(a,b){this._verify2(a,b);var res=a.isub(b);if(res.cmpn(0)<0){res.iadd(this.m)}
return res};Red.prototype.shl=function shl(a,num){this._verify1(a);return this.imod(a.ushln(num))};Red.prototype.imul=function imul(a,b){this._verify2(a,b);return this.imod(a.imul(b))};Red.prototype.mul=function mul(a,b){this._verify2(a,b);return this.imod(a.mul(b))};Red.prototype.isqr=function isqr(a){return this.imul(a,a.clone())};Red.prototype.sqr=function sqr(a){return this.mul(a,a)};Red.prototype.sqrt=function sqrt(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);assert(mod3%2===1);if(mod3===3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}
var q=this.m.subn(1);var s=0;while(!q.isZero()&&q.andln(1)===0){s++;q.iushrn(1)}
assert(!q.isZero());var one=new BN(1).toRed(this);var nOne=one.redNeg();var lpow=this.m.subn(1).iushrn(1);var z=this.m.bitLength();z=new BN(2*z*z).toRed(this);while(this.pow(z,lpow).cmp(nOne)!==0){z.redIAdd(nOne)}
var c=this.pow(z,q);var r=this.pow(a,q.addn(1).iushrn(1));var t=this.pow(a,q);var m=s;while(t.cmp(one)!==0){var tmp=t;for(var i=0;tmp.cmp(one)!==0;i++){tmp=tmp.redSqr()}
assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b);c=b.redSqr();t=t.redMul(c);m=i}
return r};Red.prototype.invm=function invm(a){var inv=a._invmp(this.m);if(inv.negative!==0){inv.negative=0;return this.imod(inv).redNeg()}else{return this.imod(inv)}};Red.prototype.pow=function pow(a,num){if(num.isZero())return new BN(1);if(num.cmpn(1)===0)return a.clone();var windowSize=4;var wnd=new Array(1<<windowSize);wnd[0]=new BN(1).toRed(this);wnd[1]=a;for(var i=2;i<wnd.length;i++){wnd[i]=this.mul(wnd[i-1],a)}
var res=wnd[0];var current=0;var currentLen=0;var start=num.bitLength()%26;if(start===0){start=26}
for(i=num.length-1;i>=0;i--){var word=num.words[i];for(var j=start-1;j>=0;j--){var bit=(word>>j)&1;if(res!==wnd[0]){res=this.sqr(res)}
if(bit===0&&current===0){currentLen=0;continue}
current<<=1;current|=bit;currentLen++;if(currentLen!==windowSize&&(i!==0||j!==0))continue;res=this.mul(res,wnd[current]);currentLen=0;current=0}
start=26}
return res};Red.prototype.convertTo=function convertTo(num){var r=num.umod(this.m);return r===num?r.clone():r};Red.prototype.convertFrom=function convertFrom(num){var res=num.clone();res.red=null;return res};BN.mont=function mont(num){return new Mont(num)};function Mont(m){Red.call(this,m);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-(this.shift%26)}
this.r=new BN(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}
inherits(Mont,Red);Mont.prototype.convertTo=function convertTo(num){return this.imod(num.ushln(this.shift))};Mont.prototype.convertFrom=function convertFrom(num){var r=this.imod(num.mul(this.rinv));r.red=null;return r};Mont.prototype.imul=function imul(a,b){if(a.isZero()||b.isZero()){a.words[0]=0;a.length=1;return a}
var t=a.imul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}
return res._forceRed(this)};Mont.prototype.mul=function mul(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}
return res._forceRed(this)};Mont.prototype.invm=function invm(a){var res=this.imod(a._invmp(this.m).mul(this.r2));return res._forceRed(this)}})(typeof module==='undefined'||module,this)},{}],51:[function(require,module,exports){module.exports=function isHexPrefixed(str){if(typeof str!=='string'){throw new Error("[is-hex-prefixed] value must be type 'string', is currently type "+(typeof str)+", while checking isHexPrefixed.")}
return str.slice(0,2)==='0x'}},{}],52:[function(require,module,exports){require('webcrypto-shim');var b64u=require('b64u-lite/bundle/b64u-lite');var str2buf=require('str2buf');var isEdge=navigator.userAgent.indexOf('Edge')>-1;var isIE11=!!window.MSInputMethodContext&&!!document.documentMode;function assign(target){if(target==null){throw new TypeError('Cannot convert undefined or null to object')}
var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null){for(var nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey]}}}}
return to}
function toArray(item){return Array.prototype.slice.call(item)}
if(isEdge||isIE11){var originalGenerateKey=crypto.subtle.generateKey;crypto.subtle.generateKey=function(){const args=toArray(arguments);var algo=assign({},args[0]);if(algo.name==='ECDSA'){delete algo.hash}
args[0]=algo;return originalGenerateKey.apply(crypto.subtle,args)};var originalExportKey=crypto.subtle.exportKey;crypto.subtle.exportKey=function(){var args=toArray(arguments);var key=args[1];return originalExportKey.apply(crypto.subtle,args).then(function(res){if(!res.key_ops||!res.key_ops.length){res.key_ops=key.usages}
return res})};var originalImportKey=crypto.subtle.importKey;crypto.subtle.importKey=function(){var args=toArray(arguments);var jwk=args[1];var algo=args[2];if(algo.name==='RSASSA-PKCS1-v1_5'&&algo.hash.name==='SHA-256'){delete jwk.qi}
return originalImportKey.apply(crypto.subtle,args).then(function(res){var algo=res.algorithm;if(algo.name==='RSASSA-PKCS1-v1_5'){algo.modulusLength=str2buf.toUint8Array(b64u.toBinaryString(jwk.n)).length*8;algo.publicExponent=str2buf.toUint8Array(b64u.toBinaryString(jwk.e))}
return res})}}
module.exports=window.crypto},{"b64u-lite/bundle/b64u-lite":47,"str2buf":301,"webcrypto-shim":353}],53:[function(require,module,exports){module.exports=require('./browser')},{"./browser":52}],54:[function(require,module,exports){arguments[4][50][0].apply(exports,arguments)},{"dup":50}],55:[function(require,module,exports){var BN=require('bn.js');var stripHexPrefix=require('strip-hex-prefix');module.exports=function numberToBN(arg){if(typeof arg==='string'||typeof arg==='number'){var multiplier=new BN(1);var formattedString=String(arg).toLowerCase().trim();var isHexPrefixed=formattedString.substr(0,2)==='0x'||formattedString.substr(0,3)==='-0x';var stringArg=stripHexPrefix(formattedString);if(stringArg.substr(0,1)==='-'){stringArg=stripHexPrefix(stringArg.slice(1));multiplier=new BN(-1,10)}
stringArg=stringArg===''?'0':stringArg;if((!stringArg.match(/^-?[0-9]+$/)&&stringArg.match(/^[0-9A-Fa-f]+$/))||stringArg.match(/^[a-fA-F]+$/)||(isHexPrefixed===!0&&stringArg.match(/^[0-9A-Fa-f]+$/))){return new BN(stringArg,16).mul(multiplier)}
if((stringArg.match(/^-?[0-9]+$/)||stringArg==='')&&isHexPrefixed===!1){return new BN(stringArg,10).mul(multiplier)}}else if(typeof arg==='object'&&arg.toString&&(!arg.pop&&!arg.push)){if(arg.toString(10).match(/^-?[0-9]+$/)&&(arg.mul||arg.dividedToIntegerBy)){return new BN(arg.toString(10),10)}}
throw new Error('[number-to-bn] while converting number '+JSON.stringify(arg)+' to BN.js instance, error: invalid number value. Value must be an integer, hex string, BN or BigNumber instance. Note, decimals are not supported.')}},{"bn.js":54,"strip-hex-prefix":302}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("./internal/Observable");exports.Observable=Observable_1.Observable;var ConnectableObservable_1=require("./internal/observable/ConnectableObservable");exports.ConnectableObservable=ConnectableObservable_1.ConnectableObservable;var groupBy_1=require("./internal/operators/groupBy");exports.GroupedObservable=groupBy_1.GroupedObservable;var observable_1=require("./internal/symbol/observable");exports.observable=observable_1.observable;var Subject_1=require("./internal/Subject");exports.Subject=Subject_1.Subject;var BehaviorSubject_1=require("./internal/BehaviorSubject");exports.BehaviorSubject=BehaviorSubject_1.BehaviorSubject;var ReplaySubject_1=require("./internal/ReplaySubject");exports.ReplaySubject=ReplaySubject_1.ReplaySubject;var AsyncSubject_1=require("./internal/AsyncSubject");exports.AsyncSubject=AsyncSubject_1.AsyncSubject;var asap_1=require("./internal/scheduler/asap");exports.asap=asap_1.asap;exports.asapScheduler=asap_1.asapScheduler;var async_1=require("./internal/scheduler/async");exports.async=async_1.async;exports.asyncScheduler=async_1.asyncScheduler;var queue_1=require("./internal/scheduler/queue");exports.queue=queue_1.queue;exports.queueScheduler=queue_1.queueScheduler;var animationFrame_1=require("./internal/scheduler/animationFrame");exports.animationFrame=animationFrame_1.animationFrame;exports.animationFrameScheduler=animationFrame_1.animationFrameScheduler;var VirtualTimeScheduler_1=require("./internal/scheduler/VirtualTimeScheduler");exports.VirtualTimeScheduler=VirtualTimeScheduler_1.VirtualTimeScheduler;exports.VirtualAction=VirtualTimeScheduler_1.VirtualAction;var Scheduler_1=require("./internal/Scheduler");exports.Scheduler=Scheduler_1.Scheduler;var Subscription_1=require("./internal/Subscription");exports.Subscription=Subscription_1.Subscription;var Subscriber_1=require("./internal/Subscriber");exports.Subscriber=Subscriber_1.Subscriber;var Notification_1=require("./internal/Notification");exports.Notification=Notification_1.Notification;exports.NotificationKind=Notification_1.NotificationKind;var pipe_1=require("./internal/util/pipe");exports.pipe=pipe_1.pipe;var noop_1=require("./internal/util/noop");exports.noop=noop_1.noop;var identity_1=require("./internal/util/identity");exports.identity=identity_1.identity;var isObservable_1=require("./internal/util/isObservable");exports.isObservable=isObservable_1.isObservable;var ArgumentOutOfRangeError_1=require("./internal/util/ArgumentOutOfRangeError");exports.ArgumentOutOfRangeError=ArgumentOutOfRangeError_1.ArgumentOutOfRangeError;var EmptyError_1=require("./internal/util/EmptyError");exports.EmptyError=EmptyError_1.EmptyError;var ObjectUnsubscribedError_1=require("./internal/util/ObjectUnsubscribedError");exports.ObjectUnsubscribedError=ObjectUnsubscribedError_1.ObjectUnsubscribedError;var UnsubscriptionError_1=require("./internal/util/UnsubscriptionError");exports.UnsubscriptionError=UnsubscriptionError_1.UnsubscriptionError;var TimeoutError_1=require("./internal/util/TimeoutError");exports.TimeoutError=TimeoutError_1.TimeoutError;var bindCallback_1=require("./internal/observable/bindCallback");exports.bindCallback=bindCallback_1.bindCallback;var bindNodeCallback_1=require("./internal/observable/bindNodeCallback");exports.bindNodeCallback=bindNodeCallback_1.bindNodeCallback;var combineLatest_1=require("./internal/observable/combineLatest");exports.combineLatest=combineLatest_1.combineLatest;var concat_1=require("./internal/observable/concat");exports.concat=concat_1.concat;var defer_1=require("./internal/observable/defer");exports.defer=defer_1.defer;var empty_1=require("./internal/observable/empty");exports.empty=empty_1.empty;var forkJoin_1=require("./internal/observable/forkJoin");exports.forkJoin=forkJoin_1.forkJoin;var from_1=require("./internal/observable/from");exports.from=from_1.from;var fromEvent_1=require("./internal/observable/fromEvent");exports.fromEvent=fromEvent_1.fromEvent;var fromEventPattern_1=require("./internal/observable/fromEventPattern");exports.fromEventPattern=fromEventPattern_1.fromEventPattern;var generate_1=require("./internal/observable/generate");exports.generate=generate_1.generate;var iif_1=require("./internal/observable/iif");exports.iif=iif_1.iif;var interval_1=require("./internal/observable/interval");exports.interval=interval_1.interval;var merge_1=require("./internal/observable/merge");exports.merge=merge_1.merge;var never_1=require("./internal/observable/never");exports.never=never_1.never;var of_1=require("./internal/observable/of");exports.of=of_1.of;var onErrorResumeNext_1=require("./internal/observable/onErrorResumeNext");exports.onErrorResumeNext=onErrorResumeNext_1.onErrorResumeNext;var pairs_1=require("./internal/observable/pairs");exports.pairs=pairs_1.pairs;var partition_1=require("./internal/observable/partition");exports.partition=partition_1.partition;var race_1=require("./internal/observable/race");exports.race=race_1.race;var range_1=require("./internal/observable/range");exports.range=range_1.range;var throwError_1=require("./internal/observable/throwError");exports.throwError=throwError_1.throwError;var timer_1=require("./internal/observable/timer");exports.timer=timer_1.timer;var using_1=require("./internal/observable/using");exports.using=using_1.using;var zip_1=require("./internal/observable/zip");exports.zip=zip_1.zip;var scheduled_1=require("./internal/scheduled/scheduled");exports.scheduled=scheduled_1.scheduled;var empty_2=require("./internal/observable/empty");exports.EMPTY=empty_2.EMPTY;var never_2=require("./internal/observable/never");exports.NEVER=never_2.NEVER;var config_1=require("./internal/config");exports.config=config_1.config},{"./internal/AsyncSubject":57,"./internal/BehaviorSubject":58,"./internal/Notification":60,"./internal/Observable":61,"./internal/ReplaySubject":64,"./internal/Scheduler":65,"./internal/Subject":66,"./internal/Subscriber":68,"./internal/Subscription":69,"./internal/config":70,"./internal/observable/ConnectableObservable":72,"./internal/observable/bindCallback":74,"./internal/observable/bindNodeCallback":75,"./internal/observable/combineLatest":76,"./internal/observable/concat":77,"./internal/observable/defer":78,"./internal/observable/empty":79,"./internal/observable/forkJoin":80,"./internal/observable/from":81,"./internal/observable/fromEvent":83,"./internal/observable/fromEventPattern":84,"./internal/observable/generate":85,"./internal/observable/iif":86,"./internal/observable/interval":87,"./internal/observable/merge":88,"./internal/observable/never":89,"./internal/observable/of":90,"./internal/observable/onErrorResumeNext":91,"./internal/observable/pairs":92,"./internal/observable/partition":93,"./internal/observable/race":94,"./internal/observable/range":95,"./internal/observable/throwError":96,"./internal/observable/timer":97,"./internal/observable/using":98,"./internal/observable/zip":99,"./internal/operators/groupBy":135,"./internal/scheduled/scheduled":207,"./internal/scheduler/VirtualTimeScheduler":217,"./internal/scheduler/animationFrame":218,"./internal/scheduler/asap":219,"./internal/scheduler/async":220,"./internal/scheduler/queue":221,"./internal/symbol/observable":223,"./internal/util/ArgumentOutOfRangeError":225,"./internal/util/EmptyError":226,"./internal/util/ObjectUnsubscribedError":228,"./internal/util/TimeoutError":229,"./internal/util/UnsubscriptionError":230,"./internal/util/identity":233,"./internal/util/isObservable":242,"./internal/util/noop":245,"./internal/util/pipe":247}],57:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("./Subject");var Subscription_1=require("./Subscription");var AsyncSubject=(function(_super){__extends(AsyncSubject,_super);function AsyncSubject(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.value=null;_this.hasNext=!1;_this.hasCompleted=!1;return _this}
AsyncSubject.prototype._subscribe=function(subscriber){if(this.hasError){subscriber.error(this.thrownError);return Subscription_1.Subscription.EMPTY}else if(this.hasCompleted&&this.hasNext){subscriber.next(this.value);subscriber.complete();return Subscription_1.Subscription.EMPTY}
return _super.prototype._subscribe.call(this,subscriber)};AsyncSubject.prototype.next=function(value){if(!this.hasCompleted){this.value=value;this.hasNext=!0}};AsyncSubject.prototype.error=function(error){if(!this.hasCompleted){_super.prototype.error.call(this,error)}};AsyncSubject.prototype.complete=function(){this.hasCompleted=!0;if(this.hasNext){_super.prototype.next.call(this,this.value)}
_super.prototype.complete.call(this)};return AsyncSubject}(Subject_1.Subject));exports.AsyncSubject=AsyncSubject},{"./Subject":66,"./Subscription":69}],58:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("./Subject");var ObjectUnsubscribedError_1=require("./util/ObjectUnsubscribedError");var BehaviorSubject=(function(_super){__extends(BehaviorSubject,_super);function BehaviorSubject(_value){var _this=_super.call(this)||this;_this._value=_value;return _this}
Object.defineProperty(BehaviorSubject.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0});BehaviorSubject.prototype._subscribe=function(subscriber){var subscription=_super.prototype._subscribe.call(this,subscriber);if(subscription&&!subscription.closed){subscriber.next(this._value)}
return subscription};BehaviorSubject.prototype.getValue=function(){if(this.hasError){throw this.thrownError}else if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}else{return this._value}};BehaviorSubject.prototype.next=function(value){_super.prototype.next.call(this,this._value=value)};return BehaviorSubject}(Subject_1.Subject));exports.BehaviorSubject=BehaviorSubject},{"./Subject":66,"./util/ObjectUnsubscribedError":228}],59:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("./Subscriber");var InnerSubscriber=(function(_super){__extends(InnerSubscriber,_super);function InnerSubscriber(parent,outerValue,outerIndex){var _this=_super.call(this)||this;_this.parent=parent;_this.outerValue=outerValue;_this.outerIndex=outerIndex;_this.index=0;return _this}
InnerSubscriber.prototype._next=function(value){this.parent.notifyNext(this.outerValue,value,this.outerIndex,this.index++,this)};InnerSubscriber.prototype._error=function(error){this.parent.notifyError(error,this);this.unsubscribe()};InnerSubscriber.prototype._complete=function(){this.parent.notifyComplete(this);this.unsubscribe()};return InnerSubscriber}(Subscriber_1.Subscriber));exports.InnerSubscriber=InnerSubscriber},{"./Subscriber":68}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var empty_1=require("./observable/empty");var of_1=require("./observable/of");var throwError_1=require("./observable/throwError");var NotificationKind;(function(NotificationKind){NotificationKind.NEXT="N";NotificationKind.ERROR="E";NotificationKind.COMPLETE="C"})(NotificationKind=exports.NotificationKind||(exports.NotificationKind={}));var Notification=(function(){function Notification(kind,value,error){this.kind=kind;this.value=value;this.error=error;this.hasValue=kind==='N'}
Notification.prototype.observe=function(observer){switch(this.kind){case 'N':return observer.next&&observer.next(this.value);case 'E':return observer.error&&observer.error(this.error);case 'C':return observer.complete&&observer.complete()}};Notification.prototype.do=function(next,error,complete){var kind=this.kind;switch(kind){case 'N':return next&&next(this.value);case 'E':return error&&error(this.error);case 'C':return complete&&complete()}};Notification.prototype.accept=function(nextOrObserver,error,complete){if(nextOrObserver&&typeof nextOrObserver.next==='function'){return this.observe(nextOrObserver)}else{return this.do(nextOrObserver,error,complete)}};Notification.prototype.toObservable=function(){var kind=this.kind;switch(kind){case 'N':return of_1.of(this.value);case 'E':return throwError_1.throwError(this.error);case 'C':return empty_1.empty()}
throw new Error('unexpected notification kind value')};Notification.createNext=function(value){if(typeof value!=='undefined'){return new Notification('N',value)}
return Notification.undefinedValueNotification};Notification.createError=function(err){return new Notification('E',undefined,err)};Notification.createComplete=function(){return Notification.completeNotification};Notification.completeNotification=new Notification('C');Notification.undefinedValueNotification=new Notification('N',undefined);return Notification}());exports.Notification=Notification},{"./observable/empty":79,"./observable/of":90,"./observable/throwError":96}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var canReportError_1=require("./util/canReportError");var toSubscriber_1=require("./util/toSubscriber");var observable_1=require("./symbol/observable");var pipe_1=require("./util/pipe");var config_1=require("./config");var Observable=(function(){function Observable(subscribe){this._isScalar=!1;if(subscribe){this._subscribe=subscribe}}
Observable.prototype.lift=function(operator){var observable=new Observable();observable.source=this;observable.operator=operator;return observable};Observable.prototype.subscribe=function(observerOrNext,error,complete){var operator=this.operator;var sink=toSubscriber_1.toSubscriber(observerOrNext,error,complete);if(operator){sink.add(operator.call(sink,this.source))}else{sink.add(this.source||(config_1.config.useDeprecatedSynchronousErrorHandling&&!sink.syncErrorThrowable)?this._subscribe(sink):this._trySubscribe(sink))}
if(config_1.config.useDeprecatedSynchronousErrorHandling){if(sink.syncErrorThrowable){sink.syncErrorThrowable=!1;if(sink.syncErrorThrown){throw sink.syncErrorValue}}}
return sink};Observable.prototype._trySubscribe=function(sink){try{return this._subscribe(sink)}catch(err){if(config_1.config.useDeprecatedSynchronousErrorHandling){sink.syncErrorThrown=!0;sink.syncErrorValue=err}
if(canReportError_1.canReportError(sink)){sink.error(err)}else{console.warn(err)}}};Observable.prototype.forEach=function(next,promiseCtor){var _this=this;promiseCtor=getPromiseCtor(promiseCtor);return new promiseCtor(function(resolve,reject){var subscription;subscription=_this.subscribe(function(value){try{next(value)}catch(err){reject(err);if(subscription){subscription.unsubscribe()}}},reject,resolve)})};Observable.prototype._subscribe=function(subscriber){var source=this.source;return source&&source.subscribe(subscriber)};Observable.prototype[observable_1.observable]=function(){return this};Observable.prototype.pipe=function(){var operations=[];for(var _i=0;_i<arguments.length;_i++){operations[_i]=arguments[_i]}
if(operations.length===0){return this}
return pipe_1.pipeFromArray(operations)(this)};Observable.prototype.toPromise=function(promiseCtor){var _this=this;promiseCtor=getPromiseCtor(promiseCtor);return new promiseCtor(function(resolve,reject){var value;_this.subscribe(function(x){return value=x},function(err){return reject(err)},function(){return resolve(value)})})};Observable.create=function(subscribe){return new Observable(subscribe)};return Observable}());exports.Observable=Observable;function getPromiseCtor(promiseCtor){if(!promiseCtor){promiseCtor=config_1.config.Promise||Promise}
if(!promiseCtor){throw new Error('no Promise impl found')}
return promiseCtor}},{"./config":70,"./symbol/observable":223,"./util/canReportError":231,"./util/pipe":247,"./util/toSubscriber":254}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var config_1=require("./config");var hostReportError_1=require("./util/hostReportError");exports.empty={closed:!0,next:function(value){},error:function(err){if(config_1.config.useDeprecatedSynchronousErrorHandling){throw err}else{hostReportError_1.hostReportError(err)}},complete:function(){}}},{"./config":70,"./util/hostReportError":232}],63:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("./Subscriber");var OuterSubscriber=(function(_super){__extends(OuterSubscriber,_super);function OuterSubscriber(){return _super!==null&&_super.apply(this,arguments)||this}
OuterSubscriber.prototype.notifyNext=function(outerValue,innerValue,outerIndex,innerIndex,innerSub){this.destination.next(innerValue)};OuterSubscriber.prototype.notifyError=function(error,innerSub){this.destination.error(error)};OuterSubscriber.prototype.notifyComplete=function(innerSub){this.destination.complete()};return OuterSubscriber}(Subscriber_1.Subscriber));exports.OuterSubscriber=OuterSubscriber},{"./Subscriber":68}],64:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("./Subject");var queue_1=require("./scheduler/queue");var Subscription_1=require("./Subscription");var observeOn_1=require("./operators/observeOn");var ObjectUnsubscribedError_1=require("./util/ObjectUnsubscribedError");var SubjectSubscription_1=require("./SubjectSubscription");var ReplaySubject=(function(_super){__extends(ReplaySubject,_super);function ReplaySubject(bufferSize,windowTime,scheduler){if(bufferSize===void 0){bufferSize=Number.POSITIVE_INFINITY}
if(windowTime===void 0){windowTime=Number.POSITIVE_INFINITY}
var _this=_super.call(this)||this;_this.scheduler=scheduler;_this._events=[];_this._infiniteTimeWindow=!1;_this._bufferSize=bufferSize<1?1:bufferSize;_this._windowTime=windowTime<1?1:windowTime;if(windowTime===Number.POSITIVE_INFINITY){_this._infiniteTimeWindow=!0;_this.next=_this.nextInfiniteTimeWindow}else{_this.next=_this.nextTimeWindow}
return _this}
ReplaySubject.prototype.nextInfiniteTimeWindow=function(value){if(!this.isStopped){var _events=this._events;_events.push(value);if(_events.length>this._bufferSize){_events.shift()}}
_super.prototype.next.call(this,value)};ReplaySubject.prototype.nextTimeWindow=function(value){if(!this.isStopped){this._events.push(new ReplayEvent(this._getNow(),value));this._trimBufferThenGetEvents()}
_super.prototype.next.call(this,value)};ReplaySubject.prototype._subscribe=function(subscriber){var _infiniteTimeWindow=this._infiniteTimeWindow;var _events=_infiniteTimeWindow?this._events:this._trimBufferThenGetEvents();var scheduler=this.scheduler;var len=_events.length;var subscription;if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}else if(this.isStopped||this.hasError){subscription=Subscription_1.Subscription.EMPTY}else{this.observers.push(subscriber);subscription=new SubjectSubscription_1.SubjectSubscription(this,subscriber)}
if(scheduler){subscriber.add(subscriber=new observeOn_1.ObserveOnSubscriber(subscriber,scheduler))}
if(_infiniteTimeWindow){for(var i=0;i<len&&!subscriber.closed;i++){subscriber.next(_events[i])}}else{for(var i=0;i<len&&!subscriber.closed;i++){subscriber.next(_events[i].value)}}
if(this.hasError){subscriber.error(this.thrownError)}else if(this.isStopped){subscriber.complete()}
return subscription};ReplaySubject.prototype._getNow=function(){return(this.scheduler||queue_1.queue).now()};ReplaySubject.prototype._trimBufferThenGetEvents=function(){var now=this._getNow();var _bufferSize=this._bufferSize;var _windowTime=this._windowTime;var _events=this._events;var eventsCount=_events.length;var spliceCount=0;while(spliceCount<eventsCount){if((now-_events[spliceCount].time)<_windowTime){break}
spliceCount++}
if(eventsCount>_bufferSize){spliceCount=Math.max(spliceCount,eventsCount-_bufferSize)}
if(spliceCount>0){_events.splice(0,spliceCount)}
return _events};return ReplaySubject}(Subject_1.Subject));exports.ReplaySubject=ReplaySubject;var ReplayEvent=(function(){function ReplayEvent(time,value){this.time=time;this.value=value}
return ReplayEvent}())},{"./Subject":66,"./SubjectSubscription":67,"./Subscription":69,"./operators/observeOn":150,"./scheduler/queue":221,"./util/ObjectUnsubscribedError":228}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Scheduler=(function(){function Scheduler(SchedulerAction,now){if(now===void 0){now=Scheduler.now}
this.SchedulerAction=SchedulerAction;this.now=now}
Scheduler.prototype.schedule=function(work,delay,state){if(delay===void 0){delay=0}
return new this.SchedulerAction(this,work).schedule(state,delay)};Scheduler.now=function(){return Date.now()};return Scheduler}());exports.Scheduler=Scheduler},{}],66:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("./Observable");var Subscriber_1=require("./Subscriber");var Subscription_1=require("./Subscription");var ObjectUnsubscribedError_1=require("./util/ObjectUnsubscribedError");var SubjectSubscription_1=require("./SubjectSubscription");var rxSubscriber_1=require("../internal/symbol/rxSubscriber");var SubjectSubscriber=(function(_super){__extends(SubjectSubscriber,_super);function SubjectSubscriber(destination){var _this=_super.call(this,destination)||this;_this.destination=destination;return _this}
return SubjectSubscriber}(Subscriber_1.Subscriber));exports.SubjectSubscriber=SubjectSubscriber;var Subject=(function(_super){__extends(Subject,_super);function Subject(){var _this=_super.call(this)||this;_this.observers=[];_this.closed=!1;_this.isStopped=!1;_this.hasError=!1;_this.thrownError=null;return _this}
Subject.prototype[rxSubscriber_1.rxSubscriber]=function(){return new SubjectSubscriber(this)};Subject.prototype.lift=function(operator){var subject=new AnonymousSubject(this,this);subject.operator=operator;return subject};Subject.prototype.next=function(value){if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}
if(!this.isStopped){var observers=this.observers;var len=observers.length;var copy=observers.slice();for(var i=0;i<len;i++){copy[i].next(value)}}};Subject.prototype.error=function(err){if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}
this.hasError=!0;this.thrownError=err;this.isStopped=!0;var observers=this.observers;var len=observers.length;var copy=observers.slice();for(var i=0;i<len;i++){copy[i].error(err)}
this.observers.length=0};Subject.prototype.complete=function(){if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}
this.isStopped=!0;var observers=this.observers;var len=observers.length;var copy=observers.slice();for(var i=0;i<len;i++){copy[i].complete()}
this.observers.length=0};Subject.prototype.unsubscribe=function(){this.isStopped=!0;this.closed=!0;this.observers=null};Subject.prototype._trySubscribe=function(subscriber){if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}else{return _super.prototype._trySubscribe.call(this,subscriber)}};Subject.prototype._subscribe=function(subscriber){if(this.closed){throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError()}else if(this.hasError){subscriber.error(this.thrownError);return Subscription_1.Subscription.EMPTY}else if(this.isStopped){subscriber.complete();return Subscription_1.Subscription.EMPTY}else{this.observers.push(subscriber);return new SubjectSubscription_1.SubjectSubscription(this,subscriber)}};Subject.prototype.asObservable=function(){var observable=new Observable_1.Observable();observable.source=this;return observable};Subject.create=function(destination,source){return new AnonymousSubject(destination,source)};return Subject}(Observable_1.Observable));exports.Subject=Subject;var AnonymousSubject=(function(_super){__extends(AnonymousSubject,_super);function AnonymousSubject(destination,source){var _this=_super.call(this)||this;_this.destination=destination;_this.source=source;return _this}
AnonymousSubject.prototype.next=function(value){var destination=this.destination;if(destination&&destination.next){destination.next(value)}};AnonymousSubject.prototype.error=function(err){var destination=this.destination;if(destination&&destination.error){this.destination.error(err)}};AnonymousSubject.prototype.complete=function(){var destination=this.destination;if(destination&&destination.complete){this.destination.complete()}};AnonymousSubject.prototype._subscribe=function(subscriber){var source=this.source;if(source){return this.source.subscribe(subscriber)}else{return Subscription_1.Subscription.EMPTY}};return AnonymousSubject}(Subject));exports.AnonymousSubject=AnonymousSubject},{"../internal/symbol/rxSubscriber":224,"./Observable":61,"./SubjectSubscription":67,"./Subscriber":68,"./Subscription":69,"./util/ObjectUnsubscribedError":228}],67:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscription_1=require("./Subscription");var SubjectSubscription=(function(_super){__extends(SubjectSubscription,_super);function SubjectSubscription(subject,subscriber){var _this=_super.call(this)||this;_this.subject=subject;_this.subscriber=subscriber;_this.closed=!1;return _this}
SubjectSubscription.prototype.unsubscribe=function(){if(this.closed){return}
this.closed=!0;var subject=this.subject;var observers=subject.observers;this.subject=null;if(!observers||observers.length===0||subject.isStopped||subject.closed){return}
var subscriberIndex=observers.indexOf(this.subscriber);if(subscriberIndex!==-1){observers.splice(subscriberIndex,1)}};return SubjectSubscription}(Subscription_1.Subscription));exports.SubjectSubscription=SubjectSubscription},{"./Subscription":69}],68:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var isFunction_1=require("./util/isFunction");var Observer_1=require("./Observer");var Subscription_1=require("./Subscription");var rxSubscriber_1=require("../internal/symbol/rxSubscriber");var config_1=require("./config");var hostReportError_1=require("./util/hostReportError");var Subscriber=(function(_super){__extends(Subscriber,_super);function Subscriber(destinationOrNext,error,complete){var _this=_super.call(this)||this;_this.syncErrorValue=null;_this.syncErrorThrown=!1;_this.syncErrorThrowable=!1;_this.isStopped=!1;switch(arguments.length){case 0:_this.destination=Observer_1.empty;break;case 1:if(!destinationOrNext){_this.destination=Observer_1.empty;break}
if(typeof destinationOrNext==='object'){if(destinationOrNext instanceof Subscriber){_this.syncErrorThrowable=destinationOrNext.syncErrorThrowable;_this.destination=destinationOrNext;destinationOrNext.add(_this)}else{_this.syncErrorThrowable=!0;_this.destination=new SafeSubscriber(_this,destinationOrNext)}
break}
default:_this.syncErrorThrowable=!0;_this.destination=new SafeSubscriber(_this,destinationOrNext,error,complete);break}
return _this}
Subscriber.prototype[rxSubscriber_1.rxSubscriber]=function(){return this};Subscriber.create=function(next,error,complete){var subscriber=new Subscriber(next,error,complete);subscriber.syncErrorThrowable=!1;return subscriber};Subscriber.prototype.next=function(value){if(!this.isStopped){this._next(value)}};Subscriber.prototype.error=function(err){if(!this.isStopped){this.isStopped=!0;this._error(err)}};Subscriber.prototype.complete=function(){if(!this.isStopped){this.isStopped=!0;this._complete()}};Subscriber.prototype.unsubscribe=function(){if(this.closed){return}
this.isStopped=!0;_super.prototype.unsubscribe.call(this)};Subscriber.prototype._next=function(value){this.destination.next(value)};Subscriber.prototype._error=function(err){this.destination.error(err);this.unsubscribe()};Subscriber.prototype._complete=function(){this.destination.complete();this.unsubscribe()};Subscriber.prototype._unsubscribeAndRecycle=function(){var _parentOrParents=this._parentOrParents;this._parentOrParents=null;this.unsubscribe();this.closed=!1;this.isStopped=!1;this._parentOrParents=_parentOrParents;return this};return Subscriber}(Subscription_1.Subscription));exports.Subscriber=Subscriber;var SafeSubscriber=(function(_super){__extends(SafeSubscriber,_super);function SafeSubscriber(_parentSubscriber,observerOrNext,error,complete){var _this=_super.call(this)||this;_this._parentSubscriber=_parentSubscriber;var next;var context=_this;if(isFunction_1.isFunction(observerOrNext)){next=observerOrNext}else if(observerOrNext){next=observerOrNext.next;error=observerOrNext.error;complete=observerOrNext.complete;if(observerOrNext!==Observer_1.empty){context=Object.create(observerOrNext);if(isFunction_1.isFunction(context.unsubscribe)){_this.add(context.unsubscribe.bind(context))}
context.unsubscribe=_this.unsubscribe.bind(_this)}}
_this._context=context;_this._next=next;_this._error=error;_this._complete=complete;return _this}
SafeSubscriber.prototype.next=function(value){if(!this.isStopped&&this._next){var _parentSubscriber=this._parentSubscriber;if(!config_1.config.useDeprecatedSynchronousErrorHandling||!_parentSubscriber.syncErrorThrowable){this.__tryOrUnsub(this._next,value)}else if(this.__tryOrSetError(_parentSubscriber,this._next,value)){this.unsubscribe()}}};SafeSubscriber.prototype.error=function(err){if(!this.isStopped){var _parentSubscriber=this._parentSubscriber;var useDeprecatedSynchronousErrorHandling=config_1.config.useDeprecatedSynchronousErrorHandling;if(this._error){if(!useDeprecatedSynchronousErrorHandling||!_parentSubscriber.syncErrorThrowable){this.__tryOrUnsub(this._error,err);this.unsubscribe()}else{this.__tryOrSetError(_parentSubscriber,this._error,err);this.unsubscribe()}}else if(!_parentSubscriber.syncErrorThrowable){this.unsubscribe();if(useDeprecatedSynchronousErrorHandling){throw err}
hostReportError_1.hostReportError(err)}else{if(useDeprecatedSynchronousErrorHandling){_parentSubscriber.syncErrorValue=err;_parentSubscriber.syncErrorThrown=!0}else{hostReportError_1.hostReportError(err)}
this.unsubscribe()}}};SafeSubscriber.prototype.complete=function(){var _this=this;if(!this.isStopped){var _parentSubscriber=this._parentSubscriber;if(this._complete){var wrappedComplete=function(){return _this._complete.call(_this._context)};if(!config_1.config.useDeprecatedSynchronousErrorHandling||!_parentSubscriber.syncErrorThrowable){this.__tryOrUnsub(wrappedComplete);this.unsubscribe()}else{this.__tryOrSetError(_parentSubscriber,wrappedComplete);this.unsubscribe()}}else{this.unsubscribe()}}};SafeSubscriber.prototype.__tryOrUnsub=function(fn,value){try{fn.call(this._context,value)}catch(err){this.unsubscribe();if(config_1.config.useDeprecatedSynchronousErrorHandling){throw err}else{hostReportError_1.hostReportError(err)}}};SafeSubscriber.prototype.__tryOrSetError=function(parent,fn,value){if(!config_1.config.useDeprecatedSynchronousErrorHandling){throw new Error('bad call')}
try{fn.call(this._context,value)}catch(err){if(config_1.config.useDeprecatedSynchronousErrorHandling){parent.syncErrorValue=err;parent.syncErrorThrown=!0;return!0}else{hostReportError_1.hostReportError(err);return!0}}
return!1};SafeSubscriber.prototype._unsubscribe=function(){var _parentSubscriber=this._parentSubscriber;this._context=null;this._parentSubscriber=null;_parentSubscriber.unsubscribe()};return SafeSubscriber}(Subscriber));exports.SafeSubscriber=SafeSubscriber},{"../internal/symbol/rxSubscriber":224,"./Observer":62,"./Subscription":69,"./config":70,"./util/hostReportError":232,"./util/isFunction":237}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isArray_1=require("./util/isArray");var isObject_1=require("./util/isObject");var isFunction_1=require("./util/isFunction");var UnsubscriptionError_1=require("./util/UnsubscriptionError");var Subscription=(function(){function Subscription(unsubscribe){this.closed=!1;this._parentOrParents=null;this._subscriptions=null;if(unsubscribe){this._ctorUnsubscribe=!0;this._unsubscribe=unsubscribe}}
Subscription.prototype.unsubscribe=function(){var errors;if(this.closed){return}
var _a=this,_parentOrParents=_a._parentOrParents,_ctorUnsubscribe=_a._ctorUnsubscribe,_unsubscribe=_a._unsubscribe,_subscriptions=_a._subscriptions;this.closed=!0;this._parentOrParents=null;this._subscriptions=null;if(_parentOrParents instanceof Subscription){_parentOrParents.remove(this)}else if(_parentOrParents!==null){for(var index=0;index<_parentOrParents.length;++index){var parent_1=_parentOrParents[index];parent_1.remove(this)}}
if(isFunction_1.isFunction(_unsubscribe)){if(_ctorUnsubscribe){this._unsubscribe=undefined}
try{_unsubscribe.call(this)}catch(e){errors=e instanceof UnsubscriptionError_1.UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}}
if(isArray_1.isArray(_subscriptions)){var index=-1;var len=_subscriptions.length;while(++index<len){var sub=_subscriptions[index];if(isObject_1.isObject(sub)){try{sub.unsubscribe()}catch(e){errors=errors||[];if(e instanceof UnsubscriptionError_1.UnsubscriptionError){errors=errors.concat(flattenUnsubscriptionErrors(e.errors))}else{errors.push(e)}}}}}
if(errors){throw new UnsubscriptionError_1.UnsubscriptionError(errors)}};Subscription.prototype.add=function(teardown){var subscription=teardown;if(!teardown){return Subscription.EMPTY}
switch(typeof teardown){case 'function':subscription=new Subscription(teardown);case 'object':if(subscription===this||subscription.closed||typeof subscription.unsubscribe!=='function'){return subscription}else if(this.closed){subscription.unsubscribe();return subscription}else if(!(subscription instanceof Subscription)){var tmp=subscription;subscription=new Subscription();subscription._subscriptions=[tmp]}
break;default:{throw new Error('unrecognized teardown '+teardown+' added to Subscription.')}}
var _parentOrParents=subscription._parentOrParents;if(_parentOrParents===null){subscription._parentOrParents=this}else if(_parentOrParents instanceof Subscription){if(_parentOrParents===this){return subscription}
subscription._parentOrParents=[_parentOrParents,this]}else if(_parentOrParents.indexOf(this)===-1){_parentOrParents.push(this)}else{return subscription}
var subscriptions=this._subscriptions;if(subscriptions===null){this._subscriptions=[subscription]}else{subscriptions.push(subscription)}
return subscription};Subscription.prototype.remove=function(subscription){var subscriptions=this._subscriptions;if(subscriptions){var subscriptionIndex=subscriptions.indexOf(subscription);if(subscriptionIndex!==-1){subscriptions.splice(subscriptionIndex,1)}}};Subscription.EMPTY=(function(empty){empty.closed=!0;return empty}(new Subscription()));return Subscription}());exports.Subscription=Subscription;function flattenUnsubscriptionErrors(errors){return errors.reduce(function(errs,err){return errs.concat((err instanceof UnsubscriptionError_1.UnsubscriptionError)?err.errors:err)},[])}},{"./util/UnsubscriptionError":230,"./util/isArray":234,"./util/isFunction":237,"./util/isObject":241}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _enable_super_gross_mode_that_will_cause_bad_things=!1;exports.config={Promise:undefined,set useDeprecatedSynchronousErrorHandling(value){if(value){var error=new Error();console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n'+error.stack)}else if(_enable_super_gross_mode_that_will_cause_bad_things){console.log('RxJS: Back to a better error behavior. Thank you. <3')}
_enable_super_gross_mode_that_will_cause_bad_things=value},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things},}},{}],71:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("./Subscriber");var Observable_1=require("./Observable");var subscribeTo_1=require("./util/subscribeTo");var SimpleInnerSubscriber=(function(_super){__extends(SimpleInnerSubscriber,_super);function SimpleInnerSubscriber(parent){var _this=_super.call(this)||this;_this.parent=parent;return _this}
SimpleInnerSubscriber.prototype._next=function(value){this.parent.notifyNext(value)};SimpleInnerSubscriber.prototype._error=function(error){this.parent.notifyError(error);this.unsubscribe()};SimpleInnerSubscriber.prototype._complete=function(){this.parent.notifyComplete();this.unsubscribe()};return SimpleInnerSubscriber}(Subscriber_1.Subscriber));exports.SimpleInnerSubscriber=SimpleInnerSubscriber;var ComplexInnerSubscriber=(function(_super){__extends(ComplexInnerSubscriber,_super);function ComplexInnerSubscriber(parent,outerValue,outerIndex){var _this=_super.call(this)||this;_this.parent=parent;_this.outerValue=outerValue;_this.outerIndex=outerIndex;return _this}
ComplexInnerSubscriber.prototype._next=function(value){this.parent.notifyNext(this.outerValue,value,this.outerIndex,this)};ComplexInnerSubscriber.prototype._error=function(error){this.parent.notifyError(error);this.unsubscribe()};ComplexInnerSubscriber.prototype._complete=function(){this.parent.notifyComplete(this);this.unsubscribe()};return ComplexInnerSubscriber}(Subscriber_1.Subscriber));exports.ComplexInnerSubscriber=ComplexInnerSubscriber;var SimpleOuterSubscriber=(function(_super){__extends(SimpleOuterSubscriber,_super);function SimpleOuterSubscriber(){return _super!==null&&_super.apply(this,arguments)||this}
SimpleOuterSubscriber.prototype.notifyNext=function(innerValue){this.destination.next(innerValue)};SimpleOuterSubscriber.prototype.notifyError=function(err){this.destination.error(err)};SimpleOuterSubscriber.prototype.notifyComplete=function(){this.destination.complete()};return SimpleOuterSubscriber}(Subscriber_1.Subscriber));exports.SimpleOuterSubscriber=SimpleOuterSubscriber;var ComplexOuterSubscriber=(function(_super){__extends(ComplexOuterSubscriber,_super);function ComplexOuterSubscriber(){return _super!==null&&_super.apply(this,arguments)||this}
ComplexOuterSubscriber.prototype.notifyNext=function(_outerValue,innerValue,_outerIndex,_innerSub){this.destination.next(innerValue)};ComplexOuterSubscriber.prototype.notifyError=function(error){this.destination.error(error)};ComplexOuterSubscriber.prototype.notifyComplete=function(_innerSub){this.destination.complete()};return ComplexOuterSubscriber}(Subscriber_1.Subscriber));exports.ComplexOuterSubscriber=ComplexOuterSubscriber;function innerSubscribe(result,innerSubscriber){if(innerSubscriber.closed){return undefined}
if(result instanceof Observable_1.Observable){return result.subscribe(innerSubscriber)}
var subscription;try{subscription=subscribeTo_1.subscribeTo(result)(innerSubscriber)}catch(error){innerSubscriber.error(error)}
return subscription}
exports.innerSubscribe=innerSubscribe},{"./Observable":61,"./Subscriber":68,"./util/subscribeTo":248}],72:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var Observable_1=require("../Observable");var Subscriber_1=require("../Subscriber");var Subscription_1=require("../Subscription");var refCount_1=require("../operators/refCount");var ConnectableObservable=(function(_super){__extends(ConnectableObservable,_super);function ConnectableObservable(source,subjectFactory){var _this=_super.call(this)||this;_this.source=source;_this.subjectFactory=subjectFactory;_this._refCount=0;_this._isComplete=!1;return _this}
ConnectableObservable.prototype._subscribe=function(subscriber){return this.getSubject().subscribe(subscriber)};ConnectableObservable.prototype.getSubject=function(){var subject=this._subject;if(!subject||subject.isStopped){this._subject=this.subjectFactory()}
return this._subject};ConnectableObservable.prototype.connect=function(){var connection=this._connection;if(!connection){this._isComplete=!1;connection=this._connection=new Subscription_1.Subscription();connection.add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this)));if(connection.closed){this._connection=null;connection=Subscription_1.Subscription.EMPTY}}
return connection};ConnectableObservable.prototype.refCount=function(){return refCount_1.refCount()(this)};return ConnectableObservable}(Observable_1.Observable));exports.ConnectableObservable=ConnectableObservable;exports.connectableObservableDescriptor=(function(){var connectableProto=ConnectableObservable.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}}})();var ConnectableSubscriber=(function(_super){__extends(ConnectableSubscriber,_super);function ConnectableSubscriber(destination,connectable){var _this=_super.call(this,destination)||this;_this.connectable=connectable;return _this}
ConnectableSubscriber.prototype._error=function(err){this._unsubscribe();_super.prototype._error.call(this,err)};ConnectableSubscriber.prototype._complete=function(){this.connectable._isComplete=!0;this._unsubscribe();_super.prototype._complete.call(this)};ConnectableSubscriber.prototype._unsubscribe=function(){var connectable=this.connectable;if(connectable){this.connectable=null;var connection=connectable._connection;connectable._refCount=0;connectable._subject=null;connectable._connection=null;if(connection){connection.unsubscribe()}}};return ConnectableSubscriber}(Subject_1.SubjectSubscriber));var RefCountOperator=(function(){function RefCountOperator(connectable){this.connectable=connectable}
RefCountOperator.prototype.call=function(subscriber,source){var connectable=this.connectable;connectable._refCount++;var refCounter=new RefCountSubscriber(subscriber,connectable);var subscription=source.subscribe(refCounter);if(!refCounter.closed){refCounter.connection=connectable.connect()}
return subscription};return RefCountOperator}());var RefCountSubscriber=(function(_super){__extends(RefCountSubscriber,_super);function RefCountSubscriber(destination,connectable){var _this=_super.call(this,destination)||this;_this.connectable=connectable;return _this}
RefCountSubscriber.prototype._unsubscribe=function(){var connectable=this.connectable;if(!connectable){this.connection=null;return}
this.connectable=null;var refCount=connectable._refCount;if(refCount<=0){this.connection=null;return}
connectable._refCount=refCount-1;if(refCount>1){this.connection=null;return}
var connection=this.connection;var sharedConnection=connectable._connection;this.connection=null;if(sharedConnection&&(!connection||sharedConnection===connection)){sharedConnection.unsubscribe()}};return RefCountSubscriber}(Subscriber_1.Subscriber))},{"../Observable":61,"../Subject":66,"../Subscriber":68,"../Subscription":69,"../operators/refCount":161}],73:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var asap_1=require("../scheduler/asap");var isNumeric_1=require("../util/isNumeric");var SubscribeOnObservable=(function(_super){__extends(SubscribeOnObservable,_super);function SubscribeOnObservable(source,delayTime,scheduler){if(delayTime===void 0){delayTime=0}
if(scheduler===void 0){scheduler=asap_1.asap}
var _this=_super.call(this)||this;_this.source=source;_this.delayTime=delayTime;_this.scheduler=scheduler;if(!isNumeric_1.isNumeric(delayTime)||delayTime<0){_this.delayTime=0}
if(!scheduler||typeof scheduler.schedule!=='function'){_this.scheduler=asap_1.asap}
return _this}
SubscribeOnObservable.create=function(source,delay,scheduler){if(delay===void 0){delay=0}
if(scheduler===void 0){scheduler=asap_1.asap}
return new SubscribeOnObservable(source,delay,scheduler)};SubscribeOnObservable.dispatch=function(arg){var source=arg.source,subscriber=arg.subscriber;return this.add(source.subscribe(subscriber))};SubscribeOnObservable.prototype._subscribe=function(subscriber){var delay=this.delayTime;var source=this.source;var scheduler=this.scheduler;return scheduler.schedule(SubscribeOnObservable.dispatch,delay,{source:source,subscriber:subscriber})};return SubscribeOnObservable}(Observable_1.Observable));exports.SubscribeOnObservable=SubscribeOnObservable},{"../Observable":61,"../scheduler/asap":219,"../util/isNumeric":240}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var AsyncSubject_1=require("../AsyncSubject");var map_1=require("../operators/map");var canReportError_1=require("../util/canReportError");var isArray_1=require("../util/isArray");var isScheduler_1=require("../util/isScheduler");function bindCallback(callbackFunc,resultSelector,scheduler){if(resultSelector){if(isScheduler_1.isScheduler(resultSelector)){scheduler=resultSelector}else{return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}
return bindCallback(callbackFunc,scheduler).apply(void 0,args).pipe(map_1.map(function(args){return isArray_1.isArray(args)?resultSelector.apply(void 0,args):resultSelector(args)}))}}}
return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}
var context=this;var subject;var params={context:context,subject:subject,callbackFunc:callbackFunc,scheduler:scheduler,};return new Observable_1.Observable(function(subscriber){if(!scheduler){if(!subject){subject=new AsyncSubject_1.AsyncSubject();var handler=function(){var innerArgs=[];for(var _i=0;_i<arguments.length;_i++){innerArgs[_i]=arguments[_i]}
subject.next(innerArgs.length<=1?innerArgs[0]:innerArgs);subject.complete()};try{callbackFunc.apply(context,args.concat([handler]))}catch(err){if(canReportError_1.canReportError(subject)){subject.error(err)}else{console.warn(err)}}}
return subject.subscribe(subscriber)}else{var state={args:args,subscriber:subscriber,params:params,};return scheduler.schedule(dispatch,0,state)}})}}
exports.bindCallback=bindCallback;function dispatch(state){var _this=this;var self=this;var args=state.args,subscriber=state.subscriber,params=state.params;var callbackFunc=params.callbackFunc,context=params.context,scheduler=params.scheduler;var subject=params.subject;if(!subject){subject=params.subject=new AsyncSubject_1.AsyncSubject();var handler=function(){var innerArgs=[];for(var _i=0;_i<arguments.length;_i++){innerArgs[_i]=arguments[_i]}
var value=innerArgs.length<=1?innerArgs[0]:innerArgs;_this.add(scheduler.schedule(dispatchNext,0,{value:value,subject:subject}))};try{callbackFunc.apply(context,args.concat([handler]))}catch(err){subject.error(err)}}
this.add(subject.subscribe(subscriber))}
function dispatchNext(state){var value=state.value,subject=state.subject;subject.next(value);subject.complete()}
function dispatchError(state){var err=state.err,subject=state.subject;subject.error(err)}},{"../AsyncSubject":57,"../Observable":61,"../operators/map":139,"../util/canReportError":231,"../util/isArray":234,"../util/isScheduler":244}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var AsyncSubject_1=require("../AsyncSubject");var map_1=require("../operators/map");var canReportError_1=require("../util/canReportError");var isScheduler_1=require("../util/isScheduler");var isArray_1=require("../util/isArray");function bindNodeCallback(callbackFunc,resultSelector,scheduler){if(resultSelector){if(isScheduler_1.isScheduler(resultSelector)){scheduler=resultSelector}else{return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}
return bindNodeCallback(callbackFunc,scheduler).apply(void 0,args).pipe(map_1.map(function(args){return isArray_1.isArray(args)?resultSelector.apply(void 0,args):resultSelector(args)}))}}}
return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}
var params={subject:undefined,args:args,callbackFunc:callbackFunc,scheduler:scheduler,context:this,};return new Observable_1.Observable(function(subscriber){var context=params.context;var subject=params.subject;if(!scheduler){if(!subject){subject=params.subject=new AsyncSubject_1.AsyncSubject();var handler=function(){var innerArgs=[];for(var _i=0;_i<arguments.length;_i++){innerArgs[_i]=arguments[_i]}
var err=innerArgs.shift();if(err){subject.error(err);return}
subject.next(innerArgs.length<=1?innerArgs[0]:innerArgs);subject.complete()};try{callbackFunc.apply(context,args.concat([handler]))}catch(err){if(canReportError_1.canReportError(subject)){subject.error(err)}else{console.warn(err)}}}
return subject.subscribe(subscriber)}else{return scheduler.schedule(dispatch,0,{params:params,subscriber:subscriber,context:context})}})}}
exports.bindNodeCallback=bindNodeCallback;function dispatch(state){var _this=this;var params=state.params,subscriber=state.subscriber,context=state.context;var callbackFunc=params.callbackFunc,args=params.args,scheduler=params.scheduler;var subject=params.subject;if(!subject){subject=params.subject=new AsyncSubject_1.AsyncSubject();var handler=function(){var innerArgs=[];for(var _i=0;_i<arguments.length;_i++){innerArgs[_i]=arguments[_i]}
var err=innerArgs.shift();if(err){_this.add(scheduler.schedule(dispatchError,0,{err:err,subject:subject}))}else{var value=innerArgs.length<=1?innerArgs[0]:innerArgs;_this.add(scheduler.schedule(dispatchNext,0,{value:value,subject:subject}))}};try{callbackFunc.apply(context,args.concat([handler]))}catch(err){this.add(scheduler.schedule(dispatchError,0,{err:err,subject:subject}))}}
this.add(subject.subscribe(subscriber))}
function dispatchNext(arg){var value=arg.value,subject=arg.subject;subject.next(value);subject.complete()}
function dispatchError(arg){var err=arg.err,subject=arg.subject;subject.error(err)}},{"../AsyncSubject":57,"../Observable":61,"../operators/map":139,"../util/canReportError":231,"../util/isArray":234,"../util/isScheduler":244}],76:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var isScheduler_1=require("../util/isScheduler");var isArray_1=require("../util/isArray");var OuterSubscriber_1=require("../OuterSubscriber");var subscribeToResult_1=require("../util/subscribeToResult");var fromArray_1=require("./fromArray");var NONE={};function combineLatest(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
var resultSelector=undefined;var scheduler=undefined;if(isScheduler_1.isScheduler(observables[observables.length-1])){scheduler=observables.pop()}
if(typeof observables[observables.length-1]==='function'){resultSelector=observables.pop()}
if(observables.length===1&&isArray_1.isArray(observables[0])){observables=observables[0]}
return fromArray_1.fromArray(observables,scheduler).lift(new CombineLatestOperator(resultSelector))}
exports.combineLatest=combineLatest;var CombineLatestOperator=(function(){function CombineLatestOperator(resultSelector){this.resultSelector=resultSelector}
CombineLatestOperator.prototype.call=function(subscriber,source){return source.subscribe(new CombineLatestSubscriber(subscriber,this.resultSelector))};return CombineLatestOperator}());exports.CombineLatestOperator=CombineLatestOperator;var CombineLatestSubscriber=(function(_super){__extends(CombineLatestSubscriber,_super);function CombineLatestSubscriber(destination,resultSelector){var _this=_super.call(this,destination)||this;_this.resultSelector=resultSelector;_this.active=0;_this.values=[];_this.observables=[];return _this}
CombineLatestSubscriber.prototype._next=function(observable){this.values.push(NONE);this.observables.push(observable)};CombineLatestSubscriber.prototype._complete=function(){var observables=this.observables;var len=observables.length;if(len===0){this.destination.complete()}else{this.active=len;this.toRespond=len;for(var i=0;i<len;i++){var observable=observables[i];this.add(subscribeToResult_1.subscribeToResult(this,observable,undefined,i))}}};CombineLatestSubscriber.prototype.notifyComplete=function(unused){if((this.active-=1)===0){this.destination.complete()}};CombineLatestSubscriber.prototype.notifyNext=function(_outerValue,innerValue,outerIndex){var values=this.values;var oldVal=values[outerIndex];var toRespond=!this.toRespond?0:oldVal===NONE?--this.toRespond:this.toRespond;values[outerIndex]=innerValue;if(toRespond===0){if(this.resultSelector){this._tryResultSelector(values)}else{this.destination.next(values.slice())}}};CombineLatestSubscriber.prototype._tryResultSelector=function(values){var result;try{result=this.resultSelector.apply(this,values)}catch(err){this.destination.error(err);return}
this.destination.next(result)};return CombineLatestSubscriber}(OuterSubscriber_1.OuterSubscriber));exports.CombineLatestSubscriber=CombineLatestSubscriber},{"../OuterSubscriber":63,"../util/isArray":234,"../util/isScheduler":244,"../util/subscribeToResult":253,"./fromArray":82}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var of_1=require("./of");var concatAll_1=require("../operators/concatAll");function concat(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
return concatAll_1.concatAll()(of_1.of.apply(void 0,observables))}
exports.concat=concat},{"../operators/concatAll":111,"./of":90}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var from_1=require("./from");var empty_1=require("./empty");function defer(observableFactory){return new Observable_1.Observable(function(subscriber){var input;try{input=observableFactory()}catch(err){subscriber.error(err);return undefined}
var source=input?from_1.from(input):empty_1.empty();return source.subscribe(subscriber)})}
exports.defer=defer},{"../Observable":61,"./empty":79,"./from":81}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");exports.EMPTY=new Observable_1.Observable(function(subscriber){return subscriber.complete()});function empty(scheduler){return scheduler?emptyScheduled(scheduler):exports.EMPTY}
exports.empty=empty;function emptyScheduled(scheduler){return new Observable_1.Observable(function(subscriber){return scheduler.schedule(function(){return subscriber.complete()})})}},{"../Observable":61}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var isArray_1=require("../util/isArray");var map_1=require("../operators/map");var isObject_1=require("../util/isObject");var from_1=require("./from");function forkJoin(){var sources=[];for(var _i=0;_i<arguments.length;_i++){sources[_i]=arguments[_i]}
if(sources.length===1){var first_1=sources[0];if(isArray_1.isArray(first_1)){return forkJoinInternal(first_1,null)}
if(isObject_1.isObject(first_1)&&Object.getPrototypeOf(first_1)===Object.prototype){var keys=Object.keys(first_1);return forkJoinInternal(keys.map(function(key){return first_1[key]}),keys)}}
if(typeof sources[sources.length-1]==='function'){var resultSelector_1=sources.pop();sources=(sources.length===1&&isArray_1.isArray(sources[0]))?sources[0]:sources;return forkJoinInternal(sources,null).pipe(map_1.map(function(args){return resultSelector_1.apply(void 0,args)}))}
return forkJoinInternal(sources,null)}
exports.forkJoin=forkJoin;function forkJoinInternal(sources,keys){return new Observable_1.Observable(function(subscriber){var len=sources.length;if(len===0){subscriber.complete();return}
var values=new Array(len);var completed=0;var emitted=0;var _loop_1=function(i){var source=from_1.from(sources[i]);var hasValue=!1;subscriber.add(source.subscribe({next:function(value){if(!hasValue){hasValue=!0;emitted++}
values[i]=value},error:function(err){return subscriber.error(err)},complete:function(){completed++;if(completed===len||!hasValue){if(emitted===len){subscriber.next(keys?keys.reduce(function(result,key,i){return(result[key]=values[i],result)},{}):values)}
subscriber.complete()}}}))};for(var i=0;i<len;i++){_loop_1(i)}})}},{"../Observable":61,"../operators/map":139,"../util/isArray":234,"../util/isObject":241,"./from":81}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var subscribeTo_1=require("../util/subscribeTo");var scheduled_1=require("../scheduled/scheduled");function from(input,scheduler){if(!scheduler){if(input instanceof Observable_1.Observable){return input}
return new Observable_1.Observable(subscribeTo_1.subscribeTo(input))}else{return scheduled_1.scheduled(input,scheduler)}}
exports.from=from},{"../Observable":61,"../scheduled/scheduled":207,"../util/subscribeTo":248}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var subscribeToArray_1=require("../util/subscribeToArray");var scheduleArray_1=require("../scheduled/scheduleArray");function fromArray(input,scheduler){if(!scheduler){return new Observable_1.Observable(subscribeToArray_1.subscribeToArray(input))}else{return scheduleArray_1.scheduleArray(input,scheduler)}}
exports.fromArray=fromArray},{"../Observable":61,"../scheduled/scheduleArray":203,"../util/subscribeToArray":249}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var isArray_1=require("../util/isArray");var isFunction_1=require("../util/isFunction");var map_1=require("../operators/map");var toString=(function(){return Object.prototype.toString})();function fromEvent(target,eventName,options,resultSelector){if(isFunction_1.isFunction(options)){resultSelector=options;options=undefined}
if(resultSelector){return fromEvent(target,eventName,options).pipe(map_1.map(function(args){return isArray_1.isArray(args)?resultSelector.apply(void 0,args):resultSelector(args)}))}
return new Observable_1.Observable(function(subscriber){function handler(e){if(arguments.length>1){subscriber.next(Array.prototype.slice.call(arguments))}else{subscriber.next(e)}}
setupSubscription(target,eventName,handler,subscriber,options)})}
exports.fromEvent=fromEvent;function setupSubscription(sourceObj,eventName,handler,subscriber,options){var unsubscribe;if(isEventTarget(sourceObj)){var source_1=sourceObj;sourceObj.addEventListener(eventName,handler,options);unsubscribe=function(){return source_1.removeEventListener(eventName,handler,options)}}else if(isJQueryStyleEventEmitter(sourceObj)){var source_2=sourceObj;sourceObj.on(eventName,handler);unsubscribe=function(){return source_2.off(eventName,handler)}}else if(isNodeStyleEventEmitter(sourceObj)){var source_3=sourceObj;sourceObj.addListener(eventName,handler);unsubscribe=function(){return source_3.removeListener(eventName,handler)}}else if(sourceObj&&sourceObj.length){for(var i=0,len=sourceObj.length;i<len;i++){setupSubscription(sourceObj[i],eventName,handler,subscriber,options)}}else{throw new TypeError('Invalid event target')}
subscriber.add(unsubscribe)}
function isNodeStyleEventEmitter(sourceObj){return sourceObj&&typeof sourceObj.addListener==='function'&&typeof sourceObj.removeListener==='function'}
function isJQueryStyleEventEmitter(sourceObj){return sourceObj&&typeof sourceObj.on==='function'&&typeof sourceObj.off==='function'}
function isEventTarget(sourceObj){return sourceObj&&typeof sourceObj.addEventListener==='function'&&typeof sourceObj.removeEventListener==='function'}},{"../Observable":61,"../operators/map":139,"../util/isArray":234,"../util/isFunction":237}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var isArray_1=require("../util/isArray");var isFunction_1=require("../util/isFunction");var map_1=require("../operators/map");function fromEventPattern(addHandler,removeHandler,resultSelector){if(resultSelector){return fromEventPattern(addHandler,removeHandler).pipe(map_1.map(function(args){return isArray_1.isArray(args)?resultSelector.apply(void 0,args):resultSelector(args)}))}
return new Observable_1.Observable(function(subscriber){var handler=function(){var e=[];for(var _i=0;_i<arguments.length;_i++){e[_i]=arguments[_i]}
return subscriber.next(e.length===1?e[0]:e)};var retValue;try{retValue=addHandler(handler)}catch(err){subscriber.error(err);return undefined}
if(!isFunction_1.isFunction(removeHandler)){return undefined}
return function(){return removeHandler(handler,retValue)}})}
exports.fromEventPattern=fromEventPattern},{"../Observable":61,"../operators/map":139,"../util/isArray":234,"../util/isFunction":237}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var identity_1=require("../util/identity");var isScheduler_1=require("../util/isScheduler");function generate(initialStateOrOptions,condition,iterate,resultSelectorOrObservable,scheduler){var resultSelector;var initialState;if(arguments.length==1){var options=initialStateOrOptions;initialState=options.initialState;condition=options.condition;iterate=options.iterate;resultSelector=options.resultSelector||identity_1.identity;scheduler=options.scheduler}else if(resultSelectorOrObservable===undefined||isScheduler_1.isScheduler(resultSelectorOrObservable)){initialState=initialStateOrOptions;resultSelector=identity_1.identity;scheduler=resultSelectorOrObservable}else{initialState=initialStateOrOptions;resultSelector=resultSelectorOrObservable}
return new Observable_1.Observable(function(subscriber){var state=initialState;if(scheduler){return scheduler.schedule(dispatch,0,{subscriber:subscriber,iterate:iterate,condition:condition,resultSelector:resultSelector,state:state})}
do{if(condition){var conditionResult=void 0;try{conditionResult=condition(state)}catch(err){subscriber.error(err);return undefined}
if(!conditionResult){subscriber.complete();break}}
var value=void 0;try{value=resultSelector(state)}catch(err){subscriber.error(err);return undefined}
subscriber.next(value);if(subscriber.closed){break}
try{state=iterate(state)}catch(err){subscriber.error(err);return undefined}}while(!0);return undefined})}
exports.generate=generate;function dispatch(state){var subscriber=state.subscriber,condition=state.condition;if(subscriber.closed){return undefined}
if(state.needIterate){try{state.state=state.iterate(state.state)}catch(err){subscriber.error(err);return undefined}}else{state.needIterate=!0}
if(condition){var conditionResult=void 0;try{conditionResult=condition(state.state)}catch(err){subscriber.error(err);return undefined}
if(!conditionResult){subscriber.complete();return undefined}
if(subscriber.closed){return undefined}}
var value;try{value=state.resultSelector(state.state)}catch(err){subscriber.error(err);return undefined}
if(subscriber.closed){return undefined}
subscriber.next(value);if(subscriber.closed){return undefined}
return this.schedule(state)}},{"../Observable":61,"../util/identity":233,"../util/isScheduler":244}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var defer_1=require("./defer");var empty_1=require("./empty");function iif(condition,trueResult,falseResult){if(trueResult===void 0){trueResult=empty_1.EMPTY}
if(falseResult===void 0){falseResult=empty_1.EMPTY}
return defer_1.defer(function(){return condition()?trueResult:falseResult})}
exports.iif=iif},{"./defer":78,"./empty":79}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var async_1=require("../scheduler/async");var isNumeric_1=require("../util/isNumeric");function interval(period,scheduler){if(period===void 0){period=0}
if(scheduler===void 0){scheduler=async_1.async}
if(!isNumeric_1.isNumeric(period)||period<0){period=0}
if(!scheduler||typeof scheduler.schedule!=='function'){scheduler=async_1.async}
return new Observable_1.Observable(function(subscriber){subscriber.add(scheduler.schedule(dispatch,period,{subscriber:subscriber,counter:0,period:period}));return subscriber})}
exports.interval=interval;function dispatch(state){var subscriber=state.subscriber,counter=state.counter,period=state.period;subscriber.next(counter);this.schedule({subscriber:subscriber,counter:counter+1,period:period},period)}},{"../Observable":61,"../scheduler/async":220,"../util/isNumeric":240}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var isScheduler_1=require("../util/isScheduler");var mergeAll_1=require("../operators/mergeAll");var fromArray_1=require("./fromArray");function merge(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
var concurrent=Number.POSITIVE_INFINITY;var scheduler=null;var last=observables[observables.length-1];if(isScheduler_1.isScheduler(last)){scheduler=observables.pop();if(observables.length>1&&typeof observables[observables.length-1]==='number'){concurrent=observables.pop()}}else if(typeof last==='number'){concurrent=observables.pop()}
if(scheduler===null&&observables.length===1&&observables[0]instanceof Observable_1.Observable){return observables[0]}
return mergeAll_1.mergeAll(concurrent)(fromArray_1.fromArray(observables,scheduler))}
exports.merge=merge},{"../Observable":61,"../operators/mergeAll":144,"../util/isScheduler":244,"./fromArray":82}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var noop_1=require("../util/noop");exports.NEVER=new Observable_1.Observable(noop_1.noop);function never(){return exports.NEVER}
exports.never=never},{"../Observable":61,"../util/noop":245}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isScheduler_1=require("../util/isScheduler");var fromArray_1=require("./fromArray");var scheduleArray_1=require("../scheduled/scheduleArray");function of(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}
var scheduler=args[args.length-1];if(isScheduler_1.isScheduler(scheduler)){args.pop();return scheduleArray_1.scheduleArray(args,scheduler)}else{return fromArray_1.fromArray(args)}}
exports.of=of},{"../scheduled/scheduleArray":203,"../util/isScheduler":244,"./fromArray":82}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var from_1=require("./from");var isArray_1=require("../util/isArray");var empty_1=require("./empty");function onErrorResumeNext(){var sources=[];for(var _i=0;_i<arguments.length;_i++){sources[_i]=arguments[_i]}
if(sources.length===0){return empty_1.EMPTY}
var first=sources[0],remainder=sources.slice(1);if(sources.length===1&&isArray_1.isArray(first)){return onErrorResumeNext.apply(void 0,first)}
return new Observable_1.Observable(function(subscriber){var subNext=function(){return subscriber.add(onErrorResumeNext.apply(void 0,remainder).subscribe(subscriber))};return from_1.from(first).subscribe({next:function(value){subscriber.next(value)},error:subNext,complete:subNext,})})}
exports.onErrorResumeNext=onErrorResumeNext},{"../Observable":61,"../util/isArray":234,"./empty":79,"./from":81}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var Subscription_1=require("../Subscription");function pairs(obj,scheduler){if(!scheduler){return new Observable_1.Observable(function(subscriber){var keys=Object.keys(obj);for(var i=0;i<keys.length&&!subscriber.closed;i++){var key=keys[i];if(obj.hasOwnProperty(key)){subscriber.next([key,obj[key]])}}
subscriber.complete()})}else{return new Observable_1.Observable(function(subscriber){var keys=Object.keys(obj);var subscription=new Subscription_1.Subscription();subscription.add(scheduler.schedule(dispatch,0,{keys:keys,index:0,subscriber:subscriber,subscription:subscription,obj:obj}));return subscription})}}
exports.pairs=pairs;function dispatch(state){var keys=state.keys,index=state.index,subscriber=state.subscriber,subscription=state.subscription,obj=state.obj;if(!subscriber.closed){if(index<keys.length){var key=keys[index];subscriber.next([key,obj[key]]);subscription.add(this.schedule({keys:keys,index:index+1,subscriber:subscriber,subscription:subscription,obj:obj}))}else{subscriber.complete()}}}
exports.dispatch=dispatch},{"../Observable":61,"../Subscription":69}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var not_1=require("../util/not");var subscribeTo_1=require("../util/subscribeTo");var filter_1=require("../operators/filter");var Observable_1=require("../Observable");function partition(source,predicate,thisArg){return[filter_1.filter(predicate,thisArg)(new Observable_1.Observable(subscribeTo_1.subscribeTo(source))),filter_1.filter(not_1.not(predicate,thisArg))(new Observable_1.Observable(subscribeTo_1.subscribeTo(source)))]}
exports.partition=partition},{"../Observable":61,"../operators/filter":130,"../util/not":246,"../util/subscribeTo":248}],94:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var isArray_1=require("../util/isArray");var fromArray_1=require("./fromArray");var OuterSubscriber_1=require("../OuterSubscriber");var subscribeToResult_1=require("../util/subscribeToResult");function race(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
if(observables.length===1){if(isArray_1.isArray(observables[0])){observables=observables[0]}else{return observables[0]}}
return fromArray_1.fromArray(observables,undefined).lift(new RaceOperator())}
exports.race=race;var RaceOperator=(function(){function RaceOperator(){}
RaceOperator.prototype.call=function(subscriber,source){return source.subscribe(new RaceSubscriber(subscriber))};return RaceOperator}());exports.RaceOperator=RaceOperator;var RaceSubscriber=(function(_super){__extends(RaceSubscriber,_super);function RaceSubscriber(destination){var _this=_super.call(this,destination)||this;_this.hasFirst=!1;_this.observables=[];_this.subscriptions=[];return _this}
RaceSubscriber.prototype._next=function(observable){this.observables.push(observable)};RaceSubscriber.prototype._complete=function(){var observables=this.observables;var len=observables.length;if(len===0){this.destination.complete()}else{for(var i=0;i<len&&!this.hasFirst;i++){var observable=observables[i];var subscription=subscribeToResult_1.subscribeToResult(this,observable,undefined,i);if(this.subscriptions){this.subscriptions.push(subscription)}
this.add(subscription)}
this.observables=null}};RaceSubscriber.prototype.notifyNext=function(_outerValue,innerValue,outerIndex){if(!this.hasFirst){this.hasFirst=!0;for(var i=0;i<this.subscriptions.length;i++){if(i!==outerIndex){var subscription=this.subscriptions[i];subscription.unsubscribe();this.remove(subscription)}}
this.subscriptions=null}
this.destination.next(innerValue)};return RaceSubscriber}(OuterSubscriber_1.OuterSubscriber));exports.RaceSubscriber=RaceSubscriber},{"../OuterSubscriber":63,"../util/isArray":234,"../util/subscribeToResult":253,"./fromArray":82}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");function range(start,count,scheduler){if(start===void 0){start=0}
return new Observable_1.Observable(function(subscriber){if(count===undefined){count=start;start=0}
var index=0;var current=start;if(scheduler){return scheduler.schedule(dispatch,0,{index:index,count:count,start:start,subscriber:subscriber})}else{do{if(index++>=count){subscriber.complete();break}
subscriber.next(current++);if(subscriber.closed){break}}while(!0);}
return undefined})}
exports.range=range;function dispatch(state){var start=state.start,index=state.index,count=state.count,subscriber=state.subscriber;if(index>=count){subscriber.complete();return}
subscriber.next(start);if(subscriber.closed){return}
state.index=index+1;state.start=start+1;this.schedule(state)}
exports.dispatch=dispatch},{"../Observable":61}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");function throwError(error,scheduler){if(!scheduler){return new Observable_1.Observable(function(subscriber){return subscriber.error(error)})}else{return new Observable_1.Observable(function(subscriber){return scheduler.schedule(dispatch,0,{error:error,subscriber:subscriber})})}}
exports.throwError=throwError;function dispatch(_a){var error=_a.error,subscriber=_a.subscriber;subscriber.error(error)}},{"../Observable":61}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var async_1=require("../scheduler/async");var isNumeric_1=require("../util/isNumeric");var isScheduler_1=require("../util/isScheduler");function timer(dueTime,periodOrScheduler,scheduler){if(dueTime===void 0){dueTime=0}
var period=-1;if(isNumeric_1.isNumeric(periodOrScheduler)){period=Number(periodOrScheduler)<1&&1||Number(periodOrScheduler)}else if(isScheduler_1.isScheduler(periodOrScheduler)){scheduler=periodOrScheduler}
if(!isScheduler_1.isScheduler(scheduler)){scheduler=async_1.async}
return new Observable_1.Observable(function(subscriber){var due=isNumeric_1.isNumeric(dueTime)?dueTime:(+dueTime-scheduler.now());return scheduler.schedule(dispatch,due,{index:0,period:period,subscriber:subscriber})})}
exports.timer=timer;function dispatch(state){var index=state.index,period=state.period,subscriber=state.subscriber;subscriber.next(index);if(subscriber.closed){return}else if(period===-1){return subscriber.complete()}
state.index=index+1;this.schedule(state,period)}},{"../Observable":61,"../scheduler/async":220,"../util/isNumeric":240,"../util/isScheduler":244}],98:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var from_1=require("./from");var empty_1=require("./empty");function using(resourceFactory,observableFactory){return new Observable_1.Observable(function(subscriber){var resource;try{resource=resourceFactory()}catch(err){subscriber.error(err);return undefined}
var result;try{result=observableFactory(resource)}catch(err){subscriber.error(err);return undefined}
var source=result?from_1.from(result):empty_1.EMPTY;var subscription=source.subscribe(subscriber);return function(){subscription.unsubscribe();if(resource){resource.unsubscribe()}}})}
exports.using=using},{"../Observable":61,"./empty":79,"./from":81}],99:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var fromArray_1=require("./fromArray");var isArray_1=require("../util/isArray");var Subscriber_1=require("../Subscriber");var iterator_1=require("../../internal/symbol/iterator");var innerSubscribe_1=require("../innerSubscribe");function zip(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
var resultSelector=observables[observables.length-1];if(typeof resultSelector==='function'){observables.pop()}
return fromArray_1.fromArray(observables,undefined).lift(new ZipOperator(resultSelector))}
exports.zip=zip;var ZipOperator=(function(){function ZipOperator(resultSelector){this.resultSelector=resultSelector}
ZipOperator.prototype.call=function(subscriber,source){return source.subscribe(new ZipSubscriber(subscriber,this.resultSelector))};return ZipOperator}());exports.ZipOperator=ZipOperator;var ZipSubscriber=(function(_super){__extends(ZipSubscriber,_super);function ZipSubscriber(destination,resultSelector,values){if(values===void 0){values=Object.create(null)}
var _this=_super.call(this,destination)||this;_this.resultSelector=resultSelector;_this.iterators=[];_this.active=0;_this.resultSelector=(typeof resultSelector==='function')?resultSelector:undefined;return _this}
ZipSubscriber.prototype._next=function(value){var iterators=this.iterators;if(isArray_1.isArray(value)){iterators.push(new StaticArrayIterator(value))}else if(typeof value[iterator_1.iterator]==='function'){iterators.push(new StaticIterator(value[iterator_1.iterator]()))}else{iterators.push(new ZipBufferIterator(this.destination,this,value))}};ZipSubscriber.prototype._complete=function(){var iterators=this.iterators;var len=iterators.length;this.unsubscribe();if(len===0){this.destination.complete();return}
this.active=len;for(var i=0;i<len;i++){var iterator=iterators[i];if(iterator.stillUnsubscribed){var destination=this.destination;destination.add(iterator.subscribe())}else{this.active--}}};ZipSubscriber.prototype.notifyInactive=function(){this.active--;if(this.active===0){this.destination.complete()}};ZipSubscriber.prototype.checkIterators=function(){var iterators=this.iterators;var len=iterators.length;var destination=this.destination;for(var i=0;i<len;i++){var iterator=iterators[i];if(typeof iterator.hasValue==='function'&&!iterator.hasValue()){return}}
var shouldComplete=!1;var args=[];for(var i=0;i<len;i++){var iterator=iterators[i];var result=iterator.next();if(iterator.hasCompleted()){shouldComplete=!0}
if(result.done){destination.complete();return}
args.push(result.value)}
if(this.resultSelector){this._tryresultSelector(args)}else{destination.next(args)}
if(shouldComplete){destination.complete()}};ZipSubscriber.prototype._tryresultSelector=function(args){var result;try{result=this.resultSelector.apply(this,args)}catch(err){this.destination.error(err);return}
this.destination.next(result)};return ZipSubscriber}(Subscriber_1.Subscriber));exports.ZipSubscriber=ZipSubscriber;var StaticIterator=(function(){function StaticIterator(iterator){this.iterator=iterator;this.nextResult=iterator.next()}
StaticIterator.prototype.hasValue=function(){return!0};StaticIterator.prototype.next=function(){var result=this.nextResult;this.nextResult=this.iterator.next();return result};StaticIterator.prototype.hasCompleted=function(){var nextResult=this.nextResult;return Boolean(nextResult&&nextResult.done)};return StaticIterator}());var StaticArrayIterator=(function(){function StaticArrayIterator(array){this.array=array;this.index=0;this.length=0;this.length=array.length}
StaticArrayIterator.prototype[iterator_1.iterator]=function(){return this};StaticArrayIterator.prototype.next=function(value){var i=this.index++;var array=this.array;return i<this.length?{value:array[i],done:!1}:{value:null,done:!0}};StaticArrayIterator.prototype.hasValue=function(){return this.array.length>this.index};StaticArrayIterator.prototype.hasCompleted=function(){return this.array.length===this.index};return StaticArrayIterator}());var ZipBufferIterator=(function(_super){__extends(ZipBufferIterator,_super);function ZipBufferIterator(destination,parent,observable){var _this=_super.call(this,destination)||this;_this.parent=parent;_this.observable=observable;_this.stillUnsubscribed=!0;_this.buffer=[];_this.isComplete=!1;return _this}
ZipBufferIterator.prototype[iterator_1.iterator]=function(){return this};ZipBufferIterator.prototype.next=function(){var buffer=this.buffer;if(buffer.length===0&&this.isComplete){return{value:null,done:!0}}else{return{value:buffer.shift(),done:!1}}};ZipBufferIterator.prototype.hasValue=function(){return this.buffer.length>0};ZipBufferIterator.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete};ZipBufferIterator.prototype.notifyComplete=function(){if(this.buffer.length>0){this.isComplete=!0;this.parent.notifyInactive()}else{this.destination.complete()}};ZipBufferIterator.prototype.notifyNext=function(innerValue){this.buffer.push(innerValue);this.parent.checkIterators()};ZipBufferIterator.prototype.subscribe=function(){return innerSubscribe_1.innerSubscribe(this.observable,new innerSubscribe_1.SimpleInnerSubscriber(this))};return ZipBufferIterator}(innerSubscribe_1.SimpleOuterSubscriber))},{"../../internal/symbol/iterator":222,"../Subscriber":68,"../innerSubscribe":71,"../util/isArray":234,"./fromArray":82}],100:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function audit(durationSelector){return function auditOperatorFunction(source){return source.lift(new AuditOperator(durationSelector))}}
exports.audit=audit;var AuditOperator=(function(){function AuditOperator(durationSelector){this.durationSelector=durationSelector}
AuditOperator.prototype.call=function(subscriber,source){return source.subscribe(new AuditSubscriber(subscriber,this.durationSelector))};return AuditOperator}());var AuditSubscriber=(function(_super){__extends(AuditSubscriber,_super);function AuditSubscriber(destination,durationSelector){var _this=_super.call(this,destination)||this;_this.durationSelector=durationSelector;_this.hasValue=!1;return _this}
AuditSubscriber.prototype._next=function(value){this.value=value;this.hasValue=!0;if(!this.throttled){var duration=void 0;try{var durationSelector=this.durationSelector;duration=durationSelector(value)}catch(err){return this.destination.error(err)}
var innerSubscription=innerSubscribe_1.innerSubscribe(duration,new innerSubscribe_1.SimpleInnerSubscriber(this));if(!innerSubscription||innerSubscription.closed){this.clearThrottle()}else{this.add(this.throttled=innerSubscription)}}};AuditSubscriber.prototype.clearThrottle=function(){var _a=this,value=_a.value,hasValue=_a.hasValue,throttled=_a.throttled;if(throttled){this.remove(throttled);this.throttled=undefined;throttled.unsubscribe()}
if(hasValue){this.value=undefined;this.hasValue=!1;this.destination.next(value)}};AuditSubscriber.prototype.notifyNext=function(){this.clearThrottle()};AuditSubscriber.prototype.notifyComplete=function(){this.clearThrottle()};return AuditSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var audit_1=require("./audit");var timer_1=require("../observable/timer");function auditTime(duration,scheduler){if(scheduler===void 0){scheduler=async_1.async}
return audit_1.audit(function(){return timer_1.timer(duration,scheduler)})}
exports.auditTime=auditTime},{"../observable/timer":97,"../scheduler/async":220,"./audit":100}],102:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function buffer(closingNotifier){return function bufferOperatorFunction(source){return source.lift(new BufferOperator(closingNotifier))}}
exports.buffer=buffer;var BufferOperator=(function(){function BufferOperator(closingNotifier){this.closingNotifier=closingNotifier}
BufferOperator.prototype.call=function(subscriber,source){return source.subscribe(new BufferSubscriber(subscriber,this.closingNotifier))};return BufferOperator}());var BufferSubscriber=(function(_super){__extends(BufferSubscriber,_super);function BufferSubscriber(destination,closingNotifier){var _this=_super.call(this,destination)||this;_this.buffer=[];_this.add(innerSubscribe_1.innerSubscribe(closingNotifier,new innerSubscribe_1.SimpleInnerSubscriber(_this)));return _this}
BufferSubscriber.prototype._next=function(value){this.buffer.push(value)};BufferSubscriber.prototype.notifyNext=function(){var buffer=this.buffer;this.buffer=[];this.destination.next(buffer)};return BufferSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],103:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function bufferCount(bufferSize,startBufferEvery){if(startBufferEvery===void 0){startBufferEvery=null}
return function bufferCountOperatorFunction(source){return source.lift(new BufferCountOperator(bufferSize,startBufferEvery))}}
exports.bufferCount=bufferCount;var BufferCountOperator=(function(){function BufferCountOperator(bufferSize,startBufferEvery){this.bufferSize=bufferSize;this.startBufferEvery=startBufferEvery;if(!startBufferEvery||bufferSize===startBufferEvery){this.subscriberClass=BufferCountSubscriber}else{this.subscriberClass=BufferSkipCountSubscriber}}
BufferCountOperator.prototype.call=function(subscriber,source){return source.subscribe(new this.subscriberClass(subscriber,this.bufferSize,this.startBufferEvery))};return BufferCountOperator}());var BufferCountSubscriber=(function(_super){__extends(BufferCountSubscriber,_super);function BufferCountSubscriber(destination,bufferSize){var _this=_super.call(this,destination)||this;_this.bufferSize=bufferSize;_this.buffer=[];return _this}
BufferCountSubscriber.prototype._next=function(value){var buffer=this.buffer;buffer.push(value);if(buffer.length==this.bufferSize){this.destination.next(buffer);this.buffer=[]}};BufferCountSubscriber.prototype._complete=function(){var buffer=this.buffer;if(buffer.length>0){this.destination.next(buffer)}
_super.prototype._complete.call(this)};return BufferCountSubscriber}(Subscriber_1.Subscriber));var BufferSkipCountSubscriber=(function(_super){__extends(BufferSkipCountSubscriber,_super);function BufferSkipCountSubscriber(destination,bufferSize,startBufferEvery){var _this=_super.call(this,destination)||this;_this.bufferSize=bufferSize;_this.startBufferEvery=startBufferEvery;_this.buffers=[];_this.count=0;return _this}
BufferSkipCountSubscriber.prototype._next=function(value){var _a=this,bufferSize=_a.bufferSize,startBufferEvery=_a.startBufferEvery,buffers=_a.buffers,count=_a.count;this.count++;if(count%startBufferEvery===0){buffers.push([])}
for(var i=buffers.length;i--;){var buffer=buffers[i];buffer.push(value);if(buffer.length===bufferSize){buffers.splice(i,1);this.destination.next(buffer)}}};BufferSkipCountSubscriber.prototype._complete=function(){var _a=this,buffers=_a.buffers,destination=_a.destination;while(buffers.length>0){var buffer=buffers.shift();if(buffer.length>0){destination.next(buffer)}}
_super.prototype._complete.call(this)};return BufferSkipCountSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],104:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var Subscriber_1=require("../Subscriber");var isScheduler_1=require("../util/isScheduler");function bufferTime(bufferTimeSpan){var length=arguments.length;var scheduler=async_1.async;if(isScheduler_1.isScheduler(arguments[arguments.length-1])){scheduler=arguments[arguments.length-1];length--}
var bufferCreationInterval=null;if(length>=2){bufferCreationInterval=arguments[1]}
var maxBufferSize=Number.POSITIVE_INFINITY;if(length>=3){maxBufferSize=arguments[2]}
return function bufferTimeOperatorFunction(source){return source.lift(new BufferTimeOperator(bufferTimeSpan,bufferCreationInterval,maxBufferSize,scheduler))}}
exports.bufferTime=bufferTime;var BufferTimeOperator=(function(){function BufferTimeOperator(bufferTimeSpan,bufferCreationInterval,maxBufferSize,scheduler){this.bufferTimeSpan=bufferTimeSpan;this.bufferCreationInterval=bufferCreationInterval;this.maxBufferSize=maxBufferSize;this.scheduler=scheduler}
BufferTimeOperator.prototype.call=function(subscriber,source){return source.subscribe(new BufferTimeSubscriber(subscriber,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))};return BufferTimeOperator}());var Context=(function(){function Context(){this.buffer=[]}
return Context}());var BufferTimeSubscriber=(function(_super){__extends(BufferTimeSubscriber,_super);function BufferTimeSubscriber(destination,bufferTimeSpan,bufferCreationInterval,maxBufferSize,scheduler){var _this=_super.call(this,destination)||this;_this.bufferTimeSpan=bufferTimeSpan;_this.bufferCreationInterval=bufferCreationInterval;_this.maxBufferSize=maxBufferSize;_this.scheduler=scheduler;_this.contexts=[];var context=_this.openContext();_this.timespanOnly=bufferCreationInterval==null||bufferCreationInterval<0;if(_this.timespanOnly){var timeSpanOnlyState={subscriber:_this,context:context,bufferTimeSpan:bufferTimeSpan};_this.add(context.closeAction=scheduler.schedule(dispatchBufferTimeSpanOnly,bufferTimeSpan,timeSpanOnlyState))}else{var closeState={subscriber:_this,context:context};var creationState={bufferTimeSpan:bufferTimeSpan,bufferCreationInterval:bufferCreationInterval,subscriber:_this,scheduler:scheduler};_this.add(context.closeAction=scheduler.schedule(dispatchBufferClose,bufferTimeSpan,closeState));_this.add(scheduler.schedule(dispatchBufferCreation,bufferCreationInterval,creationState))}
return _this}
BufferTimeSubscriber.prototype._next=function(value){var contexts=this.contexts;var len=contexts.length;var filledBufferContext;for(var i=0;i<len;i++){var context_1=contexts[i];var buffer=context_1.buffer;buffer.push(value);if(buffer.length==this.maxBufferSize){filledBufferContext=context_1}}
if(filledBufferContext){this.onBufferFull(filledBufferContext)}};BufferTimeSubscriber.prototype._error=function(err){this.contexts.length=0;_super.prototype._error.call(this,err)};BufferTimeSubscriber.prototype._complete=function(){var _a=this,contexts=_a.contexts,destination=_a.destination;while(contexts.length>0){var context_2=contexts.shift();destination.next(context_2.buffer)}
_super.prototype._complete.call(this)};BufferTimeSubscriber.prototype._unsubscribe=function(){this.contexts=null};BufferTimeSubscriber.prototype.onBufferFull=function(context){this.closeContext(context);var closeAction=context.closeAction;closeAction.unsubscribe();this.remove(closeAction);if(!this.closed&&this.timespanOnly){context=this.openContext();var bufferTimeSpan=this.bufferTimeSpan;var timeSpanOnlyState={subscriber:this,context:context,bufferTimeSpan:bufferTimeSpan};this.add(context.closeAction=this.scheduler.schedule(dispatchBufferTimeSpanOnly,bufferTimeSpan,timeSpanOnlyState))}};BufferTimeSubscriber.prototype.openContext=function(){var context=new Context();this.contexts.push(context);return context};BufferTimeSubscriber.prototype.closeContext=function(context){this.destination.next(context.buffer);var contexts=this.contexts;var spliceIndex=contexts?contexts.indexOf(context):-1;if(spliceIndex>=0){contexts.splice(contexts.indexOf(context),1)}};return BufferTimeSubscriber}(Subscriber_1.Subscriber));function dispatchBufferTimeSpanOnly(state){var subscriber=state.subscriber;var prevContext=state.context;if(prevContext){subscriber.closeContext(prevContext)}
if(!subscriber.closed){state.context=subscriber.openContext();state.context.closeAction=this.schedule(state,state.bufferTimeSpan)}}
function dispatchBufferCreation(state){var bufferCreationInterval=state.bufferCreationInterval,bufferTimeSpan=state.bufferTimeSpan,subscriber=state.subscriber,scheduler=state.scheduler;var context=subscriber.openContext();var action=this;if(!subscriber.closed){subscriber.add(context.closeAction=scheduler.schedule(dispatchBufferClose,bufferTimeSpan,{subscriber:subscriber,context:context}));action.schedule(state,bufferCreationInterval)}}
function dispatchBufferClose(arg){var subscriber=arg.subscriber,context=arg.context;subscriber.closeContext(context)}},{"../Subscriber":68,"../scheduler/async":220,"../util/isScheduler":244}],105:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscription_1=require("../Subscription");var subscribeToResult_1=require("../util/subscribeToResult");var OuterSubscriber_1=require("../OuterSubscriber");function bufferToggle(openings,closingSelector){return function bufferToggleOperatorFunction(source){return source.lift(new BufferToggleOperator(openings,closingSelector))}}
exports.bufferToggle=bufferToggle;var BufferToggleOperator=(function(){function BufferToggleOperator(openings,closingSelector){this.openings=openings;this.closingSelector=closingSelector}
BufferToggleOperator.prototype.call=function(subscriber,source){return source.subscribe(new BufferToggleSubscriber(subscriber,this.openings,this.closingSelector))};return BufferToggleOperator}());var BufferToggleSubscriber=(function(_super){__extends(BufferToggleSubscriber,_super);function BufferToggleSubscriber(destination,openings,closingSelector){var _this=_super.call(this,destination)||this;_this.closingSelector=closingSelector;_this.contexts=[];_this.add(subscribeToResult_1.subscribeToResult(_this,openings));return _this}
BufferToggleSubscriber.prototype._next=function(value){var contexts=this.contexts;var len=contexts.length;for(var i=0;i<len;i++){contexts[i].buffer.push(value)}};BufferToggleSubscriber.prototype._error=function(err){var contexts=this.contexts;while(contexts.length>0){var context_1=contexts.shift();context_1.subscription.unsubscribe();context_1.buffer=null;context_1.subscription=null}
this.contexts=null;_super.prototype._error.call(this,err)};BufferToggleSubscriber.prototype._complete=function(){var contexts=this.contexts;while(contexts.length>0){var context_2=contexts.shift();this.destination.next(context_2.buffer);context_2.subscription.unsubscribe();context_2.buffer=null;context_2.subscription=null}
this.contexts=null;_super.prototype._complete.call(this)};BufferToggleSubscriber.prototype.notifyNext=function(outerValue,innerValue){outerValue?this.closeBuffer(outerValue):this.openBuffer(innerValue)};BufferToggleSubscriber.prototype.notifyComplete=function(innerSub){this.closeBuffer(innerSub.context)};BufferToggleSubscriber.prototype.openBuffer=function(value){try{var closingSelector=this.closingSelector;var closingNotifier=closingSelector.call(this,value);if(closingNotifier){this.trySubscribe(closingNotifier)}}catch(err){this._error(err)}};BufferToggleSubscriber.prototype.closeBuffer=function(context){var contexts=this.contexts;if(contexts&&context){var buffer=context.buffer,subscription=context.subscription;this.destination.next(buffer);contexts.splice(contexts.indexOf(context),1);this.remove(subscription);subscription.unsubscribe()}};BufferToggleSubscriber.prototype.trySubscribe=function(closingNotifier){var contexts=this.contexts;var buffer=[];var subscription=new Subscription_1.Subscription();var context={buffer:buffer,subscription:subscription};contexts.push(context);var innerSubscription=subscribeToResult_1.subscribeToResult(this,closingNotifier,context);if(!innerSubscription||innerSubscription.closed){this.closeBuffer(context)}else{innerSubscription.context=context;this.add(innerSubscription);subscription.add(innerSubscription)}};return BufferToggleSubscriber}(OuterSubscriber_1.OuterSubscriber))},{"../OuterSubscriber":63,"../Subscription":69,"../util/subscribeToResult":253}],106:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscription_1=require("../Subscription");var innerSubscribe_1=require("../innerSubscribe");function bufferWhen(closingSelector){return function(source){return source.lift(new BufferWhenOperator(closingSelector))}}
exports.bufferWhen=bufferWhen;var BufferWhenOperator=(function(){function BufferWhenOperator(closingSelector){this.closingSelector=closingSelector}
BufferWhenOperator.prototype.call=function(subscriber,source){return source.subscribe(new BufferWhenSubscriber(subscriber,this.closingSelector))};return BufferWhenOperator}());var BufferWhenSubscriber=(function(_super){__extends(BufferWhenSubscriber,_super);function BufferWhenSubscriber(destination,closingSelector){var _this=_super.call(this,destination)||this;_this.closingSelector=closingSelector;_this.subscribing=!1;_this.openBuffer();return _this}
BufferWhenSubscriber.prototype._next=function(value){this.buffer.push(value)};BufferWhenSubscriber.prototype._complete=function(){var buffer=this.buffer;if(buffer){this.destination.next(buffer)}
_super.prototype._complete.call(this)};BufferWhenSubscriber.prototype._unsubscribe=function(){this.buffer=undefined;this.subscribing=!1};BufferWhenSubscriber.prototype.notifyNext=function(){this.openBuffer()};BufferWhenSubscriber.prototype.notifyComplete=function(){if(this.subscribing){this.complete()}else{this.openBuffer()}};BufferWhenSubscriber.prototype.openBuffer=function(){var closingSubscription=this.closingSubscription;if(closingSubscription){this.remove(closingSubscription);closingSubscription.unsubscribe()}
var buffer=this.buffer;if(this.buffer){this.destination.next(buffer)}
this.buffer=[];var closingNotifier;try{var closingSelector=this.closingSelector;closingNotifier=closingSelector()}catch(err){return this.error(err)}
closingSubscription=new Subscription_1.Subscription();this.closingSubscription=closingSubscription;this.add(closingSubscription);this.subscribing=!0;closingSubscription.add(innerSubscribe_1.innerSubscribe(closingNotifier,new innerSubscribe_1.SimpleInnerSubscriber(this)));this.subscribing=!1};return BufferWhenSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../Subscription":69,"../innerSubscribe":71}],107:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function catchError(selector){return function catchErrorOperatorFunction(source){var operator=new CatchOperator(selector);var caught=source.lift(operator);return(operator.caught=caught)}}
exports.catchError=catchError;var CatchOperator=(function(){function CatchOperator(selector){this.selector=selector}
CatchOperator.prototype.call=function(subscriber,source){return source.subscribe(new CatchSubscriber(subscriber,this.selector,this.caught))};return CatchOperator}());var CatchSubscriber=(function(_super){__extends(CatchSubscriber,_super);function CatchSubscriber(destination,selector,caught){var _this=_super.call(this,destination)||this;_this.selector=selector;_this.caught=caught;return _this}
CatchSubscriber.prototype.error=function(err){if(!this.isStopped){var result=void 0;try{result=this.selector(err,this.caught)}catch(err2){_super.prototype.error.call(this,err2);return}
this._unsubscribeAndRecycle();var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(this);this.add(innerSubscriber);var innerSubscription=innerSubscribe_1.innerSubscribe(result,innerSubscriber);if(innerSubscription!==innerSubscriber){this.add(innerSubscription)}}};return CatchSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],108:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var combineLatest_1=require("../observable/combineLatest");function combineAll(project){return function(source){return source.lift(new combineLatest_1.CombineLatestOperator(project))}}
exports.combineAll=combineAll},{"../observable/combineLatest":76}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isArray_1=require("../util/isArray");var combineLatest_1=require("../observable/combineLatest");var from_1=require("../observable/from");var none={};function combineLatest(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
var project=null;if(typeof observables[observables.length-1]==='function'){project=observables.pop()}
if(observables.length===1&&isArray_1.isArray(observables[0])){observables=observables[0].slice()}
return function(source){return source.lift.call(from_1.from([source].concat(observables)),new combineLatest_1.CombineLatestOperator(project))}}
exports.combineLatest=combineLatest},{"../observable/combineLatest":76,"../observable/from":81,"../util/isArray":234}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var concat_1=require("../observable/concat");function concat(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
return function(source){return source.lift.call(concat_1.concat.apply(void 0,[source].concat(observables)))}}
exports.concat=concat},{"../observable/concat":77}],111:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var mergeAll_1=require("./mergeAll");function concatAll(){return mergeAll_1.mergeAll(1)}
exports.concatAll=concatAll},{"./mergeAll":144}],112:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var mergeMap_1=require("./mergeMap");function concatMap(project,resultSelector){return mergeMap_1.mergeMap(project,resultSelector,1)}
exports.concatMap=concatMap},{"./mergeMap":145}],113:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var concatMap_1=require("./concatMap");function concatMapTo(innerObservable,resultSelector){return concatMap_1.concatMap(function(){return innerObservable},resultSelector)}
exports.concatMapTo=concatMapTo},{"./concatMap":112}],114:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function count(predicate){return function(source){return source.lift(new CountOperator(predicate,source))}}
exports.count=count;var CountOperator=(function(){function CountOperator(predicate,source){this.predicate=predicate;this.source=source}
CountOperator.prototype.call=function(subscriber,source){return source.subscribe(new CountSubscriber(subscriber,this.predicate,this.source))};return CountOperator}());var CountSubscriber=(function(_super){__extends(CountSubscriber,_super);function CountSubscriber(destination,predicate,source){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.source=source;_this.count=0;_this.index=0;return _this}
CountSubscriber.prototype._next=function(value){if(this.predicate){this._tryPredicate(value)}else{this.count++}};CountSubscriber.prototype._tryPredicate=function(value){var result;try{result=this.predicate(value,this.index++,this.source)}catch(err){this.destination.error(err);return}
if(result){this.count++}};CountSubscriber.prototype._complete=function(){this.destination.next(this.count);this.destination.complete()};return CountSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],115:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function debounce(durationSelector){return function(source){return source.lift(new DebounceOperator(durationSelector))}}
exports.debounce=debounce;var DebounceOperator=(function(){function DebounceOperator(durationSelector){this.durationSelector=durationSelector}
DebounceOperator.prototype.call=function(subscriber,source){return source.subscribe(new DebounceSubscriber(subscriber,this.durationSelector))};return DebounceOperator}());var DebounceSubscriber=(function(_super){__extends(DebounceSubscriber,_super);function DebounceSubscriber(destination,durationSelector){var _this=_super.call(this,destination)||this;_this.durationSelector=durationSelector;_this.hasValue=!1;return _this}
DebounceSubscriber.prototype._next=function(value){try{var result=this.durationSelector.call(this,value);if(result){this._tryNext(value,result)}}catch(err){this.destination.error(err)}};DebounceSubscriber.prototype._complete=function(){this.emitValue();this.destination.complete()};DebounceSubscriber.prototype._tryNext=function(value,duration){var subscription=this.durationSubscription;this.value=value;this.hasValue=!0;if(subscription){subscription.unsubscribe();this.remove(subscription)}
subscription=innerSubscribe_1.innerSubscribe(duration,new innerSubscribe_1.SimpleInnerSubscriber(this));if(subscription&&!subscription.closed){this.add(this.durationSubscription=subscription)}};DebounceSubscriber.prototype.notifyNext=function(){this.emitValue()};DebounceSubscriber.prototype.notifyComplete=function(){this.emitValue()};DebounceSubscriber.prototype.emitValue=function(){if(this.hasValue){var value=this.value;var subscription=this.durationSubscription;if(subscription){this.durationSubscription=undefined;subscription.unsubscribe();this.remove(subscription)}
this.value=undefined;this.hasValue=!1;_super.prototype._next.call(this,value)}};return DebounceSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],116:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var async_1=require("../scheduler/async");function debounceTime(dueTime,scheduler){if(scheduler===void 0){scheduler=async_1.async}
return function(source){return source.lift(new DebounceTimeOperator(dueTime,scheduler))}}
exports.debounceTime=debounceTime;var DebounceTimeOperator=(function(){function DebounceTimeOperator(dueTime,scheduler){this.dueTime=dueTime;this.scheduler=scheduler}
DebounceTimeOperator.prototype.call=function(subscriber,source){return source.subscribe(new DebounceTimeSubscriber(subscriber,this.dueTime,this.scheduler))};return DebounceTimeOperator}());var DebounceTimeSubscriber=(function(_super){__extends(DebounceTimeSubscriber,_super);function DebounceTimeSubscriber(destination,dueTime,scheduler){var _this=_super.call(this,destination)||this;_this.dueTime=dueTime;_this.scheduler=scheduler;_this.debouncedSubscription=null;_this.lastValue=null;_this.hasValue=!1;return _this}
DebounceTimeSubscriber.prototype._next=function(value){this.clearDebounce();this.lastValue=value;this.hasValue=!0;this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext,this.dueTime,this))};DebounceTimeSubscriber.prototype._complete=function(){this.debouncedNext();this.destination.complete()};DebounceTimeSubscriber.prototype.debouncedNext=function(){this.clearDebounce();if(this.hasValue){var lastValue=this.lastValue;this.lastValue=null;this.hasValue=!1;this.destination.next(lastValue)}};DebounceTimeSubscriber.prototype.clearDebounce=function(){var debouncedSubscription=this.debouncedSubscription;if(debouncedSubscription!==null){this.remove(debouncedSubscription);debouncedSubscription.unsubscribe();this.debouncedSubscription=null}};return DebounceTimeSubscriber}(Subscriber_1.Subscriber));function dispatchNext(subscriber){subscriber.debouncedNext()}},{"../Subscriber":68,"../scheduler/async":220}],117:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function defaultIfEmpty(defaultValue){if(defaultValue===void 0){defaultValue=null}
return function(source){return source.lift(new DefaultIfEmptyOperator(defaultValue))}}
exports.defaultIfEmpty=defaultIfEmpty;var DefaultIfEmptyOperator=(function(){function DefaultIfEmptyOperator(defaultValue){this.defaultValue=defaultValue}
DefaultIfEmptyOperator.prototype.call=function(subscriber,source){return source.subscribe(new DefaultIfEmptySubscriber(subscriber,this.defaultValue))};return DefaultIfEmptyOperator}());var DefaultIfEmptySubscriber=(function(_super){__extends(DefaultIfEmptySubscriber,_super);function DefaultIfEmptySubscriber(destination,defaultValue){var _this=_super.call(this,destination)||this;_this.defaultValue=defaultValue;_this.isEmpty=!0;return _this}
DefaultIfEmptySubscriber.prototype._next=function(value){this.isEmpty=!1;this.destination.next(value)};DefaultIfEmptySubscriber.prototype._complete=function(){if(this.isEmpty){this.destination.next(this.defaultValue)}
this.destination.complete()};return DefaultIfEmptySubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],118:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var isDate_1=require("../util/isDate");var Subscriber_1=require("../Subscriber");var Notification_1=require("../Notification");function delay(delay,scheduler){if(scheduler===void 0){scheduler=async_1.async}
var absoluteDelay=isDate_1.isDate(delay);var delayFor=absoluteDelay?(+delay-scheduler.now()):Math.abs(delay);return function(source){return source.lift(new DelayOperator(delayFor,scheduler))}}
exports.delay=delay;var DelayOperator=(function(){function DelayOperator(delay,scheduler){this.delay=delay;this.scheduler=scheduler}
DelayOperator.prototype.call=function(subscriber,source){return source.subscribe(new DelaySubscriber(subscriber,this.delay,this.scheduler))};return DelayOperator}());var DelaySubscriber=(function(_super){__extends(DelaySubscriber,_super);function DelaySubscriber(destination,delay,scheduler){var _this=_super.call(this,destination)||this;_this.delay=delay;_this.scheduler=scheduler;_this.queue=[];_this.active=!1;_this.errored=!1;return _this}
DelaySubscriber.dispatch=function(state){var source=state.source;var queue=source.queue;var scheduler=state.scheduler;var destination=state.destination;while(queue.length>0&&(queue[0].time-scheduler.now())<=0){queue.shift().notification.observe(destination)}
if(queue.length>0){var delay_1=Math.max(0,queue[0].time-scheduler.now());this.schedule(state,delay_1)}else{this.unsubscribe();source.active=!1}};DelaySubscriber.prototype._schedule=function(scheduler){this.active=!0;var destination=this.destination;destination.add(scheduler.schedule(DelaySubscriber.dispatch,this.delay,{source:this,destination:this.destination,scheduler:scheduler}))};DelaySubscriber.prototype.scheduleNotification=function(notification){if(this.errored===!0){return}
var scheduler=this.scheduler;var message=new DelayMessage(scheduler.now()+this.delay,notification);this.queue.push(message);if(this.active===!1){this._schedule(scheduler)}};DelaySubscriber.prototype._next=function(value){this.scheduleNotification(Notification_1.Notification.createNext(value))};DelaySubscriber.prototype._error=function(err){this.errored=!0;this.queue=[];this.destination.error(err);this.unsubscribe()};DelaySubscriber.prototype._complete=function(){this.scheduleNotification(Notification_1.Notification.createComplete());this.unsubscribe()};return DelaySubscriber}(Subscriber_1.Subscriber));var DelayMessage=(function(){function DelayMessage(time,notification){this.time=time;this.notification=notification}
return DelayMessage}())},{"../Notification":60,"../Subscriber":68,"../scheduler/async":220,"../util/isDate":236}],119:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var Observable_1=require("../Observable");var OuterSubscriber_1=require("../OuterSubscriber");var subscribeToResult_1=require("../util/subscribeToResult");function delayWhen(delayDurationSelector,subscriptionDelay){if(subscriptionDelay){return function(source){return new SubscriptionDelayObservable(source,subscriptionDelay).lift(new DelayWhenOperator(delayDurationSelector))}}
return function(source){return source.lift(new DelayWhenOperator(delayDurationSelector))}}
exports.delayWhen=delayWhen;var DelayWhenOperator=(function(){function DelayWhenOperator(delayDurationSelector){this.delayDurationSelector=delayDurationSelector}
DelayWhenOperator.prototype.call=function(subscriber,source){return source.subscribe(new DelayWhenSubscriber(subscriber,this.delayDurationSelector))};return DelayWhenOperator}());var DelayWhenSubscriber=(function(_super){__extends(DelayWhenSubscriber,_super);function DelayWhenSubscriber(destination,delayDurationSelector){var _this=_super.call(this,destination)||this;_this.delayDurationSelector=delayDurationSelector;_this.completed=!1;_this.delayNotifierSubscriptions=[];_this.index=0;return _this}
DelayWhenSubscriber.prototype.notifyNext=function(outerValue,_innerValue,_outerIndex,_innerIndex,innerSub){this.destination.next(outerValue);this.removeSubscription(innerSub);this.tryComplete()};DelayWhenSubscriber.prototype.notifyError=function(error,innerSub){this._error(error)};DelayWhenSubscriber.prototype.notifyComplete=function(innerSub){var value=this.removeSubscription(innerSub);if(value){this.destination.next(value)}
this.tryComplete()};DelayWhenSubscriber.prototype._next=function(value){var index=this.index++;try{var delayNotifier=this.delayDurationSelector(value,index);if(delayNotifier){this.tryDelay(delayNotifier,value)}}catch(err){this.destination.error(err)}};DelayWhenSubscriber.prototype._complete=function(){this.completed=!0;this.tryComplete();this.unsubscribe()};DelayWhenSubscriber.prototype.removeSubscription=function(subscription){subscription.unsubscribe();var subscriptionIdx=this.delayNotifierSubscriptions.indexOf(subscription);if(subscriptionIdx!==-1){this.delayNotifierSubscriptions.splice(subscriptionIdx,1)}
return subscription.outerValue};DelayWhenSubscriber.prototype.tryDelay=function(delayNotifier,value){var notifierSubscription=subscribeToResult_1.subscribeToResult(this,delayNotifier,value);if(notifierSubscription&&!notifierSubscription.closed){var destination=this.destination;destination.add(notifierSubscription);this.delayNotifierSubscriptions.push(notifierSubscription)}};DelayWhenSubscriber.prototype.tryComplete=function(){if(this.completed&&this.delayNotifierSubscriptions.length===0){this.destination.complete()}};return DelayWhenSubscriber}(OuterSubscriber_1.OuterSubscriber));var SubscriptionDelayObservable=(function(_super){__extends(SubscriptionDelayObservable,_super);function SubscriptionDelayObservable(source,subscriptionDelay){var _this=_super.call(this)||this;_this.source=source;_this.subscriptionDelay=subscriptionDelay;return _this}
SubscriptionDelayObservable.prototype._subscribe=function(subscriber){this.subscriptionDelay.subscribe(new SubscriptionDelaySubscriber(subscriber,this.source))};return SubscriptionDelayObservable}(Observable_1.Observable));var SubscriptionDelaySubscriber=(function(_super){__extends(SubscriptionDelaySubscriber,_super);function SubscriptionDelaySubscriber(parent,source){var _this=_super.call(this)||this;_this.parent=parent;_this.source=source;_this.sourceSubscribed=!1;return _this}
SubscriptionDelaySubscriber.prototype._next=function(unused){this.subscribeToSource()};SubscriptionDelaySubscriber.prototype._error=function(err){this.unsubscribe();this.parent.error(err)};SubscriptionDelaySubscriber.prototype._complete=function(){this.unsubscribe();this.subscribeToSource()};SubscriptionDelaySubscriber.prototype.subscribeToSource=function(){if(!this.sourceSubscribed){this.sourceSubscribed=!0;this.unsubscribe();this.source.subscribe(this.parent)}};return SubscriptionDelaySubscriber}(Subscriber_1.Subscriber))},{"../Observable":61,"../OuterSubscriber":63,"../Subscriber":68,"../util/subscribeToResult":253}],120:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function dematerialize(){return function dematerializeOperatorFunction(source){return source.lift(new DeMaterializeOperator())}}
exports.dematerialize=dematerialize;var DeMaterializeOperator=(function(){function DeMaterializeOperator(){}
DeMaterializeOperator.prototype.call=function(subscriber,source){return source.subscribe(new DeMaterializeSubscriber(subscriber))};return DeMaterializeOperator}());var DeMaterializeSubscriber=(function(_super){__extends(DeMaterializeSubscriber,_super);function DeMaterializeSubscriber(destination){return _super.call(this,destination)||this}
DeMaterializeSubscriber.prototype._next=function(value){value.observe(this.destination)};return DeMaterializeSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],121:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function distinct(keySelector,flushes){return function(source){return source.lift(new DistinctOperator(keySelector,flushes))}}
exports.distinct=distinct;var DistinctOperator=(function(){function DistinctOperator(keySelector,flushes){this.keySelector=keySelector;this.flushes=flushes}
DistinctOperator.prototype.call=function(subscriber,source){return source.subscribe(new DistinctSubscriber(subscriber,this.keySelector,this.flushes))};return DistinctOperator}());var DistinctSubscriber=(function(_super){__extends(DistinctSubscriber,_super);function DistinctSubscriber(destination,keySelector,flushes){var _this=_super.call(this,destination)||this;_this.keySelector=keySelector;_this.values=new Set();if(flushes){_this.add(innerSubscribe_1.innerSubscribe(flushes,new innerSubscribe_1.SimpleInnerSubscriber(_this)))}
return _this}
DistinctSubscriber.prototype.notifyNext=function(){this.values.clear()};DistinctSubscriber.prototype.notifyError=function(error){this._error(error)};DistinctSubscriber.prototype._next=function(value){if(this.keySelector){this._useKeySelector(value)}else{this._finalizeNext(value,value)}};DistinctSubscriber.prototype._useKeySelector=function(value){var key;var destination=this.destination;try{key=this.keySelector(value)}catch(err){destination.error(err);return}
this._finalizeNext(key,value)};DistinctSubscriber.prototype._finalizeNext=function(key,value){var values=this.values;if(!values.has(key)){values.add(key);this.destination.next(value)}};return DistinctSubscriber}(innerSubscribe_1.SimpleOuterSubscriber));exports.DistinctSubscriber=DistinctSubscriber},{"../innerSubscribe":71}],122:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function distinctUntilChanged(compare,keySelector){return function(source){return source.lift(new DistinctUntilChangedOperator(compare,keySelector))}}
exports.distinctUntilChanged=distinctUntilChanged;var DistinctUntilChangedOperator=(function(){function DistinctUntilChangedOperator(compare,keySelector){this.compare=compare;this.keySelector=keySelector}
DistinctUntilChangedOperator.prototype.call=function(subscriber,source){return source.subscribe(new DistinctUntilChangedSubscriber(subscriber,this.compare,this.keySelector))};return DistinctUntilChangedOperator}());var DistinctUntilChangedSubscriber=(function(_super){__extends(DistinctUntilChangedSubscriber,_super);function DistinctUntilChangedSubscriber(destination,compare,keySelector){var _this=_super.call(this,destination)||this;_this.keySelector=keySelector;_this.hasKey=!1;if(typeof compare==='function'){_this.compare=compare}
return _this}
DistinctUntilChangedSubscriber.prototype.compare=function(x,y){return x===y};DistinctUntilChangedSubscriber.prototype._next=function(value){var key;try{var keySelector=this.keySelector;key=keySelector?keySelector(value):value}catch(err){return this.destination.error(err)}
var result=!1;if(this.hasKey){try{var compare=this.compare;result=compare(this.key,key)}catch(err){return this.destination.error(err)}}else{this.hasKey=!0}
if(!result){this.key=key;this.destination.next(value)}};return DistinctUntilChangedSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],123:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var distinctUntilChanged_1=require("./distinctUntilChanged");function distinctUntilKeyChanged(key,compare){return distinctUntilChanged_1.distinctUntilChanged(function(x,y){return compare?compare(x[key],y[key]):x[key]===y[key]})}
exports.distinctUntilKeyChanged=distinctUntilKeyChanged},{"./distinctUntilChanged":122}],124:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ArgumentOutOfRangeError_1=require("../util/ArgumentOutOfRangeError");var filter_1=require("./filter");var throwIfEmpty_1=require("./throwIfEmpty");var defaultIfEmpty_1=require("./defaultIfEmpty");var take_1=require("./take");function elementAt(index,defaultValue){if(index<0){throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError()}
var hasDefaultValue=arguments.length>=2;return function(source){return source.pipe(filter_1.filter(function(v,i){return i===index}),take_1.take(1),hasDefaultValue?defaultIfEmpty_1.defaultIfEmpty(defaultValue):throwIfEmpty_1.throwIfEmpty(function(){return new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError()}))}}
exports.elementAt=elementAt},{"../util/ArgumentOutOfRangeError":225,"./defaultIfEmpty":117,"./filter":130,"./take":182,"./throwIfEmpty":189}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var concat_1=require("../observable/concat");var of_1=require("../observable/of");function endWith(){var array=[];for(var _i=0;_i<arguments.length;_i++){array[_i]=arguments[_i]}
return function(source){return concat_1.concat(source,of_1.of.apply(void 0,array))}}
exports.endWith=endWith},{"../observable/concat":77,"../observable/of":90}],126:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function every(predicate,thisArg){return function(source){return source.lift(new EveryOperator(predicate,thisArg,source))}}
exports.every=every;var EveryOperator=(function(){function EveryOperator(predicate,thisArg,source){this.predicate=predicate;this.thisArg=thisArg;this.source=source}
EveryOperator.prototype.call=function(observer,source){return source.subscribe(new EverySubscriber(observer,this.predicate,this.thisArg,this.source))};return EveryOperator}());var EverySubscriber=(function(_super){__extends(EverySubscriber,_super);function EverySubscriber(destination,predicate,thisArg,source){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.thisArg=thisArg;_this.source=source;_this.index=0;_this.thisArg=thisArg||_this;return _this}
EverySubscriber.prototype.notifyComplete=function(everyValueMatch){this.destination.next(everyValueMatch);this.destination.complete()};EverySubscriber.prototype._next=function(value){var result=!1;try{result=this.predicate.call(this.thisArg,value,this.index++,this.source)}catch(err){this.destination.error(err);return}
if(!result){this.notifyComplete(!1)}};EverySubscriber.prototype._complete=function(){this.notifyComplete(!0)};return EverySubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],127:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function exhaust(){return function(source){return source.lift(new SwitchFirstOperator())}}
exports.exhaust=exhaust;var SwitchFirstOperator=(function(){function SwitchFirstOperator(){}
SwitchFirstOperator.prototype.call=function(subscriber,source){return source.subscribe(new SwitchFirstSubscriber(subscriber))};return SwitchFirstOperator}());var SwitchFirstSubscriber=(function(_super){__extends(SwitchFirstSubscriber,_super);function SwitchFirstSubscriber(destination){var _this=_super.call(this,destination)||this;_this.hasCompleted=!1;_this.hasSubscription=!1;return _this}
SwitchFirstSubscriber.prototype._next=function(value){if(!this.hasSubscription){this.hasSubscription=!0;this.add(innerSubscribe_1.innerSubscribe(value,new innerSubscribe_1.SimpleInnerSubscriber(this)))}};SwitchFirstSubscriber.prototype._complete=function(){this.hasCompleted=!0;if(!this.hasSubscription){this.destination.complete()}};SwitchFirstSubscriber.prototype.notifyComplete=function(){this.hasSubscription=!1;if(this.hasCompleted){this.destination.complete()}};return SwitchFirstSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],128:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var map_1=require("./map");var from_1=require("../observable/from");var innerSubscribe_1=require("../innerSubscribe");function exhaustMap(project,resultSelector){if(resultSelector){return function(source){return source.pipe(exhaustMap(function(a,i){return from_1.from(project(a,i)).pipe(map_1.map(function(b,ii){return resultSelector(a,b,i,ii)}))}))}}
return function(source){return source.lift(new ExhaustMapOperator(project))}}
exports.exhaustMap=exhaustMap;var ExhaustMapOperator=(function(){function ExhaustMapOperator(project){this.project=project}
ExhaustMapOperator.prototype.call=function(subscriber,source){return source.subscribe(new ExhaustMapSubscriber(subscriber,this.project))};return ExhaustMapOperator}());var ExhaustMapSubscriber=(function(_super){__extends(ExhaustMapSubscriber,_super);function ExhaustMapSubscriber(destination,project){var _this=_super.call(this,destination)||this;_this.project=project;_this.hasSubscription=!1;_this.hasCompleted=!1;_this.index=0;return _this}
ExhaustMapSubscriber.prototype._next=function(value){if(!this.hasSubscription){this.tryNext(value)}};ExhaustMapSubscriber.prototype.tryNext=function(value){var result;var index=this.index++;try{result=this.project(value,index)}catch(err){this.destination.error(err);return}
this.hasSubscription=!0;this._innerSub(result)};ExhaustMapSubscriber.prototype._innerSub=function(result){var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(this);var destination=this.destination;destination.add(innerSubscriber);var innerSubscription=innerSubscribe_1.innerSubscribe(result,innerSubscriber);if(innerSubscription!==innerSubscriber){destination.add(innerSubscription)}};ExhaustMapSubscriber.prototype._complete=function(){this.hasCompleted=!0;if(!this.hasSubscription){this.destination.complete()}
this.unsubscribe()};ExhaustMapSubscriber.prototype.notifyNext=function(innerValue){this.destination.next(innerValue)};ExhaustMapSubscriber.prototype.notifyError=function(err){this.destination.error(err)};ExhaustMapSubscriber.prototype.notifyComplete=function(){this.hasSubscription=!1;if(this.hasCompleted){this.destination.complete()}};return ExhaustMapSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71,"../observable/from":81,"./map":139}],129:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function expand(project,concurrent,scheduler){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
concurrent=(concurrent||0)<1?Number.POSITIVE_INFINITY:concurrent;return function(source){return source.lift(new ExpandOperator(project,concurrent,scheduler))}}
exports.expand=expand;var ExpandOperator=(function(){function ExpandOperator(project,concurrent,scheduler){this.project=project;this.concurrent=concurrent;this.scheduler=scheduler}
ExpandOperator.prototype.call=function(subscriber,source){return source.subscribe(new ExpandSubscriber(subscriber,this.project,this.concurrent,this.scheduler))};return ExpandOperator}());exports.ExpandOperator=ExpandOperator;var ExpandSubscriber=(function(_super){__extends(ExpandSubscriber,_super);function ExpandSubscriber(destination,project,concurrent,scheduler){var _this=_super.call(this,destination)||this;_this.project=project;_this.concurrent=concurrent;_this.scheduler=scheduler;_this.index=0;_this.active=0;_this.hasCompleted=!1;if(concurrent<Number.POSITIVE_INFINITY){_this.buffer=[]}
return _this}
ExpandSubscriber.dispatch=function(arg){var subscriber=arg.subscriber,result=arg.result,value=arg.value,index=arg.index;subscriber.subscribeToProjection(result,value,index)};ExpandSubscriber.prototype._next=function(value){var destination=this.destination;if(destination.closed){this._complete();return}
var index=this.index++;if(this.active<this.concurrent){destination.next(value);try{var project=this.project;var result=project(value,index);if(!this.scheduler){this.subscribeToProjection(result,value,index)}else{var state={subscriber:this,result:result,value:value,index:index};var destination_1=this.destination;destination_1.add(this.scheduler.schedule(ExpandSubscriber.dispatch,0,state))}}catch(e){destination.error(e)}}else{this.buffer.push(value)}};ExpandSubscriber.prototype.subscribeToProjection=function(result,value,index){this.active++;var destination=this.destination;destination.add(innerSubscribe_1.innerSubscribe(result,new innerSubscribe_1.SimpleInnerSubscriber(this)))};ExpandSubscriber.prototype._complete=function(){this.hasCompleted=!0;if(this.hasCompleted&&this.active===0){this.destination.complete()}
this.unsubscribe()};ExpandSubscriber.prototype.notifyNext=function(innerValue){this._next(innerValue)};ExpandSubscriber.prototype.notifyComplete=function(){var buffer=this.buffer;this.active--;if(buffer&&buffer.length>0){this._next(buffer.shift())}
if(this.hasCompleted&&this.active===0){this.destination.complete()}};return ExpandSubscriber}(innerSubscribe_1.SimpleOuterSubscriber));exports.ExpandSubscriber=ExpandSubscriber},{"../innerSubscribe":71}],130:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function filter(predicate,thisArg){return function filterOperatorFunction(source){return source.lift(new FilterOperator(predicate,thisArg))}}
exports.filter=filter;var FilterOperator=(function(){function FilterOperator(predicate,thisArg){this.predicate=predicate;this.thisArg=thisArg}
FilterOperator.prototype.call=function(subscriber,source){return source.subscribe(new FilterSubscriber(subscriber,this.predicate,this.thisArg))};return FilterOperator}());var FilterSubscriber=(function(_super){__extends(FilterSubscriber,_super);function FilterSubscriber(destination,predicate,thisArg){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.thisArg=thisArg;_this.count=0;return _this}
FilterSubscriber.prototype._next=function(value){var result;try{result=this.predicate.call(this.thisArg,value,this.count++)}catch(err){this.destination.error(err);return}
if(result){this.destination.next(value)}};return FilterSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],131:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var Subscription_1=require("../Subscription");function finalize(callback){return function(source){return source.lift(new FinallyOperator(callback))}}
exports.finalize=finalize;var FinallyOperator=(function(){function FinallyOperator(callback){this.callback=callback}
FinallyOperator.prototype.call=function(subscriber,source){return source.subscribe(new FinallySubscriber(subscriber,this.callback))};return FinallyOperator}());var FinallySubscriber=(function(_super){__extends(FinallySubscriber,_super);function FinallySubscriber(destination,callback){var _this=_super.call(this,destination)||this;_this.add(new Subscription_1.Subscription(callback));return _this}
return FinallySubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../Subscription":69}],132:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function find(predicate,thisArg){if(typeof predicate!=='function'){throw new TypeError('predicate is not a function')}
return function(source){return source.lift(new FindValueOperator(predicate,source,!1,thisArg))}}
exports.find=find;var FindValueOperator=(function(){function FindValueOperator(predicate,source,yieldIndex,thisArg){this.predicate=predicate;this.source=source;this.yieldIndex=yieldIndex;this.thisArg=thisArg}
FindValueOperator.prototype.call=function(observer,source){return source.subscribe(new FindValueSubscriber(observer,this.predicate,this.source,this.yieldIndex,this.thisArg))};return FindValueOperator}());exports.FindValueOperator=FindValueOperator;var FindValueSubscriber=(function(_super){__extends(FindValueSubscriber,_super);function FindValueSubscriber(destination,predicate,source,yieldIndex,thisArg){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.source=source;_this.yieldIndex=yieldIndex;_this.thisArg=thisArg;_this.index=0;return _this}
FindValueSubscriber.prototype.notifyComplete=function(value){var destination=this.destination;destination.next(value);destination.complete();this.unsubscribe()};FindValueSubscriber.prototype._next=function(value){var _a=this,predicate=_a.predicate,thisArg=_a.thisArg;var index=this.index++;try{var result=predicate.call(thisArg||this,value,index,this.source);if(result){this.notifyComplete(this.yieldIndex?index:value)}}catch(err){this.destination.error(err)}};FindValueSubscriber.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:undefined)};return FindValueSubscriber}(Subscriber_1.Subscriber));exports.FindValueSubscriber=FindValueSubscriber},{"../Subscriber":68}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var find_1=require("../operators/find");function findIndex(predicate,thisArg){return function(source){return source.lift(new find_1.FindValueOperator(predicate,source,!0,thisArg))}}
exports.findIndex=findIndex},{"../operators/find":132}],134:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var EmptyError_1=require("../util/EmptyError");var filter_1=require("./filter");var take_1=require("./take");var defaultIfEmpty_1=require("./defaultIfEmpty");var throwIfEmpty_1=require("./throwIfEmpty");var identity_1=require("../util/identity");function first(predicate,defaultValue){var hasDefaultValue=arguments.length>=2;return function(source){return source.pipe(predicate?filter_1.filter(function(v,i){return predicate(v,i,source)}):identity_1.identity,take_1.take(1),hasDefaultValue?defaultIfEmpty_1.defaultIfEmpty(defaultValue):throwIfEmpty_1.throwIfEmpty(function(){return new EmptyError_1.EmptyError()}))}}
exports.first=first},{"../util/EmptyError":226,"../util/identity":233,"./defaultIfEmpty":117,"./filter":130,"./take":182,"./throwIfEmpty":189}],135:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var Subscription_1=require("../Subscription");var Observable_1=require("../Observable");var Subject_1=require("../Subject");function groupBy(keySelector,elementSelector,durationSelector,subjectSelector){return function(source){return source.lift(new GroupByOperator(keySelector,elementSelector,durationSelector,subjectSelector))}}
exports.groupBy=groupBy;var GroupByOperator=(function(){function GroupByOperator(keySelector,elementSelector,durationSelector,subjectSelector){this.keySelector=keySelector;this.elementSelector=elementSelector;this.durationSelector=durationSelector;this.subjectSelector=subjectSelector}
GroupByOperator.prototype.call=function(subscriber,source){return source.subscribe(new GroupBySubscriber(subscriber,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))};return GroupByOperator}());var GroupBySubscriber=(function(_super){__extends(GroupBySubscriber,_super);function GroupBySubscriber(destination,keySelector,elementSelector,durationSelector,subjectSelector){var _this=_super.call(this,destination)||this;_this.keySelector=keySelector;_this.elementSelector=elementSelector;_this.durationSelector=durationSelector;_this.subjectSelector=subjectSelector;_this.groups=null;_this.attemptedToUnsubscribe=!1;_this.count=0;return _this}
GroupBySubscriber.prototype._next=function(value){var key;try{key=this.keySelector(value)}catch(err){this.error(err);return}
this._group(value,key)};GroupBySubscriber.prototype._group=function(value,key){var groups=this.groups;if(!groups){groups=this.groups=new Map()}
var group=groups.get(key);var element;if(this.elementSelector){try{element=this.elementSelector(value)}catch(err){this.error(err)}}else{element=value}
if(!group){group=(this.subjectSelector?this.subjectSelector():new Subject_1.Subject());groups.set(key,group);var groupedObservable=new GroupedObservable(key,group,this);this.destination.next(groupedObservable);if(this.durationSelector){var duration=void 0;try{duration=this.durationSelector(new GroupedObservable(key,group))}catch(err){this.error(err);return}
this.add(duration.subscribe(new GroupDurationSubscriber(key,group,this)))}}
if(!group.closed){group.next(element)}};GroupBySubscriber.prototype._error=function(err){var groups=this.groups;if(groups){groups.forEach(function(group,key){group.error(err)});groups.clear()}
this.destination.error(err)};GroupBySubscriber.prototype._complete=function(){var groups=this.groups;if(groups){groups.forEach(function(group,key){group.complete()});groups.clear()}
this.destination.complete()};GroupBySubscriber.prototype.removeGroup=function(key){this.groups.delete(key)};GroupBySubscriber.prototype.unsubscribe=function(){if(!this.closed){this.attemptedToUnsubscribe=!0;if(this.count===0){_super.prototype.unsubscribe.call(this)}}};return GroupBySubscriber}(Subscriber_1.Subscriber));var GroupDurationSubscriber=(function(_super){__extends(GroupDurationSubscriber,_super);function GroupDurationSubscriber(key,group,parent){var _this=_super.call(this,group)||this;_this.key=key;_this.group=group;_this.parent=parent;return _this}
GroupDurationSubscriber.prototype._next=function(value){this.complete()};GroupDurationSubscriber.prototype._unsubscribe=function(){var _a=this,parent=_a.parent,key=_a.key;this.key=this.parent=null;if(parent){parent.removeGroup(key)}};return GroupDurationSubscriber}(Subscriber_1.Subscriber));var GroupedObservable=(function(_super){__extends(GroupedObservable,_super);function GroupedObservable(key,groupSubject,refCountSubscription){var _this=_super.call(this)||this;_this.key=key;_this.groupSubject=groupSubject;_this.refCountSubscription=refCountSubscription;return _this}
GroupedObservable.prototype._subscribe=function(subscriber){var subscription=new Subscription_1.Subscription();var _a=this,refCountSubscription=_a.refCountSubscription,groupSubject=_a.groupSubject;if(refCountSubscription&&!refCountSubscription.closed){subscription.add(new InnerRefCountSubscription(refCountSubscription))}
subscription.add(groupSubject.subscribe(subscriber));return subscription};return GroupedObservable}(Observable_1.Observable));exports.GroupedObservable=GroupedObservable;var InnerRefCountSubscription=(function(_super){__extends(InnerRefCountSubscription,_super);function InnerRefCountSubscription(parent){var _this=_super.call(this)||this;_this.parent=parent;parent.count++;return _this}
InnerRefCountSubscription.prototype.unsubscribe=function(){var parent=this.parent;if(!parent.closed&&!this.closed){_super.prototype.unsubscribe.call(this);parent.count-=1;if(parent.count===0&&parent.attemptedToUnsubscribe){parent.unsubscribe()}}};return InnerRefCountSubscription}(Subscription_1.Subscription))},{"../Observable":61,"../Subject":66,"../Subscriber":68,"../Subscription":69}],136:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function ignoreElements(){return function ignoreElementsOperatorFunction(source){return source.lift(new IgnoreElementsOperator())}}
exports.ignoreElements=ignoreElements;var IgnoreElementsOperator=(function(){function IgnoreElementsOperator(){}
IgnoreElementsOperator.prototype.call=function(subscriber,source){return source.subscribe(new IgnoreElementsSubscriber(subscriber))};return IgnoreElementsOperator}());var IgnoreElementsSubscriber=(function(_super){__extends(IgnoreElementsSubscriber,_super);function IgnoreElementsSubscriber(){return _super!==null&&_super.apply(this,arguments)||this}
IgnoreElementsSubscriber.prototype._next=function(unused){};return IgnoreElementsSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],137:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function isEmpty(){return function(source){return source.lift(new IsEmptyOperator())}}
exports.isEmpty=isEmpty;var IsEmptyOperator=(function(){function IsEmptyOperator(){}
IsEmptyOperator.prototype.call=function(observer,source){return source.subscribe(new IsEmptySubscriber(observer))};return IsEmptyOperator}());var IsEmptySubscriber=(function(_super){__extends(IsEmptySubscriber,_super);function IsEmptySubscriber(destination){return _super.call(this,destination)||this}
IsEmptySubscriber.prototype.notifyComplete=function(isEmpty){var destination=this.destination;destination.next(isEmpty);destination.complete()};IsEmptySubscriber.prototype._next=function(value){this.notifyComplete(!1)};IsEmptySubscriber.prototype._complete=function(){this.notifyComplete(!0)};return IsEmptySubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],138:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var EmptyError_1=require("../util/EmptyError");var filter_1=require("./filter");var takeLast_1=require("./takeLast");var throwIfEmpty_1=require("./throwIfEmpty");var defaultIfEmpty_1=require("./defaultIfEmpty");var identity_1=require("../util/identity");function last(predicate,defaultValue){var hasDefaultValue=arguments.length>=2;return function(source){return source.pipe(predicate?filter_1.filter(function(v,i){return predicate(v,i,source)}):identity_1.identity,takeLast_1.takeLast(1),hasDefaultValue?defaultIfEmpty_1.defaultIfEmpty(defaultValue):throwIfEmpty_1.throwIfEmpty(function(){return new EmptyError_1.EmptyError()}))}}
exports.last=last},{"../util/EmptyError":226,"../util/identity":233,"./defaultIfEmpty":117,"./filter":130,"./takeLast":183,"./throwIfEmpty":189}],139:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function map(project,thisArg){return function mapOperation(source){if(typeof project!=='function'){throw new TypeError('argument is not a function. Are you looking for `mapTo()`?')}
return source.lift(new MapOperator(project,thisArg))}}
exports.map=map;var MapOperator=(function(){function MapOperator(project,thisArg){this.project=project;this.thisArg=thisArg}
MapOperator.prototype.call=function(subscriber,source){return source.subscribe(new MapSubscriber(subscriber,this.project,this.thisArg))};return MapOperator}());exports.MapOperator=MapOperator;var MapSubscriber=(function(_super){__extends(MapSubscriber,_super);function MapSubscriber(destination,project,thisArg){var _this=_super.call(this,destination)||this;_this.project=project;_this.count=0;_this.thisArg=thisArg||_this;return _this}
MapSubscriber.prototype._next=function(value){var result;try{result=this.project.call(this.thisArg,value,this.count++)}catch(err){this.destination.error(err);return}
this.destination.next(result)};return MapSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],140:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function mapTo(value){return function(source){return source.lift(new MapToOperator(value))}}
exports.mapTo=mapTo;var MapToOperator=(function(){function MapToOperator(value){this.value=value}
MapToOperator.prototype.call=function(subscriber,source){return source.subscribe(new MapToSubscriber(subscriber,this.value))};return MapToOperator}());var MapToSubscriber=(function(_super){__extends(MapToSubscriber,_super);function MapToSubscriber(destination,value){var _this=_super.call(this,destination)||this;_this.value=value;return _this}
MapToSubscriber.prototype._next=function(x){this.destination.next(this.value)};return MapToSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],141:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var Notification_1=require("../Notification");function materialize(){return function materializeOperatorFunction(source){return source.lift(new MaterializeOperator())}}
exports.materialize=materialize;var MaterializeOperator=(function(){function MaterializeOperator(){}
MaterializeOperator.prototype.call=function(subscriber,source){return source.subscribe(new MaterializeSubscriber(subscriber))};return MaterializeOperator}());var MaterializeSubscriber=(function(_super){__extends(MaterializeSubscriber,_super);function MaterializeSubscriber(destination){return _super.call(this,destination)||this}
MaterializeSubscriber.prototype._next=function(value){this.destination.next(Notification_1.Notification.createNext(value))};MaterializeSubscriber.prototype._error=function(err){var destination=this.destination;destination.next(Notification_1.Notification.createError(err));destination.complete()};MaterializeSubscriber.prototype._complete=function(){var destination=this.destination;destination.next(Notification_1.Notification.createComplete());destination.complete()};return MaterializeSubscriber}(Subscriber_1.Subscriber))},{"../Notification":60,"../Subscriber":68}],142:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var reduce_1=require("./reduce");function max(comparer){var max=(typeof comparer==='function')?function(x,y){return comparer(x,y)>0?x:y}:function(x,y){return x>y?x:y};return reduce_1.reduce(max)}
exports.max=max},{"./reduce":160}],143:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var merge_1=require("../observable/merge");function merge(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
return function(source){return source.lift.call(merge_1.merge.apply(void 0,[source].concat(observables)))}}
exports.merge=merge},{"../observable/merge":88}],144:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var mergeMap_1=require("./mergeMap");var identity_1=require("../util/identity");function mergeAll(concurrent){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
return mergeMap_1.mergeMap(identity_1.identity,concurrent)}
exports.mergeAll=mergeAll},{"../util/identity":233,"./mergeMap":145}],145:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var map_1=require("./map");var from_1=require("../observable/from");var innerSubscribe_1=require("../innerSubscribe");function mergeMap(project,resultSelector,concurrent){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
if(typeof resultSelector==='function'){return function(source){return source.pipe(mergeMap(function(a,i){return from_1.from(project(a,i)).pipe(map_1.map(function(b,ii){return resultSelector(a,b,i,ii)}))},concurrent))}}else if(typeof resultSelector==='number'){concurrent=resultSelector}
return function(source){return source.lift(new MergeMapOperator(project,concurrent))}}
exports.mergeMap=mergeMap;var MergeMapOperator=(function(){function MergeMapOperator(project,concurrent){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
this.project=project;this.concurrent=concurrent}
MergeMapOperator.prototype.call=function(observer,source){return source.subscribe(new MergeMapSubscriber(observer,this.project,this.concurrent))};return MergeMapOperator}());exports.MergeMapOperator=MergeMapOperator;var MergeMapSubscriber=(function(_super){__extends(MergeMapSubscriber,_super);function MergeMapSubscriber(destination,project,concurrent){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
var _this=_super.call(this,destination)||this;_this.project=project;_this.concurrent=concurrent;_this.hasCompleted=!1;_this.buffer=[];_this.active=0;_this.index=0;return _this}
MergeMapSubscriber.prototype._next=function(value){if(this.active<this.concurrent){this._tryNext(value)}else{this.buffer.push(value)}};MergeMapSubscriber.prototype._tryNext=function(value){var result;var index=this.index++;try{result=this.project(value,index)}catch(err){this.destination.error(err);return}
this.active++;this._innerSub(result)};MergeMapSubscriber.prototype._innerSub=function(ish){var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(this);var destination=this.destination;destination.add(innerSubscriber);var innerSubscription=innerSubscribe_1.innerSubscribe(ish,innerSubscriber);if(innerSubscription!==innerSubscriber){destination.add(innerSubscription)}};MergeMapSubscriber.prototype._complete=function(){this.hasCompleted=!0;if(this.active===0&&this.buffer.length===0){this.destination.complete()}
this.unsubscribe()};MergeMapSubscriber.prototype.notifyNext=function(innerValue){this.destination.next(innerValue)};MergeMapSubscriber.prototype.notifyComplete=function(){var buffer=this.buffer;this.active--;if(buffer.length>0){this._next(buffer.shift())}else if(this.active===0&&this.hasCompleted){this.destination.complete()}};return MergeMapSubscriber}(innerSubscribe_1.SimpleOuterSubscriber));exports.MergeMapSubscriber=MergeMapSubscriber;exports.flatMap=mergeMap},{"../innerSubscribe":71,"../observable/from":81,"./map":139}],146:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var mergeMap_1=require("./mergeMap");function mergeMapTo(innerObservable,resultSelector,concurrent){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
if(typeof resultSelector==='function'){return mergeMap_1.mergeMap(function(){return innerObservable},resultSelector,concurrent)}
if(typeof resultSelector==='number'){concurrent=resultSelector}
return mergeMap_1.mergeMap(function(){return innerObservable},concurrent)}
exports.mergeMapTo=mergeMapTo},{"./mergeMap":145}],147:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function mergeScan(accumulator,seed,concurrent){if(concurrent===void 0){concurrent=Number.POSITIVE_INFINITY}
return function(source){return source.lift(new MergeScanOperator(accumulator,seed,concurrent))}}
exports.mergeScan=mergeScan;var MergeScanOperator=(function(){function MergeScanOperator(accumulator,seed,concurrent){this.accumulator=accumulator;this.seed=seed;this.concurrent=concurrent}
MergeScanOperator.prototype.call=function(subscriber,source){return source.subscribe(new MergeScanSubscriber(subscriber,this.accumulator,this.seed,this.concurrent))};return MergeScanOperator}());exports.MergeScanOperator=MergeScanOperator;var MergeScanSubscriber=(function(_super){__extends(MergeScanSubscriber,_super);function MergeScanSubscriber(destination,accumulator,acc,concurrent){var _this=_super.call(this,destination)||this;_this.accumulator=accumulator;_this.acc=acc;_this.concurrent=concurrent;_this.hasValue=!1;_this.hasCompleted=!1;_this.buffer=[];_this.active=0;_this.index=0;return _this}
MergeScanSubscriber.prototype._next=function(value){if(this.active<this.concurrent){var index=this.index++;var destination=this.destination;var ish=void 0;try{var accumulator=this.accumulator;ish=accumulator(this.acc,value,index)}catch(e){return destination.error(e)}
this.active++;this._innerSub(ish)}else{this.buffer.push(value)}};MergeScanSubscriber.prototype._innerSub=function(ish){var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(this);var destination=this.destination;destination.add(innerSubscriber);var innerSubscription=innerSubscribe_1.innerSubscribe(ish,innerSubscriber);if(innerSubscription!==innerSubscriber){destination.add(innerSubscription)}};MergeScanSubscriber.prototype._complete=function(){this.hasCompleted=!0;if(this.active===0&&this.buffer.length===0){if(this.hasValue===!1){this.destination.next(this.acc)}
this.destination.complete()}
this.unsubscribe()};MergeScanSubscriber.prototype.notifyNext=function(innerValue){var destination=this.destination;this.acc=innerValue;this.hasValue=!0;destination.next(innerValue)};MergeScanSubscriber.prototype.notifyComplete=function(){var buffer=this.buffer;this.active--;if(buffer.length>0){this._next(buffer.shift())}else if(this.active===0&&this.hasCompleted){if(this.hasValue===!1){this.destination.next(this.acc)}
this.destination.complete()}};return MergeScanSubscriber}(innerSubscribe_1.SimpleOuterSubscriber));exports.MergeScanSubscriber=MergeScanSubscriber},{"../innerSubscribe":71}],148:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var reduce_1=require("./reduce");function min(comparer){var min=(typeof comparer==='function')?function(x,y){return comparer(x,y)<0?x:y}:function(x,y){return x<y?x:y};return reduce_1.reduce(min)}
exports.min=min},{"./reduce":160}],149:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ConnectableObservable_1=require("../observable/ConnectableObservable");function multicast(subjectOrSubjectFactory,selector){return function multicastOperatorFunction(source){var subjectFactory;if(typeof subjectOrSubjectFactory==='function'){subjectFactory=subjectOrSubjectFactory}else{subjectFactory=function subjectFactory(){return subjectOrSubjectFactory}}
if(typeof selector==='function'){return source.lift(new MulticastOperator(subjectFactory,selector))}
var connectable=Object.create(source,ConnectableObservable_1.connectableObservableDescriptor);connectable.source=source;connectable.subjectFactory=subjectFactory;return connectable}}
exports.multicast=multicast;var MulticastOperator=(function(){function MulticastOperator(subjectFactory,selector){this.subjectFactory=subjectFactory;this.selector=selector}
MulticastOperator.prototype.call=function(subscriber,source){var selector=this.selector;var subject=this.subjectFactory();var subscription=selector(subject).subscribe(subscriber);subscription.add(source.subscribe(subject));return subscription};return MulticastOperator}());exports.MulticastOperator=MulticastOperator},{"../observable/ConnectableObservable":72}],150:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var Notification_1=require("../Notification");function observeOn(scheduler,delay){if(delay===void 0){delay=0}
return function observeOnOperatorFunction(source){return source.lift(new ObserveOnOperator(scheduler,delay))}}
exports.observeOn=observeOn;var ObserveOnOperator=(function(){function ObserveOnOperator(scheduler,delay){if(delay===void 0){delay=0}
this.scheduler=scheduler;this.delay=delay}
ObserveOnOperator.prototype.call=function(subscriber,source){return source.subscribe(new ObserveOnSubscriber(subscriber,this.scheduler,this.delay))};return ObserveOnOperator}());exports.ObserveOnOperator=ObserveOnOperator;var ObserveOnSubscriber=(function(_super){__extends(ObserveOnSubscriber,_super);function ObserveOnSubscriber(destination,scheduler,delay){if(delay===void 0){delay=0}
var _this=_super.call(this,destination)||this;_this.scheduler=scheduler;_this.delay=delay;return _this}
ObserveOnSubscriber.dispatch=function(arg){var notification=arg.notification,destination=arg.destination;notification.observe(destination);this.unsubscribe()};ObserveOnSubscriber.prototype.scheduleMessage=function(notification){var destination=this.destination;destination.add(this.scheduler.schedule(ObserveOnSubscriber.dispatch,this.delay,new ObserveOnMessage(notification,this.destination)))};ObserveOnSubscriber.prototype._next=function(value){this.scheduleMessage(Notification_1.Notification.createNext(value))};ObserveOnSubscriber.prototype._error=function(err){this.scheduleMessage(Notification_1.Notification.createError(err));this.unsubscribe()};ObserveOnSubscriber.prototype._complete=function(){this.scheduleMessage(Notification_1.Notification.createComplete());this.unsubscribe()};return ObserveOnSubscriber}(Subscriber_1.Subscriber));exports.ObserveOnSubscriber=ObserveOnSubscriber;var ObserveOnMessage=(function(){function ObserveOnMessage(notification,destination){this.notification=notification;this.destination=destination}
return ObserveOnMessage}());exports.ObserveOnMessage=ObserveOnMessage},{"../Notification":60,"../Subscriber":68}],151:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var from_1=require("../observable/from");var isArray_1=require("../util/isArray");var innerSubscribe_1=require("../innerSubscribe");function onErrorResumeNext(){var nextSources=[];for(var _i=0;_i<arguments.length;_i++){nextSources[_i]=arguments[_i]}
if(nextSources.length===1&&isArray_1.isArray(nextSources[0])){nextSources=nextSources[0]}
return function(source){return source.lift(new OnErrorResumeNextOperator(nextSources))}}
exports.onErrorResumeNext=onErrorResumeNext;function onErrorResumeNextStatic(){var nextSources=[];for(var _i=0;_i<arguments.length;_i++){nextSources[_i]=arguments[_i]}
var source=undefined;if(nextSources.length===1&&isArray_1.isArray(nextSources[0])){nextSources=nextSources[0]}
source=nextSources.shift();return from_1.from(source).lift(new OnErrorResumeNextOperator(nextSources))}
exports.onErrorResumeNextStatic=onErrorResumeNextStatic;var OnErrorResumeNextOperator=(function(){function OnErrorResumeNextOperator(nextSources){this.nextSources=nextSources}
OnErrorResumeNextOperator.prototype.call=function(subscriber,source){return source.subscribe(new OnErrorResumeNextSubscriber(subscriber,this.nextSources))};return OnErrorResumeNextOperator}());var OnErrorResumeNextSubscriber=(function(_super){__extends(OnErrorResumeNextSubscriber,_super);function OnErrorResumeNextSubscriber(destination,nextSources){var _this=_super.call(this,destination)||this;_this.destination=destination;_this.nextSources=nextSources;return _this}
OnErrorResumeNextSubscriber.prototype.notifyError=function(){this.subscribeToNextSource()};OnErrorResumeNextSubscriber.prototype.notifyComplete=function(){this.subscribeToNextSource()};OnErrorResumeNextSubscriber.prototype._error=function(err){this.subscribeToNextSource();this.unsubscribe()};OnErrorResumeNextSubscriber.prototype._complete=function(){this.subscribeToNextSource();this.unsubscribe()};OnErrorResumeNextSubscriber.prototype.subscribeToNextSource=function(){var next=this.nextSources.shift();if(!!next){var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(this);var destination=this.destination;destination.add(innerSubscriber);var innerSubscription=innerSubscribe_1.innerSubscribe(next,innerSubscriber);if(innerSubscription!==innerSubscriber){destination.add(innerSubscription)}}else{this.destination.complete()}};return OnErrorResumeNextSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71,"../observable/from":81,"../util/isArray":234}],152:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function pairwise(){return function(source){return source.lift(new PairwiseOperator())}}
exports.pairwise=pairwise;var PairwiseOperator=(function(){function PairwiseOperator(){}
PairwiseOperator.prototype.call=function(subscriber,source){return source.subscribe(new PairwiseSubscriber(subscriber))};return PairwiseOperator}());var PairwiseSubscriber=(function(_super){__extends(PairwiseSubscriber,_super);function PairwiseSubscriber(destination){var _this=_super.call(this,destination)||this;_this.hasPrev=!1;return _this}
PairwiseSubscriber.prototype._next=function(value){var pair;if(this.hasPrev){pair=[this.prev,value]}else{this.hasPrev=!0}
this.prev=value;if(pair){this.destination.next(pair)}};return PairwiseSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],153:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var not_1=require("../util/not");var filter_1=require("./filter");function partition(predicate,thisArg){return function(source){return[filter_1.filter(predicate,thisArg)(source),filter_1.filter(not_1.not(predicate,thisArg))(source)]}}
exports.partition=partition},{"../util/not":246,"./filter":130}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var map_1=require("./map");function pluck(){var properties=[];for(var _i=0;_i<arguments.length;_i++){properties[_i]=arguments[_i]}
var length=properties.length;if(length===0){throw new Error('list of properties cannot be empty.')}
return function(source){return map_1.map(plucker(properties,length))(source)}}
exports.pluck=pluck;function plucker(props,length){var mapper=function(x){var currentProp=x;for(var i=0;i<length;i++){var p=currentProp!=null?currentProp[props[i]]:undefined;if(p!==void 0){currentProp=p}else{return undefined}}
return currentProp};return mapper}},{"./map":139}],155:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var multicast_1=require("./multicast");function publish(selector){return selector?multicast_1.multicast(function(){return new Subject_1.Subject()},selector):multicast_1.multicast(new Subject_1.Subject())}
exports.publish=publish},{"../Subject":66,"./multicast":149}],156:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BehaviorSubject_1=require("../BehaviorSubject");var multicast_1=require("./multicast");function publishBehavior(value){return function(source){return multicast_1.multicast(new BehaviorSubject_1.BehaviorSubject(value))(source)}}
exports.publishBehavior=publishBehavior},{"../BehaviorSubject":58,"./multicast":149}],157:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var AsyncSubject_1=require("../AsyncSubject");var multicast_1=require("./multicast");function publishLast(){return function(source){return multicast_1.multicast(new AsyncSubject_1.AsyncSubject())(source)}}
exports.publishLast=publishLast},{"../AsyncSubject":57,"./multicast":149}],158:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ReplaySubject_1=require("../ReplaySubject");var multicast_1=require("./multicast");function publishReplay(bufferSize,windowTime,selectorOrScheduler,scheduler){if(selectorOrScheduler&&typeof selectorOrScheduler!=='function'){scheduler=selectorOrScheduler}
var selector=typeof selectorOrScheduler==='function'?selectorOrScheduler:undefined;var subject=new ReplaySubject_1.ReplaySubject(bufferSize,windowTime,scheduler);return function(source){return multicast_1.multicast(function(){return subject},selector)(source)}}
exports.publishReplay=publishReplay},{"../ReplaySubject":64,"./multicast":149}],159:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isArray_1=require("../util/isArray");var race_1=require("../observable/race");function race(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
return function raceOperatorFunction(source){if(observables.length===1&&isArray_1.isArray(observables[0])){observables=observables[0]}
return source.lift.call(race_1.race.apply(void 0,[source].concat(observables)))}}
exports.race=race},{"../observable/race":94,"../util/isArray":234}],160:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var scan_1=require("./scan");var takeLast_1=require("./takeLast");var defaultIfEmpty_1=require("./defaultIfEmpty");var pipe_1=require("../util/pipe");function reduce(accumulator,seed){if(arguments.length>=2){return function reduceOperatorFunctionWithSeed(source){return pipe_1.pipe(scan_1.scan(accumulator,seed),takeLast_1.takeLast(1),defaultIfEmpty_1.defaultIfEmpty(seed))(source)}}
return function reduceOperatorFunction(source){return pipe_1.pipe(scan_1.scan(function(acc,value,index){return accumulator(acc,value,index+1)}),takeLast_1.takeLast(1))(source)}}
exports.reduce=reduce},{"../util/pipe":247,"./defaultIfEmpty":117,"./scan":168,"./takeLast":183}],161:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function refCount(){return function refCountOperatorFunction(source){return source.lift(new RefCountOperator(source))}}
exports.refCount=refCount;var RefCountOperator=(function(){function RefCountOperator(connectable){this.connectable=connectable}
RefCountOperator.prototype.call=function(subscriber,source){var connectable=this.connectable;connectable._refCount++;var refCounter=new RefCountSubscriber(subscriber,connectable);var subscription=source.subscribe(refCounter);if(!refCounter.closed){refCounter.connection=connectable.connect()}
return subscription};return RefCountOperator}());var RefCountSubscriber=(function(_super){__extends(RefCountSubscriber,_super);function RefCountSubscriber(destination,connectable){var _this=_super.call(this,destination)||this;_this.connectable=connectable;return _this}
RefCountSubscriber.prototype._unsubscribe=function(){var connectable=this.connectable;if(!connectable){this.connection=null;return}
this.connectable=null;var refCount=connectable._refCount;if(refCount<=0){this.connection=null;return}
connectable._refCount=refCount-1;if(refCount>1){this.connection=null;return}
var connection=this.connection;var sharedConnection=connectable._connection;this.connection=null;if(sharedConnection&&(!connection||sharedConnection===connection)){sharedConnection.unsubscribe()}};return RefCountSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],162:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var empty_1=require("../observable/empty");function repeat(count){if(count===void 0){count=-1}
return function(source){if(count===0){return empty_1.empty()}else if(count<0){return source.lift(new RepeatOperator(-1,source))}else{return source.lift(new RepeatOperator(count-1,source))}}}
exports.repeat=repeat;var RepeatOperator=(function(){function RepeatOperator(count,source){this.count=count;this.source=source}
RepeatOperator.prototype.call=function(subscriber,source){return source.subscribe(new RepeatSubscriber(subscriber,this.count,this.source))};return RepeatOperator}());var RepeatSubscriber=(function(_super){__extends(RepeatSubscriber,_super);function RepeatSubscriber(destination,count,source){var _this=_super.call(this,destination)||this;_this.count=count;_this.source=source;return _this}
RepeatSubscriber.prototype.complete=function(){if(!this.isStopped){var _a=this,source=_a.source,count=_a.count;if(count===0){return _super.prototype.complete.call(this)}else if(count>-1){this.count=count-1}
source.subscribe(this._unsubscribeAndRecycle())}};return RepeatSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../observable/empty":79}],163:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var innerSubscribe_1=require("../innerSubscribe");function repeatWhen(notifier){return function(source){return source.lift(new RepeatWhenOperator(notifier))}}
exports.repeatWhen=repeatWhen;var RepeatWhenOperator=(function(){function RepeatWhenOperator(notifier){this.notifier=notifier}
RepeatWhenOperator.prototype.call=function(subscriber,source){return source.subscribe(new RepeatWhenSubscriber(subscriber,this.notifier,source))};return RepeatWhenOperator}());var RepeatWhenSubscriber=(function(_super){__extends(RepeatWhenSubscriber,_super);function RepeatWhenSubscriber(destination,notifier,source){var _this=_super.call(this,destination)||this;_this.notifier=notifier;_this.source=source;_this.sourceIsBeingSubscribedTo=!0;return _this}
RepeatWhenSubscriber.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0;this.source.subscribe(this)};RepeatWhenSubscriber.prototype.notifyComplete=function(){if(this.sourceIsBeingSubscribedTo===!1){return _super.prototype.complete.call(this)}};RepeatWhenSubscriber.prototype.complete=function(){this.sourceIsBeingSubscribedTo=!1;if(!this.isStopped){if(!this.retries){this.subscribeToRetries()}
if(!this.retriesSubscription||this.retriesSubscription.closed){return _super.prototype.complete.call(this)}
this._unsubscribeAndRecycle();this.notifications.next(undefined)}};RepeatWhenSubscriber.prototype._unsubscribe=function(){var _a=this,notifications=_a.notifications,retriesSubscription=_a.retriesSubscription;if(notifications){notifications.unsubscribe();this.notifications=undefined}
if(retriesSubscription){retriesSubscription.unsubscribe();this.retriesSubscription=undefined}
this.retries=undefined};RepeatWhenSubscriber.prototype._unsubscribeAndRecycle=function(){var _unsubscribe=this._unsubscribe;this._unsubscribe=null;_super.prototype._unsubscribeAndRecycle.call(this);this._unsubscribe=_unsubscribe;return this};RepeatWhenSubscriber.prototype.subscribeToRetries=function(){this.notifications=new Subject_1.Subject();var retries;try{var notifier=this.notifier;retries=notifier(this.notifications)}catch(e){return _super.prototype.complete.call(this)}
this.retries=retries;this.retriesSubscription=innerSubscribe_1.innerSubscribe(retries,new innerSubscribe_1.SimpleInnerSubscriber(this))};return RepeatWhenSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../Subject":66,"../innerSubscribe":71}],164:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function retry(count){if(count===void 0){count=-1}
return function(source){return source.lift(new RetryOperator(count,source))}}
exports.retry=retry;var RetryOperator=(function(){function RetryOperator(count,source){this.count=count;this.source=source}
RetryOperator.prototype.call=function(subscriber,source){return source.subscribe(new RetrySubscriber(subscriber,this.count,this.source))};return RetryOperator}());var RetrySubscriber=(function(_super){__extends(RetrySubscriber,_super);function RetrySubscriber(destination,count,source){var _this=_super.call(this,destination)||this;_this.count=count;_this.source=source;return _this}
RetrySubscriber.prototype.error=function(err){if(!this.isStopped){var _a=this,source=_a.source,count=_a.count;if(count===0){return _super.prototype.error.call(this,err)}else if(count>-1){this.count=count-1}
source.subscribe(this._unsubscribeAndRecycle())}};return RetrySubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],165:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var innerSubscribe_1=require("../innerSubscribe");function retryWhen(notifier){return function(source){return source.lift(new RetryWhenOperator(notifier,source))}}
exports.retryWhen=retryWhen;var RetryWhenOperator=(function(){function RetryWhenOperator(notifier,source){this.notifier=notifier;this.source=source}
RetryWhenOperator.prototype.call=function(subscriber,source){return source.subscribe(new RetryWhenSubscriber(subscriber,this.notifier,this.source))};return RetryWhenOperator}());var RetryWhenSubscriber=(function(_super){__extends(RetryWhenSubscriber,_super);function RetryWhenSubscriber(destination,notifier,source){var _this=_super.call(this,destination)||this;_this.notifier=notifier;_this.source=source;return _this}
RetryWhenSubscriber.prototype.error=function(err){if(!this.isStopped){var errors=this.errors;var retries=this.retries;var retriesSubscription=this.retriesSubscription;if(!retries){errors=new Subject_1.Subject();try{var notifier=this.notifier;retries=notifier(errors)}catch(e){return _super.prototype.error.call(this,e)}
retriesSubscription=innerSubscribe_1.innerSubscribe(retries,new innerSubscribe_1.SimpleInnerSubscriber(this))}else{this.errors=undefined;this.retriesSubscription=undefined}
this._unsubscribeAndRecycle();this.errors=errors;this.retries=retries;this.retriesSubscription=retriesSubscription;errors.next(err)}};RetryWhenSubscriber.prototype._unsubscribe=function(){var _a=this,errors=_a.errors,retriesSubscription=_a.retriesSubscription;if(errors){errors.unsubscribe();this.errors=undefined}
if(retriesSubscription){retriesSubscription.unsubscribe();this.retriesSubscription=undefined}
this.retries=undefined};RetryWhenSubscriber.prototype.notifyNext=function(){var _unsubscribe=this._unsubscribe;this._unsubscribe=null;this._unsubscribeAndRecycle();this._unsubscribe=_unsubscribe;this.source.subscribe(this)};return RetryWhenSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../Subject":66,"../innerSubscribe":71}],166:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function sample(notifier){return function(source){return source.lift(new SampleOperator(notifier))}}
exports.sample=sample;var SampleOperator=(function(){function SampleOperator(notifier){this.notifier=notifier}
SampleOperator.prototype.call=function(subscriber,source){var sampleSubscriber=new SampleSubscriber(subscriber);var subscription=source.subscribe(sampleSubscriber);subscription.add(innerSubscribe_1.innerSubscribe(this.notifier,new innerSubscribe_1.SimpleInnerSubscriber(sampleSubscriber)));return subscription};return SampleOperator}());var SampleSubscriber=(function(_super){__extends(SampleSubscriber,_super);function SampleSubscriber(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.hasValue=!1;return _this}
SampleSubscriber.prototype._next=function(value){this.value=value;this.hasValue=!0};SampleSubscriber.prototype.notifyNext=function(){this.emitValue()};SampleSubscriber.prototype.notifyComplete=function(){this.emitValue()};SampleSubscriber.prototype.emitValue=function(){if(this.hasValue){this.hasValue=!1;this.destination.next(this.value)}};return SampleSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],167:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var async_1=require("../scheduler/async");function sampleTime(period,scheduler){if(scheduler===void 0){scheduler=async_1.async}
return function(source){return source.lift(new SampleTimeOperator(period,scheduler))}}
exports.sampleTime=sampleTime;var SampleTimeOperator=(function(){function SampleTimeOperator(period,scheduler){this.period=period;this.scheduler=scheduler}
SampleTimeOperator.prototype.call=function(subscriber,source){return source.subscribe(new SampleTimeSubscriber(subscriber,this.period,this.scheduler))};return SampleTimeOperator}());var SampleTimeSubscriber=(function(_super){__extends(SampleTimeSubscriber,_super);function SampleTimeSubscriber(destination,period,scheduler){var _this=_super.call(this,destination)||this;_this.period=period;_this.scheduler=scheduler;_this.hasValue=!1;_this.add(scheduler.schedule(dispatchNotification,period,{subscriber:_this,period:period}));return _this}
SampleTimeSubscriber.prototype._next=function(value){this.lastValue=value;this.hasValue=!0};SampleTimeSubscriber.prototype.notifyNext=function(){if(this.hasValue){this.hasValue=!1;this.destination.next(this.lastValue)}};return SampleTimeSubscriber}(Subscriber_1.Subscriber));function dispatchNotification(state){var subscriber=state.subscriber,period=state.period;subscriber.notifyNext();this.schedule(state,period)}},{"../Subscriber":68,"../scheduler/async":220}],168:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function scan(accumulator,seed){var hasSeed=!1;if(arguments.length>=2){hasSeed=!0}
return function scanOperatorFunction(source){return source.lift(new ScanOperator(accumulator,seed,hasSeed))}}
exports.scan=scan;var ScanOperator=(function(){function ScanOperator(accumulator,seed,hasSeed){if(hasSeed===void 0){hasSeed=!1}
this.accumulator=accumulator;this.seed=seed;this.hasSeed=hasSeed}
ScanOperator.prototype.call=function(subscriber,source){return source.subscribe(new ScanSubscriber(subscriber,this.accumulator,this.seed,this.hasSeed))};return ScanOperator}());var ScanSubscriber=(function(_super){__extends(ScanSubscriber,_super);function ScanSubscriber(destination,accumulator,_seed,hasSeed){var _this=_super.call(this,destination)||this;_this.accumulator=accumulator;_this._seed=_seed;_this.hasSeed=hasSeed;_this.index=0;return _this}
Object.defineProperty(ScanSubscriber.prototype,"seed",{get:function(){return this._seed},set:function(value){this.hasSeed=!0;this._seed=value},enumerable:!0,configurable:!0});ScanSubscriber.prototype._next=function(value){if(!this.hasSeed){this.seed=value;this.destination.next(value)}else{return this._tryNext(value)}};ScanSubscriber.prototype._tryNext=function(value){var index=this.index++;var result;try{result=this.accumulator(this.seed,value,index)}catch(err){this.destination.error(err)}
this.seed=result;this.destination.next(result)};return ScanSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],169:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function sequenceEqual(compareTo,comparator){return function(source){return source.lift(new SequenceEqualOperator(compareTo,comparator))}}
exports.sequenceEqual=sequenceEqual;var SequenceEqualOperator=(function(){function SequenceEqualOperator(compareTo,comparator){this.compareTo=compareTo;this.comparator=comparator}
SequenceEqualOperator.prototype.call=function(subscriber,source){return source.subscribe(new SequenceEqualSubscriber(subscriber,this.compareTo,this.comparator))};return SequenceEqualOperator}());exports.SequenceEqualOperator=SequenceEqualOperator;var SequenceEqualSubscriber=(function(_super){__extends(SequenceEqualSubscriber,_super);function SequenceEqualSubscriber(destination,compareTo,comparator){var _this=_super.call(this,destination)||this;_this.compareTo=compareTo;_this.comparator=comparator;_this._a=[];_this._b=[];_this._oneComplete=!1;_this.destination.add(compareTo.subscribe(new SequenceEqualCompareToSubscriber(destination,_this)));return _this}
SequenceEqualSubscriber.prototype._next=function(value){if(this._oneComplete&&this._b.length===0){this.emit(!1)}else{this._a.push(value);this.checkValues()}};SequenceEqualSubscriber.prototype._complete=function(){if(this._oneComplete){this.emit(this._a.length===0&&this._b.length===0)}else{this._oneComplete=!0}
this.unsubscribe()};SequenceEqualSubscriber.prototype.checkValues=function(){var _c=this,_a=_c._a,_b=_c._b,comparator=_c.comparator;while(_a.length>0&&_b.length>0){var a=_a.shift();var b=_b.shift();var areEqual=!1;try{areEqual=comparator?comparator(a,b):a===b}catch(e){this.destination.error(e)}
if(!areEqual){this.emit(!1)}}};SequenceEqualSubscriber.prototype.emit=function(value){var destination=this.destination;destination.next(value);destination.complete()};SequenceEqualSubscriber.prototype.nextB=function(value){if(this._oneComplete&&this._a.length===0){this.emit(!1)}else{this._b.push(value);this.checkValues()}};SequenceEqualSubscriber.prototype.completeB=function(){if(this._oneComplete){this.emit(this._a.length===0&&this._b.length===0)}else{this._oneComplete=!0}};return SequenceEqualSubscriber}(Subscriber_1.Subscriber));exports.SequenceEqualSubscriber=SequenceEqualSubscriber;var SequenceEqualCompareToSubscriber=(function(_super){__extends(SequenceEqualCompareToSubscriber,_super);function SequenceEqualCompareToSubscriber(destination,parent){var _this=_super.call(this,destination)||this;_this.parent=parent;return _this}
SequenceEqualCompareToSubscriber.prototype._next=function(value){this.parent.nextB(value)};SequenceEqualCompareToSubscriber.prototype._error=function(err){this.parent.error(err);this.unsubscribe()};SequenceEqualCompareToSubscriber.prototype._complete=function(){this.parent.completeB();this.unsubscribe()};return SequenceEqualCompareToSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],170:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var multicast_1=require("./multicast");var refCount_1=require("./refCount");var Subject_1=require("../Subject");function shareSubjectFactory(){return new Subject_1.Subject()}
function share(){return function(source){return refCount_1.refCount()(multicast_1.multicast(shareSubjectFactory)(source))}}
exports.share=share},{"../Subject":66,"./multicast":149,"./refCount":161}],171:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ReplaySubject_1=require("../ReplaySubject");function shareReplay(configOrBufferSize,windowTime,scheduler){var config;if(configOrBufferSize&&typeof configOrBufferSize==='object'){config=configOrBufferSize}else{config={bufferSize:configOrBufferSize,windowTime:windowTime,refCount:!1,scheduler:scheduler,}}
return function(source){return source.lift(shareReplayOperator(config))}}
exports.shareReplay=shareReplay;function shareReplayOperator(_a){var _b=_a.bufferSize,bufferSize=_b===void 0?Number.POSITIVE_INFINITY:_b,_c=_a.windowTime,windowTime=_c===void 0?Number.POSITIVE_INFINITY:_c,useRefCount=_a.refCount,scheduler=_a.scheduler;var subject;var refCount=0;var subscription;var hasError=!1;var isComplete=!1;return function shareReplayOperation(source){refCount++;var innerSub;if(!subject||hasError){hasError=!1;subject=new ReplaySubject_1.ReplaySubject(bufferSize,windowTime,scheduler);innerSub=subject.subscribe(this);subscription=source.subscribe({next:function(value){subject.next(value)},error:function(err){hasError=!0;subject.error(err)},complete:function(){isComplete=!0;subscription=undefined;subject.complete()},});if(isComplete){subscription=undefined}}else{innerSub=subject.subscribe(this)}
this.add(function(){refCount--;innerSub.unsubscribe();innerSub=undefined;if(subscription&&!isComplete&&useRefCount&&refCount===0){subscription.unsubscribe();subscription=undefined;subject=undefined}})}}},{"../ReplaySubject":64}],172:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var EmptyError_1=require("../util/EmptyError");function single(predicate){return function(source){return source.lift(new SingleOperator(predicate,source))}}
exports.single=single;var SingleOperator=(function(){function SingleOperator(predicate,source){this.predicate=predicate;this.source=source}
SingleOperator.prototype.call=function(subscriber,source){return source.subscribe(new SingleSubscriber(subscriber,this.predicate,this.source))};return SingleOperator}());var SingleSubscriber=(function(_super){__extends(SingleSubscriber,_super);function SingleSubscriber(destination,predicate,source){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.source=source;_this.seenValue=!1;_this.index=0;return _this}
SingleSubscriber.prototype.applySingleValue=function(value){if(this.seenValue){this.destination.error('Sequence contains more than one element')}else{this.seenValue=!0;this.singleValue=value}};SingleSubscriber.prototype._next=function(value){var index=this.index++;if(this.predicate){this.tryNext(value,index)}else{this.applySingleValue(value)}};SingleSubscriber.prototype.tryNext=function(value,index){try{if(this.predicate(value,index,this.source)){this.applySingleValue(value)}}catch(err){this.destination.error(err)}};SingleSubscriber.prototype._complete=function(){var destination=this.destination;if(this.index>0){destination.next(this.seenValue?this.singleValue:undefined);destination.complete()}else{destination.error(new EmptyError_1.EmptyError)}};return SingleSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../util/EmptyError":226}],173:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function skip(count){return function(source){return source.lift(new SkipOperator(count))}}
exports.skip=skip;var SkipOperator=(function(){function SkipOperator(total){this.total=total}
SkipOperator.prototype.call=function(subscriber,source){return source.subscribe(new SkipSubscriber(subscriber,this.total))};return SkipOperator}());var SkipSubscriber=(function(_super){__extends(SkipSubscriber,_super);function SkipSubscriber(destination,total){var _this=_super.call(this,destination)||this;_this.total=total;_this.count=0;return _this}
SkipSubscriber.prototype._next=function(x){if(++this.count>this.total){this.destination.next(x)}};return SkipSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],174:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var ArgumentOutOfRangeError_1=require("../util/ArgumentOutOfRangeError");function skipLast(count){return function(source){return source.lift(new SkipLastOperator(count))}}
exports.skipLast=skipLast;var SkipLastOperator=(function(){function SkipLastOperator(_skipCount){this._skipCount=_skipCount;if(this._skipCount<0){throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}}
SkipLastOperator.prototype.call=function(subscriber,source){if(this._skipCount===0){return source.subscribe(new Subscriber_1.Subscriber(subscriber))}else{return source.subscribe(new SkipLastSubscriber(subscriber,this._skipCount))}};return SkipLastOperator}());var SkipLastSubscriber=(function(_super){__extends(SkipLastSubscriber,_super);function SkipLastSubscriber(destination,_skipCount){var _this=_super.call(this,destination)||this;_this._skipCount=_skipCount;_this._count=0;_this._ring=new Array(_skipCount);return _this}
SkipLastSubscriber.prototype._next=function(value){var skipCount=this._skipCount;var count=this._count++;if(count<skipCount){this._ring[count]=value}else{var currentIndex=count%skipCount;var ring=this._ring;var oldValue=ring[currentIndex];ring[currentIndex]=value;this.destination.next(oldValue)}};return SkipLastSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../util/ArgumentOutOfRangeError":225}],175:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function skipUntil(notifier){return function(source){return source.lift(new SkipUntilOperator(notifier))}}
exports.skipUntil=skipUntil;var SkipUntilOperator=(function(){function SkipUntilOperator(notifier){this.notifier=notifier}
SkipUntilOperator.prototype.call=function(destination,source){return source.subscribe(new SkipUntilSubscriber(destination,this.notifier))};return SkipUntilOperator}());var SkipUntilSubscriber=(function(_super){__extends(SkipUntilSubscriber,_super);function SkipUntilSubscriber(destination,notifier){var _this=_super.call(this,destination)||this;_this.hasValue=!1;var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(_this);_this.add(innerSubscriber);_this.innerSubscription=innerSubscriber;var innerSubscription=innerSubscribe_1.innerSubscribe(notifier,innerSubscriber);if(innerSubscription!==innerSubscriber){_this.add(innerSubscription);_this.innerSubscription=innerSubscription}
return _this}
SkipUntilSubscriber.prototype._next=function(value){if(this.hasValue){_super.prototype._next.call(this,value)}};SkipUntilSubscriber.prototype.notifyNext=function(){this.hasValue=!0;if(this.innerSubscription){this.innerSubscription.unsubscribe()}};SkipUntilSubscriber.prototype.notifyComplete=function(){};return SkipUntilSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],176:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function skipWhile(predicate){return function(source){return source.lift(new SkipWhileOperator(predicate))}}
exports.skipWhile=skipWhile;var SkipWhileOperator=(function(){function SkipWhileOperator(predicate){this.predicate=predicate}
SkipWhileOperator.prototype.call=function(subscriber,source){return source.subscribe(new SkipWhileSubscriber(subscriber,this.predicate))};return SkipWhileOperator}());var SkipWhileSubscriber=(function(_super){__extends(SkipWhileSubscriber,_super);function SkipWhileSubscriber(destination,predicate){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.skipping=!0;_this.index=0;return _this}
SkipWhileSubscriber.prototype._next=function(value){var destination=this.destination;if(this.skipping){this.tryCallPredicate(value)}
if(!this.skipping){destination.next(value)}};SkipWhileSubscriber.prototype.tryCallPredicate=function(value){try{var result=this.predicate(value,this.index++);this.skipping=Boolean(result)}catch(err){this.destination.error(err)}};return SkipWhileSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],177:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var concat_1=require("../observable/concat");var isScheduler_1=require("../util/isScheduler");function startWith(){var array=[];for(var _i=0;_i<arguments.length;_i++){array[_i]=arguments[_i]}
var scheduler=array[array.length-1];if(isScheduler_1.isScheduler(scheduler)){array.pop();return function(source){return concat_1.concat(array,source,scheduler)}}else{return function(source){return concat_1.concat(array,source)}}}
exports.startWith=startWith},{"../observable/concat":77,"../util/isScheduler":244}],178:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var SubscribeOnObservable_1=require("../observable/SubscribeOnObservable");function subscribeOn(scheduler,delay){if(delay===void 0){delay=0}
return function subscribeOnOperatorFunction(source){return source.lift(new SubscribeOnOperator(scheduler,delay))}}
exports.subscribeOn=subscribeOn;var SubscribeOnOperator=(function(){function SubscribeOnOperator(scheduler,delay){this.scheduler=scheduler;this.delay=delay}
SubscribeOnOperator.prototype.call=function(subscriber,source){return new SubscribeOnObservable_1.SubscribeOnObservable(source,this.delay,this.scheduler).subscribe(subscriber)};return SubscribeOnOperator}())},{"../observable/SubscribeOnObservable":73}],179:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var switchMap_1=require("./switchMap");var identity_1=require("../util/identity");function switchAll(){return switchMap_1.switchMap(identity_1.identity)}
exports.switchAll=switchAll},{"../util/identity":233,"./switchMap":180}],180:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var map_1=require("./map");var from_1=require("../observable/from");var innerSubscribe_1=require("../innerSubscribe");function switchMap(project,resultSelector){if(typeof resultSelector==='function'){return function(source){return source.pipe(switchMap(function(a,i){return from_1.from(project(a,i)).pipe(map_1.map(function(b,ii){return resultSelector(a,b,i,ii)}))}))}}
return function(source){return source.lift(new SwitchMapOperator(project))}}
exports.switchMap=switchMap;var SwitchMapOperator=(function(){function SwitchMapOperator(project){this.project=project}
SwitchMapOperator.prototype.call=function(subscriber,source){return source.subscribe(new SwitchMapSubscriber(subscriber,this.project))};return SwitchMapOperator}());var SwitchMapSubscriber=(function(_super){__extends(SwitchMapSubscriber,_super);function SwitchMapSubscriber(destination,project){var _this=_super.call(this,destination)||this;_this.project=project;_this.index=0;return _this}
SwitchMapSubscriber.prototype._next=function(value){var result;var index=this.index++;try{result=this.project(value,index)}catch(error){this.destination.error(error);return}
this._innerSub(result)};SwitchMapSubscriber.prototype._innerSub=function(result){var innerSubscription=this.innerSubscription;if(innerSubscription){innerSubscription.unsubscribe()}
var innerSubscriber=new innerSubscribe_1.SimpleInnerSubscriber(this);var destination=this.destination;destination.add(innerSubscriber);this.innerSubscription=innerSubscribe_1.innerSubscribe(result,innerSubscriber);if(this.innerSubscription!==innerSubscriber){destination.add(this.innerSubscription)}};SwitchMapSubscriber.prototype._complete=function(){var innerSubscription=this.innerSubscription;if(!innerSubscription||innerSubscription.closed){_super.prototype._complete.call(this)}
this.unsubscribe()};SwitchMapSubscriber.prototype._unsubscribe=function(){this.innerSubscription=undefined};SwitchMapSubscriber.prototype.notifyComplete=function(){this.innerSubscription=undefined;if(this.isStopped){_super.prototype._complete.call(this)}};SwitchMapSubscriber.prototype.notifyNext=function(innerValue){this.destination.next(innerValue)};return SwitchMapSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71,"../observable/from":81,"./map":139}],181:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var switchMap_1=require("./switchMap");function switchMapTo(innerObservable,resultSelector){return resultSelector?switchMap_1.switchMap(function(){return innerObservable},resultSelector):switchMap_1.switchMap(function(){return innerObservable})}
exports.switchMapTo=switchMapTo},{"./switchMap":180}],182:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var ArgumentOutOfRangeError_1=require("../util/ArgumentOutOfRangeError");var empty_1=require("../observable/empty");function take(count){return function(source){if(count===0){return empty_1.empty()}else{return source.lift(new TakeOperator(count))}}}
exports.take=take;var TakeOperator=(function(){function TakeOperator(total){this.total=total;if(this.total<0){throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}}
TakeOperator.prototype.call=function(subscriber,source){return source.subscribe(new TakeSubscriber(subscriber,this.total))};return TakeOperator}());var TakeSubscriber=(function(_super){__extends(TakeSubscriber,_super);function TakeSubscriber(destination,total){var _this=_super.call(this,destination)||this;_this.total=total;_this.count=0;return _this}
TakeSubscriber.prototype._next=function(value){var total=this.total;var count=++this.count;if(count<=total){this.destination.next(value);if(count===total){this.destination.complete();this.unsubscribe()}}};return TakeSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../observable/empty":79,"../util/ArgumentOutOfRangeError":225}],183:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var ArgumentOutOfRangeError_1=require("../util/ArgumentOutOfRangeError");var empty_1=require("../observable/empty");function takeLast(count){return function takeLastOperatorFunction(source){if(count===0){return empty_1.empty()}else{return source.lift(new TakeLastOperator(count))}}}
exports.takeLast=takeLast;var TakeLastOperator=(function(){function TakeLastOperator(total){this.total=total;if(this.total<0){throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}}
TakeLastOperator.prototype.call=function(subscriber,source){return source.subscribe(new TakeLastSubscriber(subscriber,this.total))};return TakeLastOperator}());var TakeLastSubscriber=(function(_super){__extends(TakeLastSubscriber,_super);function TakeLastSubscriber(destination,total){var _this=_super.call(this,destination)||this;_this.total=total;_this.ring=new Array();_this.count=0;return _this}
TakeLastSubscriber.prototype._next=function(value){var ring=this.ring;var total=this.total;var count=this.count++;if(ring.length<total){ring.push(value)}else{var index=count%total;ring[index]=value}};TakeLastSubscriber.prototype._complete=function(){var destination=this.destination;var count=this.count;if(count>0){var total=this.count>=this.total?this.total:this.count;var ring=this.ring;for(var i=0;i<total;i++){var idx=(count++)%total;destination.next(ring[idx])}}
destination.complete()};return TakeLastSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../observable/empty":79,"../util/ArgumentOutOfRangeError":225}],184:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");function takeUntil(notifier){return function(source){return source.lift(new TakeUntilOperator(notifier))}}
exports.takeUntil=takeUntil;var TakeUntilOperator=(function(){function TakeUntilOperator(notifier){this.notifier=notifier}
TakeUntilOperator.prototype.call=function(subscriber,source){var takeUntilSubscriber=new TakeUntilSubscriber(subscriber);var notifierSubscription=innerSubscribe_1.innerSubscribe(this.notifier,new innerSubscribe_1.SimpleInnerSubscriber(takeUntilSubscriber));if(notifierSubscription&&!takeUntilSubscriber.seenValue){takeUntilSubscriber.add(notifierSubscription);return source.subscribe(takeUntilSubscriber)}
return takeUntilSubscriber};return TakeUntilOperator}());var TakeUntilSubscriber=(function(_super){__extends(TakeUntilSubscriber,_super);function TakeUntilSubscriber(destination){var _this=_super.call(this,destination)||this;_this.seenValue=!1;return _this}
TakeUntilSubscriber.prototype.notifyNext=function(){this.seenValue=!0;this.complete()};TakeUntilSubscriber.prototype.notifyComplete=function(){};return TakeUntilSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],185:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function takeWhile(predicate,inclusive){if(inclusive===void 0){inclusive=!1}
return function(source){return source.lift(new TakeWhileOperator(predicate,inclusive))}}
exports.takeWhile=takeWhile;var TakeWhileOperator=(function(){function TakeWhileOperator(predicate,inclusive){this.predicate=predicate;this.inclusive=inclusive}
TakeWhileOperator.prototype.call=function(subscriber,source){return source.subscribe(new TakeWhileSubscriber(subscriber,this.predicate,this.inclusive))};return TakeWhileOperator}());var TakeWhileSubscriber=(function(_super){__extends(TakeWhileSubscriber,_super);function TakeWhileSubscriber(destination,predicate,inclusive){var _this=_super.call(this,destination)||this;_this.predicate=predicate;_this.inclusive=inclusive;_this.index=0;return _this}
TakeWhileSubscriber.prototype._next=function(value){var destination=this.destination;var result;try{result=this.predicate(value,this.index++)}catch(err){destination.error(err);return}
this.nextOrComplete(value,result)};TakeWhileSubscriber.prototype.nextOrComplete=function(value,predicateResult){var destination=this.destination;if(Boolean(predicateResult)){destination.next(value)}else{if(this.inclusive){destination.next(value)}
destination.complete()}};return TakeWhileSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68}],186:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var noop_1=require("../util/noop");var isFunction_1=require("../util/isFunction");function tap(nextOrObserver,error,complete){return function tapOperatorFunction(source){return source.lift(new DoOperator(nextOrObserver,error,complete))}}
exports.tap=tap;var DoOperator=(function(){function DoOperator(nextOrObserver,error,complete){this.nextOrObserver=nextOrObserver;this.error=error;this.complete=complete}
DoOperator.prototype.call=function(subscriber,source){return source.subscribe(new TapSubscriber(subscriber,this.nextOrObserver,this.error,this.complete))};return DoOperator}());var TapSubscriber=(function(_super){__extends(TapSubscriber,_super);function TapSubscriber(destination,observerOrNext,error,complete){var _this=_super.call(this,destination)||this;_this._tapNext=noop_1.noop;_this._tapError=noop_1.noop;_this._tapComplete=noop_1.noop;_this._tapError=error||noop_1.noop;_this._tapComplete=complete||noop_1.noop;if(isFunction_1.isFunction(observerOrNext)){_this._context=_this;_this._tapNext=observerOrNext}else if(observerOrNext){_this._context=observerOrNext;_this._tapNext=observerOrNext.next||noop_1.noop;_this._tapError=observerOrNext.error||noop_1.noop;_this._tapComplete=observerOrNext.complete||noop_1.noop}
return _this}
TapSubscriber.prototype._next=function(value){try{this._tapNext.call(this._context,value)}catch(err){this.destination.error(err);return}
this.destination.next(value)};TapSubscriber.prototype._error=function(err){try{this._tapError.call(this._context,err)}catch(err){this.destination.error(err);return}
this.destination.error(err)};TapSubscriber.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(err){this.destination.error(err);return}
return this.destination.complete()};return TapSubscriber}(Subscriber_1.Subscriber))},{"../Subscriber":68,"../util/isFunction":237,"../util/noop":245}],187:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var innerSubscribe_1=require("../innerSubscribe");exports.defaultThrottleConfig={leading:!0,trailing:!1};function throttle(durationSelector,config){if(config===void 0){config=exports.defaultThrottleConfig}
return function(source){return source.lift(new ThrottleOperator(durationSelector,!!config.leading,!!config.trailing))}}
exports.throttle=throttle;var ThrottleOperator=(function(){function ThrottleOperator(durationSelector,leading,trailing){this.durationSelector=durationSelector;this.leading=leading;this.trailing=trailing}
ThrottleOperator.prototype.call=function(subscriber,source){return source.subscribe(new ThrottleSubscriber(subscriber,this.durationSelector,this.leading,this.trailing))};return ThrottleOperator}());var ThrottleSubscriber=(function(_super){__extends(ThrottleSubscriber,_super);function ThrottleSubscriber(destination,durationSelector,_leading,_trailing){var _this=_super.call(this,destination)||this;_this.destination=destination;_this.durationSelector=durationSelector;_this._leading=_leading;_this._trailing=_trailing;_this._hasValue=!1;return _this}
ThrottleSubscriber.prototype._next=function(value){this._hasValue=!0;this._sendValue=value;if(!this._throttled){if(this._leading){this.send()}else{this.throttle(value)}}};ThrottleSubscriber.prototype.send=function(){var _a=this,_hasValue=_a._hasValue,_sendValue=_a._sendValue;if(_hasValue){this.destination.next(_sendValue);this.throttle(_sendValue)}
this._hasValue=!1;this._sendValue=undefined};ThrottleSubscriber.prototype.throttle=function(value){var duration=this.tryDurationSelector(value);if(!!duration){this.add(this._throttled=innerSubscribe_1.innerSubscribe(duration,new innerSubscribe_1.SimpleInnerSubscriber(this)))}};ThrottleSubscriber.prototype.tryDurationSelector=function(value){try{return this.durationSelector(value)}catch(err){this.destination.error(err);return null}};ThrottleSubscriber.prototype.throttlingDone=function(){var _a=this,_throttled=_a._throttled,_trailing=_a._trailing;if(_throttled){_throttled.unsubscribe()}
this._throttled=undefined;if(_trailing){this.send()}};ThrottleSubscriber.prototype.notifyNext=function(){this.throttlingDone()};ThrottleSubscriber.prototype.notifyComplete=function(){this.throttlingDone()};return ThrottleSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71}],188:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var async_1=require("../scheduler/async");var throttle_1=require("./throttle");function throttleTime(duration,scheduler,config){if(scheduler===void 0){scheduler=async_1.async}
if(config===void 0){config=throttle_1.defaultThrottleConfig}
return function(source){return source.lift(new ThrottleTimeOperator(duration,scheduler,config.leading,config.trailing))}}
exports.throttleTime=throttleTime;var ThrottleTimeOperator=(function(){function ThrottleTimeOperator(duration,scheduler,leading,trailing){this.duration=duration;this.scheduler=scheduler;this.leading=leading;this.trailing=trailing}
ThrottleTimeOperator.prototype.call=function(subscriber,source){return source.subscribe(new ThrottleTimeSubscriber(subscriber,this.duration,this.scheduler,this.leading,this.trailing))};return ThrottleTimeOperator}());var ThrottleTimeSubscriber=(function(_super){__extends(ThrottleTimeSubscriber,_super);function ThrottleTimeSubscriber(destination,duration,scheduler,leading,trailing){var _this=_super.call(this,destination)||this;_this.duration=duration;_this.scheduler=scheduler;_this.leading=leading;_this.trailing=trailing;_this._hasTrailingValue=!1;_this._trailingValue=null;return _this}
ThrottleTimeSubscriber.prototype._next=function(value){if(this.throttled){if(this.trailing){this._trailingValue=value;this._hasTrailingValue=!0}}else{this.add(this.throttled=this.scheduler.schedule(dispatchNext,this.duration,{subscriber:this}));if(this.leading){this.destination.next(value)}else if(this.trailing){this._trailingValue=value;this._hasTrailingValue=!0}}};ThrottleTimeSubscriber.prototype._complete=function(){if(this._hasTrailingValue){this.destination.next(this._trailingValue);this.destination.complete()}else{this.destination.complete()}};ThrottleTimeSubscriber.prototype.clearThrottle=function(){var throttled=this.throttled;if(throttled){if(this.trailing&&this._hasTrailingValue){this.destination.next(this._trailingValue);this._trailingValue=null;this._hasTrailingValue=!1}
throttled.unsubscribe();this.remove(throttled);this.throttled=null}};return ThrottleTimeSubscriber}(Subscriber_1.Subscriber));function dispatchNext(arg){var subscriber=arg.subscriber;subscriber.clearThrottle()}},{"../Subscriber":68,"../scheduler/async":220,"./throttle":187}],189:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var EmptyError_1=require("../util/EmptyError");var Subscriber_1=require("../Subscriber");function throwIfEmpty(errorFactory){if(errorFactory===void 0){errorFactory=defaultErrorFactory}
return function(source){return source.lift(new ThrowIfEmptyOperator(errorFactory))}}
exports.throwIfEmpty=throwIfEmpty;var ThrowIfEmptyOperator=(function(){function ThrowIfEmptyOperator(errorFactory){this.errorFactory=errorFactory}
ThrowIfEmptyOperator.prototype.call=function(subscriber,source){return source.subscribe(new ThrowIfEmptySubscriber(subscriber,this.errorFactory))};return ThrowIfEmptyOperator}());var ThrowIfEmptySubscriber=(function(_super){__extends(ThrowIfEmptySubscriber,_super);function ThrowIfEmptySubscriber(destination,errorFactory){var _this=_super.call(this,destination)||this;_this.errorFactory=errorFactory;_this.hasValue=!1;return _this}
ThrowIfEmptySubscriber.prototype._next=function(value){this.hasValue=!0;this.destination.next(value)};ThrowIfEmptySubscriber.prototype._complete=function(){if(!this.hasValue){var err=void 0;try{err=this.errorFactory()}catch(e){err=e}
this.destination.error(err)}else{return this.destination.complete()}};return ThrowIfEmptySubscriber}(Subscriber_1.Subscriber));function defaultErrorFactory(){return new EmptyError_1.EmptyError()}},{"../Subscriber":68,"../util/EmptyError":226}],190:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var scan_1=require("./scan");var defer_1=require("../observable/defer");var map_1=require("./map");function timeInterval(scheduler){if(scheduler===void 0){scheduler=async_1.async}
return function(source){return defer_1.defer(function(){return source.pipe(scan_1.scan(function(_a,value){var current=_a.current;return({value:value,current:scheduler.now(),last:current})},{current:scheduler.now(),value:undefined,last:undefined}),map_1.map(function(_a){var current=_a.current,last=_a.last,value=_a.value;return new TimeInterval(value,current-last)}))})}}
exports.timeInterval=timeInterval;var TimeInterval=(function(){function TimeInterval(value,interval){this.value=value;this.interval=interval}
return TimeInterval}());exports.TimeInterval=TimeInterval},{"../observable/defer":78,"../scheduler/async":220,"./map":139,"./scan":168}],191:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var TimeoutError_1=require("../util/TimeoutError");var timeoutWith_1=require("./timeoutWith");var throwError_1=require("../observable/throwError");function timeout(due,scheduler){if(scheduler===void 0){scheduler=async_1.async}
return timeoutWith_1.timeoutWith(due,throwError_1.throwError(new TimeoutError_1.TimeoutError()),scheduler)}
exports.timeout=timeout},{"../observable/throwError":96,"../scheduler/async":220,"../util/TimeoutError":229,"./timeoutWith":192}],192:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var isDate_1=require("../util/isDate");var innerSubscribe_1=require("../innerSubscribe");function timeoutWith(due,withObservable,scheduler){if(scheduler===void 0){scheduler=async_1.async}
return function(source){var absoluteTimeout=isDate_1.isDate(due);var waitFor=absoluteTimeout?(+due-scheduler.now()):Math.abs(due);return source.lift(new TimeoutWithOperator(waitFor,absoluteTimeout,withObservable,scheduler))}}
exports.timeoutWith=timeoutWith;var TimeoutWithOperator=(function(){function TimeoutWithOperator(waitFor,absoluteTimeout,withObservable,scheduler){this.waitFor=waitFor;this.absoluteTimeout=absoluteTimeout;this.withObservable=withObservable;this.scheduler=scheduler}
TimeoutWithOperator.prototype.call=function(subscriber,source){return source.subscribe(new TimeoutWithSubscriber(subscriber,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))};return TimeoutWithOperator}());var TimeoutWithSubscriber=(function(_super){__extends(TimeoutWithSubscriber,_super);function TimeoutWithSubscriber(destination,absoluteTimeout,waitFor,withObservable,scheduler){var _this=_super.call(this,destination)||this;_this.absoluteTimeout=absoluteTimeout;_this.waitFor=waitFor;_this.withObservable=withObservable;_this.scheduler=scheduler;_this.scheduleTimeout();return _this}
TimeoutWithSubscriber.dispatchTimeout=function(subscriber){var withObservable=subscriber.withObservable;subscriber._unsubscribeAndRecycle();subscriber.add(innerSubscribe_1.innerSubscribe(withObservable,new innerSubscribe_1.SimpleInnerSubscriber(subscriber)))};TimeoutWithSubscriber.prototype.scheduleTimeout=function(){var action=this.action;if(action){this.action=action.schedule(this,this.waitFor)}else{this.add(this.action=this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout,this.waitFor,this))}};TimeoutWithSubscriber.prototype._next=function(value){if(!this.absoluteTimeout){this.scheduleTimeout()}
_super.prototype._next.call(this,value)};TimeoutWithSubscriber.prototype._unsubscribe=function(){this.action=undefined;this.scheduler=null;this.withObservable=null};return TimeoutWithSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../innerSubscribe":71,"../scheduler/async":220,"../util/isDate":236}],193:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var async_1=require("../scheduler/async");var map_1=require("./map");function timestamp(scheduler){if(scheduler===void 0){scheduler=async_1.async}
return map_1.map(function(value){return new Timestamp(value,scheduler.now())})}
exports.timestamp=timestamp;var Timestamp=(function(){function Timestamp(value,timestamp){this.value=value;this.timestamp=timestamp}
return Timestamp}());exports.Timestamp=Timestamp},{"../scheduler/async":220,"./map":139}],194:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var reduce_1=require("./reduce");function toArrayReducer(arr,item,index){if(index===0){return[item]}
arr.push(item);return arr}
function toArray(){return reduce_1.reduce(toArrayReducer,[])}
exports.toArray=toArray},{"./reduce":160}],195:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var innerSubscribe_1=require("../innerSubscribe");function window(windowBoundaries){return function windowOperatorFunction(source){return source.lift(new WindowOperator(windowBoundaries))}}
exports.window=window;var WindowOperator=(function(){function WindowOperator(windowBoundaries){this.windowBoundaries=windowBoundaries}
WindowOperator.prototype.call=function(subscriber,source){var windowSubscriber=new WindowSubscriber(subscriber);var sourceSubscription=source.subscribe(windowSubscriber);if(!sourceSubscription.closed){windowSubscriber.add(innerSubscribe_1.innerSubscribe(this.windowBoundaries,new innerSubscribe_1.SimpleInnerSubscriber(windowSubscriber)))}
return sourceSubscription};return WindowOperator}());var WindowSubscriber=(function(_super){__extends(WindowSubscriber,_super);function WindowSubscriber(destination){var _this=_super.call(this,destination)||this;_this.window=new Subject_1.Subject();destination.next(_this.window);return _this}
WindowSubscriber.prototype.notifyNext=function(){this.openWindow()};WindowSubscriber.prototype.notifyError=function(error){this._error(error)};WindowSubscriber.prototype.notifyComplete=function(){this._complete()};WindowSubscriber.prototype._next=function(value){this.window.next(value)};WindowSubscriber.prototype._error=function(err){this.window.error(err);this.destination.error(err)};WindowSubscriber.prototype._complete=function(){this.window.complete();this.destination.complete()};WindowSubscriber.prototype._unsubscribe=function(){this.window=null};WindowSubscriber.prototype.openWindow=function(){var prevWindow=this.window;if(prevWindow){prevWindow.complete()}
var destination=this.destination;var newWindow=this.window=new Subject_1.Subject();destination.next(newWindow)};return WindowSubscriber}(innerSubscribe_1.SimpleOuterSubscriber))},{"../Subject":66,"../innerSubscribe":71}],196:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var Subject_1=require("../Subject");function windowCount(windowSize,startWindowEvery){if(startWindowEvery===void 0){startWindowEvery=0}
return function windowCountOperatorFunction(source){return source.lift(new WindowCountOperator(windowSize,startWindowEvery))}}
exports.windowCount=windowCount;var WindowCountOperator=(function(){function WindowCountOperator(windowSize,startWindowEvery){this.windowSize=windowSize;this.startWindowEvery=startWindowEvery}
WindowCountOperator.prototype.call=function(subscriber,source){return source.subscribe(new WindowCountSubscriber(subscriber,this.windowSize,this.startWindowEvery))};return WindowCountOperator}());var WindowCountSubscriber=(function(_super){__extends(WindowCountSubscriber,_super);function WindowCountSubscriber(destination,windowSize,startWindowEvery){var _this=_super.call(this,destination)||this;_this.destination=destination;_this.windowSize=windowSize;_this.startWindowEvery=startWindowEvery;_this.windows=[new Subject_1.Subject()];_this.count=0;destination.next(_this.windows[0]);return _this}
WindowCountSubscriber.prototype._next=function(value){var startWindowEvery=(this.startWindowEvery>0)?this.startWindowEvery:this.windowSize;var destination=this.destination;var windowSize=this.windowSize;var windows=this.windows;var len=windows.length;for(var i=0;i<len&&!this.closed;i++){windows[i].next(value)}
var c=this.count-windowSize+1;if(c>=0&&c%startWindowEvery===0&&!this.closed){windows.shift().complete()}
if(++this.count%startWindowEvery===0&&!this.closed){var window_1=new Subject_1.Subject();windows.push(window_1);destination.next(window_1)}};WindowCountSubscriber.prototype._error=function(err){var windows=this.windows;if(windows){while(windows.length>0&&!this.closed){windows.shift().error(err)}}
this.destination.error(err)};WindowCountSubscriber.prototype._complete=function(){var windows=this.windows;if(windows){while(windows.length>0&&!this.closed){windows.shift().complete()}}
this.destination.complete()};WindowCountSubscriber.prototype._unsubscribe=function(){this.count=0;this.windows=null};return WindowCountSubscriber}(Subscriber_1.Subscriber))},{"../Subject":66,"../Subscriber":68}],197:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var async_1=require("../scheduler/async");var Subscriber_1=require("../Subscriber");var isNumeric_1=require("../util/isNumeric");var isScheduler_1=require("../util/isScheduler");function windowTime(windowTimeSpan){var scheduler=async_1.async;var windowCreationInterval=null;var maxWindowSize=Number.POSITIVE_INFINITY;if(isScheduler_1.isScheduler(arguments[3])){scheduler=arguments[3]}
if(isScheduler_1.isScheduler(arguments[2])){scheduler=arguments[2]}else if(isNumeric_1.isNumeric(arguments[2])){maxWindowSize=Number(arguments[2])}
if(isScheduler_1.isScheduler(arguments[1])){scheduler=arguments[1]}else if(isNumeric_1.isNumeric(arguments[1])){windowCreationInterval=Number(arguments[1])}
return function windowTimeOperatorFunction(source){return source.lift(new WindowTimeOperator(windowTimeSpan,windowCreationInterval,maxWindowSize,scheduler))}}
exports.windowTime=windowTime;var WindowTimeOperator=(function(){function WindowTimeOperator(windowTimeSpan,windowCreationInterval,maxWindowSize,scheduler){this.windowTimeSpan=windowTimeSpan;this.windowCreationInterval=windowCreationInterval;this.maxWindowSize=maxWindowSize;this.scheduler=scheduler}
WindowTimeOperator.prototype.call=function(subscriber,source){return source.subscribe(new WindowTimeSubscriber(subscriber,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))};return WindowTimeOperator}());var CountedSubject=(function(_super){__extends(CountedSubject,_super);function CountedSubject(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this._numberOfNextedValues=0;return _this}
CountedSubject.prototype.next=function(value){this._numberOfNextedValues++;_super.prototype.next.call(this,value)};Object.defineProperty(CountedSubject.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0});return CountedSubject}(Subject_1.Subject));var WindowTimeSubscriber=(function(_super){__extends(WindowTimeSubscriber,_super);function WindowTimeSubscriber(destination,windowTimeSpan,windowCreationInterval,maxWindowSize,scheduler){var _this=_super.call(this,destination)||this;_this.destination=destination;_this.windowTimeSpan=windowTimeSpan;_this.windowCreationInterval=windowCreationInterval;_this.maxWindowSize=maxWindowSize;_this.scheduler=scheduler;_this.windows=[];var window=_this.openWindow();if(windowCreationInterval!==null&&windowCreationInterval>=0){var closeState={subscriber:_this,window:window,context:null};var creationState={windowTimeSpan:windowTimeSpan,windowCreationInterval:windowCreationInterval,subscriber:_this,scheduler:scheduler};_this.add(scheduler.schedule(dispatchWindowClose,windowTimeSpan,closeState));_this.add(scheduler.schedule(dispatchWindowCreation,windowCreationInterval,creationState))}else{var timeSpanOnlyState={subscriber:_this,window:window,windowTimeSpan:windowTimeSpan};_this.add(scheduler.schedule(dispatchWindowTimeSpanOnly,windowTimeSpan,timeSpanOnlyState))}
return _this}
WindowTimeSubscriber.prototype._next=function(value){var windows=this.windows;var len=windows.length;for(var i=0;i<len;i++){var window_1=windows[i];if(!window_1.closed){window_1.next(value);if(window_1.numberOfNextedValues>=this.maxWindowSize){this.closeWindow(window_1)}}}};WindowTimeSubscriber.prototype._error=function(err){var windows=this.windows;while(windows.length>0){windows.shift().error(err)}
this.destination.error(err)};WindowTimeSubscriber.prototype._complete=function(){var windows=this.windows;while(windows.length>0){var window_2=windows.shift();if(!window_2.closed){window_2.complete()}}
this.destination.complete()};WindowTimeSubscriber.prototype.openWindow=function(){var window=new CountedSubject();this.windows.push(window);var destination=this.destination;destination.next(window);return window};WindowTimeSubscriber.prototype.closeWindow=function(window){window.complete();var windows=this.windows;windows.splice(windows.indexOf(window),1)};return WindowTimeSubscriber}(Subscriber_1.Subscriber));function dispatchWindowTimeSpanOnly(state){var subscriber=state.subscriber,windowTimeSpan=state.windowTimeSpan,window=state.window;if(window){subscriber.closeWindow(window)}
state.window=subscriber.openWindow();this.schedule(state,windowTimeSpan)}
function dispatchWindowCreation(state){var windowTimeSpan=state.windowTimeSpan,subscriber=state.subscriber,scheduler=state.scheduler,windowCreationInterval=state.windowCreationInterval;var window=subscriber.openWindow();var action=this;var context={action:action,subscription:null};var timeSpanState={subscriber:subscriber,window:window,context:context};context.subscription=scheduler.schedule(dispatchWindowClose,windowTimeSpan,timeSpanState);action.add(context.subscription);action.schedule(state,windowCreationInterval)}
function dispatchWindowClose(state){var subscriber=state.subscriber,window=state.window,context=state.context;if(context&&context.action&&context.subscription){context.action.remove(context.subscription)}
subscriber.closeWindow(window)}},{"../Subject":66,"../Subscriber":68,"../scheduler/async":220,"../util/isNumeric":240,"../util/isScheduler":244}],198:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var Subscription_1=require("../Subscription");var OuterSubscriber_1=require("../OuterSubscriber");var subscribeToResult_1=require("../util/subscribeToResult");function windowToggle(openings,closingSelector){return function(source){return source.lift(new WindowToggleOperator(openings,closingSelector))}}
exports.windowToggle=windowToggle;var WindowToggleOperator=(function(){function WindowToggleOperator(openings,closingSelector){this.openings=openings;this.closingSelector=closingSelector}
WindowToggleOperator.prototype.call=function(subscriber,source){return source.subscribe(new WindowToggleSubscriber(subscriber,this.openings,this.closingSelector))};return WindowToggleOperator}());var WindowToggleSubscriber=(function(_super){__extends(WindowToggleSubscriber,_super);function WindowToggleSubscriber(destination,openings,closingSelector){var _this=_super.call(this,destination)||this;_this.openings=openings;_this.closingSelector=closingSelector;_this.contexts=[];_this.add(_this.openSubscription=subscribeToResult_1.subscribeToResult(_this,openings,openings));return _this}
WindowToggleSubscriber.prototype._next=function(value){var contexts=this.contexts;if(contexts){var len=contexts.length;for(var i=0;i<len;i++){contexts[i].window.next(value)}}};WindowToggleSubscriber.prototype._error=function(err){var contexts=this.contexts;this.contexts=null;if(contexts){var len=contexts.length;var index=-1;while(++index<len){var context_1=contexts[index];context_1.window.error(err);context_1.subscription.unsubscribe()}}
_super.prototype._error.call(this,err)};WindowToggleSubscriber.prototype._complete=function(){var contexts=this.contexts;this.contexts=null;if(contexts){var len=contexts.length;var index=-1;while(++index<len){var context_2=contexts[index];context_2.window.complete();context_2.subscription.unsubscribe()}}
_super.prototype._complete.call(this)};WindowToggleSubscriber.prototype._unsubscribe=function(){var contexts=this.contexts;this.contexts=null;if(contexts){var len=contexts.length;var index=-1;while(++index<len){var context_3=contexts[index];context_3.window.unsubscribe();context_3.subscription.unsubscribe()}}};WindowToggleSubscriber.prototype.notifyNext=function(outerValue,innerValue,outerIndex,innerIndex,innerSub){if(outerValue===this.openings){var closingNotifier=void 0;try{var closingSelector=this.closingSelector;closingNotifier=closingSelector(innerValue)}catch(e){return this.error(e)}
var window_1=new Subject_1.Subject();var subscription=new Subscription_1.Subscription();var context_4={window:window_1,subscription:subscription};this.contexts.push(context_4);var innerSubscription=subscribeToResult_1.subscribeToResult(this,closingNotifier,context_4);if(innerSubscription.closed){this.closeWindow(this.contexts.length-1)}else{innerSubscription.context=context_4;subscription.add(innerSubscription)}
this.destination.next(window_1)}else{this.closeWindow(this.contexts.indexOf(outerValue))}};WindowToggleSubscriber.prototype.notifyError=function(err){this.error(err)};WindowToggleSubscriber.prototype.notifyComplete=function(inner){if(inner!==this.openSubscription){this.closeWindow(this.contexts.indexOf(inner.context))}};WindowToggleSubscriber.prototype.closeWindow=function(index){if(index===-1){return}
var contexts=this.contexts;var context=contexts[index];var window=context.window,subscription=context.subscription;contexts.splice(index,1);window.complete();subscription.unsubscribe()};return WindowToggleSubscriber}(OuterSubscriber_1.OuterSubscriber))},{"../OuterSubscriber":63,"../Subject":66,"../Subscription":69,"../util/subscribeToResult":253}],199:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject");var OuterSubscriber_1=require("../OuterSubscriber");var subscribeToResult_1=require("../util/subscribeToResult");function windowWhen(closingSelector){return function windowWhenOperatorFunction(source){return source.lift(new WindowOperator(closingSelector))}}
exports.windowWhen=windowWhen;var WindowOperator=(function(){function WindowOperator(closingSelector){this.closingSelector=closingSelector}
WindowOperator.prototype.call=function(subscriber,source){return source.subscribe(new WindowSubscriber(subscriber,this.closingSelector))};return WindowOperator}());var WindowSubscriber=(function(_super){__extends(WindowSubscriber,_super);function WindowSubscriber(destination,closingSelector){var _this=_super.call(this,destination)||this;_this.destination=destination;_this.closingSelector=closingSelector;_this.openWindow();return _this}
WindowSubscriber.prototype.notifyNext=function(_outerValue,_innerValue,_outerIndex,_innerIndex,innerSub){this.openWindow(innerSub)};WindowSubscriber.prototype.notifyError=function(error){this._error(error)};WindowSubscriber.prototype.notifyComplete=function(innerSub){this.openWindow(innerSub)};WindowSubscriber.prototype._next=function(value){this.window.next(value)};WindowSubscriber.prototype._error=function(err){this.window.error(err);this.destination.error(err);this.unsubscribeClosingNotification()};WindowSubscriber.prototype._complete=function(){this.window.complete();this.destination.complete();this.unsubscribeClosingNotification()};WindowSubscriber.prototype.unsubscribeClosingNotification=function(){if(this.closingNotification){this.closingNotification.unsubscribe()}};WindowSubscriber.prototype.openWindow=function(innerSub){if(innerSub===void 0){innerSub=null}
if(innerSub){this.remove(innerSub);innerSub.unsubscribe()}
var prevWindow=this.window;if(prevWindow){prevWindow.complete()}
var window=this.window=new Subject_1.Subject();this.destination.next(window);var closingNotifier;try{var closingSelector=this.closingSelector;closingNotifier=closingSelector()}catch(e){this.destination.error(e);this.window.error(e);return}
this.add(this.closingNotification=subscribeToResult_1.subscribeToResult(this,closingNotifier))};return WindowSubscriber}(OuterSubscriber_1.OuterSubscriber))},{"../OuterSubscriber":63,"../Subject":66,"../util/subscribeToResult":253}],200:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var OuterSubscriber_1=require("../OuterSubscriber");var subscribeToResult_1=require("../util/subscribeToResult");function withLatestFrom(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}
return function(source){var project;if(typeof args[args.length-1]==='function'){project=args.pop()}
var observables=args;return source.lift(new WithLatestFromOperator(observables,project))}}
exports.withLatestFrom=withLatestFrom;var WithLatestFromOperator=(function(){function WithLatestFromOperator(observables,project){this.observables=observables;this.project=project}
WithLatestFromOperator.prototype.call=function(subscriber,source){return source.subscribe(new WithLatestFromSubscriber(subscriber,this.observables,this.project))};return WithLatestFromOperator}());var WithLatestFromSubscriber=(function(_super){__extends(WithLatestFromSubscriber,_super);function WithLatestFromSubscriber(destination,observables,project){var _this=_super.call(this,destination)||this;_this.observables=observables;_this.project=project;_this.toRespond=[];var len=observables.length;_this.values=new Array(len);for(var i=0;i<len;i++){_this.toRespond.push(i)}
for(var i=0;i<len;i++){var observable=observables[i];_this.add(subscribeToResult_1.subscribeToResult(_this,observable,undefined,i))}
return _this}
WithLatestFromSubscriber.prototype.notifyNext=function(_outerValue,innerValue,outerIndex){this.values[outerIndex]=innerValue;var toRespond=this.toRespond;if(toRespond.length>0){var found=toRespond.indexOf(outerIndex);if(found!==-1){toRespond.splice(found,1)}}};WithLatestFromSubscriber.prototype.notifyComplete=function(){};WithLatestFromSubscriber.prototype._next=function(value){if(this.toRespond.length===0){var args=[value].concat(this.values);if(this.project){this._tryProject(args)}else{this.destination.next(args)}}};WithLatestFromSubscriber.prototype._tryProject=function(args){var result;try{result=this.project.apply(this,args)}catch(err){this.destination.error(err);return}
this.destination.next(result)};return WithLatestFromSubscriber}(OuterSubscriber_1.OuterSubscriber))},{"../OuterSubscriber":63,"../util/subscribeToResult":253}],201:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var zip_1=require("../observable/zip");function zip(){var observables=[];for(var _i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}
return function zipOperatorFunction(source){return source.lift.call(zip_1.zip.apply(void 0,[source].concat(observables)))}}
exports.zip=zip},{"../observable/zip":99}],202:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var zip_1=require("../observable/zip");function zipAll(project){return function(source){return source.lift(new zip_1.ZipOperator(project))}}
exports.zipAll=zipAll},{"../observable/zip":99}],203:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var Subscription_1=require("../Subscription");function scheduleArray(input,scheduler){return new Observable_1.Observable(function(subscriber){var sub=new Subscription_1.Subscription();var i=0;sub.add(scheduler.schedule(function(){if(i===input.length){subscriber.complete();return}
subscriber.next(input[i++]);if(!subscriber.closed){sub.add(this.schedule())}}));return sub})}
exports.scheduleArray=scheduleArray},{"../Observable":61,"../Subscription":69}],204:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var Subscription_1=require("../Subscription");var iterator_1=require("../symbol/iterator");function scheduleIterable(input,scheduler){if(!input){throw new Error('Iterable cannot be null')}
return new Observable_1.Observable(function(subscriber){var sub=new Subscription_1.Subscription();var iterator;sub.add(function(){if(iterator&&typeof iterator.return==='function'){iterator.return()}});sub.add(scheduler.schedule(function(){iterator=input[iterator_1.iterator]();sub.add(scheduler.schedule(function(){if(subscriber.closed){return}
var value;var done;try{var result=iterator.next();value=result.value;done=result.done}catch(err){subscriber.error(err);return}
if(done){subscriber.complete()}else{subscriber.next(value);this.schedule()}}))}));return sub})}
exports.scheduleIterable=scheduleIterable},{"../Observable":61,"../Subscription":69,"../symbol/iterator":222}],205:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var Subscription_1=require("../Subscription");var observable_1=require("../symbol/observable");function scheduleObservable(input,scheduler){return new Observable_1.Observable(function(subscriber){var sub=new Subscription_1.Subscription();sub.add(scheduler.schedule(function(){var observable=input[observable_1.observable]();sub.add(observable.subscribe({next:function(value){sub.add(scheduler.schedule(function(){return subscriber.next(value)}))},error:function(err){sub.add(scheduler.schedule(function(){return subscriber.error(err)}))},complete:function(){sub.add(scheduler.schedule(function(){return subscriber.complete()}))},}))}));return sub})}
exports.scheduleObservable=scheduleObservable},{"../Observable":61,"../Subscription":69,"../symbol/observable":223}],206:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");var Subscription_1=require("../Subscription");function schedulePromise(input,scheduler){return new Observable_1.Observable(function(subscriber){var sub=new Subscription_1.Subscription();sub.add(scheduler.schedule(function(){return input.then(function(value){sub.add(scheduler.schedule(function(){subscriber.next(value);sub.add(scheduler.schedule(function(){return subscriber.complete()}))}))},function(err){sub.add(scheduler.schedule(function(){return subscriber.error(err)}))})}));return sub})}
exports.schedulePromise=schedulePromise},{"../Observable":61,"../Subscription":69}],207:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var scheduleObservable_1=require("./scheduleObservable");var schedulePromise_1=require("./schedulePromise");var scheduleArray_1=require("./scheduleArray");var scheduleIterable_1=require("./scheduleIterable");var isInteropObservable_1=require("../util/isInteropObservable");var isPromise_1=require("../util/isPromise");var isArrayLike_1=require("../util/isArrayLike");var isIterable_1=require("../util/isIterable");function scheduled(input,scheduler){if(input!=null){if(isInteropObservable_1.isInteropObservable(input)){return scheduleObservable_1.scheduleObservable(input,scheduler)}else if(isPromise_1.isPromise(input)){return schedulePromise_1.schedulePromise(input,scheduler)}else if(isArrayLike_1.isArrayLike(input)){return scheduleArray_1.scheduleArray(input,scheduler)}else if(isIterable_1.isIterable(input)||typeof input==='string'){return scheduleIterable_1.scheduleIterable(input,scheduler)}}
throw new TypeError((input!==null&&typeof input||input)+' is not observable')}
exports.scheduled=scheduled},{"../util/isArrayLike":235,"../util/isInteropObservable":238,"../util/isIterable":239,"../util/isPromise":243,"./scheduleArray":203,"./scheduleIterable":204,"./scheduleObservable":205,"./schedulePromise":206}],208:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Subscription_1=require("../Subscription");var Action=(function(_super){__extends(Action,_super);function Action(scheduler,work){return _super.call(this)||this}
Action.prototype.schedule=function(state,delay){if(delay===void 0){delay=0}
return this};return Action}(Subscription_1.Subscription));exports.Action=Action},{"../Subscription":69}],209:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var AsyncAction_1=require("./AsyncAction");var AnimationFrameAction=(function(_super){__extends(AnimationFrameAction,_super);function AnimationFrameAction(scheduler,work){var _this=_super.call(this,scheduler,work)||this;_this.scheduler=scheduler;_this.work=work;return _this}
AnimationFrameAction.prototype.requestAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
if(delay!==null&&delay>0){return _super.prototype.requestAsyncId.call(this,scheduler,id,delay)}
scheduler.actions.push(this);return scheduler.scheduled||(scheduler.scheduled=requestAnimationFrame(function(){return scheduler.flush(null)}))};AnimationFrameAction.prototype.recycleAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
if((delay!==null&&delay>0)||(delay===null&&this.delay>0)){return _super.prototype.recycleAsyncId.call(this,scheduler,id,delay)}
if(scheduler.actions.length===0){cancelAnimationFrame(id);scheduler.scheduled=undefined}
return undefined};return AnimationFrameAction}(AsyncAction_1.AsyncAction));exports.AnimationFrameAction=AnimationFrameAction},{"./AsyncAction":213}],210:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var AsyncScheduler_1=require("./AsyncScheduler");var AnimationFrameScheduler=(function(_super){__extends(AnimationFrameScheduler,_super);function AnimationFrameScheduler(){return _super!==null&&_super.apply(this,arguments)||this}
AnimationFrameScheduler.prototype.flush=function(action){this.active=!0;this.scheduled=undefined;var actions=this.actions;var error;var index=-1;var count=actions.length;action=action||actions.shift();do{if(error=action.execute(action.state,action.delay)){break}}while(++index<count&&(action=actions.shift()));this.active=!1;if(error){while(++index<count&&(action=actions.shift())){action.unsubscribe()}
throw error}};return AnimationFrameScheduler}(AsyncScheduler_1.AsyncScheduler));exports.AnimationFrameScheduler=AnimationFrameScheduler},{"./AsyncScheduler":214}],211:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Immediate_1=require("../util/Immediate");var AsyncAction_1=require("./AsyncAction");var AsapAction=(function(_super){__extends(AsapAction,_super);function AsapAction(scheduler,work){var _this=_super.call(this,scheduler,work)||this;_this.scheduler=scheduler;_this.work=work;return _this}
AsapAction.prototype.requestAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
if(delay!==null&&delay>0){return _super.prototype.requestAsyncId.call(this,scheduler,id,delay)}
scheduler.actions.push(this);return scheduler.scheduled||(scheduler.scheduled=Immediate_1.Immediate.setImmediate(scheduler.flush.bind(scheduler,null)))};AsapAction.prototype.recycleAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
if((delay!==null&&delay>0)||(delay===null&&this.delay>0)){return _super.prototype.recycleAsyncId.call(this,scheduler,id,delay)}
if(scheduler.actions.length===0){Immediate_1.Immediate.clearImmediate(id);scheduler.scheduled=undefined}
return undefined};return AsapAction}(AsyncAction_1.AsyncAction));exports.AsapAction=AsapAction},{"../util/Immediate":227,"./AsyncAction":213}],212:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var AsyncScheduler_1=require("./AsyncScheduler");var AsapScheduler=(function(_super){__extends(AsapScheduler,_super);function AsapScheduler(){return _super!==null&&_super.apply(this,arguments)||this}
AsapScheduler.prototype.flush=function(action){this.active=!0;this.scheduled=undefined;var actions=this.actions;var error;var index=-1;var count=actions.length;action=action||actions.shift();do{if(error=action.execute(action.state,action.delay)){break}}while(++index<count&&(action=actions.shift()));this.active=!1;if(error){while(++index<count&&(action=actions.shift())){action.unsubscribe()}
throw error}};return AsapScheduler}(AsyncScheduler_1.AsyncScheduler));exports.AsapScheduler=AsapScheduler},{"./AsyncScheduler":214}],213:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Action_1=require("./Action");var AsyncAction=(function(_super){__extends(AsyncAction,_super);function AsyncAction(scheduler,work){var _this=_super.call(this,scheduler,work)||this;_this.scheduler=scheduler;_this.work=work;_this.pending=!1;return _this}
AsyncAction.prototype.schedule=function(state,delay){if(delay===void 0){delay=0}
if(this.closed){return this}
this.state=state;var id=this.id;var scheduler=this.scheduler;if(id!=null){this.id=this.recycleAsyncId(scheduler,id,delay)}
this.pending=!0;this.delay=delay;this.id=this.id||this.requestAsyncId(scheduler,this.id,delay);return this};AsyncAction.prototype.requestAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
return setInterval(scheduler.flush.bind(scheduler,this),delay)};AsyncAction.prototype.recycleAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
if(delay!==null&&this.delay===delay&&this.pending===!1){return id}
clearInterval(id);return undefined};AsyncAction.prototype.execute=function(state,delay){if(this.closed){return new Error('executing a cancelled action')}
this.pending=!1;var error=this._execute(state,delay);if(error){return error}else if(this.pending===!1&&this.id!=null){this.id=this.recycleAsyncId(this.scheduler,this.id,null)}};AsyncAction.prototype._execute=function(state,delay){var errored=!1;var errorValue=undefined;try{this.work(state)}catch(e){errored=!0;errorValue=!!e&&e||new Error(e)}
if(errored){this.unsubscribe();return errorValue}};AsyncAction.prototype._unsubscribe=function(){var id=this.id;var scheduler=this.scheduler;var actions=scheduler.actions;var index=actions.indexOf(this);this.work=null;this.state=null;this.pending=!1;this.scheduler=null;if(index!==-1){actions.splice(index,1)}
if(id!=null){this.id=this.recycleAsyncId(scheduler,id,null)}
this.delay=null};return AsyncAction}(Action_1.Action));exports.AsyncAction=AsyncAction},{"./Action":208}],214:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var Scheduler_1=require("../Scheduler");var AsyncScheduler=(function(_super){__extends(AsyncScheduler,_super);function AsyncScheduler(SchedulerAction,now){if(now===void 0){now=Scheduler_1.Scheduler.now}
var _this=_super.call(this,SchedulerAction,function(){if(AsyncScheduler.delegate&&AsyncScheduler.delegate!==_this){return AsyncScheduler.delegate.now()}else{return now()}})||this;_this.actions=[];_this.active=!1;_this.scheduled=undefined;return _this}
AsyncScheduler.prototype.schedule=function(work,delay,state){if(delay===void 0){delay=0}
if(AsyncScheduler.delegate&&AsyncScheduler.delegate!==this){return AsyncScheduler.delegate.schedule(work,delay,state)}else{return _super.prototype.schedule.call(this,work,delay,state)}};AsyncScheduler.prototype.flush=function(action){var actions=this.actions;if(this.active){actions.push(action);return}
var error;this.active=!0;do{if(error=action.execute(action.state,action.delay)){break}}while(action=actions.shift());this.active=!1;if(error){while(action=actions.shift()){action.unsubscribe()}
throw error}};return AsyncScheduler}(Scheduler_1.Scheduler));exports.AsyncScheduler=AsyncScheduler},{"../Scheduler":65}],215:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var AsyncAction_1=require("./AsyncAction");var QueueAction=(function(_super){__extends(QueueAction,_super);function QueueAction(scheduler,work){var _this=_super.call(this,scheduler,work)||this;_this.scheduler=scheduler;_this.work=work;return _this}
QueueAction.prototype.schedule=function(state,delay){if(delay===void 0){delay=0}
if(delay>0){return _super.prototype.schedule.call(this,state,delay)}
this.delay=delay;this.state=state;this.scheduler.flush(this);return this};QueueAction.prototype.execute=function(state,delay){return(delay>0||this.closed)?_super.prototype.execute.call(this,state,delay):this._execute(state,delay)};QueueAction.prototype.requestAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
if((delay!==null&&delay>0)||(delay===null&&this.delay>0)){return _super.prototype.requestAsyncId.call(this,scheduler,id,delay)}
return scheduler.flush(this)};return QueueAction}(AsyncAction_1.AsyncAction));exports.QueueAction=QueueAction},{"./AsyncAction":213}],216:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var AsyncScheduler_1=require("./AsyncScheduler");var QueueScheduler=(function(_super){__extends(QueueScheduler,_super);function QueueScheduler(){return _super!==null&&_super.apply(this,arguments)||this}
return QueueScheduler}(AsyncScheduler_1.AsyncScheduler));exports.QueueScheduler=QueueScheduler},{"./AsyncScheduler":214}],217:[function(require,module,exports){"use strict";var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);}
return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();Object.defineProperty(exports,"__esModule",{value:!0});var AsyncAction_1=require("./AsyncAction");var AsyncScheduler_1=require("./AsyncScheduler");var VirtualTimeScheduler=(function(_super){__extends(VirtualTimeScheduler,_super);function VirtualTimeScheduler(SchedulerAction,maxFrames){if(SchedulerAction===void 0){SchedulerAction=VirtualAction}
if(maxFrames===void 0){maxFrames=Number.POSITIVE_INFINITY}
var _this=_super.call(this,SchedulerAction,function(){return _this.frame})||this;_this.maxFrames=maxFrames;_this.frame=0;_this.index=-1;return _this}
VirtualTimeScheduler.prototype.flush=function(){var _a=this,actions=_a.actions,maxFrames=_a.maxFrames;var error,action;while((action=actions[0])&&action.delay<=maxFrames){actions.shift();this.frame=action.delay;if(error=action.execute(action.state,action.delay)){break}}
if(error){while(action=actions.shift()){action.unsubscribe()}
throw error}};VirtualTimeScheduler.frameTimeFactor=10;return VirtualTimeScheduler}(AsyncScheduler_1.AsyncScheduler));exports.VirtualTimeScheduler=VirtualTimeScheduler;var VirtualAction=(function(_super){__extends(VirtualAction,_super);function VirtualAction(scheduler,work,index){if(index===void 0){index=scheduler.index+=1}
var _this=_super.call(this,scheduler,work)||this;_this.scheduler=scheduler;_this.work=work;_this.index=index;_this.active=!0;_this.index=scheduler.index=index;return _this}
VirtualAction.prototype.schedule=function(state,delay){if(delay===void 0){delay=0}
if(!this.id){return _super.prototype.schedule.call(this,state,delay)}
this.active=!1;var action=new VirtualAction(this.scheduler,this.work);this.add(action);return action.schedule(state,delay)};VirtualAction.prototype.requestAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
this.delay=scheduler.frame+delay;var actions=scheduler.actions;actions.push(this);actions.sort(VirtualAction.sortActions);return!0};VirtualAction.prototype.recycleAsyncId=function(scheduler,id,delay){if(delay===void 0){delay=0}
return undefined};VirtualAction.prototype._execute=function(state,delay){if(this.active===!0){return _super.prototype._execute.call(this,state,delay)}};VirtualAction.sortActions=function(a,b){if(a.delay===b.delay){if(a.index===b.index){return 0}else if(a.index>b.index){return 1}else{return-1}}else if(a.delay>b.delay){return 1}else{return-1}};return VirtualAction}(AsyncAction_1.AsyncAction));exports.VirtualAction=VirtualAction},{"./AsyncAction":213,"./AsyncScheduler":214}],218:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var AnimationFrameAction_1=require("./AnimationFrameAction");var AnimationFrameScheduler_1=require("./AnimationFrameScheduler");exports.animationFrameScheduler=new AnimationFrameScheduler_1.AnimationFrameScheduler(AnimationFrameAction_1.AnimationFrameAction);exports.animationFrame=exports.animationFrameScheduler},{"./AnimationFrameAction":209,"./AnimationFrameScheduler":210}],219:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var AsapAction_1=require("./AsapAction");var AsapScheduler_1=require("./AsapScheduler");exports.asapScheduler=new AsapScheduler_1.AsapScheduler(AsapAction_1.AsapAction);exports.asap=exports.asapScheduler},{"./AsapAction":211,"./AsapScheduler":212}],220:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var AsyncAction_1=require("./AsyncAction");var AsyncScheduler_1=require("./AsyncScheduler");exports.asyncScheduler=new AsyncScheduler_1.AsyncScheduler(AsyncAction_1.AsyncAction);exports.async=exports.asyncScheduler},{"./AsyncAction":213,"./AsyncScheduler":214}],221:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var QueueAction_1=require("./QueueAction");var QueueScheduler_1=require("./QueueScheduler");exports.queueScheduler=new QueueScheduler_1.QueueScheduler(QueueAction_1.QueueAction);exports.queue=exports.queueScheduler},{"./QueueAction":215,"./QueueScheduler":216}],222:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function getSymbolIterator(){if(typeof Symbol!=='function'||!Symbol.iterator){return'@@iterator'}
return Symbol.iterator}
exports.getSymbolIterator=getSymbolIterator;exports.iterator=getSymbolIterator();exports.$$iterator=exports.iterator},{}],223:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.observable=(function(){return typeof Symbol==='function'&&Symbol.observable||'@@observable'})()},{}],224:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.rxSubscriber=(function(){return typeof Symbol==='function'?Symbol('rxSubscriber'):'@@rxSubscriber_'+Math.random()})();exports.$$rxSubscriber=exports.rxSubscriber},{}],225:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ArgumentOutOfRangeErrorImpl=(function(){function ArgumentOutOfRangeErrorImpl(){Error.call(this);this.message='argument out of range';this.name='ArgumentOutOfRangeError';return this}
ArgumentOutOfRangeErrorImpl.prototype=Object.create(Error.prototype);return ArgumentOutOfRangeErrorImpl})();exports.ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl},{}],226:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var EmptyErrorImpl=(function(){function EmptyErrorImpl(){Error.call(this);this.message='no elements in sequence';this.name='EmptyError';return this}
EmptyErrorImpl.prototype=Object.create(Error.prototype);return EmptyErrorImpl})();exports.EmptyError=EmptyErrorImpl},{}],227:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var nextHandle=1;var RESOLVED=(function(){return Promise.resolve()})();var activeHandles={};function findAndClearHandle(handle){if(handle in activeHandles){delete activeHandles[handle];return!0}
return!1}
exports.Immediate={setImmediate:function(cb){var handle=nextHandle++;activeHandles[handle]=!0;RESOLVED.then(function(){return findAndClearHandle(handle)&&cb()});return handle},clearImmediate:function(handle){findAndClearHandle(handle)},};exports.TestTools={pending:function(){return Object.keys(activeHandles).length}}},{}],228:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ObjectUnsubscribedErrorImpl=(function(){function ObjectUnsubscribedErrorImpl(){Error.call(this);this.message='object unsubscribed';this.name='ObjectUnsubscribedError';return this}
ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype);return ObjectUnsubscribedErrorImpl})();exports.ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl},{}],229:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var TimeoutErrorImpl=(function(){function TimeoutErrorImpl(){Error.call(this);this.message='Timeout has occurred';this.name='TimeoutError';return this}
TimeoutErrorImpl.prototype=Object.create(Error.prototype);return TimeoutErrorImpl})();exports.TimeoutError=TimeoutErrorImpl},{}],230:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var UnsubscriptionErrorImpl=(function(){function UnsubscriptionErrorImpl(errors){Error.call(this);this.message=errors?errors.length+" errors occurred during unsubscription:\n"+errors.map(function(err,i){return i+1+") "+err.toString()}).join('\n  '):'';this.name='UnsubscriptionError';this.errors=errors;return this}
UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype);return UnsubscriptionErrorImpl})();exports.UnsubscriptionError=UnsubscriptionErrorImpl},{}],231:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function canReportError(observer){while(observer){var _a=observer,closed_1=_a.closed,destination=_a.destination,isStopped=_a.isStopped;if(closed_1||isStopped){return!1}else if(destination&&destination instanceof Subscriber_1.Subscriber){observer=destination}else{observer=null}}
return!0}
exports.canReportError=canReportError},{"../Subscriber":68}],232:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function hostReportError(err){setTimeout(function(){throw err},0)}
exports.hostReportError=hostReportError},{}],233:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function identity(x){return x}
exports.identity=identity},{}],234:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.isArray=(function(){return Array.isArray||(function(x){return x&&typeof x.length==='number'})})()},{}],235:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.isArrayLike=(function(x){return x&&typeof x.length==='number'&&typeof x!=='function'})},{}],236:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function isDate(value){return value instanceof Date&&!isNaN(+value)}
exports.isDate=isDate},{}],237:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function isFunction(x){return typeof x==='function'}
exports.isFunction=isFunction},{}],238:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var observable_1=require("../symbol/observable");function isInteropObservable(input){return input&&typeof input[observable_1.observable]==='function'}
exports.isInteropObservable=isInteropObservable},{"../symbol/observable":223}],239:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var iterator_1=require("../symbol/iterator");function isIterable(input){return input&&typeof input[iterator_1.iterator]==='function'}
exports.isIterable=isIterable},{"../symbol/iterator":222}],240:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isArray_1=require("./isArray");function isNumeric(val){return!isArray_1.isArray(val)&&(val-parseFloat(val)+1)>=0}
exports.isNumeric=isNumeric},{"./isArray":234}],241:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function isObject(x){return x!==null&&typeof x==='object'}
exports.isObject=isObject},{}],242:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable");function isObservable(obj){return!!obj&&(obj instanceof Observable_1.Observable||(typeof obj.lift==='function'&&typeof obj.subscribe==='function'))}
exports.isObservable=isObservable},{"../Observable":61}],243:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function isPromise(value){return!!value&&typeof value.subscribe!=='function'&&typeof value.then==='function'}
exports.isPromise=isPromise},{}],244:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function isScheduler(value){return value&&typeof value.schedule==='function'}
exports.isScheduler=isScheduler},{}],245:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function noop(){}
exports.noop=noop},{}],246:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function not(pred,thisArg){function notPred(){return!(notPred.pred.apply(notPred.thisArg,arguments))}
notPred.pred=pred;notPred.thisArg=thisArg;return notPred}
exports.not=not},{}],247:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var identity_1=require("./identity");function pipe(){var fns=[];for(var _i=0;_i<arguments.length;_i++){fns[_i]=arguments[_i]}
return pipeFromArray(fns)}
exports.pipe=pipe;function pipeFromArray(fns){if(fns.length===0){return identity_1.identity}
if(fns.length===1){return fns[0]}
return function piped(input){return fns.reduce(function(prev,fn){return fn(prev)},input)}}
exports.pipeFromArray=pipeFromArray},{"./identity":233}],248:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var subscribeToArray_1=require("./subscribeToArray");var subscribeToPromise_1=require("./subscribeToPromise");var subscribeToIterable_1=require("./subscribeToIterable");var subscribeToObservable_1=require("./subscribeToObservable");var isArrayLike_1=require("./isArrayLike");var isPromise_1=require("./isPromise");var isObject_1=require("./isObject");var iterator_1=require("../symbol/iterator");var observable_1=require("../symbol/observable");exports.subscribeTo=function(result){if(!!result&&typeof result[observable_1.observable]==='function'){return subscribeToObservable_1.subscribeToObservable(result)}else if(isArrayLike_1.isArrayLike(result)){return subscribeToArray_1.subscribeToArray(result)}else if(isPromise_1.isPromise(result)){return subscribeToPromise_1.subscribeToPromise(result)}else if(!!result&&typeof result[iterator_1.iterator]==='function'){return subscribeToIterable_1.subscribeToIterable(result)}else{var value=isObject_1.isObject(result)?'an invalid object':"'"+result+"'";var msg="You provided "+value+" where a stream was expected."+' You can provide an Observable, Promise, Array, or Iterable.';throw new TypeError(msg)}}},{"../symbol/iterator":222,"../symbol/observable":223,"./isArrayLike":235,"./isObject":241,"./isPromise":243,"./subscribeToArray":249,"./subscribeToIterable":250,"./subscribeToObservable":251,"./subscribeToPromise":252}],249:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.subscribeToArray=function(array){return function(subscriber){for(var i=0,len=array.length;i<len&&!subscriber.closed;i++){subscriber.next(array[i])}
subscriber.complete()}}},{}],250:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var iterator_1=require("../symbol/iterator");exports.subscribeToIterable=function(iterable){return function(subscriber){var iterator=iterable[iterator_1.iterator]();do{var item=void 0;try{item=iterator.next()}catch(err){subscriber.error(err);return subscriber}
if(item.done){subscriber.complete();break}
subscriber.next(item.value);if(subscriber.closed){break}}while(!0);if(typeof iterator.return==='function'){subscriber.add(function(){if(iterator.return){iterator.return()}})}
return subscriber}}},{"../symbol/iterator":222}],251:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var observable_1=require("../symbol/observable");exports.subscribeToObservable=function(obj){return function(subscriber){var obs=obj[observable_1.observable]();if(typeof obs.subscribe!=='function'){throw new TypeError('Provided object does not correctly implement Symbol.observable')}else{return obs.subscribe(subscriber)}}}},{"../symbol/observable":223}],252:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var hostReportError_1=require("./hostReportError");exports.subscribeToPromise=function(promise){return function(subscriber){promise.then(function(value){if(!subscriber.closed){subscriber.next(value);subscriber.complete()}},function(err){return subscriber.error(err)}).then(null,hostReportError_1.hostReportError);return subscriber}}},{"./hostReportError":232}],253:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var InnerSubscriber_1=require("../InnerSubscriber");var subscribeTo_1=require("./subscribeTo");var Observable_1=require("../Observable");function subscribeToResult(outerSubscriber,result,outerValue,outerIndex,innerSubscriber){if(innerSubscriber===void 0){innerSubscriber=new InnerSubscriber_1.InnerSubscriber(outerSubscriber,outerValue,outerIndex)}
if(innerSubscriber.closed){return undefined}
if(result instanceof Observable_1.Observable){return result.subscribe(innerSubscriber)}
return subscribeTo_1.subscribeTo(result)(innerSubscriber)}
exports.subscribeToResult=subscribeToResult},{"../InnerSubscriber":59,"../Observable":61,"./subscribeTo":248}],254:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");var rxSubscriber_1=require("../symbol/rxSubscriber");var Observer_1=require("../Observer");function toSubscriber(nextOrObserver,error,complete){if(nextOrObserver){if(nextOrObserver instanceof Subscriber_1.Subscriber){return nextOrObserver}
if(nextOrObserver[rxSubscriber_1.rxSubscriber]){return nextOrObserver[rxSubscriber_1.rxSubscriber]()}}
if(!nextOrObserver&&!error&&!complete){return new Subscriber_1.Subscriber(Observer_1.empty)}
return new Subscriber_1.Subscriber(nextOrObserver,error,complete)}
exports.toSubscriber=toSubscriber},{"../Observer":62,"../Subscriber":68,"../symbol/rxSubscriber":224}],255:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var audit_1=require("../internal/operators/audit");exports.audit=audit_1.audit;var auditTime_1=require("../internal/operators/auditTime");exports.auditTime=auditTime_1.auditTime;var buffer_1=require("../internal/operators/buffer");exports.buffer=buffer_1.buffer;var bufferCount_1=require("../internal/operators/bufferCount");exports.bufferCount=bufferCount_1.bufferCount;var bufferTime_1=require("../internal/operators/bufferTime");exports.bufferTime=bufferTime_1.bufferTime;var bufferToggle_1=require("../internal/operators/bufferToggle");exports.bufferToggle=bufferToggle_1.bufferToggle;var bufferWhen_1=require("../internal/operators/bufferWhen");exports.bufferWhen=bufferWhen_1.bufferWhen;var catchError_1=require("../internal/operators/catchError");exports.catchError=catchError_1.catchError;var combineAll_1=require("../internal/operators/combineAll");exports.combineAll=combineAll_1.combineAll;var combineLatest_1=require("../internal/operators/combineLatest");exports.combineLatest=combineLatest_1.combineLatest;var concat_1=require("../internal/operators/concat");exports.concat=concat_1.concat;var concatAll_1=require("../internal/operators/concatAll");exports.concatAll=concatAll_1.concatAll;var concatMap_1=require("../internal/operators/concatMap");exports.concatMap=concatMap_1.concatMap;var concatMapTo_1=require("../internal/operators/concatMapTo");exports.concatMapTo=concatMapTo_1.concatMapTo;var count_1=require("../internal/operators/count");exports.count=count_1.count;var debounce_1=require("../internal/operators/debounce");exports.debounce=debounce_1.debounce;var debounceTime_1=require("../internal/operators/debounceTime");exports.debounceTime=debounceTime_1.debounceTime;var defaultIfEmpty_1=require("../internal/operators/defaultIfEmpty");exports.defaultIfEmpty=defaultIfEmpty_1.defaultIfEmpty;var delay_1=require("../internal/operators/delay");exports.delay=delay_1.delay;var delayWhen_1=require("../internal/operators/delayWhen");exports.delayWhen=delayWhen_1.delayWhen;var dematerialize_1=require("../internal/operators/dematerialize");exports.dematerialize=dematerialize_1.dematerialize;var distinct_1=require("../internal/operators/distinct");exports.distinct=distinct_1.distinct;var distinctUntilChanged_1=require("../internal/operators/distinctUntilChanged");exports.distinctUntilChanged=distinctUntilChanged_1.distinctUntilChanged;var distinctUntilKeyChanged_1=require("../internal/operators/distinctUntilKeyChanged");exports.distinctUntilKeyChanged=distinctUntilKeyChanged_1.distinctUntilKeyChanged;var elementAt_1=require("../internal/operators/elementAt");exports.elementAt=elementAt_1.elementAt;var endWith_1=require("../internal/operators/endWith");exports.endWith=endWith_1.endWith;var every_1=require("../internal/operators/every");exports.every=every_1.every;var exhaust_1=require("../internal/operators/exhaust");exports.exhaust=exhaust_1.exhaust;var exhaustMap_1=require("../internal/operators/exhaustMap");exports.exhaustMap=exhaustMap_1.exhaustMap;var expand_1=require("../internal/operators/expand");exports.expand=expand_1.expand;var filter_1=require("../internal/operators/filter");exports.filter=filter_1.filter;var finalize_1=require("../internal/operators/finalize");exports.finalize=finalize_1.finalize;var find_1=require("../internal/operators/find");exports.find=find_1.find;var findIndex_1=require("../internal/operators/findIndex");exports.findIndex=findIndex_1.findIndex;var first_1=require("../internal/operators/first");exports.first=first_1.first;var groupBy_1=require("../internal/operators/groupBy");exports.groupBy=groupBy_1.groupBy;var ignoreElements_1=require("../internal/operators/ignoreElements");exports.ignoreElements=ignoreElements_1.ignoreElements;var isEmpty_1=require("../internal/operators/isEmpty");exports.isEmpty=isEmpty_1.isEmpty;var last_1=require("../internal/operators/last");exports.last=last_1.last;var map_1=require("../internal/operators/map");exports.map=map_1.map;var mapTo_1=require("../internal/operators/mapTo");exports.mapTo=mapTo_1.mapTo;var materialize_1=require("../internal/operators/materialize");exports.materialize=materialize_1.materialize;var max_1=require("../internal/operators/max");exports.max=max_1.max;var merge_1=require("../internal/operators/merge");exports.merge=merge_1.merge;var mergeAll_1=require("../internal/operators/mergeAll");exports.mergeAll=mergeAll_1.mergeAll;var mergeMap_1=require("../internal/operators/mergeMap");exports.mergeMap=mergeMap_1.mergeMap;exports.flatMap=mergeMap_1.flatMap;var mergeMapTo_1=require("../internal/operators/mergeMapTo");exports.mergeMapTo=mergeMapTo_1.mergeMapTo;var mergeScan_1=require("../internal/operators/mergeScan");exports.mergeScan=mergeScan_1.mergeScan;var min_1=require("../internal/operators/min");exports.min=min_1.min;var multicast_1=require("../internal/operators/multicast");exports.multicast=multicast_1.multicast;var observeOn_1=require("../internal/operators/observeOn");exports.observeOn=observeOn_1.observeOn;var onErrorResumeNext_1=require("../internal/operators/onErrorResumeNext");exports.onErrorResumeNext=onErrorResumeNext_1.onErrorResumeNext;var pairwise_1=require("../internal/operators/pairwise");exports.pairwise=pairwise_1.pairwise;var partition_1=require("../internal/operators/partition");exports.partition=partition_1.partition;var pluck_1=require("../internal/operators/pluck");exports.pluck=pluck_1.pluck;var publish_1=require("../internal/operators/publish");exports.publish=publish_1.publish;var publishBehavior_1=require("../internal/operators/publishBehavior");exports.publishBehavior=publishBehavior_1.publishBehavior;var publishLast_1=require("../internal/operators/publishLast");exports.publishLast=publishLast_1.publishLast;var publishReplay_1=require("../internal/operators/publishReplay");exports.publishReplay=publishReplay_1.publishReplay;var race_1=require("../internal/operators/race");exports.race=race_1.race;var reduce_1=require("../internal/operators/reduce");exports.reduce=reduce_1.reduce;var repeat_1=require("../internal/operators/repeat");exports.repeat=repeat_1.repeat;var repeatWhen_1=require("../internal/operators/repeatWhen");exports.repeatWhen=repeatWhen_1.repeatWhen;var retry_1=require("../internal/operators/retry");exports.retry=retry_1.retry;var retryWhen_1=require("../internal/operators/retryWhen");exports.retryWhen=retryWhen_1.retryWhen;var refCount_1=require("../internal/operators/refCount");exports.refCount=refCount_1.refCount;var sample_1=require("../internal/operators/sample");exports.sample=sample_1.sample;var sampleTime_1=require("../internal/operators/sampleTime");exports.sampleTime=sampleTime_1.sampleTime;var scan_1=require("../internal/operators/scan");exports.scan=scan_1.scan;var sequenceEqual_1=require("../internal/operators/sequenceEqual");exports.sequenceEqual=sequenceEqual_1.sequenceEqual;var share_1=require("../internal/operators/share");exports.share=share_1.share;var shareReplay_1=require("../internal/operators/shareReplay");exports.shareReplay=shareReplay_1.shareReplay;var single_1=require("../internal/operators/single");exports.single=single_1.single;var skip_1=require("../internal/operators/skip");exports.skip=skip_1.skip;var skipLast_1=require("../internal/operators/skipLast");exports.skipLast=skipLast_1.skipLast;var skipUntil_1=require("../internal/operators/skipUntil");exports.skipUntil=skipUntil_1.skipUntil;var skipWhile_1=require("../internal/operators/skipWhile");exports.skipWhile=skipWhile_1.skipWhile;var startWith_1=require("../internal/operators/startWith");exports.startWith=startWith_1.startWith;var subscribeOn_1=require("../internal/operators/subscribeOn");exports.subscribeOn=subscribeOn_1.subscribeOn;var switchAll_1=require("../internal/operators/switchAll");exports.switchAll=switchAll_1.switchAll;var switchMap_1=require("../internal/operators/switchMap");exports.switchMap=switchMap_1.switchMap;var switchMapTo_1=require("../internal/operators/switchMapTo");exports.switchMapTo=switchMapTo_1.switchMapTo;var take_1=require("../internal/operators/take");exports.take=take_1.take;var takeLast_1=require("../internal/operators/takeLast");exports.takeLast=takeLast_1.takeLast;var takeUntil_1=require("../internal/operators/takeUntil");exports.takeUntil=takeUntil_1.takeUntil;var takeWhile_1=require("../internal/operators/takeWhile");exports.takeWhile=takeWhile_1.takeWhile;var tap_1=require("../internal/operators/tap");exports.tap=tap_1.tap;var throttle_1=require("../internal/operators/throttle");exports.throttle=throttle_1.throttle;var throttleTime_1=require("../internal/operators/throttleTime");exports.throttleTime=throttleTime_1.throttleTime;var throwIfEmpty_1=require("../internal/operators/throwIfEmpty");exports.throwIfEmpty=throwIfEmpty_1.throwIfEmpty;var timeInterval_1=require("../internal/operators/timeInterval");exports.timeInterval=timeInterval_1.timeInterval;var timeout_1=require("../internal/operators/timeout");exports.timeout=timeout_1.timeout;var timeoutWith_1=require("../internal/operators/timeoutWith");exports.timeoutWith=timeoutWith_1.timeoutWith;var timestamp_1=require("../internal/operators/timestamp");exports.timestamp=timestamp_1.timestamp;var toArray_1=require("../internal/operators/toArray");exports.toArray=toArray_1.toArray;var window_1=require("../internal/operators/window");exports.window=window_1.window;var windowCount_1=require("../internal/operators/windowCount");exports.windowCount=windowCount_1.windowCount;var windowTime_1=require("../internal/operators/windowTime");exports.windowTime=windowTime_1.windowTime;var windowToggle_1=require("../internal/operators/windowToggle");exports.windowToggle=windowToggle_1.windowToggle;var windowWhen_1=require("../internal/operators/windowWhen");exports.windowWhen=windowWhen_1.windowWhen;var withLatestFrom_1=require("../internal/operators/withLatestFrom");exports.withLatestFrom=withLatestFrom_1.withLatestFrom;var zip_1=require("../internal/operators/zip");exports.zip=zip_1.zip;var zipAll_1=require("../internal/operators/zipAll");exports.zipAll=zipAll_1.zipAll},{"../internal/operators/audit":100,"../internal/operators/auditTime":101,"../internal/operators/buffer":102,"../internal/operators/bufferCount":103,"../internal/operators/bufferTime":104,"../internal/operators/bufferToggle":105,"../internal/operators/bufferWhen":106,"../internal/operators/catchError":107,"../internal/operators/combineAll":108,"../internal/operators/combineLatest":109,"../internal/operators/concat":110,"../internal/operators/concatAll":111,"../internal/operators/concatMap":112,"../internal/operators/concatMapTo":113,"../internal/operators/count":114,"../internal/operators/debounce":115,"../internal/operators/debounceTime":116,"../internal/operators/defaultIfEmpty":117,"../internal/operators/delay":118,"../internal/operators/delayWhen":119,"../internal/operators/dematerialize":120,"../internal/operators/distinct":121,"../internal/operators/distinctUntilChanged":122,"../internal/operators/distinctUntilKeyChanged":123,"../internal/operators/elementAt":124,"../internal/operators/endWith":125,"../internal/operators/every":126,"../internal/operators/exhaust":127,"../internal/operators/exhaustMap":128,"../internal/operators/expand":129,"../internal/operators/filter":130,"../internal/operators/finalize":131,"../internal/operators/find":132,"../internal/operators/findIndex":133,"../internal/operators/first":134,"../internal/operators/groupBy":135,"../internal/operators/ignoreElements":136,"../internal/operators/isEmpty":137,"../internal/operators/last":138,"../internal/operators/map":139,"../internal/operators/mapTo":140,"../internal/operators/materialize":141,"../internal/operators/max":142,"../internal/operators/merge":143,"../internal/operators/mergeAll":144,"../internal/operators/mergeMap":145,"../internal/operators/mergeMapTo":146,"../internal/operators/mergeScan":147,"../internal/operators/min":148,"../internal/operators/multicast":149,"../internal/operators/observeOn":150,"../internal/operators/onErrorResumeNext":151,"../internal/operators/pairwise":152,"../internal/operators/partition":153,"../internal/operators/pluck":154,"../internal/operators/publish":155,"../internal/operators/publishBehavior":156,"../internal/operators/publishLast":157,"../internal/operators/publishReplay":158,"../internal/operators/race":159,"../internal/operators/reduce":160,"../internal/operators/refCount":161,"../internal/operators/repeat":162,"../internal/operators/repeatWhen":163,"../internal/operators/retry":164,"../internal/operators/retryWhen":165,"../internal/operators/sample":166,"../internal/operators/sampleTime":167,"../internal/operators/scan":168,"../internal/operators/sequenceEqual":169,"../internal/operators/share":170,"../internal/operators/shareReplay":171,"../internal/operators/single":172,"../internal/operators/skip":173,"../internal/operators/skipLast":174,"../internal/operators/skipUntil":175,"../internal/operators/skipWhile":176,"../internal/operators/startWith":177,"../internal/operators/subscribeOn":178,"../internal/operators/switchAll":179,"../internal/operators/switchMap":180,"../internal/operators/switchMapTo":181,"../internal/operators/take":182,"../internal/operators/takeLast":183,"../internal/operators/takeUntil":184,"../internal/operators/takeWhile":185,"../internal/operators/tap":186,"../internal/operators/throttle":187,"../internal/operators/throttleTime":188,"../internal/operators/throwIfEmpty":189,"../internal/operators/timeInterval":190,"../internal/operators/timeout":191,"../internal/operators/timeoutWith":192,"../internal/operators/timestamp":193,"../internal/operators/toArray":194,"../internal/operators/window":195,"../internal/operators/windowCount":196,"../internal/operators/windowTime":197,"../internal/operators/windowToggle":198,"../internal/operators/windowWhen":199,"../internal/operators/withLatestFrom":200,"../internal/operators/zip":201,"../internal/operators/zipAll":202}],256:[function(require,module,exports){const ANY=Symbol('SemVer ANY')
class Comparator{static get ANY(){return ANY}
constructor(comp,options){options=parseOptions(options)
if(comp instanceof Comparator){if(comp.loose===!!options.loose){return comp}else{comp=comp.value}}
comp=comp.trim().split(/\s+/).join(' ')
debug('comparator',comp,options)
this.options=options
this.loose=!!options.loose
this.parse(comp)
if(this.semver===ANY){this.value=''}else{this.value=this.operator+this.semver.version}
debug('comp',this)}
parse(comp){const r=this.options.loose?re[t.COMPARATORLOOSE]:re[t.COMPARATOR]
const m=comp.match(r)
if(!m){throw new TypeError(`Invalid comparator: ${comp}`)}
this.operator=m[1]!==undefined?m[1]:''
if(this.operator==='='){this.operator=''}
if(!m[2]){this.semver=ANY}else{this.semver=new SemVer(m[2],this.options.loose)}}
toString(){return this.value}
test(version){debug('Comparator.test',version,this.options.loose)
if(this.semver===ANY||version===ANY){return!0}
if(typeof version==='string'){try{version=new SemVer(version,this.options)}catch(er){return!1}}
return cmp(version,this.operator,this.semver,this.options)}
intersects(comp,options){if(!(comp instanceof Comparator)){throw new TypeError('a Comparator is required')}
if(this.operator===''){if(this.value===''){return!0}
return new Range(comp.value,options).test(this.value)}else if(comp.operator===''){if(comp.value===''){return!0}
return new Range(this.value,options).test(comp.semver)}
options=parseOptions(options)
if(options.includePrerelease&&(this.value==='<0.0.0-0'||comp.value==='<0.0.0-0')){return!1}
if(!options.includePrerelease&&(this.value.startsWith('<0.0.0')||comp.value.startsWith('<0.0.0'))){return!1}
if(this.operator.startsWith('>')&&comp.operator.startsWith('>')){return!0}
if(this.operator.startsWith('<')&&comp.operator.startsWith('<')){return!0}
if((this.semver.version===comp.semver.version)&&this.operator.includes('=')&&comp.operator.includes('=')){return!0}
if(cmp(this.semver,'<',comp.semver,options)&&this.operator.startsWith('>')&&comp.operator.startsWith('<')){return!0}
if(cmp(this.semver,'>',comp.semver,options)&&this.operator.startsWith('<')&&comp.operator.startsWith('>')){return!0}
return!1}}
module.exports=Comparator
const parseOptions=require('../internal/parse-options')
const{safeRe:re,t}=require('../internal/re')
const cmp=require('../functions/cmp')
const debug=require('../internal/debug')
const SemVer=require('./semver')
const Range=require('./range')},{"../functions/cmp":260,"../internal/debug":285,"../internal/parse-options":288,"../internal/re":289,"./range":257,"./semver":258}],257:[function(require,module,exports){class Range{constructor(range,options){options=parseOptions(options)
if(range instanceof Range){if(range.loose===!!options.loose&&range.includePrerelease===!!options.includePrerelease){return range}else{return new Range(range.raw,options)}}
if(range instanceof Comparator){this.raw=range.value
this.set=[[range]]
this.format()
return this}
this.options=options
this.loose=!!options.loose
this.includePrerelease=!!options.includePrerelease
this.raw=range.trim().split(/\s+/).join(' ')
this.set=this.raw.split('||').map(r=>this.parseRange(r.trim())).filter(c=>c.length)
if(!this.set.length){throw new TypeError(`Invalid SemVer Range: ${this.raw}`)}
if(this.set.length>1){const first=this.set[0]
this.set=this.set.filter(c=>!isNullSet(c[0]))
if(this.set.length===0){this.set=[first]}else if(this.set.length>1){for(const c of this.set){if(c.length===1&&isAny(c[0])){this.set=[c]
break}}}}
this.format()}
format(){this.range=this.set.map((comps)=>comps.join(' ').trim()).join('||').trim()
return this.range}
toString(){return this.range}
parseRange(range){const memoOpts=(this.options.includePrerelease&&FLAG_INCLUDE_PRERELEASE)|(this.options.loose&&FLAG_LOOSE)
const memoKey=memoOpts+':'+range
const cached=cache.get(memoKey)
if(cached){return cached}
const loose=this.options.loose
const hr=loose?re[t.HYPHENRANGELOOSE]:re[t.HYPHENRANGE]
range=range.replace(hr,hyphenReplace(this.options.includePrerelease))
debug('hyphen replace',range)
range=range.replace(re[t.COMPARATORTRIM],comparatorTrimReplace)
debug('comparator trim',range)
range=range.replace(re[t.TILDETRIM],tildeTrimReplace)
debug('tilde trim',range)
range=range.replace(re[t.CARETTRIM],caretTrimReplace)
debug('caret trim',range)
let rangeList=range.split(' ').map(comp=>parseComparator(comp,this.options)).join(' ').split(/\s+/).map(comp=>replaceGTE0(comp,this.options))
if(loose){rangeList=rangeList.filter(comp=>{debug('loose invalid filter',comp,this.options)
return!!comp.match(re[t.COMPARATORLOOSE])})}
debug('range list',rangeList)
const rangeMap=new Map()
const comparators=rangeList.map(comp=>new Comparator(comp,this.options))
for(const comp of comparators){if(isNullSet(comp)){return[comp]}
rangeMap.set(comp.value,comp)}
if(rangeMap.size>1&&rangeMap.has('')){rangeMap.delete('')}
const result=[...rangeMap.values()]
cache.set(memoKey,result)
return result}
intersects(range,options){if(!(range instanceof Range)){throw new TypeError('a Range is required')}
return this.set.some((thisComparators)=>{return(isSatisfiable(thisComparators,options)&&range.set.some((rangeComparators)=>{return(isSatisfiable(rangeComparators,options)&&thisComparators.every((thisComparator)=>{return rangeComparators.every((rangeComparator)=>{return thisComparator.intersects(rangeComparator,options)})}))}))})}
test(version){if(!version){return!1}
if(typeof version==='string'){try{version=new SemVer(version,this.options)}catch(er){return!1}}
for(let i=0;i<this.set.length;i++){if(testSet(this.set[i],version,this.options)){return!0}}
return!1}}
module.exports=Range
const LRU=require('../internal/lrucache')
const cache=new LRU()
const parseOptions=require('../internal/parse-options')
const Comparator=require('./comparator')
const debug=require('../internal/debug')
const SemVer=require('./semver')
const{safeRe:re,t,comparatorTrimReplace,tildeTrimReplace,caretTrimReplace,}=require('../internal/re')
const{FLAG_INCLUDE_PRERELEASE,FLAG_LOOSE}=require('../internal/constants')
const isNullSet=c=>c.value==='<0.0.0-0'
const isAny=c=>c.value===''
const isSatisfiable=(comparators,options)=>{let result=!0
const remainingComparators=comparators.slice()
let testComparator=remainingComparators.pop()
while(result&&remainingComparators.length){result=remainingComparators.every((otherComparator)=>{return testComparator.intersects(otherComparator,options)})
testComparator=remainingComparators.pop()}
return result}
const parseComparator=(comp,options)=>{debug('comp',comp,options)
comp=replaceCarets(comp,options)
debug('caret',comp)
comp=replaceTildes(comp,options)
debug('tildes',comp)
comp=replaceXRanges(comp,options)
debug('xrange',comp)
comp=replaceStars(comp,options)
debug('stars',comp)
return comp}
const isX=id=>!id||id.toLowerCase()==='x'||id==='*'
const replaceTildes=(comp,options)=>{return comp.trim().split(/\s+/).map((c)=>replaceTilde(c,options)).join(' ')}
const replaceTilde=(comp,options)=>{const r=options.loose?re[t.TILDELOOSE]:re[t.TILDE]
return comp.replace(r,(_,M,m,p,pr)=>{debug('tilde',comp,_,M,m,p,pr)
let ret
if(isX(M)){ret=''}else if(isX(m)){ret=`>=${M}.0.0 <${+M + 1}.0.0-0`}else if(isX(p)){ret=`>=${M}.${m}.0 <${M}.${+m + 1}.0-0`}else if(pr){debug('replaceTilde pr',pr)
ret=`>=${M}.${m}.${p}-${pr
      } <${M}.${+m + 1}.0-0`}else{ret=`>=${M}.${m}.${p
      } <${M}.${+m + 1}.0-0`}
debug('tilde return',ret)
return ret})}
const replaceCarets=(comp,options)=>{return comp.trim().split(/\s+/).map((c)=>replaceCaret(c,options)).join(' ')}
const replaceCaret=(comp,options)=>{debug('caret',comp,options)
const r=options.loose?re[t.CARETLOOSE]:re[t.CARET]
const z=options.includePrerelease?'-0':''
return comp.replace(r,(_,M,m,p,pr)=>{debug('caret',comp,_,M,m,p,pr)
let ret
if(isX(M)){ret=''}else if(isX(m)){ret=`>=${M}.0.0${z} <${+M + 1}.0.0-0`}else if(isX(p)){if(M==='0'){ret=`>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`}else{ret=`>=${M}.${m}.0${z} <${+M + 1}.0.0-0`}}else if(pr){debug('replaceCaret pr',pr)
if(M==='0'){if(m==='0'){ret=`>=${M}.${m}.${p}-${pr
          } <${M}.${m}.${+p + 1}-0`}else{ret=`>=${M}.${m}.${p}-${pr
          } <${M}.${+m + 1}.0-0`}}else{ret=`>=${M}.${m}.${p}-${pr
        } <${+M + 1}.0.0-0`}}else{debug('no pr')
if(M==='0'){if(m==='0'){ret=`>=${M}.${m}.${p
          }${z} <${M}.${m}.${+p + 1}-0`}else{ret=`>=${M}.${m}.${p
          }${z} <${M}.${+m + 1}.0-0`}}else{ret=`>=${M}.${m}.${p
        } <${+M + 1}.0.0-0`}}
debug('caret return',ret)
return ret})}
const replaceXRanges=(comp,options)=>{debug('replaceXRanges',comp,options)
return comp.split(/\s+/).map((c)=>replaceXRange(c,options)).join(' ')}
const replaceXRange=(comp,options)=>{comp=comp.trim()
const r=options.loose?re[t.XRANGELOOSE]:re[t.XRANGE]
return comp.replace(r,(ret,gtlt,M,m,p,pr)=>{debug('xRange',comp,ret,gtlt,M,m,p,pr)
const xM=isX(M)
const xm=xM||isX(m)
const xp=xm||isX(p)
const anyX=xp
if(gtlt==='='&&anyX){gtlt=''}
pr=options.includePrerelease?'-0':''
if(xM){if(gtlt==='>'||gtlt==='<'){ret='<0.0.0-0'}else{ret='*'}}else if(gtlt&&anyX){if(xm){m=0}
p=0
if(gtlt==='>'){gtlt='>='
if(xm){M=+M+1
m=0
p=0}else{m=+m+1
p=0}}else if(gtlt==='<='){gtlt='<'
if(xm){M=+M+1}else{m=+m+1}}
if(gtlt==='<'){pr='-0'}
ret=`${gtlt + M}.${m}.${p}${pr}`}else if(xm){ret=`>=${M}.0.0${pr} <${+M + 1}.0.0-0`}else if(xp){ret=`>=${M}.${m}.0${pr
      } <${M}.${+m + 1}.0-0`}
debug('xRange return',ret)
return ret})}
const replaceStars=(comp,options)=>{debug('replaceStars',comp,options)
return comp.trim().replace(re[t.STAR],'')}
const replaceGTE0=(comp,options)=>{debug('replaceGTE0',comp,options)
return comp.trim().replace(re[options.includePrerelease?t.GTE0PRE:t.GTE0],'')}
const hyphenReplace=incPr=>($0,from,fM,fm,fp,fpr,fb,to,tM,tm,tp,tpr)=>{if(isX(fM)){from=''}else if(isX(fm)){from=`>=${fM}.0.0${incPr ? '-0' : ''}`}else if(isX(fp)){from=`>=${fM}.${fm}.0${incPr ? '-0' : ''}`}else if(fpr){from=`>=${from}`}else{from=`>=${from}${incPr ? '-0' : ''}`}
if(isX(tM)){to=''}else if(isX(tm)){to=`<${+tM + 1}.0.0-0`}else if(isX(tp)){to=`<${tM}.${+tm + 1}.0-0`}else if(tpr){to=`<=${tM}.${tm}.${tp}-${tpr}`}else if(incPr){to=`<${tM}.${tm}.${+tp + 1}-0`}else{to=`<=${to}`}
return `${from} ${to}`.trim()}
const testSet=(set,version,options)=>{for(let i=0;i<set.length;i++){if(!set[i].test(version)){return!1}}
if(version.prerelease.length&&!options.includePrerelease){for(let i=0;i<set.length;i++){debug(set[i].semver)
if(set[i].semver===Comparator.ANY){continue}
if(set[i].semver.prerelease.length>0){const allowed=set[i].semver
if(allowed.major===version.major&&allowed.minor===version.minor&&allowed.patch===version.patch){return!0}}}
return!1}
return!0}},{"../internal/constants":284,"../internal/debug":285,"../internal/lrucache":287,"../internal/parse-options":288,"../internal/re":289,"./comparator":256,"./semver":258}],258:[function(require,module,exports){const debug=require('../internal/debug')
const{MAX_LENGTH,MAX_SAFE_INTEGER}=require('../internal/constants')
const{safeRe:re,t}=require('../internal/re')
const parseOptions=require('../internal/parse-options')
const{compareIdentifiers}=require('../internal/identifiers')
class SemVer{constructor(version,options){options=parseOptions(options)
if(version instanceof SemVer){if(version.loose===!!options.loose&&version.includePrerelease===!!options.includePrerelease){return version}else{version=version.version}}else if(typeof version!=='string'){throw new TypeError(`Invalid version. Must be a string. Got type "${typeof version}".`)}
if(version.length>MAX_LENGTH){throw new TypeError(`version is longer than ${MAX_LENGTH} characters`)}
debug('SemVer',version,options)
this.options=options
this.loose=!!options.loose
this.includePrerelease=!!options.includePrerelease
const m=version.trim().match(options.loose?re[t.LOOSE]:re[t.FULL])
if(!m){throw new TypeError(`Invalid Version: ${version}`)}
this.raw=version
this.major=+m[1]
this.minor=+m[2]
this.patch=+m[3]
if(this.major>MAX_SAFE_INTEGER||this.major<0){throw new TypeError('Invalid major version')}
if(this.minor>MAX_SAFE_INTEGER||this.minor<0){throw new TypeError('Invalid minor version')}
if(this.patch>MAX_SAFE_INTEGER||this.patch<0){throw new TypeError('Invalid patch version')}
if(!m[4]){this.prerelease=[]}else{this.prerelease=m[4].split('.').map((id)=>{if(/^[0-9]+$/.test(id)){const num=+id
if(num>=0&&num<MAX_SAFE_INTEGER){return num}}
return id})}
this.build=m[5]?m[5].split('.'):[]
this.format()}
format(){this.version=`${this.major}.${this.minor}.${this.patch}`
if(this.prerelease.length){this.version+=`-${this.prerelease.join('.')}`}
return this.version}
toString(){return this.version}
compare(other){debug('SemVer.compare',this.version,this.options,other)
if(!(other instanceof SemVer)){if(typeof other==='string'&&other===this.version){return 0}
other=new SemVer(other,this.options)}
if(other.version===this.version){return 0}
return this.compareMain(other)||this.comparePre(other)}
compareMain(other){if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}
return(compareIdentifiers(this.major,other.major)||compareIdentifiers(this.minor,other.minor)||compareIdentifiers(this.patch,other.patch))}
comparePre(other){if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}
if(this.prerelease.length&&!other.prerelease.length){return-1}else if(!this.prerelease.length&&other.prerelease.length){return 1}else if(!this.prerelease.length&&!other.prerelease.length){return 0}
let i=0
do{const a=this.prerelease[i]
const b=other.prerelease[i]
debug('prerelease compare',i,a,b)
if(a===undefined&&b===undefined){return 0}else if(b===undefined){return 1}else if(a===undefined){return-1}else if(a===b){continue}else{return compareIdentifiers(a,b)}}while(++i)}
compareBuild(other){if(!(other instanceof SemVer)){other=new SemVer(other,this.options)}
let i=0
do{const a=this.build[i]
const b=other.build[i]
debug('build compare',i,a,b)
if(a===undefined&&b===undefined){return 0}else if(b===undefined){return 1}else if(a===undefined){return-1}else if(a===b){continue}else{return compareIdentifiers(a,b)}}while(++i)}
inc(release,identifier,identifierBase){switch(release){case 'premajor':this.prerelease.length=0
this.patch=0
this.minor=0
this.major++
this.inc('pre',identifier,identifierBase)
break
case 'preminor':this.prerelease.length=0
this.patch=0
this.minor++
this.inc('pre',identifier,identifierBase)
break
case 'prepatch':this.prerelease.length=0
this.inc('patch',identifier,identifierBase)
this.inc('pre',identifier,identifierBase)
break
case 'prerelease':if(this.prerelease.length===0){this.inc('patch',identifier,identifierBase)}
this.inc('pre',identifier,identifierBase)
break
case 'major':if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}
this.minor=0
this.patch=0
this.prerelease=[]
break
case 'minor':if(this.patch!==0||this.prerelease.length===0){this.minor++}
this.patch=0
this.prerelease=[]
break
case 'patch':if(this.prerelease.length===0){this.patch++}
this.prerelease=[]
break
case 'pre':{const base=Number(identifierBase)?1:0
if(!identifier&&identifierBase===!1){throw new Error('invalid increment argument: identifier is empty')}
if(this.prerelease.length===0){this.prerelease=[base]}else{let i=this.prerelease.length
while(--i>=0){if(typeof this.prerelease[i]==='number'){this.prerelease[i]++
i=-2}}
if(i===-1){if(identifier===this.prerelease.join('.')&&identifierBase===!1){throw new Error('invalid increment argument: identifier already exists')}
this.prerelease.push(base)}}
if(identifier){let prerelease=[identifier,base]
if(identifierBase===!1){prerelease=[identifier]}
if(compareIdentifiers(this.prerelease[0],identifier)===0){if(isNaN(this.prerelease[1])){this.prerelease=prerelease}}else{this.prerelease=prerelease}}
break}
default:throw new Error(`invalid increment argument: ${release}`)}
this.raw=this.format()
if(this.build.length){this.raw+=`+${this.build.join('.')}`}
return this}}
module.exports=SemVer},{"../internal/constants":284,"../internal/debug":285,"../internal/identifiers":286,"../internal/parse-options":288,"../internal/re":289}],259:[function(require,module,exports){const parse=require('./parse')
const clean=(version,options)=>{const s=parse(version.trim().replace(/^[=v]+/,''),options)
return s?s.version:null}
module.exports=clean},{"./parse":275}],260:[function(require,module,exports){const eq=require('./eq')
const neq=require('./neq')
const gt=require('./gt')
const gte=require('./gte')
const lt=require('./lt')
const lte=require('./lte')
const cmp=(a,op,b,loose)=>{switch(op){case '===':if(typeof a==='object'){a=a.version}
if(typeof b==='object'){b=b.version}
return a===b
case '!==':if(typeof a==='object'){a=a.version}
if(typeof b==='object'){b=b.version}
return a!==b
case '':case '=':case '==':return eq(a,b,loose)
case '!=':return neq(a,b,loose)
case '>':return gt(a,b,loose)
case '>=':return gte(a,b,loose)
case '<':return lt(a,b,loose)
case '<=':return lte(a,b,loose)
default:throw new TypeError(`Invalid operator: ${op}`)}}
module.exports=cmp},{"./eq":266,"./gt":267,"./gte":268,"./lt":270,"./lte":271,"./neq":274}],261:[function(require,module,exports){const SemVer=require('../classes/semver')
const parse=require('./parse')
const{safeRe:re,t}=require('../internal/re')
const coerce=(version,options)=>{if(version instanceof SemVer){return version}
if(typeof version==='number'){version=String(version)}
if(typeof version!=='string'){return null}
options=options||{}
let match=null
if(!options.rtl){match=version.match(options.includePrerelease?re[t.COERCEFULL]:re[t.COERCE])}else{const coerceRtlRegex=options.includePrerelease?re[t.COERCERTLFULL]:re[t.COERCERTL]
let next
while((next=coerceRtlRegex.exec(version))&&(!match||match.index+match[0].length!==version.length)){if(!match||next.index+next[0].length!==match.index+match[0].length){match=next}
coerceRtlRegex.lastIndex=next.index+next[1].length+next[2].length}
coerceRtlRegex.lastIndex=-1}
if(match===null){return null}
const major=match[2]
const minor=match[3]||'0'
const patch=match[4]||'0'
const prerelease=options.includePrerelease&&match[5]?`-${match[5]}`:''
const build=options.includePrerelease&&match[6]?`+${match[6]}`:''
return parse(`${major}.${minor}.${patch}${prerelease}${build}`,options)}
module.exports=coerce},{"../classes/semver":258,"../internal/re":289,"./parse":275}],262:[function(require,module,exports){const SemVer=require('../classes/semver')
const compareBuild=(a,b,loose)=>{const versionA=new SemVer(a,loose)
const versionB=new SemVer(b,loose)
return versionA.compare(versionB)||versionA.compareBuild(versionB)}
module.exports=compareBuild},{"../classes/semver":258}],263:[function(require,module,exports){const compare=require('./compare')
const compareLoose=(a,b)=>compare(a,b,!0)
module.exports=compareLoose},{"./compare":264}],264:[function(require,module,exports){const SemVer=require('../classes/semver')
const compare=(a,b,loose)=>new SemVer(a,loose).compare(new SemVer(b,loose))
module.exports=compare},{"../classes/semver":258}],265:[function(require,module,exports){const parse=require('./parse.js')
const diff=(version1,version2)=>{const v1=parse(version1,null,!0)
const v2=parse(version2,null,!0)
const comparison=v1.compare(v2)
if(comparison===0){return null}
const v1Higher=comparison>0
const highVersion=v1Higher?v1:v2
const lowVersion=v1Higher?v2:v1
const highHasPre=!!highVersion.prerelease.length
const lowHasPre=!!lowVersion.prerelease.length
if(lowHasPre&&!highHasPre){if(!lowVersion.patch&&!lowVersion.minor){return'major'}
if(highVersion.patch){return'patch'}
if(highVersion.minor){return'minor'}
return'major'}
const prefix=highHasPre?'pre':''
if(v1.major!==v2.major){return prefix+'major'}
if(v1.minor!==v2.minor){return prefix+'minor'}
if(v1.patch!==v2.patch){return prefix+'patch'}
return'prerelease'}
module.exports=diff},{"./parse.js":275}],266:[function(require,module,exports){const compare=require('./compare')
const eq=(a,b,loose)=>compare(a,b,loose)===0
module.exports=eq},{"./compare":264}],267:[function(require,module,exports){const compare=require('./compare')
const gt=(a,b,loose)=>compare(a,b,loose)>0
module.exports=gt},{"./compare":264}],268:[function(require,module,exports){const compare=require('./compare')
const gte=(a,b,loose)=>compare(a,b,loose)>=0
module.exports=gte},{"./compare":264}],269:[function(require,module,exports){const SemVer=require('../classes/semver')
const inc=(version,release,options,identifier,identifierBase)=>{if(typeof(options)==='string'){identifierBase=identifier
identifier=options
options=undefined}
try{return new SemVer(version instanceof SemVer?version.version:version,options).inc(release,identifier,identifierBase).version}catch(er){return null}}
module.exports=inc},{"../classes/semver":258}],270:[function(require,module,exports){const compare=require('./compare')
const lt=(a,b,loose)=>compare(a,b,loose)<0
module.exports=lt},{"./compare":264}],271:[function(require,module,exports){const compare=require('./compare')
const lte=(a,b,loose)=>compare(a,b,loose)<=0
module.exports=lte},{"./compare":264}],272:[function(require,module,exports){const SemVer=require('../classes/semver')
const major=(a,loose)=>new SemVer(a,loose).major
module.exports=major},{"../classes/semver":258}],273:[function(require,module,exports){const SemVer=require('../classes/semver')
const minor=(a,loose)=>new SemVer(a,loose).minor
module.exports=minor},{"../classes/semver":258}],274:[function(require,module,exports){const compare=require('./compare')
const neq=(a,b,loose)=>compare(a,b,loose)!==0
module.exports=neq},{"./compare":264}],275:[function(require,module,exports){const SemVer=require('../classes/semver')
const parse=(version,options,throwErrors=!1)=>{if(version instanceof SemVer){return version}
try{return new SemVer(version,options)}catch(er){if(!throwErrors){return null}
throw er}}
module.exports=parse},{"../classes/semver":258}],276:[function(require,module,exports){const SemVer=require('../classes/semver')
const patch=(a,loose)=>new SemVer(a,loose).patch
module.exports=patch},{"../classes/semver":258}],277:[function(require,module,exports){const parse=require('./parse')
const prerelease=(version,options)=>{const parsed=parse(version,options)
return(parsed&&parsed.prerelease.length)?parsed.prerelease:null}
module.exports=prerelease},{"./parse":275}],278:[function(require,module,exports){const compare=require('./compare')
const rcompare=(a,b,loose)=>compare(b,a,loose)
module.exports=rcompare},{"./compare":264}],279:[function(require,module,exports){const compareBuild=require('./compare-build')
const rsort=(list,loose)=>list.sort((a,b)=>compareBuild(b,a,loose))
module.exports=rsort},{"./compare-build":262}],280:[function(require,module,exports){const Range=require('../classes/range')
const satisfies=(version,range,options)=>{try{range=new Range(range,options)}catch(er){return!1}
return range.test(version)}
module.exports=satisfies},{"../classes/range":257}],281:[function(require,module,exports){const compareBuild=require('./compare-build')
const sort=(list,loose)=>list.sort((a,b)=>compareBuild(a,b,loose))
module.exports=sort},{"./compare-build":262}],282:[function(require,module,exports){const parse=require('./parse')
const valid=(version,options)=>{const v=parse(version,options)
return v?v.version:null}
module.exports=valid},{"./parse":275}],283:[function(require,module,exports){const internalRe=require('./internal/re')
const constants=require('./internal/constants')
const SemVer=require('./classes/semver')
const identifiers=require('./internal/identifiers')
const parse=require('./functions/parse')
const valid=require('./functions/valid')
const clean=require('./functions/clean')
const inc=require('./functions/inc')
const diff=require('./functions/diff')
const major=require('./functions/major')
const minor=require('./functions/minor')
const patch=require('./functions/patch')
const prerelease=require('./functions/prerelease')
const compare=require('./functions/compare')
const rcompare=require('./functions/rcompare')
const compareLoose=require('./functions/compare-loose')
const compareBuild=require('./functions/compare-build')
const sort=require('./functions/sort')
const rsort=require('./functions/rsort')
const gt=require('./functions/gt')
const lt=require('./functions/lt')
const eq=require('./functions/eq')
const neq=require('./functions/neq')
const gte=require('./functions/gte')
const lte=require('./functions/lte')
const cmp=require('./functions/cmp')
const coerce=require('./functions/coerce')
const Comparator=require('./classes/comparator')
const Range=require('./classes/range')
const satisfies=require('./functions/satisfies')
const toComparators=require('./ranges/to-comparators')
const maxSatisfying=require('./ranges/max-satisfying')
const minSatisfying=require('./ranges/min-satisfying')
const minVersion=require('./ranges/min-version')
const validRange=require('./ranges/valid')
const outside=require('./ranges/outside')
const gtr=require('./ranges/gtr')
const ltr=require('./ranges/ltr')
const intersects=require('./ranges/intersects')
const simplifyRange=require('./ranges/simplify')
const subset=require('./ranges/subset')
module.exports={parse,valid,clean,inc,diff,major,minor,patch,prerelease,compare,rcompare,compareLoose,compareBuild,sort,rsort,gt,lt,eq,neq,gte,lte,cmp,coerce,Comparator,Range,satisfies,toComparators,maxSatisfying,minSatisfying,minVersion,validRange,outside,gtr,ltr,intersects,simplifyRange,subset,SemVer,re:internalRe.re,src:internalRe.src,tokens:internalRe.t,SEMVER_SPEC_VERSION:constants.SEMVER_SPEC_VERSION,RELEASE_TYPES:constants.RELEASE_TYPES,compareIdentifiers:identifiers.compareIdentifiers,rcompareIdentifiers:identifiers.rcompareIdentifiers,}},{"./classes/comparator":256,"./classes/range":257,"./classes/semver":258,"./functions/clean":259,"./functions/cmp":260,"./functions/coerce":261,"./functions/compare":264,"./functions/compare-build":262,"./functions/compare-loose":263,"./functions/diff":265,"./functions/eq":266,"./functions/gt":267,"./functions/gte":268,"./functions/inc":269,"./functions/lt":270,"./functions/lte":271,"./functions/major":272,"./functions/minor":273,"./functions/neq":274,"./functions/parse":275,"./functions/patch":276,"./functions/prerelease":277,"./functions/rcompare":278,"./functions/rsort":279,"./functions/satisfies":280,"./functions/sort":281,"./functions/valid":282,"./internal/constants":284,"./internal/identifiers":286,"./internal/re":289,"./ranges/gtr":290,"./ranges/intersects":291,"./ranges/ltr":292,"./ranges/max-satisfying":293,"./ranges/min-satisfying":294,"./ranges/min-version":295,"./ranges/outside":296,"./ranges/simplify":297,"./ranges/subset":298,"./ranges/to-comparators":299,"./ranges/valid":300}],284:[function(require,module,exports){const SEMVER_SPEC_VERSION='2.0.0'
const MAX_LENGTH=256
const MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991
const MAX_SAFE_COMPONENT_LENGTH=16
const MAX_SAFE_BUILD_LENGTH=MAX_LENGTH-6
const RELEASE_TYPES=['major','premajor','minor','preminor','patch','prepatch','prerelease',]
module.exports={MAX_LENGTH,MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_BUILD_LENGTH,MAX_SAFE_INTEGER,RELEASE_TYPES,SEMVER_SPEC_VERSION,FLAG_INCLUDE_PRERELEASE:0b001,FLAG_LOOSE:0b010,}},{}],285:[function(require,module,exports){(function(process){(function(){const debug=(typeof process==='object'&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG))?(...args)=>console.error('SEMVER',...args):()=>{}
module.exports=debug}).call(this)}).call(this,require('_process'))},{"_process":6}],286:[function(require,module,exports){const numeric=/^[0-9]+$/
const compareIdentifiers=(a,b)=>{const anum=numeric.test(a)
const bnum=numeric.test(b)
if(anum&&bnum){a=+a
b=+b}
return a===b?0:(anum&&!bnum)?-1:(bnum&&!anum)?1:a<b?-1:1}
const rcompareIdentifiers=(a,b)=>compareIdentifiers(b,a)
module.exports={compareIdentifiers,rcompareIdentifiers,}},{}],287:[function(require,module,exports){class LRUCache{constructor(){this.max=1000
this.map=new Map()}
get(key){const value=this.map.get(key)
if(value===undefined){return undefined}else{this.map.delete(key)
this.map.set(key,value)
return value}}
delete(key){return this.map.delete(key)}
set(key,value){const deleted=this.delete(key)
if(!deleted&&value!==undefined){if(this.map.size>=this.max){const firstKey=this.map.keys().next().value
this.delete(firstKey)}
this.map.set(key,value)}
return this}}
module.exports=LRUCache},{}],288:[function(require,module,exports){const looseOption=Object.freeze({loose:!0})
const emptyOpts=Object.freeze({})
const parseOptions=options=>{if(!options){return emptyOpts}
if(typeof options!=='object'){return looseOption}
return options}
module.exports=parseOptions},{}],289:[function(require,module,exports){const{MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_BUILD_LENGTH,MAX_LENGTH,}=require('./constants')
const debug=require('./debug')
exports=module.exports={}
const re=exports.re=[]
const safeRe=exports.safeRe=[]
const src=exports.src=[]
const t=exports.t={}
let R=0
const LETTERDASHNUMBER='[a-zA-Z0-9-]'
const safeRegexReplacements=[['\\s',1],['\\d',MAX_LENGTH],[LETTERDASHNUMBER,MAX_SAFE_BUILD_LENGTH],]
const makeSafeRegex=(value)=>{for(const[token,max]of safeRegexReplacements){value=value.split(`${token}*`).join(`${token}{0,${max}}`).split(`${token}+`).join(`${token}{1,${max}}`)}
return value}
const createToken=(name,value,isGlobal)=>{const safe=makeSafeRegex(value)
const index=R++
debug(name,index,value)
t[name]=index
src[index]=value
re[index]=new RegExp(value,isGlobal?'g':undefined)
safeRe[index]=new RegExp(safe,isGlobal?'g':undefined)}
createToken('NUMERICIDENTIFIER','0|[1-9]\\d*')
createToken('NUMERICIDENTIFIERLOOSE','\\d+')
createToken('NONNUMERICIDENTIFIER',`\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`)
createToken('MAINVERSION',`(${src[t.NUMERICIDENTIFIER]})\\.`+`(${src[t.NUMERICIDENTIFIER]})\\.`+`(${src[t.NUMERICIDENTIFIER]})`)
createToken('MAINVERSIONLOOSE',`(${src[t.NUMERICIDENTIFIERLOOSE]})\\.`+`(${src[t.NUMERICIDENTIFIERLOOSE]})\\.`+`(${src[t.NUMERICIDENTIFIERLOOSE]})`)
createToken('PRERELEASEIDENTIFIER',`(?:${src[t.NUMERICIDENTIFIER]
}|${src[t.NONNUMERICIDENTIFIER]})`)
createToken('PRERELEASEIDENTIFIERLOOSE',`(?:${src[t.NUMERICIDENTIFIERLOOSE]
}|${src[t.NONNUMERICIDENTIFIER]})`)
createToken('PRERELEASE',`(?:-(${src[t.PRERELEASEIDENTIFIER]
}(?:\\.${src[t.PRERELEASEIDENTIFIER]})*))`)
createToken('PRERELEASELOOSE',`(?:-?(${src[t.PRERELEASEIDENTIFIERLOOSE]
}(?:\\.${src[t.PRERELEASEIDENTIFIERLOOSE]})*))`)
createToken('BUILDIDENTIFIER',`${LETTERDASHNUMBER}+`)
createToken('BUILD',`(?:\\+(${src[t.BUILDIDENTIFIER]
}(?:\\.${src[t.BUILDIDENTIFIER]})*))`)
createToken('FULLPLAIN',`v?${src[t.MAINVERSION]
}${src[t.PRERELEASE]}?${
  src[t.BUILD]}?`)
createToken('FULL',`^${src[t.FULLPLAIN]}$`)
createToken('LOOSEPLAIN',`[v=\\s]*${src[t.MAINVERSIONLOOSE]
}${src[t.PRERELEASELOOSE]}?${
  src[t.BUILD]}?`)
createToken('LOOSE',`^${src[t.LOOSEPLAIN]}$`)
createToken('GTLT','((?:<|>)?=?)')
createToken('XRANGEIDENTIFIERLOOSE',`${src[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`)
createToken('XRANGEIDENTIFIER',`${src[t.NUMERICIDENTIFIER]}|x|X|\\*`)
createToken('XRANGEPLAIN',`[v=\\s]*(${src[t.XRANGEIDENTIFIER]})`+`(?:\\.(${src[t.XRANGEIDENTIFIER]})`+`(?:\\.(${src[t.XRANGEIDENTIFIER]})`+`(?:${src[t.PRERELEASE]})?${
                     src[t.BUILD]}?`+`)?)?`)
createToken('XRANGEPLAINLOOSE',`[v=\\s]*(${src[t.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${src[t.XRANGEIDENTIFIERLOOSE]})`+`(?:\\.(${src[t.XRANGEIDENTIFIERLOOSE]})`+`(?:${src[t.PRERELEASELOOSE]})?${
                          src[t.BUILD]}?`+`)?)?`)
createToken('XRANGE',`^${src[t.GTLT]}\\s*${src[t.XRANGEPLAIN]}$`)
createToken('XRANGELOOSE',`^${src[t.GTLT]}\\s*${src[t.XRANGEPLAINLOOSE]}$`)
createToken('COERCEPLAIN',`${'(^|[^\\d])' +
              '(\\d{1,'}${MAX_SAFE_COMPONENT_LENGTH}})`+`(?:\\.(\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?`+`(?:\\.(\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?`)
createToken('COERCE',`${src[t.COERCEPLAIN]}(?:$|[^\\d])`)
createToken('COERCEFULL',src[t.COERCEPLAIN]+`(?:${src[t.PRERELEASE]})?`+`(?:${src[t.BUILD]})?`+`(?:$|[^\\d])`)
createToken('COERCERTL',src[t.COERCE],!0)
createToken('COERCERTLFULL',src[t.COERCEFULL],!0)
createToken('LONETILDE','(?:~>?)')
createToken('TILDETRIM',`(\\s*)${src[t.LONETILDE]}\\s+`,!0)
exports.tildeTrimReplace='$1~'
createToken('TILDE',`^${src[t.LONETILDE]}${src[t.XRANGEPLAIN]}$`)
createToken('TILDELOOSE',`^${src[t.LONETILDE]}${src[t.XRANGEPLAINLOOSE]}$`)
createToken('LONECARET','(?:\\^)')
createToken('CARETTRIM',`(\\s*)${src[t.LONECARET]}\\s+`,!0)
exports.caretTrimReplace='$1^'
createToken('CARET',`^${src[t.LONECARET]}${src[t.XRANGEPLAIN]}$`)
createToken('CARETLOOSE',`^${src[t.LONECARET]}${src[t.XRANGEPLAINLOOSE]}$`)
createToken('COMPARATORLOOSE',`^${src[t.GTLT]}\\s*(${src[t.LOOSEPLAIN]})$|^$`)
createToken('COMPARATOR',`^${src[t.GTLT]}\\s*(${src[t.FULLPLAIN]})$|^$`)
createToken('COMPARATORTRIM',`(\\s*)${src[t.GTLT]
}\\s*(${src[t.LOOSEPLAIN]}|${src[t.XRANGEPLAIN]})`,!0)
exports.comparatorTrimReplace='$1$2$3'
createToken('HYPHENRANGE',`^\\s*(${src[t.XRANGEPLAIN]})`+`\\s+-\\s+`+`(${src[t.XRANGEPLAIN]})`+`\\s*$`)
createToken('HYPHENRANGELOOSE',`^\\s*(${src[t.XRANGEPLAINLOOSE]})`+`\\s+-\\s+`+`(${src[t.XRANGEPLAINLOOSE]})`+`\\s*$`)
createToken('STAR','(<|>)?=?\\s*\\*')
createToken('GTE0','^\\s*>=\\s*0\\.0\\.0\\s*$')
createToken('GTE0PRE','^\\s*>=\\s*0\\.0\\.0-0\\s*$')},{"./constants":284,"./debug":285}],290:[function(require,module,exports){const outside=require('./outside')
const gtr=(version,range,options)=>outside(version,range,'>',options)
module.exports=gtr},{"./outside":296}],291:[function(require,module,exports){const Range=require('../classes/range')
const intersects=(r1,r2,options)=>{r1=new Range(r1,options)
r2=new Range(r2,options)
return r1.intersects(r2,options)}
module.exports=intersects},{"../classes/range":257}],292:[function(require,module,exports){const outside=require('./outside')
const ltr=(version,range,options)=>outside(version,range,'<',options)
module.exports=ltr},{"./outside":296}],293:[function(require,module,exports){const SemVer=require('../classes/semver')
const Range=require('../classes/range')
const maxSatisfying=(versions,range,options)=>{let max=null
let maxSV=null
let rangeObj=null
try{rangeObj=new Range(range,options)}catch(er){return null}
versions.forEach((v)=>{if(rangeObj.test(v)){if(!max||maxSV.compare(v)===-1){max=v
maxSV=new SemVer(max,options)}}})
return max}
module.exports=maxSatisfying},{"../classes/range":257,"../classes/semver":258}],294:[function(require,module,exports){const SemVer=require('../classes/semver')
const Range=require('../classes/range')
const minSatisfying=(versions,range,options)=>{let min=null
let minSV=null
let rangeObj=null
try{rangeObj=new Range(range,options)}catch(er){return null}
versions.forEach((v)=>{if(rangeObj.test(v)){if(!min||minSV.compare(v)===1){min=v
minSV=new SemVer(min,options)}}})
return min}
module.exports=minSatisfying},{"../classes/range":257,"../classes/semver":258}],295:[function(require,module,exports){const SemVer=require('../classes/semver')
const Range=require('../classes/range')
const gt=require('../functions/gt')
const minVersion=(range,loose)=>{range=new Range(range,loose)
let minver=new SemVer('0.0.0')
if(range.test(minver)){return minver}
minver=new SemVer('0.0.0-0')
if(range.test(minver)){return minver}
minver=null
for(let i=0;i<range.set.length;++i){const comparators=range.set[i]
let setMin=null
comparators.forEach((comparator)=>{const compver=new SemVer(comparator.semver.version)
switch(comparator.operator){case '>':if(compver.prerelease.length===0){compver.patch++}else{compver.prerelease.push(0)}
compver.raw=compver.format()
case '':case '>=':if(!setMin||gt(compver,setMin)){setMin=compver}
break
case '<':case '<=':break
default:throw new Error(`Unexpected operation: ${comparator.operator}`)}})
if(setMin&&(!minver||gt(minver,setMin))){minver=setMin}}
if(minver&&range.test(minver)){return minver}
return null}
module.exports=minVersion},{"../classes/range":257,"../classes/semver":258,"../functions/gt":267}],296:[function(require,module,exports){const SemVer=require('../classes/semver')
const Comparator=require('../classes/comparator')
const{ANY}=Comparator
const Range=require('../classes/range')
const satisfies=require('../functions/satisfies')
const gt=require('../functions/gt')
const lt=require('../functions/lt')
const lte=require('../functions/lte')
const gte=require('../functions/gte')
const outside=(version,range,hilo,options)=>{version=new SemVer(version,options)
range=new Range(range,options)
let gtfn,ltefn,ltfn,comp,ecomp
switch(hilo){case '>':gtfn=gt
ltefn=lte
ltfn=lt
comp='>'
ecomp='>='
break
case '<':gtfn=lt
ltefn=gte
ltfn=gt
comp='<'
ecomp='<='
break
default:throw new TypeError('Must provide a hilo val of "<" or ">"')}
if(satisfies(version,range,options)){return!1}
for(let i=0;i<range.set.length;++i){const comparators=range.set[i]
let high=null
let low=null
comparators.forEach((comparator)=>{if(comparator.semver===ANY){comparator=new Comparator('>=0.0.0')}
high=high||comparator
low=low||comparator
if(gtfn(comparator.semver,high.semver,options)){high=comparator}else if(ltfn(comparator.semver,low.semver,options)){low=comparator}})
if(high.operator===comp||high.operator===ecomp){return!1}
if((!low.operator||low.operator===comp)&&ltefn(version,low.semver)){return!1}else if(low.operator===ecomp&&ltfn(version,low.semver)){return!1}}
return!0}
module.exports=outside},{"../classes/comparator":256,"../classes/range":257,"../classes/semver":258,"../functions/gt":267,"../functions/gte":268,"../functions/lt":270,"../functions/lte":271,"../functions/satisfies":280}],297:[function(require,module,exports){const satisfies=require('../functions/satisfies.js')
const compare=require('../functions/compare.js')
module.exports=(versions,range,options)=>{const set=[]
let first=null
let prev=null
const v=versions.sort((a,b)=>compare(a,b,options))
for(const version of v){const included=satisfies(version,range,options)
if(included){prev=version
if(!first){first=version}}else{if(prev){set.push([first,prev])}
prev=null
first=null}}
if(first){set.push([first,null])}
const ranges=[]
for(const[min,max]of set){if(min===max){ranges.push(min)}else if(!max&&min===v[0]){ranges.push('*')}else if(!max){ranges.push(`>=${min}`)}else if(min===v[0]){ranges.push(`<=${max}`)}else{ranges.push(`${min} - ${max}`)}}
const simplified=ranges.join(' || ')
const original=typeof range.raw==='string'?range.raw:String(range)
return simplified.length<original.length?simplified:range}},{"../functions/compare.js":264,"../functions/satisfies.js":280}],298:[function(require,module,exports){const Range=require('../classes/range.js')
const Comparator=require('../classes/comparator.js')
const{ANY}=Comparator
const satisfies=require('../functions/satisfies.js')
const compare=require('../functions/compare.js')
const subset=(sub,dom,options={})=>{if(sub===dom){return!0}
sub=new Range(sub,options)
dom=new Range(dom,options)
let sawNonNull=!1
OUTER:for(const simpleSub of sub.set){for(const simpleDom of dom.set){const isSub=simpleSubset(simpleSub,simpleDom,options)
sawNonNull=sawNonNull||isSub!==null
if(isSub){continue OUTER}}
if(sawNonNull){return!1}}
return!0}
const minimumVersionWithPreRelease=[new Comparator('>=0.0.0-0')]
const minimumVersion=[new Comparator('>=0.0.0')]
const simpleSubset=(sub,dom,options)=>{if(sub===dom){return!0}
if(sub.length===1&&sub[0].semver===ANY){if(dom.length===1&&dom[0].semver===ANY){return!0}else if(options.includePrerelease){sub=minimumVersionWithPreRelease}else{sub=minimumVersion}}
if(dom.length===1&&dom[0].semver===ANY){if(options.includePrerelease){return!0}else{dom=minimumVersion}}
const eqSet=new Set()
let gt,lt
for(const c of sub){if(c.operator==='>'||c.operator==='>='){gt=higherGT(gt,c,options)}else if(c.operator==='<'||c.operator==='<='){lt=lowerLT(lt,c,options)}else{eqSet.add(c.semver)}}
if(eqSet.size>1){return null}
let gtltComp
if(gt&&lt){gtltComp=compare(gt.semver,lt.semver,options)
if(gtltComp>0){return null}else if(gtltComp===0&&(gt.operator!=='>='||lt.operator!=='<=')){return null}}
for(const eq of eqSet){if(gt&&!satisfies(eq,String(gt),options)){return null}
if(lt&&!satisfies(eq,String(lt),options)){return null}
for(const c of dom){if(!satisfies(eq,String(c),options)){return!1}}
return!0}
let higher,lower
let hasDomLT,hasDomGT
let needDomLTPre=lt&&!options.includePrerelease&&lt.semver.prerelease.length?lt.semver:!1
let needDomGTPre=gt&&!options.includePrerelease&&gt.semver.prerelease.length?gt.semver:!1
if(needDomLTPre&&needDomLTPre.prerelease.length===1&&lt.operator==='<'&&needDomLTPre.prerelease[0]===0){needDomLTPre=!1}
for(const c of dom){hasDomGT=hasDomGT||c.operator==='>'||c.operator==='>='
hasDomLT=hasDomLT||c.operator==='<'||c.operator==='<='
if(gt){if(needDomGTPre){if(c.semver.prerelease&&c.semver.prerelease.length&&c.semver.major===needDomGTPre.major&&c.semver.minor===needDomGTPre.minor&&c.semver.patch===needDomGTPre.patch){needDomGTPre=!1}}
if(c.operator==='>'||c.operator==='>='){higher=higherGT(gt,c,options)
if(higher===c&&higher!==gt){return!1}}else if(gt.operator==='>='&&!satisfies(gt.semver,String(c),options)){return!1}}
if(lt){if(needDomLTPre){if(c.semver.prerelease&&c.semver.prerelease.length&&c.semver.major===needDomLTPre.major&&c.semver.minor===needDomLTPre.minor&&c.semver.patch===needDomLTPre.patch){needDomLTPre=!1}}
if(c.operator==='<'||c.operator==='<='){lower=lowerLT(lt,c,options)
if(lower===c&&lower!==lt){return!1}}else if(lt.operator==='<='&&!satisfies(lt.semver,String(c),options)){return!1}}
if(!c.operator&&(lt||gt)&&gtltComp!==0){return!1}}
if(gt&&hasDomLT&&!lt&&gtltComp!==0){return!1}
if(lt&&hasDomGT&&!gt&&gtltComp!==0){return!1}
if(needDomGTPre||needDomLTPre){return!1}
return!0}
const higherGT=(a,b,options)=>{if(!a){return b}
const comp=compare(a.semver,b.semver,options)
return comp>0?a:comp<0?b:b.operator==='>'&&a.operator==='>='?b:a}
const lowerLT=(a,b,options)=>{if(!a){return b}
const comp=compare(a.semver,b.semver,options)
return comp<0?a:comp>0?b:b.operator==='<'&&a.operator==='<='?b:a}
module.exports=subset},{"../classes/comparator.js":256,"../classes/range.js":257,"../functions/compare.js":264,"../functions/satisfies.js":280}],299:[function(require,module,exports){const Range=require('../classes/range')
const toComparators=(range,options)=>new Range(range,options).set.map(comp=>comp.map(c=>c.value).join(' ').trim().split(' '))
module.exports=toComparators},{"../classes/range":257}],300:[function(require,module,exports){const Range=require('../classes/range')
const validRange=(range,options)=>{try{return new Range(range,options).range||'*'}catch(er){return null}}
module.exports=validRange},{"../classes/range":257}],301:[function(require,module,exports){function r(r){for(var t="",n=0,e=r.length;n<e;n++)t+=String.fromCharCode(r[n]);return t}function t(r){for(var t=new Uint8Array(r.length),n=0,e=r.length;n<e;n++)t[n]=r.charCodeAt(n);return t}function n(t){return r(new Uint8Array(t))}function e(r){return t(r).buffer}exports.fromUint8Array=r,exports.toUint8Array=t,exports.fromBuffer=n,exports.toBuffer=e},{}],302:[function(require,module,exports){var isHexPrefixed=require('is-hex-prefixed');module.exports=function stripHexPrefix(str){if(typeof str!=='string'){return str}
return isHexPrefixed(str)?str.slice(2):str}},{"is-hex-prefixed":51}],303:[function(require,module,exports){const{BN,bytesToHex}=require("../utils");class BitString{constructor(length){this.array=Uint8Array.from({length:Math.ceil(length/8)},()=>0);this.cursor=0;this.length=length}
getFreeBits(){return this.length-this.cursor}
getUsedBits(){return this.cursor}
getUsedBytes(){return Math.ceil(this.cursor/8)}
get(n){return(this.array[(n/8)|0]&(1<<(7-(n%8))))>0}
checkRange(n){if(n>this.length){throw Error("BitString overflow")}}
on(n){this.checkRange(n);this.array[(n/8)|0]|=1<<(7-(n%8))}
off(n){this.checkRange(n);this.array[(n/8)|0]&=~(1<<(7-(n%8)))}
toggle(n){this.checkRange(n);this.array[(n/8)|0]^=1<<(7-(n%8))}
forEach(callback){const max=this.cursor;for(let x=0;x<max;x++){callback(this.get(x))}}
writeBit(b){if(b&&b>0){this.on(this.cursor)}else{this.off(this.cursor)}
this.cursor=this.cursor+1}
writeBitArray(ba){for(let i=0;i<ba.length;i++){this.writeBit(ba[i])}}
writeUint(number,bitLength){if(isNaN(number))throw new Error('writeUint: value is NaN');if(number===null)throw new Error('writeUint: value is null');if(number===undefined)throw new Error('writeUint: value is undefined');if(!bitLength)throw new Error('writeUint: no bitLength');number=new BN(number);if(bitLength==0||(number.toString(2).length>bitLength)){if(number==0)return;throw Error("bitLength is too small for number, got number="+number+",bitLength="+bitLength)}
const s=number.toString(2,bitLength);for(let i=0;i<bitLength;i++){this.writeBit(s[i]==1)}}
writeInt(number,bitLength){if(isNaN(number))throw new Error('writeInt: value is NaN');if(number===null)throw new Error('writeInt: value is null');if(number===undefined)throw new Error('writeInt: value is undefined');if(!bitLength)throw new Error('writeInt: no bitLength');number=new BN(number);if(bitLength==1){if(number==-1){this.writeBit(!0);return}
if(number==0){this.writeBit(!1);return}
throw Error("Bitlength is too small for number")}else{if(number.isNeg()){this.writeBit(!0);const b=new BN(2);const nb=b.pow(new BN(bitLength-1));this.writeUint(nb.add(number),bitLength-1)}else{this.writeBit(!1);this.writeUint(number,bitLength-1)}}}
writeUint8(ui8){this.writeUint(ui8,8)}
writeBytes(ui8){for(let i=0;i<ui8.length;i++){this.writeUint8(ui8[i])}}
writeString(value){this.writeBytes(new TextEncoder().encode(value))}
writeGrams(amount){if(amount==0){this.writeUint(0,4)}else{amount=new BN(amount);const l=Math.ceil((amount.toString(16).length)/2);this.writeUint(l,4);this.writeUint(amount,l*8)}}
writeCoins(amount){this.writeGrams(amount)}
writeAddress(address){if(address==null){this.writeUint(0,2)}else{this.writeUint(2,2);this.writeUint(0,1);this.writeInt(address.wc,8);this.writeBytes(address.hashPart)}}
writeBitString(anotherBitString){anotherBitString.forEach(x=>{this.writeBit(x)})}
clone(){const result=new BitString(0);result.array=this.array.slice(0);result.length=this.length
result.cursor=this.cursor;return result}
toString(){return this.toHex()}
getTopUppedArray(){const ret=this.clone();let tu=Math.ceil(ret.cursor/8)*8-ret.cursor;if(tu>0){tu=tu-1;ret.writeBit(!0);while(tu>0){tu=tu-1;ret.writeBit(!1)}}
ret.array=ret.array.slice(0,Math.ceil(ret.cursor/8));return ret.array}
toHex(){if(this.cursor%4===0){const s=bytesToHex(this.array.slice(0,Math.ceil(this.cursor/8))).toUpperCase();if(this.cursor%8===0){return s}else{return s.substr(0,s.length-1)}}else{const temp=this.clone();temp.writeBit(1);while(temp.cursor%4!==0){temp.writeBit(0)}
const hex=temp.toHex().toUpperCase();return hex+'_'}}
setTopUppedArray(array,fullfilledBytes=!0){this.length=array.length*8;this.array=array;this.cursor=this.length;if(fullfilledBytes||!this.length){return}else{let foundEndBit=!1;for(let c=0;c<7;c++){this.cursor-=1;if(this.get(this.cursor)){foundEndBit=!0;this.off(this.cursor);break}}
if(!foundEndBit){console.log(array,fullfilledBytes);throw new Error("Incorrect TopUppedArray")}}}}
module.exports={BitString}},{"../utils":351}],304:[function(require,module,exports){const{BitString}=require("./BitString");const{bytesToBase64,compareBytes,concatBytes,crc32c,hexToBytes,readNBytesUIntFromArray,sha256,bytesToHex}=require("../utils");const{Slice}=require("./Slice");const reachBocMagicPrefix=hexToBytes('B5EE9C72');const leanBocMagicPrefix=hexToBytes('68ff65f3');const leanBocMagicPrefixCRC=hexToBytes('acc3a728');class Cell{constructor(){this.bits=new BitString(1023);this.refs=[];this.isExotic=!1}
static fromBoc(serializedBoc){return deserializeBoc(serializedBoc)}
static oneFromBoc(serializedBoc){const cells=deserializeBoc(serializedBoc);if(cells.length!==1)throw new Error('expected 1 root cell but have '+cells.length);return cells[0]}
writeCell(anotherCell){this.bits.writeBitString(anotherCell.bits);this.refs=this.refs.concat(anotherCell.refs)}
getMaxLevel(){let maxLevel=0;for(let k in this.refs){const i=this.refs[k];if(i.getMaxLevel()>maxLevel){maxLevel=i.getMaxLevel()}}
return maxLevel}
isExplicitlyStoredHashes(){return 0}
getMaxDepth(){let maxDepth=0;if(this.refs.length>0){for(let k=0;k<this.refs.length;k++){const child=this.refs[k];let childMaxDepth=child.getMaxDepth();if(childMaxDepth>maxDepth){maxDepth=childMaxDepth}}
maxDepth=maxDepth+1}
return maxDepth}
getMaxDepthAsArray(){const maxDepth=this.getMaxDepth();const d=Uint8Array.from({length:2},()=>0);d[1]=maxDepth%256;d[0]=Math.floor(maxDepth/256);return d}
getRefsDescriptor(){const d1=Uint8Array.from({length:1},()=>0);d1[0]=this.refs.length+this.isExotic*8+this.getMaxLevel()*32;return d1}
getBitsDescriptor(){const d2=Uint8Array.from({length:1},()=>0);d2[0]=Math.ceil(this.bits.cursor/8)+Math.floor(this.bits.cursor/8);return d2}
getDataWithDescriptors(){const d1=this.getRefsDescriptor();const d2=this.getBitsDescriptor();const tuBits=this.bits.getTopUppedArray();return concatBytes(concatBytes(d1,d2),tuBits)}
async getRepr(){const reprArray=[];reprArray.push(this.getDataWithDescriptors());for(let k in this.refs){const i=this.refs[k];reprArray.push(i.getMaxDepthAsArray())}
for(let k in this.refs){const i=this.refs[k];reprArray.push(await i.hash())}
let x=new Uint8Array();for(let k in reprArray){const i=reprArray[k];x=concatBytes(x,i)}
return x}
async hash(){return new Uint8Array(await sha256(await this.getRepr()))}
beginParse(){const refs=this.refs.map(ref=>ref.beginParse());return new Slice(this.bits.array.slice(),this.bits.length,refs)}
print(indent){indent=indent||'';let s=indent+'x{'+this.bits.toHex()+'}\n';for(let k in this.refs){const i=this.refs[k];s+=i.print(indent+' ')}
return s}
async toBoc(has_idx=!0,hash_crc32=!0,has_cache_bits=!1,flags=0){const root_cell=this;const allcells=await root_cell.treeWalk();const topologicalOrder=allcells[0];const cellsIndex=allcells[1];const cells_num=topologicalOrder.length;const s=cells_num.toString(2).length;const s_bytes=Math.min(Math.ceil(s/8),1);let full_size=0;let sizeIndex=[];for(let cell_info of topologicalOrder){sizeIndex.push(full_size);full_size=full_size+await cell_info[1].bocSerializationSize(cellsIndex,s_bytes)}
const offset_bits=full_size.toString(2).length;const offset_bytes=Math.max(Math.ceil(offset_bits/8),1);const serialization=new BitString((1023+32*4+32*3)*topologicalOrder.length);serialization.writeBytes(reachBocMagicPrefix);serialization.writeBitArray([has_idx,hash_crc32,has_cache_bits]);serialization.writeUint(flags,2);serialization.writeUint(s_bytes,3);serialization.writeUint8(offset_bytes);serialization.writeUint(cells_num,s_bytes*8);serialization.writeUint(1,s_bytes*8);serialization.writeUint(0,s_bytes*8);serialization.writeUint(full_size,offset_bytes*8);serialization.writeUint(0,s_bytes*8);if(has_idx){topologicalOrder.forEach((cell_data,index)=>serialization.writeUint(sizeIndex[index],offset_bytes*8))}
for(let cell_info of topologicalOrder){const refcell_ser=await cell_info[1].serializeForBoc(cellsIndex,s_bytes);serialization.writeBytes(refcell_ser)}
let ser_arr=serialization.getTopUppedArray();if(hash_crc32){ser_arr=concatBytes(ser_arr,crc32c(ser_arr))}
return ser_arr}
async serializeForBoc(cellsIndex,refSize){const reprArray=[];reprArray.push(this.getDataWithDescriptors());if(this.isExplicitlyStoredHashes()){throw new Error("Cell hashes explicit storing is not implemented")}
for(let k in this.refs){const i=this.refs[k];const refHash=await i.hash();const refIndexInt=cellsIndex[refHash];let refIndexHex=refIndexInt.toString(16);if(refIndexHex.length%2){refIndexHex="0"+refIndexHex}
const reference=hexToBytes(refIndexHex);reprArray.push(reference)}
let x=new Uint8Array();for(let k in reprArray){const i=reprArray[k];x=concatBytes(x,i)}
return x}
async bocSerializationSize(cellsIndex,refSize){return(await this.serializeForBoc(cellsIndex,refSize)).length}
async treeWalk(){return treeWalk(this,[],{})}}
async function moveToTheEnd(indexHashmap,topologicalOrderArray,target){const targetIndex=indexHashmap[target];for(let h in indexHashmap){if(indexHashmap[h]>targetIndex){indexHashmap[h]=indexHashmap[h]-1}}
indexHashmap[target]=topologicalOrderArray.length-1;const data=topologicalOrderArray.splice(targetIndex,1)[0];topologicalOrderArray.push(data);for(let subCell of data[1].refs){await moveToTheEnd(indexHashmap,topologicalOrderArray,await subCell.hash())}}
async function treeWalk(cell,topologicalOrderArray,indexHashmap,parentHash=null){const cellHash=await cell.hash();if(cellHash in indexHashmap){if(parentHash){if(indexHashmap[parentHash]>indexHashmap[cellHash]){await moveToTheEnd(indexHashmap,topologicalOrderArray,cellHash)}}
return[topologicalOrderArray,indexHashmap]}
indexHashmap[cellHash]=topologicalOrderArray.length;topologicalOrderArray.push([cellHash,cell]);for(let subCell of cell.refs){const res=await treeWalk(subCell,topologicalOrderArray,indexHashmap,cellHash);topologicalOrderArray=res[0];indexHashmap=res[1]}
return[topologicalOrderArray,indexHashmap]}
function parseBocHeader(serializedBoc){if(serializedBoc.length<4+1)
throw "Not enough bytes for magic prefix";const inputData=serializedBoc;const prefix=serializedBoc.slice(0,4);serializedBoc=serializedBoc.slice(4);let has_idx,hash_crc32,has_cache_bits,flags,size_bytes;if(compareBytes(prefix,reachBocMagicPrefix)){const flags_byte=serializedBoc[0];has_idx=flags_byte&128;hash_crc32=flags_byte&64;has_cache_bits=flags_byte&32;flags=(flags_byte&16)*2+(flags_byte&8);size_bytes=flags_byte%8}
if(compareBytes(prefix,leanBocMagicPrefix)){has_idx=1;hash_crc32=0;has_cache_bits=0;flags=0;size_bytes=serializedBoc[0]}
if(compareBytes(prefix,leanBocMagicPrefixCRC)){has_idx=1;hash_crc32=1;has_cache_bits=0;flags=0;size_bytes=serializedBoc[0]}
serializedBoc=serializedBoc.slice(1);if(serializedBoc.length<1+5*size_bytes)
throw "Not enough bytes for encoding cells counters";const offset_bytes=serializedBoc[0];serializedBoc=serializedBoc.slice(1);const cells_num=readNBytesUIntFromArray(size_bytes,serializedBoc);serializedBoc=serializedBoc.slice(size_bytes);const roots_num=readNBytesUIntFromArray(size_bytes,serializedBoc);serializedBoc=serializedBoc.slice(size_bytes);const absent_num=readNBytesUIntFromArray(size_bytes,serializedBoc);serializedBoc=serializedBoc.slice(size_bytes);const tot_cells_size=readNBytesUIntFromArray(offset_bytes,serializedBoc);serializedBoc=serializedBoc.slice(offset_bytes);if(serializedBoc.length<roots_num*size_bytes)
throw "Not enough bytes for encoding root cells hashes";let root_list=[];for(let c=0;c<roots_num;c++){root_list.push(readNBytesUIntFromArray(size_bytes,serializedBoc));serializedBoc=serializedBoc.slice(size_bytes)}
let index=!1;if(has_idx){index=[];if(serializedBoc.length<offset_bytes*cells_num)
throw "Not enough bytes for index encoding";for(let c=0;c<cells_num;c++){index.push(readNBytesUIntFromArray(offset_bytes,serializedBoc));serializedBoc=serializedBoc.slice(offset_bytes)}}
if(serializedBoc.length<tot_cells_size)
throw "Not enough bytes for cells data";const cells_data=serializedBoc.slice(0,tot_cells_size);serializedBoc=serializedBoc.slice(tot_cells_size);if(hash_crc32){if(serializedBoc.length<4)
throw "Not enough bytes for crc32c hashsum";const length=inputData.length;if(!compareBytes(crc32c(inputData.slice(0,length-4)),serializedBoc.slice(0,4)))
throw "Crc32c hashsum mismatch";serializedBoc=serializedBoc.slice(4)}
if(serializedBoc.length)
throw "Too much bytes in BoC serialization";return{has_idx:has_idx,hash_crc32:hash_crc32,has_cache_bits:has_cache_bits,flags:flags,size_bytes:size_bytes,off_bytes:offset_bytes,cells_num:cells_num,roots_num:roots_num,absent_num:absent_num,tot_cells_size:tot_cells_size,root_list:root_list,index:index,cells_data:cells_data}}
function deserializeCellData(cellData,referenceIndexSize){if(cellData.length<2)
throw "Not enough bytes to encode cell descriptors";const d1=cellData[0],d2=cellData[1];cellData=cellData.slice(2);const level=Math.floor(d1/32);const isExotic=d1&8;const refNum=d1%8;const dataBytesize=Math.ceil(d2/2);const fullfilledBytes=!(d2%2);let cell=new Cell();cell.isExotic=isExotic;if(cellData.length<dataBytesize+referenceIndexSize*refNum)
throw "Not enough bytes to encode cell data";cell.bits.setTopUppedArray(cellData.slice(0,dataBytesize),fullfilledBytes);cellData=cellData.slice(dataBytesize);for(let r=0;r<refNum;r++){cell.refs.push(readNBytesUIntFromArray(referenceIndexSize,cellData));cellData=cellData.slice(referenceIndexSize)}
return{cell:cell,residue:cellData}}
function deserializeBoc(serializedBoc){if(typeof(serializedBoc)=='string'){serializedBoc=hexToBytes(serializedBoc)}
const header=parseBocHeader(serializedBoc);let cells_data=header.cells_data;let cells_array=[];for(let ci=0;ci<header.cells_num;ci++){let dd=deserializeCellData(cells_data,header.size_bytes);cells_data=dd.residue;cells_array.push(dd.cell)}
for(let ci=header.cells_num-1;ci>=0;ci--){let c=cells_array[ci];for(let ri=0;ri<c.refs.length;ri++){const r=c.refs[ri];if(r<ci){throw "Topological order is broken"}
c.refs[ri]=cells_array[r]}}
let root_cells=[];for(let ri of header.root_list){root_cells.push(cells_array[ri])}
return root_cells}
module.exports={Cell}},{"../utils":351,"./BitString":303,"./Slice":305}],305:[function(require,module,exports){const{BN,Address,bytesToHex}=require("../utils");const{BitString}=require("./BitString");class Slice{constructor(array,length,refs){this.array=array;this.length=length;this.readCursor=0;this.refs=refs;this.refCursor=0}
getFreeBits(){return this.length-this.readCursor}
checkRange(n){if(n>this.length){throw Error("BitString overflow")}}
get(n){this.checkRange(n);return(this.array[(n/8)|0]&(1<<(7-(n%8))))>0}
loadBit(){const result=this.get(this.readCursor);this.readCursor++;return result}
loadBits(bitLength){const result=new BitString(bitLength);for(let i=0;i<bitLength;i++){result.writeBit(this.loadBit())}
return result.array}
loadUint(bitLength){if(bitLength<1){throw "Incorrect bitLength"}
let s='';for(let i=0;i<bitLength;i++){s+=(this.loadBit()?'1':'0')}
return new BN(s,2)}
loadInt(bitLength){if(bitLength<1){throw "Incorrect bitLength"}
const sign=this.loadBit();if(bitLength===1){return sign?new BN(-1):new BN(0)}
let number=this.loadUint(bitLength-1);if(sign){const b=new BN(2);const nb=b.pow(new BN(bitLength-1));number=number.sub(nb)}
return number}
loadVarUint(bitLength){const len=this.loadUint((new BN(bitLength)).toString(2).length-1);if(len.toNumber()===0){return new BN(0)}else{return this.loadUint(len*8)}}
loadCoins(){return this.loadVarUint(16)}
loadAddress(){const b=this.loadUint(2);if(b.toNumber()===0)return null;if(b.toNumber()!==2)throw new Error('unsupported address type');if(this.loadBit())throw new Error('unsupported address type');const wc=this.loadInt(8).toNumber();const hashPart=this.loadBits(256);return new Address(wc+':'+bytesToHex(hashPart))}
loadRef(){if(this.refCursor>=4)throw new Error('refs overflow');const result=this.refs[this.refCursor];this.refCursor++;return result}}
module.exports={Slice}},{"../utils":351,"./BitString":303}],306:[function(require,module,exports){const{BitString}=require("./BitString");const{Cell}=require("./Cell");const{Slice}=require("./Slice");module.exports={BitString,Cell,Slice}},{"./BitString":303,"./Cell":304,"./Slice":305}],307:[function(require,module,exports){const{Cell}=require("../../boc");const{Address,bytesToHex}=require("../../utils");const{DNS_CATEGORY_NEXT_RESOLVER,DNS_CATEGORY_SITE,DNS_CATEGORY_WALLET,DNS_CATEGORY_STORAGE,createSmartContractAddressRecord,createAdnlAddressRecord,createStorageBagIdRecord,createNextResolverRecord,parseSmartContractAddressRecord,parseAdnlAddressRecord,parseStorageBagIdRecord,parseSiteRecord,parseNextResolverRecord,dnsResolve}=require("./DnsUtils");class Dns{constructor(provider){this.provider=provider}
async getRootDnsAddress(){const cell=await this.provider.getConfigParam(4);const byteArray=cell.bits.array;if(byteArray.length!==256/8)throw new Error('Invalid ConfigParam 4 length '+byteArray.length);const hex=bytesToHex(byteArray);return new Address('-1:'+hex)}
async resolve(domain,category,oneStep){const rootDnsAddress=await this.getRootDnsAddress();return dnsResolve(this.provider,rootDnsAddress.toString(),domain,category,oneStep)}
getWalletAddress(domain){return this.resolve(domain,DNS_CATEGORY_WALLET)}
getSiteAddress(domain){return this.resolve(domain,DNS_CATEGORY_SITE)}}
Dns.resolve=dnsResolve;Dns.createSmartContractAddressRecord=createSmartContractAddressRecord;Dns.createAdnlAddressRecord=createAdnlAddressRecord;Dns.createStorageBagIdRecord=createStorageBagIdRecord;Dns.createNextResolverRecord=createNextResolverRecord;Dns.parseNextResolverRecord=parseNextResolverRecord;Dns.parseAdnlAddressRecord=parseAdnlAddressRecord;Dns.parseStorageBagIdRecord=parseStorageBagIdRecord;Dns.parseSiteRecord=parseSiteRecord;Dns.parseSmartContractAddressRecord=parseSmartContractAddressRecord;Dns.DNS_CATEGORY_NEXT_RESOLVER=DNS_CATEGORY_NEXT_RESOLVER;Dns.DNS_CATEGORY_WALLET=DNS_CATEGORY_WALLET;Dns.DNS_CATEGORY_SITE=DNS_CATEGORY_SITE;Dns.DNS_CATEGORY_STORAGE=DNS_CATEGORY_STORAGE;module.exports.default=Dns},{"../../boc":306,"../../utils":351,"./DnsUtils":310}],308:[function(require,module,exports){const{Contract}=require("../../contract/index.js");const{Cell}=require("../../boc");const{Address}=require("../../utils");const{parseAddress}=require('../token/nft/NftUtils.js');const{dnsResolve}=require("./DnsUtils.js")
const{parseOffchainUriCell}=require("../token/nft/NftUtils");class DnsCollection extends Contract{constructor(provider,options){options.wc=0;options.code=options.code;super(provider,options);if(!options.collectionContent&&!options.address)throw new Error('required collectionContent cell');this.methods.getCollectionData=this.getCollectionData.bind(this);this.methods.getNftItemAddressByIndex=this.getNftItemAddressByIndex.bind(this);this.methods.getNftItemContent=this.getNftItemContent.bind(this);this.methods.resolve=this.resolve.bind(this)}
createDataCell(){const cell=new Cell();cell.refs[0]=this.options.collectionContent;cell.refs[1]=Cell.oneFromBoc(this.options.dnsItemCodeHex);return cell}
async getCollectionData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_collection_data');const nextItemIndex=result[0].toNumber();const collectionContent=result[1];const collectionContentUri=parseOffchainUriCell(collectionContent);return{collectionContentUri,collectionContent,ownerAddress:null,nextItemIndex}}
async getNftItemContent(nftItem){const nftData=await nftItem.getData();return nftData}
async getNftItemAddressByIndex(index){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_nft_address_by_index',[['num',index.toString()]]);return parseAddress(result)}
async resolve(domain,category,oneStep){const myAddress=await this.getAddress();return dnsResolve(this.provider,myAddress.toString(),domain,category,oneStep)}}
module.exports={DnsCollection:DnsCollection}},{"../../boc":306,"../../contract/index.js":315,"../../utils":351,"../token/nft/NftUtils":330,"../token/nft/NftUtils.js":330,"./DnsUtils.js":310}],309:[function(require,module,exports){const{Contract}=require("../../contract/index.js");const{Cell}=require("../../boc");const{Address,BN}=require("../../utils");const{parseAddress}=require('./../token/nft/NftUtils.js');const{dnsResolve,categoryToBN}=require("./DnsUtils.js")
class DnsItem extends Contract{constructor(provider,options){options.wc=0;options.code=options.code;super(provider,options);this.methods.getData=this.getData.bind(this);this.methods.getDomain=this.getDomain.bind(this);this.methods.getAuctionInfo=this.getAuctionInfo.bind(this);this.methods.getLastFillUpTime=this.getLastFillUpTime.bind(this);this.methods.resolve=this.resolve.bind(this)}
createDataCell(){const cell=new Cell();cell.bits.writeUint(this.options.index,256);cell.bits.writeAddress(this.options.collectionAddress);return cell}
async getData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_nft_data');const isInitialized=result[0].toNumber()===-1;const index=result[1];const collectionAddress=parseAddress(result[2]);const ownerAddress=isInitialized?parseAddress(result[3]):null;const contentCell=result[4];return{isInitialized,index,collectionAddress,ownerAddress,contentCell}}
async createTransferBody(params){const cell=new Cell();cell.bits.writeUint(0x5fcc3d14,32);cell.bits.writeUint(params.queryId||0,64);cell.bits.writeAddress(params.newOwnerAddress);cell.bits.writeAddress(params.responseAddress);cell.bits.writeBit(!1);cell.bits.writeCoins(params.forwardAmount||new BN(0));cell.bits.writeBit(!1);if(params.forwardPayload){cell.bits.writeBytes(params.forwardPayload)}
return cell}
createGetStaticDataBody(params){const body=new Cell();body.bits.writeUint(0x2fcb26a2,32);body.bits.writeUint(params.queryId||0,64);return body}
async getDomain(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_domain');return new TextDecoder().decode(result.bits.array.buffer)}
async getAuctionInfo(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_auction_info');const maxBidAddress=parseAddress(result[0]);const maxBidAmount=result[1];const auctionEndTime=result[2].toNumber();return{maxBidAddress,maxBidAmount,auctionEndTime}}
async getLastFillUpTime(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_last_fill_up_time');return result.toNumber()}
async resolve(domain,category,oneStep){const myAddress=await this.getAddress();return dnsResolve(this.provider,myAddress.toString(),domain,category,oneStep)}}
DnsItem.createChangeContentEntryBody=async(params)=>{const body=new Cell();body.bits.writeUint(0x4eb1f0f9,32);body.bits.writeUint(params.queryId||0,64);body.bits.writeUint(await categoryToBN(params.category),256);if(params.value){body.refs[0]=params.value}
return body}
module.exports={DnsItem:DnsItem}},{"../../boc":306,"../../contract/index.js":315,"../../utils":351,"./../token/nft/NftUtils.js":330,"./DnsUtils.js":310}],310:[function(require,module,exports){const{parseAddress}=require("../token/nft/NftUtils");const{AdnlAddress,StorageBagId,BN,sha256,bytesToHex,bytesToBase64}=require("../../utils");const{Cell}=require("../../boc");const DNS_CATEGORY_NEXT_RESOLVER='dns_next_resolver';const DNS_CATEGORY_WALLET='wallet';const DNS_CATEGORY_SITE='site';const DNS_CATEGORY_STORAGE='storage';const categoryToBN=async(category)=>{if(!category)return new BN(0);const categoryBytes=new TextEncoder().encode(category);const categoryHash=new Uint8Array(await sha256(categoryBytes));return new BN(bytesToHex(categoryHash),16)}
const createSmartContractAddressRecord=(smartContractAddress)=>{const cell=new Cell();cell.bits.writeUint(0x9fd3,16);cell.bits.writeAddress(smartContractAddress);cell.bits.writeUint(0,8);return cell}
const createAdnlAddressRecord=(adnlAddress)=>{const cell=new Cell();cell.bits.writeUint(0xad01,16);cell.bits.writeBytes(adnlAddress.bytes);cell.bits.writeUint(0,8);return cell}
const createStorageBagIdRecord=(storageBagId)=>{const cell=new Cell();cell.bits.writeUint(0x7473,16);cell.bits.writeBytes(storageBagId.bytes);return cell}
const createNextResolverRecord=(smartContractAddress)=>{const cell=new Cell();cell.bits.writeUint(0xba93,16);cell.bits.writeAddress(smartContractAddress);return cell}
const parseSmartContractAddressImpl=(cell,prefix0,prefix1)=>{if(cell.bits.array[0]!==prefix0||cell.bits.array[1]!==prefix1)throw new Error('Invalid dns record value prefix');cell.bits.array=cell.bits.array.slice(2);return parseAddress(cell)}
const parseSmartContractAddressRecord=(cell)=>{return parseSmartContractAddressImpl(cell,0x9f,0xd3)}
const parseNextResolverRecord=(cell)=>{return parseSmartContractAddressImpl(cell,0xba,0x93)}
const parseAdnlAddressRecord=(cell)=>{if(cell.bits.array[0]!==0xad||cell.bits.array[1]!==0x01)throw new Error('Invalid dns record value prefix');const bytes=cell.bits.array.slice(2,2+32);return new AdnlAddress(bytes)}
const parseStorageBagIdRecord=(cell)=>{if(cell.bits.array[0]!==0x74||cell.bits.array[1]!==0x73)throw new Error('Invalid dns record value prefix');const bytes=cell.bits.array.slice(2,2+32);return new StorageBagId(bytes)}
const parseSiteRecord=(cell)=>{if(!cell)return null;if(cell.bits.array[0]===0xad||cell.bits.array[1]===0x01){return parseAdnlAddressRecord(cell)}else{return parseStorageBagIdRecord(cell)}}
const dnsResolveImpl=async(provider,dnsAddress,rawDomainBytes,category,oneStep)=>{const len=rawDomainBytes.length*8;const domainCell=new Cell();domainCell.bits.writeBytes(rawDomainBytes);const categoryBN=await categoryToBN(category);const result=await provider.call2(dnsAddress,'dnsresolve',[['tvm.Slice',bytesToBase64(await domainCell.toBoc(!1))],['num',categoryBN.toString()]]);if(result.length!==2){throw new Error('Invalid dnsresolve response')}
const resultLen=result[0].toNumber();let cell=result[1];if((cell instanceof Array)&&cell.length===0){cell=null}
if(cell&&!cell.bits){throw new Error('Invalid dnsresolve response')}
if(resultLen===0){return null}
if(resultLen%8!==0){throw new Error('domain split not at a component boundary')}
if(resultLen>len){throw new Error('invalid response '+resultLen+'/'+len)}else if(resultLen===len){if(category===DNS_CATEGORY_NEXT_RESOLVER){return cell?parseNextResolverRecord(cell):null}else if(category===DNS_CATEGORY_WALLET){return cell?parseSmartContractAddressRecord(cell):null}else if(category===DNS_CATEGORY_SITE){return cell?parseSiteRecord(cell):null}else if(category===DNS_CATEGORY_STORAGE){return cell?parseStorageBagIdRecord(cell):null}else{return cell}}else{if(!cell){return null}else{const nextAddress=parseNextResolverRecord(cell);if(oneStep){if(category===DNS_CATEGORY_NEXT_RESOLVER){return nextAddress}else{return null}}else{return await dnsResolveImpl(provider,nextAddress.toString(),rawDomainBytes.slice(resultLen/8),category,!1)}}}}
const domainToBytes=(domain)=>{if(!domain||!domain.length){throw new Error('empty domain')}
if(domain==='.'){return new Uint8Array([0])}
domain=domain.toLowerCase();for(let i=0;i<domain.length;i++){if(domain.charCodeAt(i)<=32){throw new Error('bytes in range 0..32 are not allowed in domain names')}}
for(let i=0;i<domain.length;i++){const s=domain.substring(i,i+1);for(let c=127;c<=159;c++){if(s===String.fromCharCode(c)){throw new Error('bytes in range 127..159 are not allowed in domain names')}}}
const arr=domain.split('.');arr.forEach(part=>{if(!part.length){throw new Error('domain name cannot have an empty component')}});let rawDomain=arr.reverse().join('\0')+'\0';if(rawDomain.length<126){rawDomain='\0'+rawDomain}
return new TextEncoder().encode(rawDomain)}
const dnsResolve=async(provider,rootDnsAddress,domain,category,oneStep)=>{const rawDomainBytes=domainToBytes(domain);return dnsResolveImpl(provider,rootDnsAddress,rawDomainBytes,category,oneStep)}
module.exports={DNS_CATEGORY_NEXT_RESOLVER,DNS_CATEGORY_SITE,DNS_CATEGORY_WALLET,DNS_CATEGORY_STORAGE,categoryToBN,domainToBytes,createSmartContractAddressRecord,createAdnlAddressRecord,createNextResolverRecord,parseSmartContractAddressRecord,parseAdnlAddressRecord,parseStorageBagIdRecord,parseSiteRecord,parseNextResolverRecord,createStorageBagIdRecord,dnsResolve}},{"../../boc":306,"../../utils":351,"../token/nft/NftUtils":330}],311:[function(require,module,exports){const Dns=require("./Dns").default;const{DnsCollection}=require("./DnsCollection");const{DnsItem}=require("./DnsItem");module.exports.default={Dns,DnsCollection,DnsItem}},{"./Dns":307,"./DnsCollection":308,"./DnsItem":309}],312:[function(require,module,exports){const BIT_NUMBER_SIZE=10n;const SHIFT_SIZE=13n;const MAX_BIT_NUMBER=1022n;const MAX_SHIFT=8191n;class HighloadQueryId{constructor(){this.shift=0n;this.bitnumber=0n}
static fromShiftAndBitNumber(shift,bitnumber){const q=new HighloadQueryId();q.shift=shift;if(q.shift<0)throw new Error('invalid shift');if(q.shift>MAX_SHIFT)throw new Error('invalid shift');q.bitnumber=bitnumber;if(q.bitnumber<0)throw new Error('invalid bitnumber');if(q.bitnumber>MAX_BIT_NUMBER)throw new Error('invalid bitnumber');return q}
getNext(){let newBitnumber=this.bitnumber+1n;let newShift=this.shift;if(newShift===MAX_SHIFT&&newBitnumber>(MAX_BIT_NUMBER-1n)){throw new Error('Overload')}
if(newBitnumber>MAX_BIT_NUMBER){newBitnumber=0n;newShift+=1n;if(newShift>MAX_SHIFT){throw new Error('Overload')}}
return HighloadQueryId.fromShiftAndBitNumber(newShift,newBitnumber)}
hasNext(){const isEnd=this.bitnumber>=(MAX_BIT_NUMBER-1n)&&this.shift===MAX_SHIFT;return!isEnd}
getShift(){return this.shift}
getBitNumber(){return this.bitnumber}
getQueryId(){return(this.shift<<BIT_NUMBER_SIZE)+this.bitnumber}
static fromQueryId(queryId){const shift=queryId>>BIT_NUMBER_SIZE;const bitnumber=queryId&1023n;return this.fromShiftAndBitNumber(shift,bitnumber)}
static fromSeqno(i){const shift=i/1023n;const bitnumber=i%1023n;return this.fromShiftAndBitNumber(shift,bitnumber)}
toSeqno(){return this.bitnumber+this.shift*1023n}}
module.exports={HighloadQueryId}},{}],313:[function(require,module,exports){const{Cell}=require("../../boc");const{Contract}=require("../index.js");const{Address,BN,nacl}=require("../../utils");const CODE_HEX="b5ee9c7241021001000228000114ff00f4a413f4bcf2c80b01020120020d02014803040078d020d74bc00101c060b0915be101d0d3030171b0915be0fa4030f828c705b39130e0d31f018210ae42e5a4ba9d8040d721d74cf82a01ed55fb04e030020120050a02027306070011adce76a2686b85ffc00201200809001aabb6ed44d0810122d721d70b3f0018aa3bed44d08307d721d70b1f0201200b0c001bb9a6eed44d0810162d721d70b15800e5b8bf2eda2edfb21ab09028409b0ed44d0810120d721f404f404d33fd315d1058e1bf82325a15210b99f326df82305aa0015a112b992306dde923033e2923033e25230800df40f6fa19ed021d721d70a00955f037fdb31e09130e259800df40f6fa19cd001d721d70a00937fdb31e0915be270801f6f2d48308d718d121f900ed44d0d3ffd31ff404f404d33fd315d1f82321a15220b98e12336df82324aa00a112b9926d32de58f82301de541675f910f2a106d0d31fd4d307d30cd309d33fd315d15168baf2a2515abaf2a6f8232aa15250bcf2a304f823bbf2a35304800df40f6fa199d024d721d70a00f2649130e20e01fe5309800df40f6fa18e13d05004d718d20001f264c858cf16cf8301cf168e1030c824cf40cf8384095005a1a514cf40e2f800c94039800df41704c8cbff13cb1ff40012f40012cb3f12cb15c9ed54f80f21d0d30001f265d3020171b0925f03e0fa4001d70b01c000f2a5fa4031fa0031f401fa0031fa00318060d721d300010f0020f265d2000193d431d19130e272b1fb00b585bf03";const HIGHLOAD_WALLET_SUBWALLET_ID=0x10ad;const checkTimeout=(seconds)=>{if(!seconds)throw new Error('invalid timeout');if(seconds<60*10)throw new Error('minimum timeout 10 minute');if(seconds>60*60*24*30)throw new Error('maximum timeout 30 days');}
class HighloadWalletContractV3 extends Contract{constructor(provider,options){if(options.wc)throw new Error('only basechain (wc = 0) supported');options.wc=0;if(!options.address){if(!options.publicKey)throw new Error('no publicKey');if(!(options.publicKey instanceof Uint8Array))throw new Error('publicKey not Uint8Array');checkTimeout(options.timeout)}
options.code=Cell.oneFromBoc(CODE_HEX);super(provider,options);if(!this.options.walletId)this.options.walletId=HIGHLOAD_WALLET_SUBWALLET_ID;this.methods={transfer:(params)=>Contract.createMethod(provider,this.createTransferMessage(params.secretKey,params.toAddress,params.amount,params.queryId,params.payload,params.sendMode,params.createdAt,params.needDeploy)),}
this.methods.getPublicKey=this.getPublicKey.bind(this);this.methods.getWalletId=this.getWalletId.bind(this);this.methods.getLastCleanTime=this.getLastCleanTime.bind(this);this.methods.getTimeout=this.getTimeout.bind(this);this.methods.isProcessed=this.isProcessed.bind(this)}
getName(){return'highload-3'}
createDataCell(){if(this.options.walletId!==0&&!this.options.walletId)throw new Error('no walletId');if(!this.options.publicKey)throw new Error('no publicKey');if(!(this.options.publicKey instanceof Uint8Array))throw new Error('publicKey not Uint8Array');checkTimeout(this.options.timeout);const cell=new Cell();cell.bits.writeBytes(this.options.publicKey);cell.bits.writeUint(this.options.walletId,32);cell.bits.writeUint(0,1);cell.bits.writeUint(0,1);cell.bits.writeUint(0,64);cell.bits.writeUint(this.options.timeout,22);return cell}
createSigningMessage(queryId,createdAt,sendMode,messageToSend){if(isNaN(sendMode)||sendMode===undefined||sendMode===null)throw new Error('invalid sendMode');if(isNaN(createdAt)||createdAt===undefined||createdAt===null)throw new Error('invalid createdAt');checkTimeout(this.options.timeout);const cell=new Cell();cell.bits.writeUint(this.options.walletId,32);cell.refs.push(messageToSend);cell.bits.writeUint(sendMode,8);cell.bits.writeUint(Number(queryId.getShift()),13);cell.bits.writeUint(Number(queryId.getBitNumber()),10);cell.bits.writeUint(createdAt,64);cell.bits.writeUint(this.options.timeout,22);return cell}
async createTransferMessage(secretKey,address,amount,queryId,payload="",sendMode=3,createAt,needDeploy=!1){if(queryId===null||queryId===undefined){throw new Error('queryId must be number >= 0')}
if(createAt===null||createAt===undefined||createAt<0){throw new Error('createAt must be number >= 0')}
if(sendMode===null||sendMode===undefined){sendMode=3}
const messageToSend=Contract.createOutMsg(address,amount,payload);const signingMessage=this.createSigningMessage(queryId,createAt,sendMode,messageToSend);return this.createExternalMessage(signingMessage,secretKey,needDeploy)}
async createExternalMessage(signingMessage,secretKey,needDeploy){const signature=nacl.sign.detached(await signingMessage.hash(),secretKey);const body=new Cell();body.bits.writeBytes(signature);body.refs.push(signingMessage);let stateInit=null,code=null,data=null;if(needDeploy){if(!this.options.publicKey){const keyPair=nacl.sign.keyPair.fromSecretKey(secretKey)
this.options.publicKey=keyPair.publicKey}
const deploy=await this.createStateInit();stateInit=deploy.stateInit;code=deploy.code;data=deploy.data}
const selfAddress=await this.getAddress();const header=Contract.createExternalMessageHeader(selfAddress);const resultMessage=Contract.createCommonMsgInfo(header,stateInit,body);return{address:selfAddress,message:resultMessage,body:body,signature:signature,signingMessage:signingMessage,stateInit,code,data,}}
async getWalletId(){const myAddress=await this.getAddress();const id=await this.provider.call2(myAddress.toString(),'get_subwallet_id');return id.toNumber()}
async getPublicKey(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_public_key')}
async getLastCleanTime(){const myAddress=await this.getAddress();const id=await this.provider.call2(myAddress.toString(),'get_last_clean_time');return id.toNumber()}
async getTimeout(){const myAddress=await this.getAddress();const id=await this.provider.call2(myAddress.toString(),'get_timeout');return id.toNumber()}
async isProcessed(queryId,needClean){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'processed?',[['num',queryId.getQueryId().toString()],['num',needClean?'-1':'0']]);return!result.isZero()}}
HighloadWalletContractV3.WALLET_ID_BASE=HIGHLOAD_WALLET_SUBWALLET_ID;HighloadWalletContractV3.codeHex=CODE_HEX;module.exports={HighloadWalletContractV3}},{"../../boc":306,"../../utils":351,"../index.js":315}],314:[function(require,module,exports){const{HighloadWalletContractV3}=require("./HighloadWalletContractV3");const{HighloadQueryId}=require("./HighloadQueryId");module.exports.default={HighloadQueryId,HighloadWalletContractV3,all:{'highload-3':HighloadWalletContractV3,},list:[HighloadWalletContractV3]}},{"./HighloadQueryId":312,"./HighloadWalletContractV3":313}],315:[function(require,module,exports){const{Cell}=require("../boc");const{Address,bytesToBase64,bytesToHex,BN}=require("../utils");class Contract{constructor(provider,options){this.provider=provider;this.options=options;this.address=options.address?new Address(options.address):null;if(!options.wc)options.wc=this.address?this.address.wc:0;this.methods={}}
async getAddress(){if(!this.address){this.address=(await this.createStateInit()).address}
return this.address}
createCodeCell(){if(!this.options.code)throw new Error('Contract: options.code is not defined')
return this.options.code}
createDataCell(){return new Cell()}
async createStateInit(){const codeCell=this.createCodeCell();const dataCell=this.createDataCell();const stateInit=Contract.createStateInit(codeCell,dataCell);const stateInitHash=await stateInit.hash();const address=new Address(this.options.wc+":"+bytesToHex(stateInitHash));return{stateInit:stateInit,address:address,code:codeCell,data:dataCell,}}
static createStateInit(code,data,library=null,splitDepth=null,ticktock=null){if(library)
throw "Library in state init is not implemented";if(splitDepth)
throw "Split depth in state init is not implemented";if(ticktock)
throw "Ticktock in state init is not implemented";const stateInit=new Cell();stateInit.bits.writeBitArray([Boolean(splitDepth),Boolean(ticktock),Boolean(code),Boolean(data),Boolean(library)]);if(code)
stateInit.refs.push(code);if(data)
stateInit.refs.push(data);if(library)
stateInit.refs.push(library);return stateInit}
static createInternalMessageHeader(dest,gramValue=0,ihrDisabled=!0,bounce=null,bounced=!1,src=null,currencyCollection=null,ihrFees=0,fwdFees=0,createdLt=0,createdAt=0){const message=new Cell();message.bits.writeBit(!1);message.bits.writeBit(ihrDisabled);if(!(bounce===null)){message.bits.writeBit(bounce)}else{message.bits.writeBit((new Address(dest)).isBounceable)}
message.bits.writeBit(bounced);message.bits.writeAddress(src?new Address(src):null);message.bits.writeAddress(new Address(dest));message.bits.writeGrams(gramValue);if(currencyCollection){throw "Currency collections are not implemented yet"}
message.bits.writeBit(Boolean(currencyCollection));message.bits.writeGrams(ihrFees);message.bits.writeGrams(fwdFees);message.bits.writeUint(createdLt,64);message.bits.writeUint(createdAt,32);return message}
static createExternalMessageHeader(dest,src=null,importFee=0){const message=new Cell();message.bits.writeUint(2,2);message.bits.writeAddress(src?new Address(src):null);message.bits.writeAddress(new Address(dest));message.bits.writeGrams(importFee);return message}
static createOutMsg(address,amount,payload,stateInit=null){let payloadCell=new Cell();if(payload){if(payload.refs){payloadCell=payload}else if(typeof payload==='string'){if(payload.length>0){payloadCell.bits.writeUint(0,32);payloadCell.bits.writeString(payload)}}else{payloadCell.bits.writeBytes(payload)}}
const orderHeader=Contract.createInternalMessageHeader(new Address(address),new BN(amount));const order=Contract.createCommonMsgInfo(orderHeader,stateInit,payloadCell);return order}
static createCommonMsgInfo(header,stateInit=null,body=null){const commonMsgInfo=new Cell();commonMsgInfo.writeCell(header);if(stateInit){commonMsgInfo.bits.writeBit(!0);if(!1&&(commonMsgInfo.bits.getFreeBits()-1>=stateInit.bits.getUsedBits())){commonMsgInfo.bits.writeBit(!1);commonMsgInfo.writeCell(stateInit)}else{commonMsgInfo.bits.writeBit(!0);commonMsgInfo.refs.push(stateInit)}}else{commonMsgInfo.bits.writeBit(!1)}
if(body){if((commonMsgInfo.bits.getFreeBits()>=body.bits.getUsedBits())&&(commonMsgInfo.refs.length+body.refs.length<=4)){commonMsgInfo.bits.writeBit(!1);commonMsgInfo.writeCell(body)}else{commonMsgInfo.bits.writeBit(!0);commonMsgInfo.refs.push(body)}}else{commonMsgInfo.bits.writeBit(!1)}
return commonMsgInfo}
static createMethod(provider,queryPromise){return{getBody:async()=>{return(await queryPromise).body},getQuery:async()=>{return(await queryPromise).message},send:async()=>{const query=await queryPromise;const boc=bytesToBase64(await query.message.toBoc(!1));return provider.sendBoc(boc)},estimateFee:async()=>{const query=await queryPromise;const serialized=query.code?{address:query.address.toString(!0,!0,!1),body:bytesToBase64(await query.body.toBoc(!1)),init_code:bytesToBase64(await query.code.toBoc(!1)),init_data:bytesToBase64(await query.data.toBoc(!1)),}:{address:query.address.toString(!0,!0,!0),body:bytesToBase64(await query.body.toBoc(!1)),};return provider.getEstimateFee(serialized)}}}}
module.exports={Contract}},{"../boc":306,"../utils":351}],316:[function(require,module,exports){const{Cell}=require("../../boc");const{Address,BN,base64ToBytes}=require("../../utils");const{WalletContract}=require("../wallet/WalletContract");const WALLET_ID_BASE=698983191;class LockupWalletV1 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C7241021E01000261000114FF00F4A413F4BCF2C80B010201200203020148040501F2F28308D71820D31FD31FD31F802403F823BB13F2F2F003802251A9BA1AF2F4802351B7BA1BF2F4801F0BF9015410C5F9101AF2F4F8005057F823F0065098F823F0062071289320D74A8E8BD30731D4511BDB3C12B001E8309229A0DF72FB02069320D74A96D307D402FB00E8D103A4476814154330F004ED541D0202CD0607020120131402012008090201200F100201200A0B002D5ED44D0D31FD31FD3FFD3FFF404FA00F404FA00F404D1803F7007434C0C05C6C2497C0F83E900C0871C02497C0F80074C7C87040A497C1383C00D46D3C00608420BABE7114AC2F6C2497C338200A208420BABE7106EE86BCBD20084AE0840EE6B2802FBCBD01E0C235C62008087E4055040DBE4404BCBD34C7E00A60840DCEAA7D04EE84BCBD34C034C7CC0078C3C412040DD78CA00C0D0E00130875D27D2A1BE95B0C60000C1039480AF00500161037410AF0050810575056001010244300F004ED540201201112004548E1E228020F4966FA520933023BB9131E2209835FA00D113A14013926C21E2B3E6308003502323287C5F287C572FFC4F2FFFD00007E80BD00007E80BD00326000431448A814C4E0083D039BE865BE803444E800A44C38B21400FE809004E0083D10C06002012015160015BDE9F780188242F847800C02012017180201481B1C002DB5187E006D88868A82609E00C6207E00C63F04EDE20B30020158191A0017ADCE76A268699F98EB85FFC00017AC78F6A268698F98EB858FC00011B325FB513435C2C7E00017B1D1BE08E0804230FB50F620002801D0D3030178B0925B7FE0FA4031FA403001F001A80EDAA4");super(provider,options);if(!this.options.walletId)this.options.walletId=WALLET_ID_BASE+this.options.wc;this.methods.getPublicKey=this.getPublicKey.bind(this);this.methods.getWalletId=this.getWalletId.bind(this);this.methods.getLiquidBalance=this.getLiquidBalance.bind(this);this.methods.getNominalRestrictedBalance=this.getNominalRestrictedBalance.bind(this);this.methods.getNominalLockedBalance=this.getNominalLockedBalance.bind(this)}
getName(){return'lockup-0.1'}
createSigningMessage(seqno,expireAt,withoutOp){seqno=seqno||0;expireAt=expireAt||(Math.floor(Date.now()/1e3)+60);const message=new Cell();message.bits.writeUint(this.options.walletId,32);if(seqno===0){for(let i=0;i<32;i++){message.bits.writeBit(1)}}else{message.bits.writeUint(expireAt,32)}
message.bits.writeUint(seqno,32);return message}
createDataCell(){const cell=new Cell();cell.bits.writeUint(0,32);cell.bits.writeUint(this.options.walletId,32);cell.bits.writeBytes(this.options.publicKey);cell.bits.writeBytes(base64ToBytes(this.options.config.config_public_key));if(this.options.config.allowed_destinations){cell.bits.writeUint(1,1);cell.refs.push(Cell.oneFromBoc(base64ToBytes(this.options.config.allowed_destinations)))}else{cell.bits.writeUint(0,1)}
cell.bits.writeGrams(0);cell.bits.writeUint(0,1);cell.bits.writeGrams(0);cell.bits.writeUint(0,1);return cell}
async getWalletId(){const myAddress=await this.getAddress();const id=await this.provider.call2(myAddress.toString(),'get_subwallet_id');return id.toNumber()}
async getPublicKey(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_public_key')}
async getLiquidBalance(){const balances=await this.getBalances();return balances[0]-balances[1]-balances[2]}
async getNominalRestrictedBalance(){return await this.getBalances()[1]}
async getNominalLockedBalance(){return await this.getBalances()[2]}
async getBalances(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_balances')}}
LockupWalletV1.WALLET_ID_BASE=WALLET_ID_BASE;module.exports={LockupWalletV1}},{"../../boc":306,"../../utils":351,"../wallet/WalletContract":332}],317:[function(require,module,exports){const{Cell}=require("../../boc");const{Address,BN,bytesToHex,}=require("../../utils");const{WalletContract}=require("../wallet/WalletContract");const{parseAddress}=require("../token/nft/NftUtils");const{Contract}=require("../index");const WALLET_ID_BASE=0x10C;const CODE_HEX='b5ee9c7241021c010003fb000114ff00f4a413f4bcf2c80b01020120030203b8f28308d71820d31fd31fd31f02f823bbf264ed44d0d31fd31fd3ff305abaf2a15033baf2a202f9014033f910f2a3f800db3c20d74ac0018e99ed44ed45ed47915bed67ed65ed648e82db3ced41edf101f2ff9130e2f841a4f861db3c1b1413020148110402012008050201200706020db9846db3cdb3c81b1a0129ba462db3cf845f846f847f848f849f84af84bf84481b0201200e090201620d0a02016a0c0b012fa2c76cf3e9100723281f2fff2743e112040423d029be84c61b000fa25fb513435c2c7e014bad346d9e36fc22470d4080847a4937d29910ce6903e9ff9837812801b7810148987159f318401b02016e100f0019af1df6a26840106b90eb858fc00019adce76a26840206b90eb85ffc003acd06c2220d749c160915be001d0d3030171b0915be0fa4030db3c01d31fd33ff84b5240c705238210a7733acdbab08ea46c12db3c8210f7733acd01708018c8cb055004cf1623fa0213cb6acb1fcb3fc98040fb00e30e1b141201cef84a5240c7050382107258a69bba13b08ed18e2c01fa407fc8ca0002fa4401c8ca07cbffc9d0f8441023810108f441f86420d74ac200209501d430d001deb312e68210f258a69b32708018c8cb055004cf1623fa0213cb6acb1fcb3fc98040fb00db3c925f03e2130066f848f847f846f845c8cb3fcb1fcb1fcb1ff849fa02f84acf16f84bcf16c9f844f843f842f841c8cb1fcb1fcbfff400ccc9ed54025cd307d4d1f823db3c20c2008e9b22c003f2e06421d0d303fa4031fa40f84a5220c705b3925f04e30d9130e201fb001a1503fa21fa4401c8ca07cbffc9d0f844810108f40a6fa1318f5f330172b0c002f2e06501fa003171d721fa0031fa0031d33f31d31f31d30001c000f2e066d3000193d430d0de2171db3c8e2a31d31f302082104e73744bba21821047657424bab121821056744370bab1018210566f7465bab1f2e067e30e70925f03e220c200191716000e9372fb029130e202ea0170db3c8e6d20d749c2008e63d31f21c00022830bbab122811001bab122821047d54391bab1228210595f07bcbab122821069fb306cbab1228210566f7465bab122821056744370bab1f2e06701c00021d749c200b08e15d3073020c06421c077b121c044b101c057b1f2e0689130e29130e2e30d1918001ad31f308210566f7465baf2e067004401fa4401c3ff925b70e001f833206e925b70e0d020d7498307b9925b70e0d70bffba0060f845f846a05210bc923070e0f845f848a05210b99330f849e0f849f849f84513a1f847a904f846f847a9041023a984a1007eed44d0d31f01f861d31f01f862d3ff01f863f40401f864d401d0d33f01f865d31f01f866d31f01f867d31f01f868fa0001f869fa4001f86afa4001f86bd1d10a20c6a7';class VestingWalletV1 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc(CODE_HEX);super(provider,options);if(!this.options.walletId)this.options.walletId=WALLET_ID_BASE+this.options.wc;this.methods.getPublicKey=this.getPublicKey.bind(this);this.methods.getWalletId=this.getWalletId.bind(this);this.methods.getLockedAmount=this.getLockedAmount.bind(this);this.methods.getVestingData=this.getVestingData.bind(this);this.methods.getWhitelist=this.getWhitelist.bind(this)}
getName(){return'vesting-1'}
createSigningMessage(seqno,expireAt,withoutOp){seqno=seqno||0;expireAt=expireAt||(Math.floor(Date.now()/1e3)+60);const message=new Cell();message.bits.writeUint(this.options.walletId,32);if(seqno===0){for(let i=0;i<32;i++){message.bits.writeBit(1)}}else{message.bits.writeUint(expireAt,32)}
message.bits.writeUint(seqno,32);return message}
createDataCell(){if(this.options.walletId!==0&&!this.options.walletId)throw new Error('no walletId');if(!this.options.publicKey)throw new Error('no publicKey');if(!(this.options.publicKey instanceof Uint8Array))throw new Error('publicKey not Uint8Array');if(this.options.vestingStartTime!==0&&!this.options.vestingStartTime)throw new Error('no vestingStartTime');if(this.options.vestingTotalDuration<=0)throw new Error('vestingTotalDuration cant be zero or negative');if(!this.options.vestingTotalDuration)throw new Error('no vestingTotalDuration');if(this.options.vestingTotalDuration>2**32-1)throw new Error('vestingTotalDuration > 2^32 - 1');if(this.options.unlockPeriod<=0)throw new Error('unlockPeriod cant be zero or negative');if(!this.options.unlockPeriod)throw new Error('no unlockPeriod');if(this.options.unlockPeriod>this.options.vestingTotalDuration)throw new Error('unlockPeriod > vestingTotalDuration');if(this.options.cliffDuration!==0&&(!this.options.cliffDuration))throw new Error('no cliffDuration');if(this.options.cliffDuration<0)throw new Error('cliffDuration cant be negative');if(this.options.cliffDuration>=this.options.vestingTotalDuration)throw new Error('cliffDuration >= vestingTotalDuration');const durationMod=new BN(this.options.vestingTotalDuration).div(new BN(this.options.unlockPeriod)).mul(new BN(this.options.unlockPeriod));if(!durationMod.eq(new BN(this.options.vestingTotalDuration)))throw new Error('vestingTotalDuration mod unlockPeriod != 0');const cliffMod=new BN(this.options.cliffDuration).div(new BN(this.options.unlockPeriod)).mul(new BN(this.options.unlockPeriod));if(!cliffMod.eq(new BN(this.options.cliffDuration)))throw new Error('cliffDuration mod unlockPeriod != 0');if(!this.options.vestingTotalAmount)throw new Error('no vestingTotalAmount');if(!this.options.vestingTotalAmount.gt(new BN(0)))throw new Error('vestingTotalAmount cant be zero');if(!this.options.vestingSenderAddress)throw new Error('no vestingSenderAddress');if(!(this.options.vestingSenderAddress instanceof Address))throw new Error('vestingSenderAddress not Address');if(!this.options.ownerAddress)throw new Error('no ownerAddress');if(!(this.options.ownerAddress instanceof Address))throw new Error('ownerAddress not Address');const cell=new Cell();cell.bits.writeUint(0,32);cell.bits.writeUint(this.options.walletId,32);cell.bits.writeUint(new BN(bytesToHex(this.options.publicKey),16),256);cell.bits.writeBit(!1);const vestingCell=new Cell();vestingCell.bits.writeUint(this.options.vestingStartTime,64);vestingCell.bits.writeUint(this.options.vestingTotalDuration,32);vestingCell.bits.writeUint(this.options.unlockPeriod,32);vestingCell.bits.writeUint(this.options.cliffDuration,32);vestingCell.bits.writeCoins(this.options.vestingTotalAmount);vestingCell.bits.writeAddress(new Address(this.options.vestingSenderAddress));vestingCell.bits.writeAddress(new Address(this.options.ownerAddress));cell.refs[0]=vestingCell;return cell}
createAddWhitelistBody(params){const{addresses,queryId}=params;const root=new Cell();root.bits.writeUint(0x7258a69b,32)
root.bits.writeUint(queryId||0,64)
root.bits.writeAddress(addresses[0]);let cell=null;for(let i=addresses.length-1;i>=1;i--){const newCell=new Cell();newCell.bits.writeAddress(addresses[i]);if(cell){newCell.refs[0]=cell}
cell=newCell}
if(cell){root.refs[0]=cell}
return root}
createInternalTransfer(params){const message=new Cell();message.bits.writeUint(0xa7733acd,32);message.bits.writeUint(params.queryId||0,64)
message.bits.writeUint8(params.sendMode||3);message.refs.push(Contract.createOutMsg(params.address,params.amount,params.payload));return message}
async getPublicKey(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_public_key')}
async getWalletId(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_subwallet_id')}
async getLockedAmount(time){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_locked_amount',[['num',time]])}
async getVestingData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_vesting_data');const vestingStartTime=result[0].toNumber();const vestingTotalDuration=result[1].toNumber();const unlockPeriod=result[2].toNumber();const cliffDuration=result[3].toNumber();const vestingTotalAmount=result[4];const vestingSenderAddress=parseAddress(result[5]);const ownerAddress=parseAddress(result[6]);const whitelistCell=result[7];return{vestingStartTime,vestingTotalDuration,unlockPeriod,cliffDuration,vestingTotalAmount,vestingSenderAddress,ownerAddress,whitelistCell,}}
async getWhitelist(){const myAddress=await this.getAddress();const list=await this.provider.call2(myAddress.toString(),'get_whitelist');const addresses=[];for(const tuple of list){if(tuple.length!==2)throw new Error('invalid whitelist result');const wc=tuple[0];const hash=tuple[1];const address=new Address(wc.toString(10)+':'+hash.toString(16).padStart(64,'0'));addresses.push(address)}
return addresses}}
VestingWalletV1.WALLET_ID_BASE=WALLET_ID_BASE;VestingWalletV1.codeHex=CODE_HEX;module.exports={VestingWalletV1:VestingWalletV1}},{"../../boc":306,"../../utils":351,"../index":315,"../token/nft/NftUtils":330,"../wallet/WalletContract":332}],318:[function(require,module,exports){const{LockupWalletV1}=require("./LockupWalletV1");const{VestingWalletV1}=require("./VestingWalletV1");module.exports.default={LockupWalletV1,VestingWalletV1,all:{'lockup-0.1':LockupWalletV1,'vesting-1':VestingWalletV1,},list:[LockupWalletV1,VestingWalletV1]}},{"./LockupWalletV1":316,"./VestingWalletV1":317}],319:[function(require,module,exports){const{Contract}=require("../index");const{Cell}=require("../../boc");const{nacl,hexToBytes,BN}=require("../../utils");const{parseAddress}=require("../token/nft/NftUtils");const{writePublicKey,writeSignature,createSignatureCell,tag_init,tag_cooperative_close,tag_cooperative_commit,tag_start_uncooperative_close,tag_challenge_state,tag_settle_conditionals,tag_state,op_top_up_balance,op_init_channel,op_cooperative_close,op_cooperative_commit,op_start_uncooperative_close,op_challenge_quarantined_state,op_settle_conditionals,op_finish_uncooperative_close,op_channel_closed,createTopUpBalance,createInitChannelBody,createCooperativeCloseChannelBody,createCooperativeCommitBody,createConditionalPayment,createSemiChannelBody,createSemiChannelState,createSignedSemiChannelState,createStartUncooperativeCloseBody,createChallengeQuarantinedStateBody,createSettleConditionalsBody,createFinishUncooperativeClose,createOneSignature,createTwoSignature}=require("./PaymentUtils");const PAYMENT_CHANNEL_CODE_HEX='B5EE9C72410230010007FB000114FF00F4A413F4BCF2C80B0102012002030201480405000AF26C21F0190202CB06070201202E2F020120080902012016170201200A0B0201200C0D0009D3610F80CC001D6B5007434C7FE8034C7CC1BC0FE19E0201580E0F0201201011002D3E11DBC4BE11DBC43232C7FE11DBC47E80B2C7F2407320008B083E1B7B51343480007E187E80007E18BE80007E18F4FFC07E1934FFC07E1974DFC07E19BC01887080A7F4C7C07E1A34C7C07E1A7D01007E1AB7807080E535007E1AF7BE1B2002012012130201201415008D3E13723E11BE117E113E10540132803E10BE80BE10FE8084F2FFC4B2FFF2DFFC02887080A7FE12BE127E121400F2C7C4B2C7FD0037807080E53E12C073253E1333C5B8B27B5520004D1C3C02FE106CFCB8193E803E800C3E1096283E18BE10C0683E18FE10BE10E8006EFCB819BC032000CF1D3C02FE106CFCB819348020C235C6083E4040E4BE1124BE117890CC3E443CB81974C7C060841A5B9A5D2EBCB81A3E118074DFD66EBCB81CBE803E800C3E1094882FBE10D4882FAC3CB819807E18BE18FE12F43E800C3E10BE10E80068006E7CB8199FFE187C0320004120843777222E9C20043232C15401B3C594013E808532DA84B2C7F2DFF2407EC02002012018190201D42B2C0201201A1B0201201E1F0201201C1D00E5473F00BD401D001D401D021F90102D31F01821043436D74BAF2E068F84601D37F59BAF2E072F844544355F910F8454330F910B0F2E065D33FD33F30F84822B9F84922B9B0F2E06C21F86820F869F84A6E915B8E19F84AD0D33FFA003171D721D33F305033BC02BCB1936DF86ADEE2F800F00C8006F3E12F43E800C7E903E900C3E09DBC41CBE10D62F24CC20C1B7BE10FE11963C03FE10BE11A04020BC03DC3E185C3E189C3E18DB7E1ABC032000B51D3C02F5007400750074087E4040B4C7C0608410DB1BDCEEBCB81A3E118074DFD66EBCB81CBE111510D57E443E1150CC3E442C3CB8197E80007E18BE80007E18F4CFF4CFCC3E1208AE7E1248AE6C3CB81B007E1A3E1A7E003C042001C1573F00BF84A6EF2E06AD2008308D71820F9012392F84492F845E24130F910F2E065D31F018210556E436CBAF2E068F84601D37F59BAF2E072D401D08308D71820F901F8444130F910F2E06501D430D08308D71820F901F8454130F910F2E06501820020120222301FED31F01821043685374BAF2E068F84601D37F59BAF2E072D33FFA00F404552003D200019AD401D0D33FFA00F40430937F206DE2303205D31F01821043685374BAF2E068F84601D37F59BAF2E072D33FFA00F404552003D200019AD401D0D33FFA00F40430937F206DE23032F8485280BEF8495250BEB0524BBE1AB0527ABE19210064B05215BE14B05248BE17B0F2E06970F82305C8CB3F5004FA0215F40015CB3F5004FA0212F400CB1F12CA00CA00C9F86AF00C01C31CFC02FE129BACFCB81AF48020C235C6083E4048E4BE1124BE1178904C3E443CB81974C7C0608410DA19D46EBCB81A3E118074DFD66EBCB81CB5007420C235C6083E407E11104C3E443CB81940750C3420C235C6083E407E11504C3E443CB81940602403F71CFC02FE129BACFCB81AF48020C235C6083E4048E4BE1124BE1178904C3E443CB81974C7C0608410DB10DBAEBCB81A3E118074DFD66EBCB81CBD010C3E12B434CFFE803D0134CFFE803D0134C7FE11DBC4148828083E08EE7CB81BBE11DBC4A83E08EF3CB81C34800C151D5A64D6D4C8F7A2B98E82A49B08B8C3816028292A01FCD31F01821043685374BAF2E068F84601D37F59BAF2E072D33FFA00F404552003D200019AD401D0D33FFA00F40430937F206DE2303205D31F01821043685374BAF2E068F84601D37F59BAF2E072D33FFA00F404552003D200019AD401D0D33FFA00F40430937F206DE230325339BE5381BEB0F8495250BEB0F8485290BEB02502FE5237BE16B05262BEB0F2E06927C20097F84918BEF2E0699137E222C20097F84813BEF2E0699132E2F84AD0D33FFA00F404D33FFA00F404D31FF8476F105220A0F823BCF2E06FD200D20030B3F2E073209C3537373A5274BC5263BC12B18E11323939395250BC5299BC18B14650134440E25319BAB3F2E06D9130E30D7F05C82627002496F8476F1114A098F8476F1117A00603E203003ECB3F5004FA0215F40012CB3F5004FA0213F400CB1F12CA00CA00C9F86AF00C00620A8020F4966FA5208E213050038020F4666FA1208E1001FA00ED1E15DA119450C3A00B9133E2923430E202926C21E2B31B000C3535075063140038C8CB3F5004FA0212F400CB3F5003FA0213F400CB1FCA00C9F86AF00C00D51D3C02FE129BACFCB81AFE12B434CFFE803D010C74CFFE803D010C74C7CC3E11DBC4283E11DBC4A83E08EE7CB81C7E003E10886808E87E18BE10D400E816287E18FE10F04026BE10BE10E83E189C3E18F7BE10B04026BE10FE10A83E18DC3E18F780693E1A293E1A7C042001F53B7EF4C7C8608419F1F4A06EA4CC7C037808608403818830AEA54C7C03B6CC780C882084155DD61FAEA54C3C0476CC780820841E6849BBEEA54C3C04B6CC7808208407C546B3EEA54C3C0576CC780820840223AA8CAEA54C3C05B6CC7808208419BDBC1A6EA54C3C05F6CC780C60840950CAA46EA53C0636CC78202D0008840FF2F00075BC7FE3A7805FC25E87D007D207D20184100D0CAF6A1EC7C217C21B7817C227C22B7817C237C23FC247C24B7817C2524C3B7818823881B22A021984008DBD0CABA7805FC20C8B870FC253748B8F07C256840206B90FD0018C020EB90FD0018B8EB90E98F987C23B7882908507C11DE491839707C23B788507C23B789507C11DE48B9F03A4331C4966';class PaymentChannel extends Contract{constructor(provider,options){options.publicKeyA=options.isA?options.myKeyPair.publicKey:options.hisPublicKey;options.publicKeyB=!options.isA?options.myKeyPair.publicKey:options.hisPublicKey;options.wc=options.wc||0;options.code=options.code||Cell.oneFromBoc(PAYMENT_CHANNEL_CODE_HEX);super(provider,options)}
createDataCell(){const cell=new Cell();cell.bits.writeBit(0);cell.bits.writeCoins(0);cell.bits.writeCoins(0);writePublicKey(cell,this.options.publicKeyA);writePublicKey(cell,this.options.publicKeyB);cell.bits.writeUint(this.options.channelId,128);const closingConfig=new Cell();closingConfig.bits.writeUint(this.options.closingConfig?.quarantineDuration||0,32);closingConfig.bits.writeCoins(this.options.closingConfig?.misbehaviorFine||new BN(0));closingConfig.bits.writeUint(this.options.closingConfig?.conditionalCloseDuration||0,32);cell.refs[0]=closingConfig;cell.bits.writeUint(0,32);cell.bits.writeUint(0,32);cell.bits.writeBit(!1);const paymentConfig=new Cell();paymentConfig.bits.writeCoins(this.options.excessFee||new BN(0));paymentConfig.bits.writeAddress(this.options.addressA);paymentConfig.bits.writeAddress(this.options.addressB);cell.refs[1]=paymentConfig;return cell}
async createOneSignature(op,cellForSigning){const signature=nacl.sign.detached(await cellForSigning.hash(),this.options.myKeyPair.secretKey);const cell=createOneSignature({op,isA:this.options.isA,signature,cell:cellForSigning});return{cell,signature}}
async createTwoSignature(op,hisSignature,cellForSigning){const signature=nacl.sign.detached(await cellForSigning.hash(),this.options.myKeyPair.secretKey);const signatureA=this.options.isA?signature:hisSignature;const signatureB=!this.options.isA?signature:hisSignature;const cell=createTwoSignature({op,signatureA,signatureB,cell:cellForSigning});return{cell,signature}}
async createTopUpBalance(params){return createTopUpBalance(params)}
async createInitChannel(params){return this.createOneSignature(op_init_channel,createInitChannelBody({...params,channelId:this.options.channelId}))}
async createCooperativeCloseChannel(params){if(!params.hisSignature){params.hisSignature=new Uint8Array(512/8)}
return this.createTwoSignature(op_cooperative_close,params.hisSignature,createCooperativeCloseChannelBody({...params,channelId:this.options.channelId}))}
async createCooperativeCommit(params){if(!params.hisSignature){params.hisSignature=new Uint8Array(512/8)}
return this.createTwoSignature(op_cooperative_commit,params.hisSignature,createCooperativeCommitBody({...params,channelId:this.options.channelId}))}
async createSignedSemiChannelState(params){const state=createSemiChannelState({channelId:this.options.channelId,semiChannelBody:createSemiChannelBody({seqno:params.mySeqno,sentCoins:params.mySentCoins,conditionals:null}),counterpartySemiChannelBody:params.hisSeqno===undefined?null:createSemiChannelBody({seqno:params.hisSeqno,sentCoins:params.hisSentCoins,conditionals:null}),});const signature=nacl.sign.detached(await state.hash(),this.options.myKeyPair.secretKey);const cell=createSignedSemiChannelState({signature,state});return{cell,signature}}
async signState(params){const mySeqno=this.options.isA?params.seqnoA:params.seqnoB;const hisSeqno=!this.options.isA?params.seqnoA:params.seqnoB;const sentCoinsA=this.options.initBalanceA.gt(params.balanceA)?this.options.initBalanceA.sub(params.balanceA):new BN(0);const sentCoinsB=this.options.initBalanceB.gt(params.balanceB)?this.options.initBalanceB.sub(params.balanceB):new BN(0);const mySentCoins=this.options.isA?sentCoinsA:sentCoinsB;const hisSentCoins=!this.options.isA?sentCoinsA:sentCoinsB;const{cell,signature}=await this.createSignedSemiChannelState({mySeqno,mySentCoins,hisSeqno,hisSentCoins});return signature}
async verifyState(params,hisSignature){const mySeqno=!this.options.isA?params.seqnoA:params.seqnoB;const hisSeqno=this.options.isA?params.seqnoA:params.seqnoB;const sentCoinsA=this.options.initBalanceA.gt(params.balanceA)?this.options.initBalanceA.sub(params.balanceA):new BN(0);const sentCoinsB=this.options.initBalanceB.gt(params.balanceB)?this.options.initBalanceB.sub(params.balanceB):new BN(0);const mySentCoins=!this.options.isA?sentCoinsA:sentCoinsB;const hisSentCoins=this.options.isA?sentCoinsA:sentCoinsB;const state=createSemiChannelState({channelId:this.options.channelId,semiChannelBody:createSemiChannelBody({seqno:mySeqno,sentCoins:mySentCoins,conditionals:null}),counterpartySemiChannelBody:hisSeqno===undefined?null:createSemiChannelBody({seqno:hisSeqno,sentCoins:hisSentCoins,conditionals:null}),});const hash=await state.hash();return nacl.sign.detached.verify(hash,hisSignature,this.options.isA?this.options.publicKeyB:this.options.publicKeyA)}
async signClose(params){const{cell,signature}=await this.createCooperativeCloseChannel(params);return signature}
async verifyClose(params,hisSignature){const cell=await createCooperativeCloseChannelBody({...params,channelId:this.options.channelId});const hash=await cell.hash();return nacl.sign.detached.verify(hash,hisSignature,this.options.isA?this.options.publicKeyB:this.options.publicKeyA)}
async createStartUncooperativeClose(params){return this.createOneSignature(op_start_uncooperative_close,createStartUncooperativeCloseBody({...params,channelId:this.options.channelId}))}
async createChallengeQuarantinedState(params){return this.createOneSignature(op_challenge_quarantined_state,createChallengeQuarantinedStateBody({...params,channelId:this.options.channelId}))}
async createSettleConditionals(params){return this.createOneSignature(op_settle_conditionals,createSettleConditionalsBody({...params,channelId:this.options.channelId}))}
async createFinishUncooperativeClose(){return createFinishUncooperativeClose()}
static STATE_UNINITED=0;static STATE_OPEN=1;static STATE_CLOSURE_STARTED=2;static STATE_SETTLING_CONDITIONALS=3;static STATE_AWAITING_FINALIZATION=4;async getChannelState(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_channel_state',[]);return result.toNumber()}
async getData(){const bnToBytes=(bn)=>{let hex=bn.toString(16);if(hex.length%2!==0)hex='0'+hex;return hexToBytes(hex)}
const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_channel_data',[]);const state=result[0].toNumber();const balanceA=result[1][0];const balanceB=result[1][1];const publicKeyA=bnToBytes(result[2][0]);const publicKeyB=bnToBytes(result[2][1]);const channelId=result[3];const quarantineDuration=result[4][0].toNumber();const misbehaviorFine=result[4][1];const conditionalCloseDuration=result[4][2].toNumber();const seqnoA=result[5][0];const seqnoB=result[5][1];const quarantine=result[6];const excessFee=result[7][0];const addressA=parseAddress(result[7][1]);const addressB=parseAddress(result[7][2]);return{state,balanceA,balanceB,publicKeyA,publicKeyB,channelId,quarantineDuration,misbehaviorFine,conditionalCloseDuration,seqnoA,seqnoB,quarantine,excessFee,addressA,addressB}}
fromWallet(params){const{wallet,secretKey}=params;const transfer=(payloadPromise,needStateInit)=>{const createPromise=async(amount)=>{const stateInit=needStateInit?(await this.createStateInit()).stateInit:null
const myAddress=await this.getAddress();const seqno=(await wallet.methods.seqno().call())||0;const payload=await payloadPromise;return wallet.methods.transfer({secretKey:secretKey,toAddress:myAddress.toString(!0,!0,!0),amount:amount,seqno:seqno,payload,stateInit,sendMode:3})}
return{send:(amount)=>{return createPromise(amount).then(x=>x.send())},estimateFee:(amount)=>{return createPromise(amount).then(x=>x.estimateFee())}}}
return{deploy:()=>{return transfer(null,!0)},init:(params)=>{return transfer(this.createInitChannel(params).then(x=>x.cell))},topUp:(params)=>{return transfer(this.createTopUpBalance(params))},close:(params)=>{return transfer(this.createCooperativeCloseChannel(params).then(x=>x.cell))},commit:(params)=>{return transfer(this.createCooperativeCommit(params).then(x=>x.cell))},startUncooperativeClose:(params)=>{return transfer(this.createStartUncooperativeClose(params).then(x=>x.cell))},challengeQuarantinedState:(params)=>{return transfer(this.createChallengeQuarantinedState(params).then(x=>x.cell))},settleConditionals:(params)=>{return transfer(this.createSettleConditionals(params).then(x=>x.cell))},finishUncooperativeClose:()=>{return transfer(this.createFinishUncooperativeClose())}}}}
PaymentChannel.codeHex=PAYMENT_CHANNEL_CODE_HEX;module.exports={PaymentChannel}},{"../../boc":306,"../../utils":351,"../index":315,"../token/nft/NftUtils":330,"./PaymentUtils":320}],320:[function(require,module,exports){const{Cell}=require("../../boc");const writePublicKey=(cell,publicKey)=>{if(publicKey.length!==256/8){throw new Error('invalid publicKey length')}
cell.bits.writeBytes(publicKey)}
const writeSignature=(cell,signature)=>{if(signature.length!==512/8){throw new Error('invalid signature length')}
cell.bits.writeBytes(signature)}
const createSignatureCell=(signature)=>{const cell=new Cell();writeSignature(cell,signature);return cell}
const writeMayBe=(cell,ref)=>{if(ref){cell.bits.writeBit(1);if(cell.refs.length>=4){throw new Error('refs overflow')}
cell.refs.push(ref)}else{cell.bits.writeBit(0)}}
const writeDict=writeMayBe;const tag_init=0x696e6974;const tag_cooperative_close=0x436c6f73;const tag_cooperative_commit=0x43436d74;const tag_start_uncooperative_close=0x556e436c;const tag_challenge_state=0x43686751;const tag_settle_conditionals=0x436c436e;const tag_state=0x43685374;const op_top_up_balance=1741148801;const op_init_channel=235282626;const op_cooperative_close=1433884798;const op_cooperative_commit=2040604399;const op_start_uncooperative_close=521476815;const op_challenge_quarantined_state=143567410;const op_settle_conditionals=1727459433;const op_finish_uncooperative_close=625158801;const op_channel_closed=-572749638;const createTopUpBalance=(params)=>{const cell=new Cell();cell.bits.writeUint(op_top_up_balance,32);cell.bits.writeCoins(params.coinsA);cell.bits.writeCoins(params.coinsB);return cell}
const createInitChannelBody=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_init,32);cell.bits.writeUint(params.channelId,128);cell.bits.writeCoins(params.balanceA);cell.bits.writeCoins(params.balanceB);return cell}
const createCooperativeCloseChannelBody=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_cooperative_close,32);cell.bits.writeUint(params.channelId,128);cell.bits.writeCoins(params.balanceA);cell.bits.writeCoins(params.balanceB);cell.bits.writeUint(params.seqnoA,64);cell.bits.writeUint(params.seqnoB,64);return cell}
const createCooperativeCommitBody=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_cooperative_commit,32);cell.bits.writeUint(params.channelId,128);cell.bits.writeUint(params.seqnoA,64);cell.bits.writeUint(params.seqnoB,64);return cell}
const createConditionalPayment=(params)=>{const cell=new Cell();cell.bits.writeCoins(params.amount);cell.writeCell(params.condition);return cell}
const createSemiChannelBody=(params)=>{const cell=new Cell();cell.bits.writeUint(params.seqno,64);cell.bits.writeCoins(params.sentCoins);writeDict(cell,params.conditionals);return cell}
const createSemiChannelState=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_state,32);cell.bits.writeUint(params.channelId,128);cell.writeCell(params.semiChannelBody);writeMayBe(cell,params.counterpartySemiChannelBody)
return cell}
const createSignedSemiChannelState=(params)=>{const cell=new Cell();writeSignature(cell,params.signature);cell.writeCell(params.state);return cell}
const createStartUncooperativeCloseBody=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_start_uncooperative_close,32);cell.bits.writeUint(params.channelId,128);cell.refs[0]=params.signedSemiChannelStateA;cell.refs[1]=params.signedSemiChannelStateB;return cell}
const createChallengeQuarantinedStateBody=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_challenge_state,32);cell.bits.writeUint(params.channelId,128);cell.refs[0]=params.signedSemiChannelStateA;cell.refs[1]=params.signedSemiChannelStateB;return cell}
const createSettleConditionalsBody=(params)=>{const cell=new Cell();cell.bits.writeUint(tag_settle_conditionals,32);cell.bits.writeUint(params.channelId,128);writeDict(cell,params.conditionalsToSettle);return cell}
const createFinishUncooperativeClose=()=>{const cell=new Cell();cell.bits.writeUint(op_finish_uncooperative_close,32);return cell}
const createOneSignature=(params)=>{const cell=new Cell();cell.bits.writeUint(params.op,32);cell.bits.writeBit(params.isA);writeSignature(cell,params.signature);cell.writeCell(params.cell);return cell}
const createTwoSignature=(params)=>{const cell=new Cell();cell.bits.writeUint(params.op,32);cell.refs[0]=createSignatureCell(params.signatureA);cell.refs[1]=createSignatureCell(params.signatureB);cell.writeCell(params.cell);return cell}
module.exports={writePublicKey,writeSignature,createSignatureCell,tag_init,tag_cooperative_close,tag_cooperative_commit,tag_start_uncooperative_close,tag_challenge_state,tag_settle_conditionals,tag_state,op_top_up_balance,op_init_channel,op_cooperative_close,op_cooperative_commit,op_start_uncooperative_close,op_challenge_quarantined_state,op_settle_conditionals,op_finish_uncooperative_close,op_channel_closed,createTopUpBalance,createInitChannelBody,createCooperativeCloseChannelBody,createCooperativeCommitBody,createConditionalPayment,createSemiChannelBody,createSemiChannelState,createSignedSemiChannelState,createStartUncooperativeCloseBody,createChallengeQuarantinedStateBody,createSettleConditionalsBody,createFinishUncooperativeClose,createOneSignature,createTwoSignature}},{"../../boc":306}],321:[function(require,module,exports){const{PaymentChannel}=require("./PaymentChannel");class Payments{constructor(provider){this.provider=provider}
createChannel(options){return new PaymentChannel(this.provider,options)}}
module.exports={Payments,PaymentChannel}},{"./PaymentChannel":319}],322:[function(require,module,exports){const{Contract}=require("../index.js");const{Cell}=require("../../boc");const{hexToBytes,BN,nacl,bytesToBase64}=require("../../utils");class SubscriptionContract extends Contract{constructor(provider,options){options.code=Cell.oneFromBoc('B5EE9C7241020F01000262000114FF00F4A413F4BCF2C80B0102012002030201480405036AF230DB3C5335A127A904F82327A128A90401BC5135A0F823B913B0F29EF800725210BE945387F0078E855386DB3CA4E2F82302DB3C0B0C0D0202CD06070121A0D0C9B67813F488DE0411F488DE0410130B048FD6D9E05E8698198FD201829846382C74E2F841999E98F9841083239BA395D497803F018B841083AB735BBED9E702984E382D9C74688462F863841083AB735BBED9E70156BA4E09040B0A0A080269F10FD22184093886D9E7C12C1083239BA39384008646582A803678B2801FD010A65B5658F89659FE4B9FD803FC1083239BA396D9E40E0A04F08E8D108C5F0C708210756E6B77DB3CE00AD31F308210706C7567831EB15210BA8F48305324A126A904F82326A127A904BEF27109FA4430A619F833D078D721D70B3F5260A11BBE8E923036F82370708210737562732759DB3C5077DE106910581047103645135042DB3CE0395F076C2232821064737472BA0A0A0D09011A8E897F821064737472DB3CE0300A006821B39982100400000072FB02DE70F8276F118010C8CB055005CF1621FA0214F40013CB6912CB1F830602948100A032DEC901FB000030ED44D0FA40FA40FA00D31FD31FD31FD31FD31FD307D31F30018021FA443020813A98DB3C01A619F833D078D721D70B3FA070F8258210706C7567228018C8CB055007CF165004FA0215CB6A12CB1F13CB3F01FA02CB00C973FB000E0040C8500ACF165008CF165006FA0214CB1F12CB1FCB1FCB1FCB1FCB07CB1FC9ED54005801A615F833D020D70B078100D1BA95810088D721DED307218100DDBA028100DEBA12B1F2E047D33F30A8AB0FE5855AB4');super(provider,options);this.methods.pay=()=>Contract.createMethod(provider,this.createPayExternalMessage());this.methods.getSubscriptionData=this.getSubscriptionData.bind(this)}
createDataCell(){const cell=new Cell();cell.bits.writeAddress(this.options.wallet);cell.bits.writeAddress(this.options.beneficiary);cell.bits.writeGrams(this.options.amount);cell.bits.writeUint(this.options.period,32);cell.bits.writeUint(this.options.startAt,32);cell.bits.writeUint(this.options.timeout,32);cell.bits.writeUint(0,32);cell.bits.writeUint(0,32);cell.bits.writeUint(0,8);cell.bits.writeUint(this.options.subscriptionId,32);return cell}
createBody(){const body=new Cell();body.bits.writeUint(new BN(0x706c7567).add(new BN(0x80000000)),32);return body}
createSelfDestructBody(){const body=new Cell();body.bits.writeUint(0x64737472,32);return body}
async getSubscriptionData(){const parseAddress=tuple=>tuple[0].toNumber()+':'+tuple[1].toString(16);const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_subscription_data');const wallet=parseAddress(result[0]);const beneficiary=parseAddress(result[1]);const amount=result[2];const period=result[3].toNumber();const startAt=result[4].toNumber();const timeout=result[5].toNumber();const lastPayment=result[6].toNumber();const lastRequest=result[7].toNumber();const failedAttempts=result[8].toNumber();const subscriptionId=result[9].toNumber();return{wallet,beneficiary,amount,period,startAt,timeout,lastPayment,lastRequest,failedAttempts,subscriptionId}}
async createPayExternalMessage(){const selfAddress=await this.getAddress();const header=Contract.createExternalMessageHeader(selfAddress);const resultMessage=Contract.createCommonMsgInfo(header,null,null);const body=new Cell();body.bits.writeUint(Math.floor(Date.now()/1000),64);return{address:selfAddress,message:resultMessage,body:body}}}
module.exports={SubscriptionContract}},{"../../boc":306,"../../utils":351,"../index.js":315}],323:[function(require,module,exports){const{Contract}=require("../../index");const{Cell}=require("../../../boc");const{createOffchainUriCell,parseOffchainUriCell,parseAddress}=require("../nft/NftUtils");const{Address,BN,bytesToBase64}=require("../../../utils");class JettonMinter extends Contract{constructor(provider,options){options.wc=0;options.code=options.code||Cell.oneFromBoc('B5EE9C7241020B010001ED000114FF00F4A413F4BCF2C80B0102016202030202CC040502037A60090A03EFD9910E38048ADF068698180B8D848ADF07D201800E98FE99FF6A2687D007D206A6A18400AA9385D47181A9AA8AAE382F9702480FD207D006A18106840306B90FD001812881A28217804502A906428027D012C678B666664F6AA7041083DEECBEF29385D71811A92E001F1811802600271812F82C207F97840607080093DFC142201B82A1009AA0A01E428027D012C678B00E78B666491646580897A007A00658064907C80383A6465816503E5FFE4E83BC00C646582AC678B28027D0109E5B589666664B8FD80400FE3603FA00FA40F82854120870542013541403C85004FA0258CF1601CF16CCC922C8CB0112F400F400CB00C9F9007074C8CB02CA07CBFFC9D05008C705F2E04A12A1035024C85004FA0258CF16CCCCC9ED5401FA403020D70B01C3008E1F8210D53276DB708010C8CB055003CF1622FA0212CB6ACB1FCB3FC98042FB00915BE200303515C705F2E049FA403059C85004FA0258CF16CCCCC9ED54002E5143C705F2E049D43001C85004FA0258CF16CCCCC9ED54007DADBCF6A2687D007D206A6A183618FC1400B82A1009AA0A01E428027D012C678B00E78B666491646580897A007A00658064FC80383A6465816503E5FFE4E840001FAF16F6A2687D007D206A6A183FAA904051007F09');super(provider,options)}
createDataCell(){const cell=new Cell();cell.bits.writeCoins(0);cell.bits.writeAddress(this.options.adminAddress);cell.refs[0]=createOffchainUriCell(this.options.jettonContentUri);cell.refs[1]=Cell.oneFromBoc(this.options.jettonWalletCodeHex);return cell}
createMintBody(params){const body=new Cell();body.bits.writeUint(21,32);body.bits.writeUint(params.queryId||0,64);body.bits.writeAddress(params.destination);body.bits.writeCoins(params.amount);const transferBody=new Cell();transferBody.bits.writeUint(0x178d4519,32);transferBody.bits.writeUint(params.queryId||0,64);transferBody.bits.writeCoins(params.jettonAmount);transferBody.bits.writeAddress(null);transferBody.bits.writeAddress(null);transferBody.bits.writeCoins(new BN(0));transferBody.bits.writeBit(!1);body.refs[0]=transferBody;return body}
createChangeAdminBody(params){if(params.newAdminAddress===undefined)throw new Error('Specify newAdminAddress');const body=new Cell();body.bits.writeUint(3,32);body.bits.writeUint(params.queryId||0,64);body.bits.writeAddress(params.newAdminAddress);return body}
createEditContentBody(params){const body=new Cell();body.bits.writeUint(4,32);body.bits.writeUint(params.queryId||0,64);body.refs[0]=createOffchainUriCell(params.jettonContentUri);return body}
async getJettonData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_jetton_data');const totalSupply=result[0];const isMutable=result[1].toNumber()===-1;const adminAddress=parseAddress(result[2]);const jettonContentCell=result[3];let jettonContentUri=null;try{jettonContentUri=parseOffchainUriCell(jettonContentCell)}catch(e){}
const jettonWalletCode=result[4];return{totalSupply,isMutable,adminAddress,jettonContentCell,jettonContentUri,jettonWalletCode}}
async getJettonWalletAddress(ownerAddress){const myAddress=await this.getAddress();const cell=new Cell()
cell.bits.writeAddress(ownerAddress)
const result=await this.provider.call2(myAddress.toString(),'get_wallet_address',[['tvm.Slice',bytesToBase64(await cell.toBoc(!1))]],);return parseAddress(result)}}
module.exports={JettonMinter}},{"../../../boc":306,"../../../utils":351,"../../index":315,"../nft/NftUtils":330}],324:[function(require,module,exports){const{Contract}=require("../../index");const{Cell}=require("../../../boc");const{parseAddress}=require("../nft/NftUtils");const{BN}=require("../../../utils");const JETTON_WALLET_CODE_HEX='B5EE9C7241021201000328000114FF00F4A413F4BCF2C80B0102016202030202CC0405001BA0F605DA89A1F401F481F481A8610201D40607020148080900BB0831C02497C138007434C0C05C6C2544D7C0FC02F83E903E900C7E800C5C75C87E800C7E800C00B4C7E08403E29FA954882EA54C4D167C0238208405E3514654882EA58C511100FC02780D60841657C1EF2EA4D67C02B817C12103FCBC2000113E910C1C2EBCB853600201200A0B020120101101F500F4CFFE803E90087C007B51343E803E903E90350C144DA8548AB1C17CB8B04A30BFFCB8B0950D109C150804D50500F214013E809633C58073C5B33248B232C044BD003D0032C032483E401C1D3232C0B281F2FFF274013E903D010C7E801DE0063232C1540233C59C3E8085F2DAC4F3208405E351467232C7C6600C03F73B51343E803E903E90350C0234CFFE80145468017E903E9014D6F1C1551CDB5C150804D50500F214013E809633C58073C5B33248B232C044BD003D0032C0327E401C1D3232C0B281F2FFF274140371C1472C7CB8B0C2BE80146A2860822625A020822625A004AD822860822625A028062849F8C3C975C2C070C008E00D0E0F009ACB3F5007FA0222CF165006CF1625FA025003CF16C95005CC2391729171E25008A813A08208989680AA008208989680A0A014BCF2E2C504C98040FB001023C85004FA0258CF1601CF16CCC9ED5400705279A018A182107362D09CC8CB1F5230CB3F58FA025007CF165007CF16C9718018C8CB0524CF165006FA0215CB6A14CCC971FB0010241023000E10491038375F040076C200B08E218210D53276DB708010C8CB055008CF165004FA0216CB6A12CB1F12CB3FC972FB0093356C21E203C85004FA0258CF1601CF16CCC9ED5400DB3B51343E803E903E90350C01F4CFFE803E900C145468549271C17CB8B049F0BFFCB8B0A0822625A02A8005A805AF3CB8B0E0841EF765F7B232C7C572CFD400FE8088B3C58073C5B25C60063232C14933C59C3E80B2DAB33260103EC01004F214013E809633C58073C5B3327B55200083200835C87B51343E803E903E90350C0134C7E08405E3514654882EA0841EF765F784EE84AC7CB8B174CFCC7E800C04E81408F214013E809633C58073C5B3327B55205ECCF23D';class JettonWallet extends Contract{constructor(provider,options){options.wc=0;options.code=options.code||Cell.oneFromBoc(JETTON_WALLET_CODE_HEX);super(provider,options)}
async createTransferBody(params){const cell=new Cell();cell.bits.writeUint(0xf8a7ea5,32);cell.bits.writeUint(params.queryId||0,64);cell.bits.writeCoins(params.jettonAmount);cell.bits.writeAddress(params.toAddress);cell.bits.writeAddress(params.responseAddress);cell.bits.writeBit(!1);cell.bits.writeCoins(params.forwardAmount||new BN(0));if(params.forwardPayload){if(params.forwardPayload.refs){cell.bits.writeBit(!0);cell.refs.push(params.forwardPayload)}else{cell.bits.writeBit(!1);cell.bits.writeBytes(params.forwardPayload)}}else{cell.bits.writeBit(!1)}
return cell}
async createBurnBody(params){const cell=new Cell();cell.bits.writeUint(0x595f07bc,32);cell.bits.writeUint(params.queryId||0,64);cell.bits.writeCoins(params.jettonAmount);cell.bits.writeAddress(params.responseAddress);return cell}
async getData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_wallet_data');const balance=result[0];const ownerAddress=parseAddress(result[1]);const jettonMinterAddress=parseAddress(result[2]);const jettonWalletCode=result[3];return{balance,ownerAddress,jettonMinterAddress,jettonWalletCode}}}
JettonWallet.codeHex=JETTON_WALLET_CODE_HEX;module.exports={JettonWallet}},{"../../../boc":306,"../../../utils":351,"../../index":315,"../nft/NftUtils":330}],325:[function(require,module,exports){const{JettonMinter}=require("./JettonMinter.js");const{JettonWallet}=require("./JettonWallet.js");module.exports.default={JettonMinter,JettonWallet}},{"./JettonMinter.js":323,"./JettonWallet.js":324}],326:[function(require,module,exports){const{Contract}=require("../../index.js");const{Cell}=require("../../../boc");const{Address,bytesToBase64,BN}=require("../../../utils");const{parseAddress}=require('./NftUtils.js');const{createOffchainUriCell,serializeUri,parseOffchainUriCell,getRoyaltyParams}=require("./NftUtils");class NftCollection extends Contract{constructor(provider,options){options.wc=0;options.code=options.code||Cell.oneFromBoc('B5EE9C724102140100021F000114FF00F4A413F4BCF2C80B0102016202030202CD04050201200E0F04E7D10638048ADF000E8698180B8D848ADF07D201800E98FE99FF6A2687D20699FEA6A6A184108349E9CA829405D47141BAF8280E8410854658056B84008646582A802E78B127D010A65B509E58FE59F80E78B64C0207D80701B28B9E382F970C892E000F18112E001718112E001F181181981E0024060708090201200A0B00603502D33F5313BBF2E1925313BA01FA00D43028103459F0068E1201A44343C85005CF1613CB3FCCCCCCC9ED54925F05E200A6357003D4308E378040F4966FA5208E2906A4208100FABE93F2C18FDE81019321A05325BBF2F402FA00D43022544B30F00623BA9302A402DE04926C21E2B3E6303250444313C85005CF1613CB3FCCCCCCC9ED54002C323401FA40304144C85005CF1613CB3FCCCCCCC9ED54003C8E15D4D43010344130C85005CF1613CB3FCCCCCCC9ED54E05F04840FF2F00201200C0D003D45AF0047021F005778018C8CB0558CF165004FA0213CB6B12CCCCC971FB008002D007232CFFE0A33C5B25C083232C044FD003D0032C03260001B3E401D3232C084B281F2FFF2742002012010110025BC82DF6A2687D20699FEA6A6A182DE86A182C40043B8B5D31ED44D0FA40D33FD4D4D43010245F04D0D431D430D071C8CB0701CF16CCC980201201213002FB5DAFDA89A1F481A67FA9A9A860D883A1A61FA61FF480610002DB4F47DA89A1F481A67FA9A9A86028BE09E008E003E00B01A500C6E');if(options.royalty>1)throw new Error('royalty > 1');options.royaltyBase=1000;options.royaltyFactor=Math.floor(options.royalty*options.royaltyBase);super(provider,options);this.methods.getCollectionData=this.getCollectionData.bind(this);this.methods.getNftItemAddressByIndex=this.getNftItemAddressByIndex.bind(this);this.methods.getNftItemContent=this.getNftItemContent.bind(this);this.methods.getRoyaltyParams=this.getRoyaltyParams.bind(this)}
createContentCell(params){const collectionContentCell=createOffchainUriCell(params.collectionContentUri);const commonContentCell=new Cell();commonContentCell.bits.writeBytes(serializeUri(params.nftItemContentBaseUri));const contentCell=new Cell();contentCell.refs[0]=collectionContentCell;contentCell.refs[1]=commonContentCell;return contentCell}
createRoyaltyCell(params){const royaltyCell=new Cell();royaltyCell.bits.writeUint(params.royaltyFactor,16);royaltyCell.bits.writeUint(params.royaltyBase,16);royaltyCell.bits.writeAddress(params.royaltyAddress);return royaltyCell}
createDataCell(){const cell=new Cell();cell.bits.writeAddress(this.options.ownerAddress);cell.bits.writeUint(0,64);cell.refs[0]=this.createContentCell(this.options);cell.refs[1]=Cell.oneFromBoc(this.options.nftItemCodeHex);cell.refs[2]=this.createRoyaltyCell(this.options);return cell}
createMintBody(params){const body=new Cell();body.bits.writeUint(1,32);body.bits.writeUint(params.queryId||0,64);body.bits.writeUint(params.itemIndex,64);body.bits.writeCoins(params.amount);const nftItemContent=new Cell();nftItemContent.bits.writeAddress(params.itemOwnerAddress);const uriContent=new Cell();uriContent.bits.writeBytes(serializeUri(params.itemContentUri));nftItemContent.refs[0]=uriContent;body.refs[0]=nftItemContent;return body}
createGetRoyaltyParamsBody(params){const body=new Cell();body.bits.writeUint(0x693d3950,32);body.bits.writeUint(params.queryId||0,64);return body}
createChangeOwnerBody(params){if(params.newOwnerAddress===undefined)throw new Error('Specify newOwnerAddress');const body=new Cell();body.bits.writeUint(3,32);body.bits.writeUint(params.queryId||0,64);body.bits.writeAddress(params.newOwnerAddress);return body}
createEditContentBody(params){if(params.royalty>1)throw new Error('royalty > 1');params.royaltyBase=1000;params.royaltyFactor=Math.floor(params.royalty*params.royaltyBase);const body=new Cell();body.bits.writeUint(4,32);body.bits.writeUint(params.queryId||0,64);body.refs[0]=this.createContentCell(params);body.refs[1]=this.createRoyaltyCell(params);return body}
async getCollectionData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_collection_data');const itemsCount=result[0];let nextItemIndex=NaN;try{nextItemIndex=itemsCount.toNumber()}catch(e){}
const collectionContentCell=result[1];let collectionContentUri=null;try{collectionContentUri=parseOffchainUriCell(collectionContentCell)}catch(e){}
const ownerAddress=parseAddress(result[2]);return{nextItemIndex,itemsCount,ownerAddress,collectionContentCell,collectionContentUri}}
async getNftItemContent(nftItem){const myAddress=await this.getAddress();const nftData=await nftItem.getData();if(nftData.isInitialized){const result=await this.provider.call2(myAddress.toString(),'get_nft_content',[['num',nftData.itemIndex.toString(10)],['tvm.Cell',bytesToBase64(await nftData.contentCell.toBoc(!1))]]);nftData.contentUri=null;try{nftData.contentUri=parseOffchainUriCell(result)}catch(e){}}
return nftData}
async getNftItemAddressByIndex(index){index=new BN(index);const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_nft_address_by_index',[['num',index.toString(10)]]);return parseAddress(result)}
async getRoyaltyParams(){const myAddress=await this.getAddress();return getRoyaltyParams(this.provider,myAddress.toString())}}
module.exports={NftCollection}},{"../../../boc":306,"../../../utils":351,"../../index.js":315,"./NftUtils":330,"./NftUtils.js":330}],327:[function(require,module,exports){const{Contract}=require("../../index");const{Cell}=require("../../../boc");const{Address,BN}=require("../../../utils");const{parseAddress,getRoyaltyParams}=require('./NftUtils.js');const{parseOffchainUriCell}=require("./NftUtils");const NFT_ITEM_CODE_HEX='B5EE9C7241020D010001D0000114FF00F4A413F4BCF2C80B0102016202030202CE04050009A11F9FE00502012006070201200B0C02D70C8871C02497C0F83434C0C05C6C2497C0F83E903E900C7E800C5C75C87E800C7E800C3C00812CE3850C1B088D148CB1C17CB865407E90350C0408FC00F801B4C7F4CFE08417F30F45148C2EA3A1CC840DD78C9004F80C0D0D0D4D60840BF2C9A884AEB8C097C12103FCBC20080900113E910C1C2EBCB8536001F65135C705F2E191FA4021F001FA40D20031FA00820AFAF0801BA121945315A0A1DE22D70B01C300209206A19136E220C2FFF2E192218E3E821005138D91C85009CF16500BCF16712449145446A0708010C8CB055007CF165005FA0215CB6A12CB1FCB3F226EB39458CF17019132E201C901FB00104794102A375BE20A00727082108B77173505C8CBFF5004CF1610248040708010C8CB055007CF165005FA0215CB6A12CB1FCB3F226EB39458CF17019132E201C901FB000082028E3526F0018210D53276DB103744006D71708010C8CB055007CF165005FA0215CB6A12CB1FCB3F226EB39458CF17019132E201C901FB0093303234E25502F003003B3B513434CFFE900835D27080269FC07E90350C04090408F80C1C165B5B60001D00F232CFD633C58073C5B3327B5520BF75041B';class NftItem extends Contract{constructor(provider,options){options.wc=0;options.code=options.code||Cell.oneFromBoc(NFT_ITEM_CODE_HEX);super(provider,options);this.methods.getData=this.getData.bind(this)}
createDataCell(){const cell=new Cell();cell.bits.writeUint(this.options.index,64);cell.bits.writeAddress(this.options.collectionAddress);return cell}
async getData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_nft_data');const isInitialized=result[0].toNumber()===-1;const itemIndex=result[1];let index=NaN;try{index=itemIndex.toNumber()}catch(e){}
const collectionAddress=parseAddress(result[2]);const ownerAddress=isInitialized?parseAddress(result[3]):null;const contentCell=result[4];let contentUri=null;try{contentUri=(isInitialized&&collectionAddress===null)?parseOffchainUriCell(contentCell):null}catch(e){}
return{isInitialized,index,itemIndex,collectionAddress,ownerAddress,contentCell,contentUri}}
async createTransferBody(params){const cell=new Cell();cell.bits.writeUint(0x5fcc3d14,32);cell.bits.writeUint(params.queryId||0,64);cell.bits.writeAddress(params.newOwnerAddress);cell.bits.writeAddress(params.responseAddress);cell.bits.writeBit(!1);cell.bits.writeCoins(params.forwardAmount||new BN(0));if(params.forwardPayload){if(params.forwardPayload.refs){cell.bits.writeBit(!0);cell.refs.push(params.forwardPayload)}else{cell.bits.writeBit(!1);cell.bits.writeBytes(params.forwardPayload)}}else{cell.bits.writeBit(!1)}
return cell}
createGetStaticDataBody(params){const body=new Cell();body.bits.writeUint(0x2fcb26a2,32);body.bits.writeUint(params.queryId||0,64);return body}
async getRoyaltyParams(){const myAddress=await this.getAddress();return getRoyaltyParams(this.provider,myAddress.toString())}}
NftItem.codeHex=NFT_ITEM_CODE_HEX;module.exports={NftItem}},{"../../../boc":306,"../../../utils":351,"../../index":315,"./NftUtils":330,"./NftUtils.js":330}],328:[function(require,module,exports){const{Contract}=require("../../index.js");const{Cell}=require("../../../boc");const{Address}=require("../../../utils");const{parseAddress}=require('./NftUtils.js');class NftMarketplace extends Contract{constructor(provider,options){options.wc=0;options.code=options.code||Cell.oneFromBoc('B5EE9C7241010401006D000114FF00F4A413F4BCF2C80B01020120020300AAD23221C700915BE0D0D3030171B0915BE0FA40ED44D0FA403012C705F2E19101D31F01C0018E2BFA003001D4D43021F90070C8CA07CBFFC9D077748018C8CB05CB0258CF165004FA0213CB6BCCCCC971FB00915BE20004F2308EF7CCE7');super(provider,options)}
createDataCell(){const cell=new Cell();cell.bits.writeAddress(this.options.ownerAddress);return cell}}
module.exports={NftMarketplace}},{"../../../boc":306,"../../../utils":351,"../../index.js":315,"./NftUtils.js":330}],329:[function(require,module,exports){const{Contract}=require("../../index");const{Cell}=require("../../../boc");const{parseAddress}=require("./NftUtils");const{BN}=require("../../../utils");const NFT_SALE_HEX_CODE='B5EE9C7241020A010001B4000114FF00F4A413F4BCF2C80B01020120020302014804050004F2300202CD0607002FA03859DA89A1F481F481F481F401A861A1F401F481F4006101F7D00E8698180B8D8492F82707D201876A2687D207D207D207D006A18116BA4E10159C71D991B1B2990E382C92F837028916382F970FA01698FC1080289C6C8895D7970FAE99F98FD2018201A642802E78B2801E78B00E78B00FD016664F6AA701363804C9B081B2299823878027003698FE99F9810E000C92F857010C0801F5D41081DCD650029285029185F7970E101E87D007D207D0018384008646582A804E78B28B9D090D0A85AD08A500AFD010AE5B564B8FD80384008646582AC678B2803FD010B65B564B8FD80384008646582A802E78B00FD0109E5B564B8FD80381041082FE61E8A10C00C646582A802E78B117D010A65B509E58F8A40900C8C0029A3110471036454012F004E032363704C0038E4782103B9ACA0015BEF2E1C95312C70559C705B1F2E1CA702082105FCC3D14218010C8CB055006CF1622FA0215CB6A14CB1F14CB3F21CF1601CF16CA0021FA02CA00C98100A0FB00E05F06840FF2F0002ACB3F22CF1658CF16CA0021FA02CA00C98100A0FB00AECABAD1';class NftSale extends Contract{constructor(provider,options){options.wc=0;options.code=options.code||Cell.oneFromBoc(NFT_SALE_HEX_CODE);super(provider,options);this.methods.getData=this.getData.bind(this)}
createDataCell(){const cell=new Cell();cell.bits.writeAddress(this.options.marketplaceAddress);cell.bits.writeAddress(this.options.nftAddress);cell.bits.writeAddress(null);cell.bits.writeCoins(this.options.fullPrice);const feesCell=new Cell();feesCell.bits.writeCoins(this.options.marketplaceFee);feesCell.bits.writeAddress(this.options.royaltyAddress);feesCell.bits.writeCoins(this.options.royaltyAmount);cell.refs[0]=feesCell;return cell}
async getData(){const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_sale_data');const marketplaceAddress=parseAddress(result[0]);const nftAddress=parseAddress(result[1]);const nftOwnerAddress=parseAddress(result[2]);const fullPrice=result[3];const marketplaceFee=result[4];const royaltyAddress=parseAddress(result[5]);const royaltyAmount=result[6];return{marketplaceAddress,nftAddress,nftOwnerAddress,fullPrice,marketplaceFee,royaltyAddress,royaltyAmount}}
async createCancelBody(params){const cell=new Cell();cell.bits.writeUint(3,32);cell.bits.writeUint(params.queryId||0,64);return cell}}
NftSale.codeHex=NFT_SALE_HEX_CODE;module.exports={NftSale}},{"../../../boc":306,"../../../utils":351,"../../index":315,"./NftUtils":330}],330:[function(require,module,exports){const{Address}=require("../../../utils");const{Cell}=require("../../../boc");const SNAKE_DATA_PREFIX=0x00;const CHUNK_DATA_PREFIX=0x01;const ONCHAIN_CONTENT_PREFIX=0x00;const OFFCHAIN_CONTENT_PREFIX=0x01;const serializeUri=(uri)=>{return new TextEncoder().encode(encodeURI(uri))}
const parseUri=(bytes)=>{return new TextDecoder().decode(bytes)}
const createOffchainUriCell=(uri)=>{const cell=new Cell();cell.bits.writeUint(OFFCHAIN_CONTENT_PREFIX,8);cell.bits.writeBytes(serializeUri(uri));return cell}
const parseOffchainUriCell=(cell)=>{if(cell.bits.array[0]!==OFFCHAIN_CONTENT_PREFIX){throw new Error('no OFFCHAIN_CONTENT_PREFIX')}
let length=0;let c=cell;while(c){length+=c.bits.array.length;c=c.refs[0]}
const bytes=new Uint8Array(length);length=0;c=cell;while(c){bytes.set(c.bits.array,length)
length+=c.bits.array.length;c=c.refs[0]}
return parseUri(bytes.slice(1))}
const readIntFromBitString=(bs,cursor,bits)=>{let n=BigInt(0);for(let i=0;i<bits;i++){n*=BigInt(2);n+=BigInt(bs.get(cursor+i))}
return n}
const parseAddress=cell=>{let n=readIntFromBitString(cell.bits,3,8);if(n>BigInt(127)){n=n-BigInt(256)}
const hashPart=readIntFromBitString(cell.bits,3+8,256);if(n.toString(10)+":"+hashPart.toString(16)==='0:0')return null;const s=n.toString(10)+":"+hashPart.toString(16).padStart(64,'0');return new Address(s)};const getRoyaltyParams=async(provider,address)=>{const result=await provider.call2(address,'royalty_params');const royaltyFactor=result[0].toNumber();const royaltyBase=result[1].toNumber();const royalty=royaltyFactor/royaltyBase;const royaltyAddress=parseAddress(result[2]);return{royalty,royaltyBase,royaltyFactor,royaltyAddress}}
module.exports={SNAKE_DATA_PREFIX,CHUNK_DATA_PREFIX,ONCHAIN_CONTENT_PREFIX,OFFCHAIN_CONTENT_PREFIX,parseAddress,serializeUri,parseUri,createOffchainUriCell,parseOffchainUriCell,getRoyaltyParams}},{"../../../boc":306,"../../../utils":351}],331:[function(require,module,exports){const{NftCollection}=require("./NftCollection.js");const{NftItem}=require("./NftItem.js");const{NftMarketplace}=require("./NftMarketplace.js");const{NftSale}=require("./NftSale.js");module.exports.default={NftCollection,NftItem,NftMarketplace,NftSale}},{"./NftCollection.js":326,"./NftItem.js":327,"./NftMarketplace.js":328,"./NftSale.js":329}],332:[function(require,module,exports){const{Contract}=require("../index.js");const{Cell}=require("../../boc");const{nacl,stringToBytes,Address,BN}=require("../../utils");class WalletContract extends Contract{constructor(provider,options){if(!options.publicKey&&!options.address)throw new Error('WalletContract required publicKey or address in options')
super(provider,options);this.methods={transfer:(params)=>Contract.createMethod(provider,this.createTransferMessage(params.secretKey,params.toAddress,params.amount,params.seqno,params.payload,params.sendMode,!Boolean(params.secretKey),params.stateInit,params.expireAt)),transfers:(params)=>Contract.createMethod(provider,this.createTransferMessages(params.secretKey,params.seqno,params.messages,!Boolean(params.secretKey),params.expireAt)),seqno:()=>{return{call:async()=>{const address=await this.getAddress();let n=null;try{n=(await provider.call2(address.toString(),'seqno')).toNumber()}catch(e){}
return n}}}}
this.deploy=(secretKey)=>Contract.createMethod(provider,this.createInitExternalMessage(secretKey))}
getName(){throw new Error('override me')}
createDataCell(){const cell=new Cell();cell.bits.writeUint(0,32);cell.bits.writeBytes(this.options.publicKey);return cell}
createSigningMessage(seqno){seqno=seqno||0;const cell=new Cell();cell.bits.writeUint(seqno,32);return cell}
async createInitExternalMessage(secretKey){if(!this.options.publicKey){const keyPair=nacl.sign.keyPair.fromSecretKey(secretKey)
this.options.publicKey=keyPair.publicKey}
const{stateInit,address,code,data}=await this.createStateInit();const signingMessage=this.createSigningMessage();const signature=nacl.sign.detached(await signingMessage.hash(),secretKey);const body=new Cell();body.bits.writeBytes(signature);body.writeCell(signingMessage);const header=Contract.createExternalMessageHeader(address);const externalMessage=Contract.createCommonMsgInfo(header,stateInit,body);return{address:address,message:externalMessage,body,signingMessage,stateInit,code,data,}}
async createExternalMessage(signingMessage,secretKey,seqno,dummySignature=!1){const signature=dummySignature?new Uint8Array(64):nacl.sign.detached(await signingMessage.hash(),secretKey);const body=new Cell();body.bits.writeBytes(signature);body.writeCell(signingMessage);let stateInit=null,code=null,data=null;if(seqno===0){if(!this.options.publicKey){const keyPair=nacl.sign.keyPair.fromSecretKey(secretKey)
this.options.publicKey=keyPair.publicKey}
const deploy=await this.createStateInit();stateInit=deploy.stateInit;code=deploy.code;data=deploy.data}
const selfAddress=await this.getAddress();const header=Contract.createExternalMessageHeader(selfAddress);const resultMessage=Contract.createCommonMsgInfo(header,stateInit,body);return{address:selfAddress,message:resultMessage,body:body,signature:signature,signingMessage:signingMessage,stateInit,code,data,}}
async createTransferMessage(secretKey,address,amount,seqno,payload="",sendMode=3,dummySignature=!1,stateInit=null,expireAt=undefined){if(seqno===null||seqno===undefined||seqno<0){throw new Error('seqno must be number >= 0')}
const signingMessage=this.createSigningMessage(seqno,expireAt);if(sendMode===null||sendMode===undefined){sendMode=3}
signingMessage.bits.writeUint8(sendMode);signingMessage.refs.push(Contract.createOutMsg(address,amount,payload,stateInit));return this.createExternalMessage(signingMessage,secretKey,seqno,dummySignature)}
async createTransferMessages(secretKey,seqno,messages,dummySignature=!1,expireAt=undefined,){if(seqno===null||seqno===undefined||seqno<0){throw new Error('seqno must be number >= 0')}
const signingMessage=this.createSigningMessage(seqno,expireAt);if(messages.length<1||messages.length>4){throw new Error('put 1-4 messages')}
for(const msg of messages){let sendMode=msg.sendMode;if(sendMode===null||sendMode===undefined){sendMode=3}
signingMessage.bits.writeUint8(sendMode);signingMessage.refs.push(Contract.createOutMsg(msg.toAddress,msg.amount,msg.payload,msg.stateInit))}
return this.createExternalMessage(signingMessage,secretKey,seqno,dummySignature)}}
module.exports={WalletContract}},{"../../boc":306,"../../utils":351,"../index.js":315}],333:[function(require,module,exports){const{Cell}=require("../../boc");const{WalletContract}=require("./WalletContract");class SimpleWalletContractR1 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C72410101010044000084FF0020DDA4F260810200D71820D70B1FED44D0D31FD3FFD15112BAF2A122F901541044F910F2A2F80001D31F3120D74A96D307D402FB00DED1A4C8CB1FCBFFC9ED5441FDF089");super(provider,options)}
getName(){return'simpleR1'}}
class SimpleWalletContractR2 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C724101010100530000A2FF0020DD2082014C97BA9730ED44D0D70B1FE0A4F260810200D71820D70B1FED44D0D31FD3FFD15112BAF2A122F901541044F910F2A2F80001D31F3120D74A96D307D402FB00DED1A4C8CB1FCBFFC9ED54D0E2786F");super(provider,options)}
getName(){return'simpleR2'}}
class SimpleWalletContractR3 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C7241010101005F0000BAFF0020DD2082014C97BA218201339CBAB19C71B0ED44D0D31FD70BFFE304E0A4F260810200D71820D70B1FED44D0D31FD3FFD15112BAF2A122F901541044F910F2A2F80001D31F3120D74A96D307D402FB00DED1A4C8CB1FCBFFC9ED54B5B86E42");super(provider,options)}
getName(){return'simpleR3'}}
module.exports={SimpleWalletContractR1,SimpleWalletContractR2,SimpleWalletContractR3}},{"../../boc":306,"./WalletContract":332}],334:[function(require,module,exports){const{Cell}=require("../../boc");const{WalletContract}=require("./WalletContract");class WalletV2ContractBase extends WalletContract{createSigningMessage(seqno,expireAt){seqno=seqno||0;expireAt=expireAt||(Math.floor(Date.now()/1e3)+60);const message=new Cell();message.bits.writeUint(seqno,32);if(seqno===0){for(let i=0;i<32;i++){message.bits.writeBit(1)}}else{message.bits.writeUint(expireAt,32)}
return message}}
class WalletV2ContractR1 extends WalletV2ContractBase{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C724101010100570000AAFF0020DD2082014C97BA9730ED44D0D70B1FE0A4F2608308D71820D31FD31F01F823BBF263ED44D0D31FD3FFD15131BAF2A103F901541042F910F2A2F800029320D74A96D307D402FB00E8D1A4C8CB1FCBFFC9ED54A1370BB6");super(provider,options)}
getName(){return'v2R1'}}
class WalletV2ContractR2 extends WalletV2ContractBase{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C724101010100630000C2FF0020DD2082014C97BA218201339CBAB19C71B0ED44D0D31FD70BFFE304E0A4F2608308D71820D31FD31F01F823BBF263ED44D0D31FD3FFD15131BAF2A103F901541042F910F2A2F800029320D74A96D307D402FB00E8D1A4C8CB1FCBFFC9ED54044CD7A1");super(provider,options)}
getName(){return'v2R2'}}
module.exports={WalletV2ContractR1,WalletV2ContractR2}},{"../../boc":306,"./WalletContract":332}],335:[function(require,module,exports){const{Cell}=require("../../boc");const{WalletContract}=require("./WalletContract");const{parseWalletV3TransferQuery,parseWalletV3TransferBody}=require("./WalletQueryParser");class WalletV3ContractBase extends WalletContract{createSigningMessage(seqno,expireAt){seqno=seqno||0;expireAt=expireAt||(Math.floor(Date.now()/1e3)+60);const message=new Cell();message.bits.writeUint(this.options.walletId,32);if(seqno===0){for(let i=0;i<32;i++){message.bits.writeBit(1)}}else{message.bits.writeUint(expireAt,32)}
message.bits.writeUint(seqno,32);return message}
createDataCell(){const cell=new Cell();cell.bits.writeUint(0,32);cell.bits.writeUint(this.options.walletId,32);cell.bits.writeBytes(this.options.publicKey);return cell}}
class WalletV3ContractR1 extends WalletV3ContractBase{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C724101010100620000C0FF0020DD2082014C97BA9730ED44D0D70B1FE0A4F2608308D71820D31FD31FD31FF82313BBF263ED44D0D31FD31FD3FFD15132BAF2A15144BAF2A204F901541055F910F2A3F8009320D74A96D307D402FB00E8D101A4C8CB1FCB1FCBFFC9ED543FBE6EE0");super(provider,options);if(!this.options.walletId)this.options.walletId=698983191+this.options.wc}
getName(){return'v3R1'}}
WalletV3ContractR1.parseTransferQuery=parseWalletV3TransferQuery;WalletV3ContractR1.parseTransferBody=parseWalletV3TransferBody;class WalletV3ContractR2 extends WalletV3ContractBase{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C724101010100710000DEFF0020DD2082014C97BA218201339CBAB19F71B0ED44D0D31FD31F31D70BFFE304E0A4F2608308D71820D31FD31FD31FF82313BBF263ED44D0D31FD31FD3FFD15132BAF2A15144BAF2A204F901541055F910F2A3F8009320D74A96D307D402FB00E8D101A4C8CB1FCB1FCBFFC9ED5410BD6DAD");super(provider,options);if(!this.options.walletId)this.options.walletId=698983191+this.options.wc}
getName(){return'v3R2'}}
WalletV3ContractR2.parseTransferQuery=parseWalletV3TransferQuery;WalletV3ContractR2.parseTransferBody=parseWalletV3TransferBody;module.exports={WalletV3ContractR1,WalletV3ContractR2}},{"../../boc":306,"./WalletContract":332,"./WalletQueryParser":338}],336:[function(require,module,exports){const{Cell}=require("../../boc");const{Contract}=require("../index.js");const{Address,bytesToHex,BN}=require("../../utils");const{WalletContract}=require("./WalletContract");const{parseWalletV3TransferQuery,parseWalletV3TransferBody}=require("./WalletQueryParser");class WalletV4ContractR1 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C72410215010002F5000114FF00F4A413F4BCF2C80B010201200203020148040504F8F28308D71820D31FD31FD31F02F823BBF263ED44D0D31FD31FD3FFF404D15143BAF2A15151BAF2A205F901541064F910F2A3F80024A4C8CB1F5240CB1F5230CBFF5210F400C9ED54F80F01D30721C0009F6C519320D74A96D307D402FB00E830E021C001E30021C002E30001C0039130E30D03A4C8CB1F12CB1FCBFF1112131403EED001D0D3030171B0915BE021D749C120915BE001D31F218210706C7567BD228210626C6E63BDB022821064737472BDB0925F03E002FA403020FA4401C8CA07CBFFC9D0ED44D0810140D721F404305C810108F40A6FA131B3925F05E004D33FC8258210706C7567BA9131E30D248210626C6E63BAE30004060708020120090A005001FA00F404308210706C7567831EB17080185005CB0527CF165003FA02F40012CB69CB1F5210CB3F0052F8276F228210626C6E63831EB17080185005CB0527CF1624FA0214CB6A13CB1F5230CB3F01FA02F4000092821064737472BA8E3504810108F45930ED44D0810140D720C801CF16F400C9ED54821064737472831EB17080185004CB0558CF1622FA0212CB6ACB1FCB3F9410345F04E2C98040FB000201200B0C0059BD242B6F6A2684080A06B90FA0218470D4080847A4937D29910CE6903E9FF9837812801B7810148987159F31840201580D0E0011B8C97ED44D0D70B1F8003DB29DFB513420405035C87D010C00B23281F2FFF274006040423D029BE84C600201200F100019ADCE76A26840206B90EB85FFC00019AF1DF6A26840106B90EB858FC0006ED207FA00D4D422F90005C8CA0715CBFFC9D077748018C8CB05CB0222CF165005FA0214CB6B12CCCCC971FB00C84014810108F451F2A702006C810108D718C8542025810108F451F2A782106E6F746570748018C8CB05CB025004CF16821005F5E100FA0213CB6A12CB1FC971FB00020072810108D718305202810108F459F2A7F82582106473747270748018C8CB05CB025005CF16821005F5E100FA0214CB6A13CB1F12CB3FC973FB00000AF400C9ED5446A9F34F");super(provider,options);if(!this.options.walletId)this.options.walletId=698983191+this.options.wc;this.methods.getPublicKey=this.getPublicKey.bind(this)}
getName(){return'v4R1'}
createSigningMessage(seqno,expireAt,withoutOp){seqno=seqno||0;expireAt=expireAt||(Math.floor(Date.now()/1e3)+60);const message=new Cell();message.bits.writeUint(this.options.walletId,32);if(seqno===0){for(let i=0;i<32;i++){message.bits.writeBit(1)}}else{message.bits.writeUint(expireAt,32)}
message.bits.writeUint(seqno,32);if(!withoutOp){message.bits.writeUint(0,8)}
return message}
createDataCell(){const cell=new Cell();cell.bits.writeUint(0,32);cell.bits.writeUint(this.options.walletId,32);cell.bits.writeBytes(this.options.publicKey);cell.bits.writeUint(0,1);return cell}
async getPublicKey(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_public_key')}}
WalletV4ContractR1.parseTransferQuery=parseWalletV3TransferQuery;WalletV4ContractR1.parseTransferBody=parseWalletV3TransferBody;module.exports={WalletV4ContractR1}},{"../../boc":306,"../../utils":351,"../index.js":315,"./WalletContract":332,"./WalletQueryParser":338}],337:[function(require,module,exports){const{Cell}=require("../../boc");const{Contract}=require("../index.js");const{Address,bytesToHex,BN,toNano}=require("../../utils");const{WalletContract}=require("./WalletContract");const{parseWalletV3TransferQuery,parseWalletV3TransferBody}=require("./WalletQueryParser");class WalletV4ContractR2 extends WalletContract{constructor(provider,options){options.code=Cell.oneFromBoc("B5EE9C72410214010002D4000114FF00F4A413F4BCF2C80B010201200203020148040504F8F28308D71820D31FD31FD31F02F823BBF264ED44D0D31FD31FD3FFF404D15143BAF2A15151BAF2A205F901541064F910F2A3F80024A4C8CB1F5240CB1F5230CBFF5210F400C9ED54F80F01D30721C0009F6C519320D74A96D307D402FB00E830E021C001E30021C002E30001C0039130E30D03A4C8CB1F12CB1FCBFF1011121302E6D001D0D3032171B0925F04E022D749C120925F04E002D31F218210706C7567BD22821064737472BDB0925F05E003FA403020FA4401C8CA07CBFFC9D0ED44D0810140D721F404305C810108F40A6FA131B3925F07E005D33FC8258210706C7567BA923830E30D03821064737472BA925F06E30D06070201200809007801FA00F40430F8276F2230500AA121BEF2E0508210706C7567831EB17080185004CB0526CF1658FA0219F400CB6917CB1F5260CB3F20C98040FB0006008A5004810108F45930ED44D0810140D720C801CF16F400C9ED540172B08E23821064737472831EB17080185005CB055003CF1623FA0213CB6ACB1FCB3FC98040FB00925F03E20201200A0B0059BD242B6F6A2684080A06B90FA0218470D4080847A4937D29910CE6903E9FF9837812801B7810148987159F31840201580C0D0011B8C97ED44D0D70B1F8003DB29DFB513420405035C87D010C00B23281F2FFF274006040423D029BE84C600201200E0F0019ADCE76A26840206B90EB85FFC00019AF1DF6A26840106B90EB858FC0006ED207FA00D4D422F90005C8CA0715CBFFC9D077748018C8CB05CB0222CF165005FA0214CB6B12CCCCC973FB00C84014810108F451F2A7020070810108D718FA00D33FC8542047810108F451F2A782106E6F746570748018C8CB05CB025006CF165004FA0214CB6A12CB1FCB3FC973FB0002006C810108D718FA00D33F305224810108F459F2A782106473747270748018C8CB05CB025005CF165003FA0213CB6ACB1F12CB3FC973FB00000AF400C9ED54696225E5");super(provider,options);if(!this.options.walletId)this.options.walletId=698983191+this.options.wc;this.methods.deployAndInstallPlugin=(params)=>Contract.createMethod(provider,this.deployAndInstallPlugin(params));this.methods.installPlugin=(params)=>Contract.createMethod(provider,this.installPlugin(params));this.methods.removePlugin=(params)=>Contract.createMethod(provider,this.removePlugin(params));this.methods.getPublicKey=this.getPublicKey.bind(this);this.methods.getWalletId=this.getWalletId.bind(this);this.methods.isPluginInstalled=this.isPluginInstalled.bind(this);this.methods.getPluginsList=this.getPluginsList.bind(this)}
getName(){return'v4R2'}
createSigningMessage(seqno,expireAt,withoutOp){seqno=seqno||0;expireAt=expireAt||(Math.floor(Date.now()/1e3)+60);const message=new Cell();message.bits.writeUint(this.options.walletId,32);if(seqno===0){for(let i=0;i<32;i++){message.bits.writeBit(1)}}else{message.bits.writeUint(expireAt,32)}
message.bits.writeUint(seqno,32);if(!withoutOp){message.bits.writeUint(0,8)}
return message}
createDataCell(){const cell=new Cell();cell.bits.writeUint(0,32);cell.bits.writeUint(this.options.walletId,32);cell.bits.writeBytes(this.options.publicKey);cell.bits.writeUint(0,1);return cell}
async deployAndInstallPlugin(params){const{secretKey,seqno,pluginWc,amount,stateInit,body,expireAt}=params;const signingMessage=this.createSigningMessage(seqno,expireAt,!0);signingMessage.bits.writeUint(1,8);signingMessage.bits.writeInt(pluginWc,8);signingMessage.bits.writeGrams(amount);signingMessage.refs.push(stateInit);signingMessage.refs.push(body);return this.createExternalMessage(signingMessage,secretKey,seqno,!1)}
async _setPlugin(params,isInstall){const{secretKey,seqno,amount,queryId,expireAt}=params;const pluginAddress=new Address(params.pluginAddress);const signingMessage=this.createSigningMessage(seqno,expireAt,!0);signingMessage.bits.writeUint(isInstall?2:3,8);signingMessage.bits.writeInt(pluginAddress.wc,8);signingMessage.bits.writeBytes(pluginAddress.hashPart);signingMessage.bits.writeGrams(amount||toNano('0.1'));signingMessage.bits.writeUint(queryId||0,64);return this.createExternalMessage(signingMessage,secretKey,seqno,!1)}
async installPlugin(params){return this._setPlugin(params,!0)}
async removePlugin(params){return this._setPlugin(params,!1)}
async getWalletId(){const myAddress=await this.getAddress();const id=await this.provider.call2(myAddress.toString(),'get_subwallet_id');return id.toNumber()}
async getPublicKey(){const myAddress=await this.getAddress();return this.provider.call2(myAddress.toString(),'get_public_key')}
async isPluginInstalled(pluginAddress){pluginAddress=new Address(pluginAddress);const hashPart='0x'+bytesToHex(pluginAddress.hashPart);const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'is_plugin_installed',[['num',pluginAddress.wc],['num',hashPart]]);return!result.isZero()}
async getPluginsList(){const parseAddress=tuple=>tuple[0].toNumber()+':'+tuple[1].toString(16);const myAddress=await this.getAddress();const result=await this.provider.call2(myAddress.toString(),'get_plugin_list');return result.map(parseAddress)}}
WalletV4ContractR2.parseTransferQuery=parseWalletV3TransferQuery;WalletV4ContractR2.parseTransferBody=parseWalletV3TransferBody;module.exports={WalletV4ContractR2}},{"../../boc":306,"../../utils":351,"../index.js":315,"./WalletContract":332,"./WalletQueryParser":338}],338:[function(require,module,exports){const{BN}=require("../../utils");function parseWalletV3TransferBody(slice){const signature=slice.loadBits(512);const walletId=slice.loadUint(32).toNumber();if(walletId!==698983191)throw new Error('invalid walletId');const expireAt=slice.loadUint(32).toNumber();const seqno=slice.loadUint(32).toNumber();const sendMode=slice.loadUint(8).toNumber();if(sendMode!==3)throw new Error('invalid sendMode');let order=slice.loadRef();if(order.loadBit())throw Error('invalid internal header');if(!order.loadBit())throw Error('invalid ihrDisabled');const bounce=order.loadBit();if(order.loadBit())throw Error('invalid bounced');const sourceAddress=order.loadAddress();if(sourceAddress!==null)throw Error('invalid externalSourceAddress');const destAddress=order.loadAddress();const value=order.loadCoins();if(order.loadBit())throw Error('invalid currencyCollection');const ihrFees=order.loadCoins();if(!ihrFees.eq(new BN(0)))throw new Error('invalid ihrFees');const fwdFees=order.loadCoins();if(!fwdFees.eq(new BN(0)))throw new Error('invalid fwdFees');const createdLt=order.loadUint(64);if(!createdLt.eq(new BN(0)))throw new Error('invalid createdLt');const createdAt=order.loadUint(32);if(!createdAt.eq(new BN(0)))throw new Error('invalid createdAt');if(order.loadBit()){order.loadRef()}
let payload=null;if(order.getFreeBits()>0){if(order.loadBit()){order=order.loadRef()}
if(order.getFreeBits()>32){const op=order.loadUint(32);const payloadBytes=order.loadBits(order.getFreeBits());payload=op.eq(new BN(0))?new TextDecoder().decode(payloadBytes):''}}
return{toAddress:destAddress,value,bounce,seqno,expireAt,payload}}
function parseWalletV3TransferQuery(cell){const slice=cell.beginParse();if(slice.loadUint(2).toNumber()!==2)throw Error('invalid header');const externalSourceAddress=slice.loadAddress();if(externalSourceAddress!==null)throw Error('invalid externalSourceAddress');const externalDestAddress=slice.loadAddress();const externalImportFee=slice.loadCoins();if(!externalImportFee.eq(new BN(0)))throw new Error('invalid externalImportFee');if(slice.loadBit()){if(slice.loadBit()){slice.loadRef()}}
const bodySlice=slice.loadBit()?slice.loadRef():slice;return{fromAddress:externalDestAddress,...parseWalletV3TransferBody(bodySlice)}}
module.exports={parseWalletV3TransferQuery,parseWalletV3TransferBody}},{"../../utils":351}],339:[function(require,module,exports){const{Cell}=require("../../boc");const{Address,BN,toNano,bytesToHex,hexToBytes,nacl,stringToBytes,bytesToBase64}=require("../../utils");const{Contract}=require("../index.js");const{SimpleWalletContractR1,SimpleWalletContractR2,SimpleWalletContractR3}=require("./WalletContractSimple");const{WalletV2ContractR1,WalletV2ContractR2}=require("./WalletContractV2");const{WalletV3ContractR1,WalletV3ContractR2}=require("./WalletContractV3");const{WalletV4ContractR1}=require("./WalletContractV4");const{WalletV4ContractR2}=require("./WalletContractV4R2");const ALL={'simpleR1':SimpleWalletContractR1,'simpleR2':SimpleWalletContractR2,'simpleR3':SimpleWalletContractR3,'v2R1':WalletV2ContractR1,'v2R2':WalletV2ContractR2,'v3R1':WalletV3ContractR1,'v3R2':WalletV3ContractR2,'v4R1':WalletV4ContractR1,'v4R2':WalletV4ContractR2};const LIST=[SimpleWalletContractR1,SimpleWalletContractR2,SimpleWalletContractR3,WalletV2ContractR1,WalletV2ContractR2,WalletV3ContractR1,WalletV3ContractR2,WalletV4ContractR1,WalletV4ContractR2];class Wallets{constructor(provider){this.provider=provider;this.all=ALL;this.list=LIST;this.defaultVersion='v3R1';this.default=this.all[this.defaultVersion]}
create(options){return new this.default(this.provider,options)}}
Wallets.all=ALL;Wallets.list=LIST;module.exports.default=Wallets},{"../../boc":306,"../../utils":351,"../index.js":315,"./WalletContractSimple":333,"./WalletContractV2":334,"./WalletContractV3":335,"./WalletContractV4":336,"./WalletContractV4R2":337}],340:[function(require,module,exports){const utils=require("./utils");const Address=utils.Address;const boc=require("./boc");const AppTon=require("./ledger/AppTon");const HttpProvider=require("./providers").default;const{Contract}=require("./contract");const Wallets=require("./contract/wallet").default;const LockupWallets=require("./contract/lockup").default;const HighloadWallets=require("./contract/highloadWallet").default;const NFT=require("./contract/token/nft").default;const JETTON=require("./contract/token/ft").default;const{BlockSubscription,InMemoryBlockStorage}=require("./providers/blockSubscription");const{SubscriptionContract}=require("./contract/subscription/index");const{Payments,PaymentChannel}=require("./contract/payments/index");const TransportWebUSB=require("@ledgerhq/hw-transport-webusb").default;const TransportWebHID=require("@ledgerhq/hw-transport-webhid").default;const BluetoothTransport=require("@ledgerhq/hw-transport-web-ble").default;const{Dns,DnsCollection,DnsItem}=require("./contract/dns").default;const version='0.0.66';class TonWeb{constructor(provider){this.version=version;this.utils=utils;this.Address=Address;this.boc=boc;this.Contract=Contract;this.BlockSubscription=BlockSubscription;this.InMemoryBlockStorage=InMemoryBlockStorage;this.provider=provider||new HttpProvider();this.dns=new Dns(this.provider);this.wallet=new Wallets(this.provider);this.payments=new Payments(this.provider);this.lockupWallet=LockupWallets}
async getTransactions(address,limit=20,lt=undefined,txhash=undefined,to_lt=undefined){return this.provider.getTransactions(address.toString(),limit,lt,txhash,to_lt)};async getBalance(address){return this.provider.getBalance(address.toString())}
async sendBoc(bytes){return this.provider.sendBoc(utils.bytesToBase64(bytes))}
async call(address,method,params=[]){return this.provider.call(address.toString(),method,params)}}
TonWeb.version=version;TonWeb.utils=utils;TonWeb.Address=Address;TonWeb.boc=boc;TonWeb.HttpProvider=HttpProvider;TonWeb.Contract=Contract;TonWeb.Wallets=Wallets;TonWeb.LockupWallets=LockupWallets;TonWeb.SubscriptionContract=SubscriptionContract;TonWeb.BlockSubscription=BlockSubscription;TonWeb.InMemoryBlockStorage=InMemoryBlockStorage;TonWeb.ledger={TransportWebUSB,TransportWebHID,BluetoothTransport,AppTon,};TonWeb.token={nft:NFT,ft:JETTON,jetton:JETTON,}
TonWeb.HighloadWallets=HighloadWallets;TonWeb.dns=Dns;TonWeb.dns.DnsCollection=DnsCollection;TonWeb.dns.DnsItem=DnsItem;TonWeb.payments=Payments;TonWeb.payments.PaymentChannel=PaymentChannel;module.exports=TonWeb},{"./boc":306,"./contract":315,"./contract/dns":311,"./contract/highloadWallet":314,"./contract/lockup":318,"./contract/payments/index":321,"./contract/subscription/index":322,"./contract/token/ft":325,"./contract/token/nft":331,"./contract/wallet":339,"./ledger/AppTon":341,"./providers":346,"./providers/blockSubscription":345,"./utils":351,"@ledgerhq/hw-transport-web-ble":13,"@ledgerhq/hw-transport-webhid":15,"@ledgerhq/hw-transport-webusb":16}],341:[function(require,module,exports){(function(Buffer){(function(){const{Cell}=require("../boc");const{Address,BN,bytesToHex}=require("../utils");const{Contract}=require("../contract");class AppTon{constructor(transport,ton){this.transport=transport;this.ton=ton;this.ADDRESS_FORMAT_HEX=0;this.ADDRESS_FORMAT_USER_FRIENDLY=1;this.ADDRESS_FORMAT_URL_SAFE=2;this.ADDRESS_FORMAT_BOUNCEABLE=4;this.ADDRESS_FORMAT_TEST_ONLY=8}
async getAppConfiguration(){const response=await this.transport.send(0xe0,0x01,0x00,0x00);return{version:""+response[0]+"."+response[1]+"."+response[2]}}
async getPublicKey(accountNumber,isDisplay){const buffer=Buffer.alloc(4);buffer.writeInt32BE(accountNumber);const response=await this.transport.send(0xe0,0x02,isDisplay?0x01:0x00,0x00,buffer);const len=response[0];const publicKey=new Uint8Array(response.slice(1,1+len));return{publicKey}}
async getAddress(accountNumber,isDisplay,addressFormat){const buffer=Buffer.alloc(4);buffer.writeInt32BE(accountNumber);const response=await this.transport.send(0xe0,0x05,isDisplay?0x01:0x00,addressFormat,buffer);const len=response[0];const addressHex=new Uint8Array(response.slice(1,1+len));const address=new Address('0:'+bytesToHex(addressHex));return{address}}
async sign(accountNumber,buffer){const accountNumberBuffer=Buffer.alloc(4);accountNumberBuffer.writeInt32BE(accountNumber);const signBuffer=Buffer.concat([accountNumberBuffer,Buffer.from(buffer)]);const response=await this.transport.send(0xe0,0x03,0x00,0x00,signBuffer);const len=response[0];const signature=response.slice(1,1+len);return{signature}}
async transfer(accountNumber,wallet,toAddress,amount,seqno,addressFormat){const sendMode=3;const query=await wallet.createTransferMessage(null,toAddress,amount,seqno,null,sendMode,!0);const accountNumberBuffer=Buffer.alloc(4);accountNumberBuffer.writeInt32BE(accountNumber);const msgBuffer=Buffer.concat([accountNumberBuffer,Buffer.from(await query.signingMessage.toBoc())]);const response=await this.transport.send(0xe0,0x04,addressFormat,0x00,msgBuffer);const len=response[0];const signatureBuffer=response.slice(1,1+len);const signature=new Uint8Array(signatureBuffer);const body=new Cell();body.bits.writeBytes(signature);body.writeCell(query.signingMessage);let stateInit=null,code=null,data=null;if(seqno===0){const deploy=await wallet.createStateInit();stateInit=deploy.stateInit;code=deploy.code;data=deploy.data}
const selfAddress=await wallet.getAddress();const header=Contract.createExternalMessageHeader(selfAddress);const resultMessage=Contract.createCommonMsgInfo(header,stateInit,body);const resultPromise=new Promise(resolve=>{resolve({address:selfAddress,message:resultMessage,body:body,signature:signature,signingMessage:query.signingMessage,stateInit,code,data,})});return Contract.createMethod(this.ton.provider,resultPromise)}}
module.exports=AppTon}).call(this)}).call(this,require("buffer").Buffer)},{"../boc":306,"../contract":315,"../utils":351,"buffer":3}],342:[function(require,module,exports){const{BN,base64ToBytes}=require("../utils");const{Cell}=require("../boc");class HttpProviderUtils{static parseObject(x){const typeName=x['@type'];switch(typeName){case 'tvm.list':case 'tvm.tuple':return x.elements.map(HttpProviderUtils.parseObject);case 'tvm.cell':return Cell.oneFromBoc(base64ToBytes(x.bytes));case 'tvm.stackEntryCell':return HttpProviderUtils.parseObject(x.cell);case 'tvm.stackEntryTuple':return HttpProviderUtils.parseObject(x.tuple);case 'tvm.stackEntryNumber':return HttpProviderUtils.parseObject(x.number);case 'tvm.numberDecimal':return new BN(x.number,10);default:throw new Error('unknown type '+typeName)}}
static parseResponseStack(pair){const typeName=pair[0];const value=pair[1];switch(typeName){case 'num':return new BN(value.replace(/0x/,''),16);case 'list':case 'tuple':return HttpProviderUtils.parseObject(value);case 'cell':const contentBytes=base64ToBytes(value.bytes);return Cell.oneFromBoc(contentBytes);default:throw new Error('unknown type '+typeName)}}
static parseResponse(result){if(result.exit_code!==0){const err=new Error('http provider parse response error')
err.result=result
throw err}
const arr=result.stack.map(HttpProviderUtils.parseResponseStack);return arr.length===1?arr[0]:arr}
static makeArg(arg){if(arg instanceof BN||arg instanceof Number){return['num',arg]}else{throw new Error('unknown arg type '+arg)}}
static makeArgs(args){return args.map(this.makeArg)}}
module.exports.default=HttpProviderUtils},{"../boc":306,"../utils":351}],343:[function(require,module,exports){const MC_INTERVAL=10*1000;const SHARDS_INTERVAL=1*1000;const parseShardBlockNumber=x=>{return{workchain:x.workchain,shardId:x.shard,shardBlockNumber:x.seqno}}
class BlockSubscription{constructor(provider,storage,onBlock,options){this.provider=provider;this.storage=storage;this.onBlock=onBlock;this.startMcBlockNumber=options?options.startMcBlockNumber:undefined;this.mcInterval=(options?options.mcInterval:undefined)||MC_INTERVAL;this.shardsInterval=(options?options.shardsInterval:undefined)||SHARDS_INTERVAL}
async start(){this.stop();if(!this.startMcBlockNumber){this.startMcBlockNumber=(await this.provider.getMasterchainInfo()).last.seqno;if(!this.startMcBlockNumber)throw new Error('Cannot get start mc block number from provider');}
const startMcBlockHeader=await this.provider.getMasterchainBlockHeader(this.startMcBlockNumber);this.startLT=startMcBlockHeader.end_lt;if(!this.startLT)throw new Error('Cannot get startLT from provider');let isMcProcessing=!1;const mcTick=async()=>{if(isMcProcessing)return;isMcProcessing=!0;try{const lastSavedMcBlock=await this.storage.getLastMasterchainBlockNumber()||this.startMcBlockNumber;if(!lastSavedMcBlock)throw new Error('no init masterchain block in storage');const lastMcBlock=(await this.provider.getMasterchainInfo()).last.seqno;if(!lastMcBlock)throw new Error('invalid last masterchain block from provider');for(let i=lastSavedMcBlock+1;i<lastMcBlock;i++){const blockShards=await this.provider.getBlockShards(i);const blockHeader=await this.provider.getMasterchainBlockHeader(i);await this.onBlock(blockHeader,blockShards);await this.storage.insertBlocks(i,blockShards.shards.map(parseShardBlockNumber))}}catch(e){console.error(e)}
isMcProcessing=!1}
this.mcIntervalId=setInterval(()=>mcTick(),this.mcInterval);mcTick();let isShardsProcessing=!1;const shardsTick=async()=>{if(isShardsProcessing)return;isShardsProcessing=!0;try{const shardBlock=await this.storage.getUnprocessedShardBlock();if(shardBlock){const{workchain,shardId,shardBlockNumber}=shardBlock;const blockHeader=await this.provider.getBlockHeader(workchain,shardId,shardBlockNumber);if(blockHeader.end_lt<this.startLT){await this.storage.setBlockProcessed(workchain,shardId,shardBlockNumber,[])}else{await this.onBlock(blockHeader);const prevBlocks=blockHeader.prev_blocks.map(parseShardBlockNumber);await this.storage.setBlockProcessed(workchain,shardId,shardBlockNumber,prevBlocks)}}}catch(e){console.log(e)}
isShardsProcessing=!1}
this.shardsIntervalId=setInterval(()=>shardsTick(),this.shardsInterval)}
stop(){clearInterval(this.mcIntervalId);clearInterval(this.shardsIntervalId)}}
module.exports={BlockSubscription}},{}],344:[function(require,module,exports){class InMemoryBlockStorage{constructor(logFunction){this.masterchainBlocks={};this.shardchainBlocks={};this.logFunction=logFunction}
async insertShardBlocks(shardBlockNumbers){for(const{workchain,shardId,shardBlockNumber}of shardBlockNumbers){if(this.shardchainBlocks[workchain+'_'+shardId+'_'+shardBlockNumber]!==undefined)continue;if(this.logFunction){this.logFunction('insert shard '+workchain+' '+shardId+' '+shardBlockNumber)}
this.shardchainBlocks[workchain+'_'+shardId+'_'+shardBlockNumber]=!1}}
async insertBlocks(mcBlockNumber,shardBlockNumbers){if(this.logFunction){this.logFunction('mc processed '+mcBlockNumber)}
if(this.masterchainBlocks[mcBlockNumber]!==undefined)throw new Error('mc already exists '+mcBlockNumber);this.masterchainBlocks[mcBlockNumber]=!0;await this.insertShardBlocks(shardBlockNumbers)}
async getLastMasterchainBlockNumber(){const blockNumbers=Object.keys(this.masterchainBlocks).map(x=>Number(x)).sort((a,b)=>b-a);return blockNumbers[0]}
async setBlockProcessed(workchain,shardId,shardBlockNumber,prevShardBlocks){if(this.logFunction){this.logFunction('shard processed '+workchain+' '+shardId+' '+shardBlockNumber)}
if(this.shardchainBlocks[workchain+'_'+shardId+'_'+shardBlockNumber]===undefined)throw new Error('shard not exists '+workchain+'_'+shardId+'_'+shardBlockNumber);this.shardchainBlocks[workchain+'_'+shardId+'_'+shardBlockNumber]=!0;await this.insertShardBlocks(prevShardBlocks)}
async getUnprocessedShardBlock(){for(let key in this.shardchainBlocks){if(this.shardchainBlocks[key]===!1){const arr=key.split('_');return{workchain:Number(arr[0]),shardId:arr[1],shardBlockNumber:Number(arr[2]),}}}
return undefined}}
module.exports={InMemoryBlockStorage}},{}],345:[function(require,module,exports){const{BlockSubscription}=require("./BlockSubscription");const{InMemoryBlockStorage}=require("./InMemoryBlockStorage");module.exports={BlockSubscription,InMemoryBlockStorage}},{"./BlockSubscription":343,"./InMemoryBlockStorage":344}],346:[function(require,module,exports){const{Cell}=require("../boc");const{base64ToBytes}=require("../utils");const HttpProviderUtils=require('./HttpProviderUtils').default;if(typeof fetch==='undefined'){fetch=require('node-fetch')}
const SHARD_ID_ALL='-9223372036854775808';class HttpProvider{constructor(host,options){this.host=host||"https://toncenter.com/api/v2/jsonRPC";this.options=options||{}}
sendImpl(apiUrl,request){const headers={'Content-Type':'application/json'};if(this.options.apiKey){headers['X-API-Key']=this.options.apiKey}
return fetch(apiUrl,{method:'POST',headers:headers,body:JSON.stringify(request)}).then((response)=>response.json()).then(({result,error})=>result||Promise.reject(error))}
send(method,params){return this.sendImpl(this.host,{id:1,jsonrpc:"2.0",method:method,params:params})}
async getAddressInfo(address){return this.send('getAddressInformation',{address:address})}
async getExtendedAddressInfo(address){return this.send('getExtendedAddressInformation',{address:address})}
async getWalletInfo(address){return this.send('getWalletInformation',{address:address})}
async getTransactions(address,limit=20,lt=undefined,hash=undefined,to_lt=undefined,archival=undefined){return this.send("getTransactions",{address,limit,lt,hash,to_lt,archival})};async getBalance(address){return this.send('getAddressBalance',{address:address})}
async sendBoc(base64){return this.send("sendBoc",{'boc':base64})};async sendQuery(query){return this.send("sendQuerySimple",query)};async getEstimateFee(query){return this.send("estimateFee",query)};async call(address,method,params=[]){return this.send('runGetMethod',{address:address,method:method,stack:params,})}
async call2(address,method,params=[]){const result=await this.send('runGetMethod',{address:address,method:method,stack:params});return HttpProviderUtils.parseResponse(result)}
async getConfigParam(configParamId){const rawResult=await this.send('getConfigParam',{config_id:configParamId});if(rawResult['@type']!=='configInfo')throw new Error('getConfigParam expected type configInfo');if(!rawResult.config)throw new Error('getConfigParam expected config');if(rawResult.config['@type']!=='tvm.cell')throw new Error('getConfigParam expected type tvm.cell');if(!rawResult.config.bytes)throw new Error('getConfigParam expected bytes');return Cell.oneFromBoc(base64ToBytes(rawResult.config.bytes))}
async getMasterchainInfo(){return this.send('getMasterchainInfo',{})}
async getBlockShards(masterchainBlockNumber){return this.send('shards',{seqno:masterchainBlockNumber})}
async getBlockTransactions(workchain,shardId,shardBlockNumber,limit,afterLt,addressHash){return this.send('getBlockTransactions',{workchain:workchain,shard:shardId,seqno:shardBlockNumber,count:limit,after_lt:afterLt,after_hash:addressHash})}
async getMasterchainBlockTransactions(masterchainBlockNumber,limit,afterLt,addressHash){return this.getBlockTransactions(-1,SHARD_ID_ALL,masterchainBlockNumber,limit,afterLt,addressHash)}
async getBlockHeader(workchain,shardId,shardBlockNumber){return this.send('getBlockHeader',{workchain:workchain,shard:shardId,seqno:shardBlockNumber})}
async getMasterchainBlockHeader(masterchainBlockNumber){return this.getBlockHeader(-1,SHARD_ID_ALL,masterchainBlockNumber)}}
HttpProvider.SHARD_ID_ALL=SHARD_ID_ALL;module.exports.default=HttpProvider},{"../boc":306,"../utils":351,"./HttpProviderUtils":342,"node-fetch":2}],347:[function(require,module,exports){const{crc16,hexToBytes,bytesToHex,stringToBytes,base64toString,stringToBase64}=require("./Utils");const bounceable_tag=0x11;const non_bounceable_tag=0x51;const test_flag=0x80;function parseFriendlyAddress(addressString){if(addressString.length!==48){throw new Error(`User-friendly address should contain strictly 48 characters`)}
const data=stringToBytes(base64toString(addressString));if(data.length!==36){throw "Unknown address type: byte length is not equal to 36"}
const addr=data.slice(0,34);const crc=data.slice(34,36);const calcedCrc=crc16(addr);if(!(calcedCrc[0]===crc[0]&&calcedCrc[1]===crc[1])){throw "Wrong crc16 hashsum"}
let tag=addr[0];let isTestOnly=!1;let isBounceable=!1;if(tag&test_flag){isTestOnly=!0;tag=tag^test_flag}
if((tag!==bounceable_tag)&&(tag!==non_bounceable_tag))
throw "Unknown address tag";isBounceable=tag===bounceable_tag;let workchain=null;if(addr[1]===0xff){workchain=-1}else{workchain=addr[1]}
if(workchain!==0&&workchain!==-1)throw new Error('Invalid address wc '+workchain);const hashPart=addr.slice(2,34);return{isTestOnly,isBounceable,workchain,hashPart}}
class Address{static isValid(anyForm){try{new Address(anyForm);return!0}catch(e){return!1}}
constructor(anyForm){if(anyForm==null){throw "Invalid address"}
if(anyForm instanceof Address){this.wc=anyForm.wc;this.hashPart=anyForm.hashPart;this.isTestOnly=anyForm.isTestOnly;this.isUserFriendly=anyForm.isUserFriendly;this.isBounceable=anyForm.isBounceable;this.isUrlSafe=anyForm.isUrlSafe;return}
this.isUrlSafe=!0;if(anyForm.search(/\-/)>0||anyForm.search(/_/)>0){anyForm=anyForm.replace(/\-/g,'+').replace(/_/g,'\/')}else{this.isUrlSafe=!1}
if(anyForm.indexOf(':')>-1){const arr=anyForm.split(':');if(arr.length!==2)throw new Error('Invalid address '+anyForm);const wc=parseInt(arr[0]);if(wc!==0&&wc!==-1)throw new Error('Invalid address wc '+anyForm);const hex=arr[1];if(hex.length!==64)throw new Error('Invalid address hex '+anyForm);this.isUserFriendly=!1;this.wc=wc;this.hashPart=hexToBytes(hex);this.isTestOnly=!1;this.isBounceable=!1}else{this.isUserFriendly=!0;const parseResult=parseFriendlyAddress(anyForm);this.wc=parseResult.workchain;this.hashPart=parseResult.hashPart;this.isTestOnly=parseResult.isTestOnly;this.isBounceable=parseResult.isBounceable}}
toString(isUserFriendly,isUrlSafe,isBounceable,isTestOnly){if(isUserFriendly===undefined)isUserFriendly=this.isUserFriendly;if(isUrlSafe===undefined)isUrlSafe=this.isUrlSafe;if(isBounceable===undefined)isBounceable=this.isBounceable;if(isTestOnly===undefined)isTestOnly=this.isTestOnly;if(!isUserFriendly){return this.wc+":"+bytesToHex(this.hashPart)}else{let tag=isBounceable?bounceable_tag:non_bounceable_tag;if(isTestOnly){tag|=test_flag}
const addr=new Int8Array(34);addr[0]=tag;addr[1]=this.wc;addr.set(this.hashPart,2);const addressWithChecksum=new Uint8Array(36);addressWithChecksum.set(addr);addressWithChecksum.set(crc16(addr),34);let addressBase64=stringToBase64(String.fromCharCode.apply(null,new Uint8Array(addressWithChecksum)));if(isUrlSafe){addressBase64=addressBase64.replace(/\+/g,'-').replace(/\//g,'_')}
return addressBase64}}}
module.exports.default=Address},{"./Utils":350}],348:[function(require,module,exports){const{hexToBytes,bytesToHex}=require("./Utils");class AdnlAddress{static isValid(anyForm){try{new AdnlAddress(anyForm);return!0}catch(e){return!1}}
constructor(anyForm){if(anyForm==null){throw "Invalid address"}
if(anyForm instanceof AdnlAddress){this.bytes=anyForm.bytes}else if(anyForm instanceof Uint8Array){if(anyForm.length!==32){throw new Error('invalid adnl bytes length')}
this.bytes=anyForm}else if(typeof anyForm==='string'){if(anyForm.length!==64){throw new Error('invalid adnl hex length')}
this.bytes=hexToBytes(anyForm)}else{throw new Error('unsupported type')}}
toHex(){let hex=bytesToHex(this.bytes);while(hex.length<64){hex='0'+hex}
return hex}}
module.exports.default=AdnlAddress},{"./Utils":350}],349:[function(require,module,exports){const{hexToBytes,bytesToHex}=require("./Utils");class StorageBagId{static isValid(anyForm){try{new StorageBagId(anyForm);return!0}catch(e){return!1}}
constructor(anyForm){if(anyForm==null){throw "Invalid address"}
if(anyForm instanceof StorageBagId){this.bytes=anyForm.bytes}else if(anyForm instanceof Uint8Array){if(anyForm.length!==32){throw new Error('invalid bag id bytes length')}
this.bytes=anyForm}else if(typeof anyForm==='string'){if(anyForm.length!==64){throw new Error('invalid bag id hex length')}
this.bytes=hexToBytes(anyForm)}else{throw new Error('unsupported type')}}
toHex(){let hex=bytesToHex(this.bytes);while(hex.length<64){hex='0'+hex}
return hex}}
module.exports.default=StorageBagId},{"./Utils":350}],350:[function(require,module,exports){(function(Buffer){(function(){const BN=require("bn.js");const nacl=require("tweetnacl");const ethunit=require("ethjs-unit");const isCryptoAvailable=!0;let myCrypto=null;if(isCryptoAvailable){}else{myCrypto=require('isomorphic-webcrypto')}
function sha256(bytes){if(isCryptoAvailable){return crypto.subtle.digest("SHA-256",bytes)}else{return myCrypto.subtle.digest({name:"SHA-256"},bytes)}}
function toNano(amount){if(!BN.isBN(amount)&&!(typeof amount==='string')){throw new Error('Please pass numbers as strings or BN objects to avoid precision errors.')}
return ethunit.toWei(amount,'gwei')}
function fromNano(amount){if(!BN.isBN(amount)&&!(typeof amount==='string')){throw new Error('Please pass numbers as strings or BN objects to avoid precision errors.')}
return ethunit.fromWei(amount,'gwei')}
const to_hex_array=[];const to_byte_map={};for(let ord=0;ord<=0xff;ord++){let s=ord.toString(16);if(s.length<2){s="0"+s}
to_hex_array.push(s);to_byte_map[s]=ord}
function bytesToHex(buffer){const hex_array=[];for(let i=0;i<buffer.byteLength;i++){hex_array.push(to_hex_array[buffer[i]])}
return hex_array.join("")}
function hexToBytes(s){s=s.toLowerCase();const length2=s.length;if(length2%2!==0){throw "hex string must have length a multiple of 2"}
const length=length2/2;const result=new Uint8Array(length);for(let i=0;i<length;i++){const i2=i*2;const b=s.substring(i2,i2+2);if(!to_byte_map.hasOwnProperty(b))throw new Error('invalid hex character '+b);result[i]=to_byte_map[b]}
return result}
function stringToBytes(str,size=1){let buf;let bufView;if(size===1){buf=new ArrayBuffer(str.length);bufView=new Uint8Array(buf)}
if(size===2){buf=new ArrayBuffer(str.length*2);bufView=new Uint16Array(buf)}
if(size===4){buf=new ArrayBuffer(str.length*4);bufView=new Uint32Array(buf)}
for(let i=0,strLen=str.length;i<strLen;i++){bufView[i]=str.charCodeAt(i)}
return new Uint8Array(bufView.buffer)}
function _crc32c(crc,bytes){const POLY=0x82f63b78;crc^=0xffffffff;for(let n=0;n<bytes.length;n++){crc^=bytes[n];crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1;crc=crc&1?(crc>>>1)^POLY:crc>>>1}
return crc^0xffffffff}
function crc32c(bytes){const int_crc=_crc32c(0,bytes);const arr=new ArrayBuffer(4);const view=new DataView(arr);view.setUint32(0,int_crc,!1);return new Uint8Array(arr).reverse()}
function crc16(data){const poly=0x1021;let reg=0;const message=new Uint8Array(data.length+2);message.set(data);for(let byte of message){let mask=0x80;while(mask>0){reg<<=1;if(byte&mask){reg+=1}
mask>>=1
if(reg>0xffff){reg&=0xffff;reg^=poly}}}
return new Uint8Array([Math.floor(reg/256),reg%256])}
function concatBytes(a,b){const c=new Uint8Array(a.length+b.length);c.set(a);c.set(b,a.length);return c}
function compareBytes(a,b){return a.toString()===b.toString()}
const base64abc=(()=>{const abc=[]
const A="A".charCodeAt(0);const a="a".charCodeAt(0);const n="0".charCodeAt(0);for(let i=0;i<26;++i){abc.push(String.fromCharCode(A+i))}
for(let i=0;i<26;++i){abc.push(String.fromCharCode(a+i))}
for(let i=0;i<10;++i){abc.push(String.fromCharCode(n+i))}
abc.push("+");abc.push("/");return abc})();function bytesToBase64(bytes){let result="";let i;const l=bytes.length;for(i=2;i<l;i+=3){result+=base64abc[bytes[i-2]>>2];result+=base64abc[((bytes[i-2]&0x03)<<4)|(bytes[i-1]>>4)];result+=base64abc[((bytes[i-1]&0x0f)<<2)|(bytes[i]>>6)];result+=base64abc[bytes[i]&0x3f]}
if(i===l+1){result+=base64abc[bytes[i-2]>>2];result+=base64abc[(bytes[i-2]&0x03)<<4];result+="=="}
if(i===l){result+=base64abc[bytes[i-2]>>2];result+=base64abc[((bytes[i-2]&0x03)<<4)|(bytes[i-1]>>4)];result+=base64abc[(bytes[i-1]&0x0f)<<2];result+="="}
return result}
function base64toString(base64){if(typeof self==='undefined'){return Buffer.from(base64,'base64').toString('binary')}else{return atob(base64)}}
function stringToBase64(s){if(typeof self==='undefined'){return Buffer.from(s,'binary').toString('base64')}else{return btoa(s)}}
function base64ToBytes(base64){const binary_string=base64toString(base64);const len=binary_string.length;const bytes=new Uint8Array(len);for(let i=0;i<len;i++){bytes[i]=binary_string.charCodeAt(i)}
return bytes}
function readNBytesUIntFromArray(n,ui8array){let res=0;for(let c=0;c<n;c++){res*=256;res+=ui8array[c]}
return res}
function keyPairFromSeed(seed){return nacl.sign.keyPair.fromSeed(seed)}
function newKeyPair(){return nacl.sign.keyPair()}
function newSeed(){return nacl.sign.keyPair().secretKey.slice(0,32)}
module.exports={BN,nacl,sha256,fromNano,toNano,bytesToHex,hexToBytes,stringToBytes,crc32c,crc16,concatBytes,bytesToBase64,base64ToBytes,base64toString,stringToBase64,compareBytes,readNBytesUIntFromArray,keyPairFromSeed,newKeyPair,newSeed}}).call(this)}).call(this,require("buffer").Buffer)},{"bn.js":48,"buffer":3,"ethjs-unit":49,"isomorphic-webcrypto":53,"tweetnacl":352}],351:[function(require,module,exports){const{BN,nacl,sha256,fromNano,toNano,bytesToHex,hexToBytes,stringToBytes,crc32c,crc16,concatBytes,bytesToBase64,base64ToBytes,base64toString,stringToBase64,compareBytes,readNBytesUIntFromArray,keyPairFromSeed,newKeyPair,newSeed}=require("./Utils");const Address=require("./Address").default;const AdnlAddress=require("./AdnlAddress").default;const StorageBagId=require("./StorageBagId").default;function parseTransferUrl(url){const PREFIX='ton://transfer/';if(!url.startsWith(PREFIX)){throw new Error('must starts with '+PREFIX)}
const arr=url.substring(PREFIX.length).split('?');if(arr.length>2){throw new Error('multiple "?"')}
const address=arr[0];if(!Address.isValid(address)){throw new Error('invalid address format '+address)}
const result={address:address};const rest=arr[1];if(rest&&rest.length){const pairs=rest.split('&').map(s=>s.split('='));for(const pair of pairs){if(pair.length!==2)throw new Error('invalid url pair');const key=pair[0];const value=pair[1];if(key==='amount'){if(result.amount){throw new Error('amount already set')}
const bn=new BN(value);if(bn.isNeg()){throw new Error('negative amount')}
result.amount=value}else if(key==='text'){if(result.text){throw new Error('text already set')}
result.text=decodeURIComponent(value)}else{throw new Error('unknown url var '+key)}}}
return result}
function formatTransferUrl(address,amount,text){let url='ton://transfer/'+address;const params=[];if(amount){params.push('amount='+amount)}
if(text){params.push('text='+encodeURIComponent(text))}
if(params.length===0)return url;return url+'?'+params.join('&')}
module.exports={Address,AdnlAddress,StorageBagId,BN,nacl,sha256,fromNano,toNano,bytesToHex,hexToBytes,stringToBytes,crc32c,crc16,concatBytes,bytesToBase64,base64ToBytes,base64toString,stringToBase64,compareBytes,readNBytesUIntFromArray,parseTransferUrl,formatTransferUrl,keyPairFromSeed,newKeyPair,newSeed}},{"./Address":347,"./AdnlAddress":348,"./StorageBagId":349,"./Utils":350}],352:[function(require,module,exports){(function(nacl){'use strict';var gf=function(init){var i,r=new Float64Array(16);if(init)for(i=0;i<init.length;i++)r[i]=init[i];return r};var randombytes=function(){throw new Error('no PRNG')};var _0=new Uint8Array(16);var _9=new Uint8Array(32);_9[0]=9;var gf0=gf(),gf1=gf([1]),_121665=gf([0xdb41,1]),D=gf([0x78a3,0x1359,0x4dca,0x75eb,0xd8ab,0x4141,0x0a4d,0x0070,0xe898,0x7779,0x4079,0x8cc7,0xfe73,0x2b6f,0x6cee,0x5203]),D2=gf([0xf159,0x26b2,0x9b94,0xebd6,0xb156,0x8283,0x149a,0x00e0,0xd130,0xeef3,0x80f2,0x198e,0xfce7,0x56df,0xd9dc,0x2406]),X=gf([0xd51a,0x8f25,0x2d60,0xc956,0xa7b2,0x9525,0xc760,0x692c,0xdc5c,0xfdd6,0xe231,0xc0a4,0x53fe,0xcd6e,0x36d3,0x2169]),Y=gf([0x6658,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666,0x6666]),I=gf([0xa0b0,0x4a0e,0x1b27,0xc4ee,0xe478,0xad2f,0x1806,0x2f43,0xd7a7,0x3dfb,0x0099,0x2b4d,0xdf0b,0x4fc1,0x2480,0x2b83]);function ts64(x,i,h,l){x[i]=(h>>24)&0xff;x[i+1]=(h>>16)&0xff;x[i+2]=(h>>8)&0xff;x[i+3]=h&0xff;x[i+4]=(l>>24)&0xff;x[i+5]=(l>>16)&0xff;x[i+6]=(l>>8)&0xff;x[i+7]=l&0xff}
function vn(x,xi,y,yi,n){var i,d=0;for(i=0;i<n;i++)d|=x[xi+i]^y[yi+i];return(1&((d-1)>>>8))-1}
function crypto_verify_16(x,xi,y,yi){return vn(x,xi,y,yi,16)}
function crypto_verify_32(x,xi,y,yi){return vn(x,xi,y,yi,32)}
function core_salsa20(o,p,k,c){var j0=c[0]&0xff|(c[1]&0xff)<<8|(c[2]&0xff)<<16|(c[3]&0xff)<<24,j1=k[0]&0xff|(k[1]&0xff)<<8|(k[2]&0xff)<<16|(k[3]&0xff)<<24,j2=k[4]&0xff|(k[5]&0xff)<<8|(k[6]&0xff)<<16|(k[7]&0xff)<<24,j3=k[8]&0xff|(k[9]&0xff)<<8|(k[10]&0xff)<<16|(k[11]&0xff)<<24,j4=k[12]&0xff|(k[13]&0xff)<<8|(k[14]&0xff)<<16|(k[15]&0xff)<<24,j5=c[4]&0xff|(c[5]&0xff)<<8|(c[6]&0xff)<<16|(c[7]&0xff)<<24,j6=p[0]&0xff|(p[1]&0xff)<<8|(p[2]&0xff)<<16|(p[3]&0xff)<<24,j7=p[4]&0xff|(p[5]&0xff)<<8|(p[6]&0xff)<<16|(p[7]&0xff)<<24,j8=p[8]&0xff|(p[9]&0xff)<<8|(p[10]&0xff)<<16|(p[11]&0xff)<<24,j9=p[12]&0xff|(p[13]&0xff)<<8|(p[14]&0xff)<<16|(p[15]&0xff)<<24,j10=c[8]&0xff|(c[9]&0xff)<<8|(c[10]&0xff)<<16|(c[11]&0xff)<<24,j11=k[16]&0xff|(k[17]&0xff)<<8|(k[18]&0xff)<<16|(k[19]&0xff)<<24,j12=k[20]&0xff|(k[21]&0xff)<<8|(k[22]&0xff)<<16|(k[23]&0xff)<<24,j13=k[24]&0xff|(k[25]&0xff)<<8|(k[26]&0xff)<<16|(k[27]&0xff)<<24,j14=k[28]&0xff|(k[29]&0xff)<<8|(k[30]&0xff)<<16|(k[31]&0xff)<<24,j15=c[12]&0xff|(c[13]&0xff)<<8|(c[14]&0xff)<<16|(c[15]&0xff)<<24;var x0=j0,x1=j1,x2=j2,x3=j3,x4=j4,x5=j5,x6=j6,x7=j7,x8=j8,x9=j9,x10=j10,x11=j11,x12=j12,x13=j13,x14=j14,x15=j15,u;for(var i=0;i<20;i+=2){u=x0+x12|0;x4^=u<<7|u>>>(32-7);u=x4+x0|0;x8^=u<<9|u>>>(32-9);u=x8+x4|0;x12^=u<<13|u>>>(32-13);u=x12+x8|0;x0^=u<<18|u>>>(32-18);u=x5+x1|0;x9^=u<<7|u>>>(32-7);u=x9+x5|0;x13^=u<<9|u>>>(32-9);u=x13+x9|0;x1^=u<<13|u>>>(32-13);u=x1+x13|0;x5^=u<<18|u>>>(32-18);u=x10+x6|0;x14^=u<<7|u>>>(32-7);u=x14+x10|0;x2^=u<<9|u>>>(32-9);u=x2+x14|0;x6^=u<<13|u>>>(32-13);u=x6+x2|0;x10^=u<<18|u>>>(32-18);u=x15+x11|0;x3^=u<<7|u>>>(32-7);u=x3+x15|0;x7^=u<<9|u>>>(32-9);u=x7+x3|0;x11^=u<<13|u>>>(32-13);u=x11+x7|0;x15^=u<<18|u>>>(32-18);u=x0+x3|0;x1^=u<<7|u>>>(32-7);u=x1+x0|0;x2^=u<<9|u>>>(32-9);u=x2+x1|0;x3^=u<<13|u>>>(32-13);u=x3+x2|0;x0^=u<<18|u>>>(32-18);u=x5+x4|0;x6^=u<<7|u>>>(32-7);u=x6+x5|0;x7^=u<<9|u>>>(32-9);u=x7+x6|0;x4^=u<<13|u>>>(32-13);u=x4+x7|0;x5^=u<<18|u>>>(32-18);u=x10+x9|0;x11^=u<<7|u>>>(32-7);u=x11+x10|0;x8^=u<<9|u>>>(32-9);u=x8+x11|0;x9^=u<<13|u>>>(32-13);u=x9+x8|0;x10^=u<<18|u>>>(32-18);u=x15+x14|0;x12^=u<<7|u>>>(32-7);u=x12+x15|0;x13^=u<<9|u>>>(32-9);u=x13+x12|0;x14^=u<<13|u>>>(32-13);u=x14+x13|0;x15^=u<<18|u>>>(32-18)}
x0=x0+j0|0;x1=x1+j1|0;x2=x2+j2|0;x3=x3+j3|0;x4=x4+j4|0;x5=x5+j5|0;x6=x6+j6|0;x7=x7+j7|0;x8=x8+j8|0;x9=x9+j9|0;x10=x10+j10|0;x11=x11+j11|0;x12=x12+j12|0;x13=x13+j13|0;x14=x14+j14|0;x15=x15+j15|0;o[0]=x0>>>0&0xff;o[1]=x0>>>8&0xff;o[2]=x0>>>16&0xff;o[3]=x0>>>24&0xff;o[4]=x1>>>0&0xff;o[5]=x1>>>8&0xff;o[6]=x1>>>16&0xff;o[7]=x1>>>24&0xff;o[8]=x2>>>0&0xff;o[9]=x2>>>8&0xff;o[10]=x2>>>16&0xff;o[11]=x2>>>24&0xff;o[12]=x3>>>0&0xff;o[13]=x3>>>8&0xff;o[14]=x3>>>16&0xff;o[15]=x3>>>24&0xff;o[16]=x4>>>0&0xff;o[17]=x4>>>8&0xff;o[18]=x4>>>16&0xff;o[19]=x4>>>24&0xff;o[20]=x5>>>0&0xff;o[21]=x5>>>8&0xff;o[22]=x5>>>16&0xff;o[23]=x5>>>24&0xff;o[24]=x6>>>0&0xff;o[25]=x6>>>8&0xff;o[26]=x6>>>16&0xff;o[27]=x6>>>24&0xff;o[28]=x7>>>0&0xff;o[29]=x7>>>8&0xff;o[30]=x7>>>16&0xff;o[31]=x7>>>24&0xff;o[32]=x8>>>0&0xff;o[33]=x8>>>8&0xff;o[34]=x8>>>16&0xff;o[35]=x8>>>24&0xff;o[36]=x9>>>0&0xff;o[37]=x9>>>8&0xff;o[38]=x9>>>16&0xff;o[39]=x9>>>24&0xff;o[40]=x10>>>0&0xff;o[41]=x10>>>8&0xff;o[42]=x10>>>16&0xff;o[43]=x10>>>24&0xff;o[44]=x11>>>0&0xff;o[45]=x11>>>8&0xff;o[46]=x11>>>16&0xff;o[47]=x11>>>24&0xff;o[48]=x12>>>0&0xff;o[49]=x12>>>8&0xff;o[50]=x12>>>16&0xff;o[51]=x12>>>24&0xff;o[52]=x13>>>0&0xff;o[53]=x13>>>8&0xff;o[54]=x13>>>16&0xff;o[55]=x13>>>24&0xff;o[56]=x14>>>0&0xff;o[57]=x14>>>8&0xff;o[58]=x14>>>16&0xff;o[59]=x14>>>24&0xff;o[60]=x15>>>0&0xff;o[61]=x15>>>8&0xff;o[62]=x15>>>16&0xff;o[63]=x15>>>24&0xff}
function core_hsalsa20(o,p,k,c){var j0=c[0]&0xff|(c[1]&0xff)<<8|(c[2]&0xff)<<16|(c[3]&0xff)<<24,j1=k[0]&0xff|(k[1]&0xff)<<8|(k[2]&0xff)<<16|(k[3]&0xff)<<24,j2=k[4]&0xff|(k[5]&0xff)<<8|(k[6]&0xff)<<16|(k[7]&0xff)<<24,j3=k[8]&0xff|(k[9]&0xff)<<8|(k[10]&0xff)<<16|(k[11]&0xff)<<24,j4=k[12]&0xff|(k[13]&0xff)<<8|(k[14]&0xff)<<16|(k[15]&0xff)<<24,j5=c[4]&0xff|(c[5]&0xff)<<8|(c[6]&0xff)<<16|(c[7]&0xff)<<24,j6=p[0]&0xff|(p[1]&0xff)<<8|(p[2]&0xff)<<16|(p[3]&0xff)<<24,j7=p[4]&0xff|(p[5]&0xff)<<8|(p[6]&0xff)<<16|(p[7]&0xff)<<24,j8=p[8]&0xff|(p[9]&0xff)<<8|(p[10]&0xff)<<16|(p[11]&0xff)<<24,j9=p[12]&0xff|(p[13]&0xff)<<8|(p[14]&0xff)<<16|(p[15]&0xff)<<24,j10=c[8]&0xff|(c[9]&0xff)<<8|(c[10]&0xff)<<16|(c[11]&0xff)<<24,j11=k[16]&0xff|(k[17]&0xff)<<8|(k[18]&0xff)<<16|(k[19]&0xff)<<24,j12=k[20]&0xff|(k[21]&0xff)<<8|(k[22]&0xff)<<16|(k[23]&0xff)<<24,j13=k[24]&0xff|(k[25]&0xff)<<8|(k[26]&0xff)<<16|(k[27]&0xff)<<24,j14=k[28]&0xff|(k[29]&0xff)<<8|(k[30]&0xff)<<16|(k[31]&0xff)<<24,j15=c[12]&0xff|(c[13]&0xff)<<8|(c[14]&0xff)<<16|(c[15]&0xff)<<24;var x0=j0,x1=j1,x2=j2,x3=j3,x4=j4,x5=j5,x6=j6,x7=j7,x8=j8,x9=j9,x10=j10,x11=j11,x12=j12,x13=j13,x14=j14,x15=j15,u;for(var i=0;i<20;i+=2){u=x0+x12|0;x4^=u<<7|u>>>(32-7);u=x4+x0|0;x8^=u<<9|u>>>(32-9);u=x8+x4|0;x12^=u<<13|u>>>(32-13);u=x12+x8|0;x0^=u<<18|u>>>(32-18);u=x5+x1|0;x9^=u<<7|u>>>(32-7);u=x9+x5|0;x13^=u<<9|u>>>(32-9);u=x13+x9|0;x1^=u<<13|u>>>(32-13);u=x1+x13|0;x5^=u<<18|u>>>(32-18);u=x10+x6|0;x14^=u<<7|u>>>(32-7);u=x14+x10|0;x2^=u<<9|u>>>(32-9);u=x2+x14|0;x6^=u<<13|u>>>(32-13);u=x6+x2|0;x10^=u<<18|u>>>(32-18);u=x15+x11|0;x3^=u<<7|u>>>(32-7);u=x3+x15|0;x7^=u<<9|u>>>(32-9);u=x7+x3|0;x11^=u<<13|u>>>(32-13);u=x11+x7|0;x15^=u<<18|u>>>(32-18);u=x0+x3|0;x1^=u<<7|u>>>(32-7);u=x1+x0|0;x2^=u<<9|u>>>(32-9);u=x2+x1|0;x3^=u<<13|u>>>(32-13);u=x3+x2|0;x0^=u<<18|u>>>(32-18);u=x5+x4|0;x6^=u<<7|u>>>(32-7);u=x6+x5|0;x7^=u<<9|u>>>(32-9);u=x7+x6|0;x4^=u<<13|u>>>(32-13);u=x4+x7|0;x5^=u<<18|u>>>(32-18);u=x10+x9|0;x11^=u<<7|u>>>(32-7);u=x11+x10|0;x8^=u<<9|u>>>(32-9);u=x8+x11|0;x9^=u<<13|u>>>(32-13);u=x9+x8|0;x10^=u<<18|u>>>(32-18);u=x15+x14|0;x12^=u<<7|u>>>(32-7);u=x12+x15|0;x13^=u<<9|u>>>(32-9);u=x13+x12|0;x14^=u<<13|u>>>(32-13);u=x14+x13|0;x15^=u<<18|u>>>(32-18)}
o[0]=x0>>>0&0xff;o[1]=x0>>>8&0xff;o[2]=x0>>>16&0xff;o[3]=x0>>>24&0xff;o[4]=x5>>>0&0xff;o[5]=x5>>>8&0xff;o[6]=x5>>>16&0xff;o[7]=x5>>>24&0xff;o[8]=x10>>>0&0xff;o[9]=x10>>>8&0xff;o[10]=x10>>>16&0xff;o[11]=x10>>>24&0xff;o[12]=x15>>>0&0xff;o[13]=x15>>>8&0xff;o[14]=x15>>>16&0xff;o[15]=x15>>>24&0xff;o[16]=x6>>>0&0xff;o[17]=x6>>>8&0xff;o[18]=x6>>>16&0xff;o[19]=x6>>>24&0xff;o[20]=x7>>>0&0xff;o[21]=x7>>>8&0xff;o[22]=x7>>>16&0xff;o[23]=x7>>>24&0xff;o[24]=x8>>>0&0xff;o[25]=x8>>>8&0xff;o[26]=x8>>>16&0xff;o[27]=x8>>>24&0xff;o[28]=x9>>>0&0xff;o[29]=x9>>>8&0xff;o[30]=x9>>>16&0xff;o[31]=x9>>>24&0xff}
function crypto_core_salsa20(out,inp,k,c){core_salsa20(out,inp,k,c)}
function crypto_core_hsalsa20(out,inp,k,c){core_hsalsa20(out,inp,k,c)}
var sigma=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(c,cpos,m,mpos,b,n,k){var z=new Uint8Array(16),x=new Uint8Array(64);var u,i;for(i=0;i<16;i++)z[i]=0;for(i=0;i<8;i++)z[i]=n[i];while(b>=64){crypto_core_salsa20(x,z,k,sigma);for(i=0;i<64;i++)c[cpos+i]=m[mpos+i]^x[i];u=1;for(i=8;i<16;i++){u=u+(z[i]&0xff)|0;z[i]=u&0xff;u>>>=8}
b-=64;cpos+=64;mpos+=64}
if(b>0){crypto_core_salsa20(x,z,k,sigma);for(i=0;i<b;i++)c[cpos+i]=m[mpos+i]^x[i]}
return 0}
function crypto_stream_salsa20(c,cpos,b,n,k){var z=new Uint8Array(16),x=new Uint8Array(64);var u,i;for(i=0;i<16;i++)z[i]=0;for(i=0;i<8;i++)z[i]=n[i];while(b>=64){crypto_core_salsa20(x,z,k,sigma);for(i=0;i<64;i++)c[cpos+i]=x[i];u=1;for(i=8;i<16;i++){u=u+(z[i]&0xff)|0;z[i]=u&0xff;u>>>=8}
b-=64;cpos+=64}
if(b>0){crypto_core_salsa20(x,z,k,sigma);for(i=0;i<b;i++)c[cpos+i]=x[i]}
return 0}
function crypto_stream(c,cpos,d,n,k){var s=new Uint8Array(32);crypto_core_hsalsa20(s,n,k,sigma);var sn=new Uint8Array(8);for(var i=0;i<8;i++)sn[i]=n[i+16];return crypto_stream_salsa20(c,cpos,d,sn,s)}
function crypto_stream_xor(c,cpos,m,mpos,d,n,k){var s=new Uint8Array(32);crypto_core_hsalsa20(s,n,k,sigma);var sn=new Uint8Array(8);for(var i=0;i<8;i++)sn[i]=n[i+16];return crypto_stream_salsa20_xor(c,cpos,m,mpos,d,sn,s)}
var poly1305=function(key){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var t0,t1,t2,t3,t4,t5,t6,t7;t0=key[0]&0xff|(key[1]&0xff)<<8;this.r[0]=(t0)&0x1fff;t1=key[2]&0xff|(key[3]&0xff)<<8;this.r[1]=((t0>>>13)|(t1<<3))&0x1fff;t2=key[4]&0xff|(key[5]&0xff)<<8;this.r[2]=((t1>>>10)|(t2<<6))&0x1f03;t3=key[6]&0xff|(key[7]&0xff)<<8;this.r[3]=((t2>>>7)|(t3<<9))&0x1fff;t4=key[8]&0xff|(key[9]&0xff)<<8;this.r[4]=((t3>>>4)|(t4<<12))&0x00ff;this.r[5]=((t4>>>1))&0x1ffe;t5=key[10]&0xff|(key[11]&0xff)<<8;this.r[6]=((t4>>>14)|(t5<<2))&0x1fff;t6=key[12]&0xff|(key[13]&0xff)<<8;this.r[7]=((t5>>>11)|(t6<<5))&0x1f81;t7=key[14]&0xff|(key[15]&0xff)<<8;this.r[8]=((t6>>>8)|(t7<<8))&0x1fff;this.r[9]=((t7>>>5))&0x007f;this.pad[0]=key[16]&0xff|(key[17]&0xff)<<8;this.pad[1]=key[18]&0xff|(key[19]&0xff)<<8;this.pad[2]=key[20]&0xff|(key[21]&0xff)<<8;this.pad[3]=key[22]&0xff|(key[23]&0xff)<<8;this.pad[4]=key[24]&0xff|(key[25]&0xff)<<8;this.pad[5]=key[26]&0xff|(key[27]&0xff)<<8;this.pad[6]=key[28]&0xff|(key[29]&0xff)<<8;this.pad[7]=key[30]&0xff|(key[31]&0xff)<<8};poly1305.prototype.blocks=function(m,mpos,bytes){var hibit=this.fin?0:(1<<11);var t0,t1,t2,t3,t4,t5,t6,t7,c;var d0,d1,d2,d3,d4,d5,d6,d7,d8,d9;var h0=this.h[0],h1=this.h[1],h2=this.h[2],h3=this.h[3],h4=this.h[4],h5=this.h[5],h6=this.h[6],h7=this.h[7],h8=this.h[8],h9=this.h[9];var r0=this.r[0],r1=this.r[1],r2=this.r[2],r3=this.r[3],r4=this.r[4],r5=this.r[5],r6=this.r[6],r7=this.r[7],r8=this.r[8],r9=this.r[9];while(bytes>=16){t0=m[mpos+0]&0xff|(m[mpos+1]&0xff)<<8;h0+=(t0)&0x1fff;t1=m[mpos+2]&0xff|(m[mpos+3]&0xff)<<8;h1+=((t0>>>13)|(t1<<3))&0x1fff;t2=m[mpos+4]&0xff|(m[mpos+5]&0xff)<<8;h2+=((t1>>>10)|(t2<<6))&0x1fff;t3=m[mpos+6]&0xff|(m[mpos+7]&0xff)<<8;h3+=((t2>>>7)|(t3<<9))&0x1fff;t4=m[mpos+8]&0xff|(m[mpos+9]&0xff)<<8;h4+=((t3>>>4)|(t4<<12))&0x1fff;h5+=((t4>>>1))&0x1fff;t5=m[mpos+10]&0xff|(m[mpos+11]&0xff)<<8;h6+=((t4>>>14)|(t5<<2))&0x1fff;t6=m[mpos+12]&0xff|(m[mpos+13]&0xff)<<8;h7+=((t5>>>11)|(t6<<5))&0x1fff;t7=m[mpos+14]&0xff|(m[mpos+15]&0xff)<<8;h8+=((t6>>>8)|(t7<<8))&0x1fff;h9+=((t7>>>5))|hibit;c=0;d0=c;d0+=h0*r0;d0+=h1*(5*r9);d0+=h2*(5*r8);d0+=h3*(5*r7);d0+=h4*(5*r6);c=(d0>>>13);d0&=0x1fff;d0+=h5*(5*r5);d0+=h6*(5*r4);d0+=h7*(5*r3);d0+=h8*(5*r2);d0+=h9*(5*r1);c+=(d0>>>13);d0&=0x1fff;d1=c;d1+=h0*r1;d1+=h1*r0;d1+=h2*(5*r9);d1+=h3*(5*r8);d1+=h4*(5*r7);c=(d1>>>13);d1&=0x1fff;d1+=h5*(5*r6);d1+=h6*(5*r5);d1+=h7*(5*r4);d1+=h8*(5*r3);d1+=h9*(5*r2);c+=(d1>>>13);d1&=0x1fff;d2=c;d2+=h0*r2;d2+=h1*r1;d2+=h2*r0;d2+=h3*(5*r9);d2+=h4*(5*r8);c=(d2>>>13);d2&=0x1fff;d2+=h5*(5*r7);d2+=h6*(5*r6);d2+=h7*(5*r5);d2+=h8*(5*r4);d2+=h9*(5*r3);c+=(d2>>>13);d2&=0x1fff;d3=c;d3+=h0*r3;d3+=h1*r2;d3+=h2*r1;d3+=h3*r0;d3+=h4*(5*r9);c=(d3>>>13);d3&=0x1fff;d3+=h5*(5*r8);d3+=h6*(5*r7);d3+=h7*(5*r6);d3+=h8*(5*r5);d3+=h9*(5*r4);c+=(d3>>>13);d3&=0x1fff;d4=c;d4+=h0*r4;d4+=h1*r3;d4+=h2*r2;d4+=h3*r1;d4+=h4*r0;c=(d4>>>13);d4&=0x1fff;d4+=h5*(5*r9);d4+=h6*(5*r8);d4+=h7*(5*r7);d4+=h8*(5*r6);d4+=h9*(5*r5);c+=(d4>>>13);d4&=0x1fff;d5=c;d5+=h0*r5;d5+=h1*r4;d5+=h2*r3;d5+=h3*r2;d5+=h4*r1;c=(d5>>>13);d5&=0x1fff;d5+=h5*r0;d5+=h6*(5*r9);d5+=h7*(5*r8);d5+=h8*(5*r7);d5+=h9*(5*r6);c+=(d5>>>13);d5&=0x1fff;d6=c;d6+=h0*r6;d6+=h1*r5;d6+=h2*r4;d6+=h3*r3;d6+=h4*r2;c=(d6>>>13);d6&=0x1fff;d6+=h5*r1;d6+=h6*r0;d6+=h7*(5*r9);d6+=h8*(5*r8);d6+=h9*(5*r7);c+=(d6>>>13);d6&=0x1fff;d7=c;d7+=h0*r7;d7+=h1*r6;d7+=h2*r5;d7+=h3*r4;d7+=h4*r3;c=(d7>>>13);d7&=0x1fff;d7+=h5*r2;d7+=h6*r1;d7+=h7*r0;d7+=h8*(5*r9);d7+=h9*(5*r8);c+=(d7>>>13);d7&=0x1fff;d8=c;d8+=h0*r8;d8+=h1*r7;d8+=h2*r6;d8+=h3*r5;d8+=h4*r4;c=(d8>>>13);d8&=0x1fff;d8+=h5*r3;d8+=h6*r2;d8+=h7*r1;d8+=h8*r0;d8+=h9*(5*r9);c+=(d8>>>13);d8&=0x1fff;d9=c;d9+=h0*r9;d9+=h1*r8;d9+=h2*r7;d9+=h3*r6;d9+=h4*r5;c=(d9>>>13);d9&=0x1fff;d9+=h5*r4;d9+=h6*r3;d9+=h7*r2;d9+=h8*r1;d9+=h9*r0;c+=(d9>>>13);d9&=0x1fff;c=(((c<<2)+c))|0;c=(c+d0)|0;d0=c&0x1fff;c=(c>>>13);d1+=c;h0=d0;h1=d1;h2=d2;h3=d3;h4=d4;h5=d5;h6=d6;h7=d7;h8=d8;h9=d9;mpos+=16;bytes-=16}
this.h[0]=h0;this.h[1]=h1;this.h[2]=h2;this.h[3]=h3;this.h[4]=h4;this.h[5]=h5;this.h[6]=h6;this.h[7]=h7;this.h[8]=h8;this.h[9]=h9};poly1305.prototype.finish=function(mac,macpos){var g=new Uint16Array(10);var c,mask,f,i;if(this.leftover){i=this.leftover;this.buffer[i++]=1;for(;i<16;i++)this.buffer[i]=0;this.fin=1;this.blocks(this.buffer,0,16)}
c=this.h[1]>>>13;this.h[1]&=0x1fff;for(i=2;i<10;i++){this.h[i]+=c;c=this.h[i]>>>13;this.h[i]&=0x1fff}
this.h[0]+=(c*5);c=this.h[0]>>>13;this.h[0]&=0x1fff;this.h[1]+=c;c=this.h[1]>>>13;this.h[1]&=0x1fff;this.h[2]+=c;g[0]=this.h[0]+5;c=g[0]>>>13;g[0]&=0x1fff;for(i=1;i<10;i++){g[i]=this.h[i]+c;c=g[i]>>>13;g[i]&=0x1fff}
g[9]-=(1<<13);mask=(c^1)-1;for(i=0;i<10;i++)g[i]&=mask;mask=~mask;for(i=0;i<10;i++)this.h[i]=(this.h[i]&mask)|g[i];this.h[0]=((this.h[0])|(this.h[1]<<13))&0xffff;this.h[1]=((this.h[1]>>>3)|(this.h[2]<<10))&0xffff;this.h[2]=((this.h[2]>>>6)|(this.h[3]<<7))&0xffff;this.h[3]=((this.h[3]>>>9)|(this.h[4]<<4))&0xffff;this.h[4]=((this.h[4]>>>12)|(this.h[5]<<1)|(this.h[6]<<14))&0xffff;this.h[5]=((this.h[6]>>>2)|(this.h[7]<<11))&0xffff;this.h[6]=((this.h[7]>>>5)|(this.h[8]<<8))&0xffff;this.h[7]=((this.h[8]>>>8)|(this.h[9]<<5))&0xffff;f=this.h[0]+this.pad[0];this.h[0]=f&0xffff;for(i=1;i<8;i++){f=(((this.h[i]+this.pad[i])|0)+(f>>>16))|0;this.h[i]=f&0xffff}
mac[macpos+0]=(this.h[0]>>>0)&0xff;mac[macpos+1]=(this.h[0]>>>8)&0xff;mac[macpos+2]=(this.h[1]>>>0)&0xff;mac[macpos+3]=(this.h[1]>>>8)&0xff;mac[macpos+4]=(this.h[2]>>>0)&0xff;mac[macpos+5]=(this.h[2]>>>8)&0xff;mac[macpos+6]=(this.h[3]>>>0)&0xff;mac[macpos+7]=(this.h[3]>>>8)&0xff;mac[macpos+8]=(this.h[4]>>>0)&0xff;mac[macpos+9]=(this.h[4]>>>8)&0xff;mac[macpos+10]=(this.h[5]>>>0)&0xff;mac[macpos+11]=(this.h[5]>>>8)&0xff;mac[macpos+12]=(this.h[6]>>>0)&0xff;mac[macpos+13]=(this.h[6]>>>8)&0xff;mac[macpos+14]=(this.h[7]>>>0)&0xff;mac[macpos+15]=(this.h[7]>>>8)&0xff};poly1305.prototype.update=function(m,mpos,bytes){var i,want;if(this.leftover){want=(16-this.leftover);if(want>bytes)
want=bytes;for(i=0;i<want;i++)
this.buffer[this.leftover+i]=m[mpos+i];bytes-=want;mpos+=want;this.leftover+=want;if(this.leftover<16)
return;this.blocks(this.buffer,0,16);this.leftover=0}
if(bytes>=16){want=bytes-(bytes%16);this.blocks(m,mpos,want);mpos+=want;bytes-=want}
if(bytes){for(i=0;i<bytes;i++)
this.buffer[this.leftover+i]=m[mpos+i];this.leftover+=bytes}};function crypto_onetimeauth(out,outpos,m,mpos,n,k){var s=new poly1305(k);s.update(m,mpos,n);s.finish(out,outpos);return 0}
function crypto_onetimeauth_verify(h,hpos,m,mpos,n,k){var x=new Uint8Array(16);crypto_onetimeauth(x,0,m,mpos,n,k);return crypto_verify_16(h,hpos,x,0)}
function crypto_secretbox(c,m,d,n,k){var i;if(d<32)return-1;crypto_stream_xor(c,0,m,0,d,n,k);crypto_onetimeauth(c,16,c,32,d-32,c);for(i=0;i<16;i++)c[i]=0;return 0}
function crypto_secretbox_open(m,c,d,n,k){var i;var x=new Uint8Array(32);if(d<32)return-1;crypto_stream(x,0,32,n,k);if(crypto_onetimeauth_verify(c,16,c,32,d-32,x)!==0)return-1;crypto_stream_xor(m,0,c,0,d,n,k);for(i=0;i<32;i++)m[i]=0;return 0}
function set25519(r,a){var i;for(i=0;i<16;i++)r[i]=a[i]|0}
function car25519(o){var i,v,c=1;for(i=0;i<16;i++){v=o[i]+c+65535;c=Math.floor(v/65536);o[i]=v-c*65536}
o[0]+=c-1+37*(c-1)}
function sel25519(p,q,b){var t,c=~(b-1);for(var i=0;i<16;i++){t=c&(p[i]^q[i]);p[i]^=t;q[i]^=t}}
function pack25519(o,n){var i,j,b;var m=gf(),t=gf();for(i=0;i<16;i++)t[i]=n[i];car25519(t);car25519(t);car25519(t);for(j=0;j<2;j++){m[0]=t[0]-0xffed;for(i=1;i<15;i++){m[i]=t[i]-0xffff-((m[i-1]>>16)&1);m[i-1]&=0xffff}
m[15]=t[15]-0x7fff-((m[14]>>16)&1);b=(m[15]>>16)&1;m[14]&=0xffff;sel25519(t,m,1-b)}
for(i=0;i<16;i++){o[2*i]=t[i]&0xff;o[2*i+1]=t[i]>>8}}
function neq25519(a,b){var c=new Uint8Array(32),d=new Uint8Array(32);pack25519(c,a);pack25519(d,b);return crypto_verify_32(c,0,d,0)}
function par25519(a){var d=new Uint8Array(32);pack25519(d,a);return d[0]&1}
function unpack25519(o,n){var i;for(i=0;i<16;i++)o[i]=n[2*i]+(n[2*i+1]<<8);o[15]&=0x7fff}
function A(o,a,b){for(var i=0;i<16;i++)o[i]=a[i]+b[i]}
function Z(o,a,b){for(var i=0;i<16;i++)o[i]=a[i]-b[i]}
function M(o,a,b){var v,c,t0=0,t1=0,t2=0,t3=0,t4=0,t5=0,t6=0,t7=0,t8=0,t9=0,t10=0,t11=0,t12=0,t13=0,t14=0,t15=0,t16=0,t17=0,t18=0,t19=0,t20=0,t21=0,t22=0,t23=0,t24=0,t25=0,t26=0,t27=0,t28=0,t29=0,t30=0,b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5],b6=b[6],b7=b[7],b8=b[8],b9=b[9],b10=b[10],b11=b[11],b12=b[12],b13=b[13],b14=b[14],b15=b[15];v=a[0];t0+=v*b0;t1+=v*b1;t2+=v*b2;t3+=v*b3;t4+=v*b4;t5+=v*b5;t6+=v*b6;t7+=v*b7;t8+=v*b8;t9+=v*b9;t10+=v*b10;t11+=v*b11;t12+=v*b12;t13+=v*b13;t14+=v*b14;t15+=v*b15;v=a[1];t1+=v*b0;t2+=v*b1;t3+=v*b2;t4+=v*b3;t5+=v*b4;t6+=v*b5;t7+=v*b6;t8+=v*b7;t9+=v*b8;t10+=v*b9;t11+=v*b10;t12+=v*b11;t13+=v*b12;t14+=v*b13;t15+=v*b14;t16+=v*b15;v=a[2];t2+=v*b0;t3+=v*b1;t4+=v*b2;t5+=v*b3;t6+=v*b4;t7+=v*b5;t8+=v*b6;t9+=v*b7;t10+=v*b8;t11+=v*b9;t12+=v*b10;t13+=v*b11;t14+=v*b12;t15+=v*b13;t16+=v*b14;t17+=v*b15;v=a[3];t3+=v*b0;t4+=v*b1;t5+=v*b2;t6+=v*b3;t7+=v*b4;t8+=v*b5;t9+=v*b6;t10+=v*b7;t11+=v*b8;t12+=v*b9;t13+=v*b10;t14+=v*b11;t15+=v*b12;t16+=v*b13;t17+=v*b14;t18+=v*b15;v=a[4];t4+=v*b0;t5+=v*b1;t6+=v*b2;t7+=v*b3;t8+=v*b4;t9+=v*b5;t10+=v*b6;t11+=v*b7;t12+=v*b8;t13+=v*b9;t14+=v*b10;t15+=v*b11;t16+=v*b12;t17+=v*b13;t18+=v*b14;t19+=v*b15;v=a[5];t5+=v*b0;t6+=v*b1;t7+=v*b2;t8+=v*b3;t9+=v*b4;t10+=v*b5;t11+=v*b6;t12+=v*b7;t13+=v*b8;t14+=v*b9;t15+=v*b10;t16+=v*b11;t17+=v*b12;t18+=v*b13;t19+=v*b14;t20+=v*b15;v=a[6];t6+=v*b0;t7+=v*b1;t8+=v*b2;t9+=v*b3;t10+=v*b4;t11+=v*b5;t12+=v*b6;t13+=v*b7;t14+=v*b8;t15+=v*b9;t16+=v*b10;t17+=v*b11;t18+=v*b12;t19+=v*b13;t20+=v*b14;t21+=v*b15;v=a[7];t7+=v*b0;t8+=v*b1;t9+=v*b2;t10+=v*b3;t11+=v*b4;t12+=v*b5;t13+=v*b6;t14+=v*b7;t15+=v*b8;t16+=v*b9;t17+=v*b10;t18+=v*b11;t19+=v*b12;t20+=v*b13;t21+=v*b14;t22+=v*b15;v=a[8];t8+=v*b0;t9+=v*b1;t10+=v*b2;t11+=v*b3;t12+=v*b4;t13+=v*b5;t14+=v*b6;t15+=v*b7;t16+=v*b8;t17+=v*b9;t18+=v*b10;t19+=v*b11;t20+=v*b12;t21+=v*b13;t22+=v*b14;t23+=v*b15;v=a[9];t9+=v*b0;t10+=v*b1;t11+=v*b2;t12+=v*b3;t13+=v*b4;t14+=v*b5;t15+=v*b6;t16+=v*b7;t17+=v*b8;t18+=v*b9;t19+=v*b10;t20+=v*b11;t21+=v*b12;t22+=v*b13;t23+=v*b14;t24+=v*b15;v=a[10];t10+=v*b0;t11+=v*b1;t12+=v*b2;t13+=v*b3;t14+=v*b4;t15+=v*b5;t16+=v*b6;t17+=v*b7;t18+=v*b8;t19+=v*b9;t20+=v*b10;t21+=v*b11;t22+=v*b12;t23+=v*b13;t24+=v*b14;t25+=v*b15;v=a[11];t11+=v*b0;t12+=v*b1;t13+=v*b2;t14+=v*b3;t15+=v*b4;t16+=v*b5;t17+=v*b6;t18+=v*b7;t19+=v*b8;t20+=v*b9;t21+=v*b10;t22+=v*b11;t23+=v*b12;t24+=v*b13;t25+=v*b14;t26+=v*b15;v=a[12];t12+=v*b0;t13+=v*b1;t14+=v*b2;t15+=v*b3;t16+=v*b4;t17+=v*b5;t18+=v*b6;t19+=v*b7;t20+=v*b8;t21+=v*b9;t22+=v*b10;t23+=v*b11;t24+=v*b12;t25+=v*b13;t26+=v*b14;t27+=v*b15;v=a[13];t13+=v*b0;t14+=v*b1;t15+=v*b2;t16+=v*b3;t17+=v*b4;t18+=v*b5;t19+=v*b6;t20+=v*b7;t21+=v*b8;t22+=v*b9;t23+=v*b10;t24+=v*b11;t25+=v*b12;t26+=v*b13;t27+=v*b14;t28+=v*b15;v=a[14];t14+=v*b0;t15+=v*b1;t16+=v*b2;t17+=v*b3;t18+=v*b4;t19+=v*b5;t20+=v*b6;t21+=v*b7;t22+=v*b8;t23+=v*b9;t24+=v*b10;t25+=v*b11;t26+=v*b12;t27+=v*b13;t28+=v*b14;t29+=v*b15;v=a[15];t15+=v*b0;t16+=v*b1;t17+=v*b2;t18+=v*b3;t19+=v*b4;t20+=v*b5;t21+=v*b6;t22+=v*b7;t23+=v*b8;t24+=v*b9;t25+=v*b10;t26+=v*b11;t27+=v*b12;t28+=v*b13;t29+=v*b14;t30+=v*b15;t0+=38*t16;t1+=38*t17;t2+=38*t18;t3+=38*t19;t4+=38*t20;t5+=38*t21;t6+=38*t22;t7+=38*t23;t8+=38*t24;t9+=38*t25;t10+=38*t26;t11+=38*t27;t12+=38*t28;t13+=38*t29;t14+=38*t30;c=1;v=t0+c+65535;c=Math.floor(v/65536);t0=v-c*65536;v=t1+c+65535;c=Math.floor(v/65536);t1=v-c*65536;v=t2+c+65535;c=Math.floor(v/65536);t2=v-c*65536;v=t3+c+65535;c=Math.floor(v/65536);t3=v-c*65536;v=t4+c+65535;c=Math.floor(v/65536);t4=v-c*65536;v=t5+c+65535;c=Math.floor(v/65536);t5=v-c*65536;v=t6+c+65535;c=Math.floor(v/65536);t6=v-c*65536;v=t7+c+65535;c=Math.floor(v/65536);t7=v-c*65536;v=t8+c+65535;c=Math.floor(v/65536);t8=v-c*65536;v=t9+c+65535;c=Math.floor(v/65536);t9=v-c*65536;v=t10+c+65535;c=Math.floor(v/65536);t10=v-c*65536;v=t11+c+65535;c=Math.floor(v/65536);t11=v-c*65536;v=t12+c+65535;c=Math.floor(v/65536);t12=v-c*65536;v=t13+c+65535;c=Math.floor(v/65536);t13=v-c*65536;v=t14+c+65535;c=Math.floor(v/65536);t14=v-c*65536;v=t15+c+65535;c=Math.floor(v/65536);t15=v-c*65536;t0+=c-1+37*(c-1);c=1;v=t0+c+65535;c=Math.floor(v/65536);t0=v-c*65536;v=t1+c+65535;c=Math.floor(v/65536);t1=v-c*65536;v=t2+c+65535;c=Math.floor(v/65536);t2=v-c*65536;v=t3+c+65535;c=Math.floor(v/65536);t3=v-c*65536;v=t4+c+65535;c=Math.floor(v/65536);t4=v-c*65536;v=t5+c+65535;c=Math.floor(v/65536);t5=v-c*65536;v=t6+c+65535;c=Math.floor(v/65536);t6=v-c*65536;v=t7+c+65535;c=Math.floor(v/65536);t7=v-c*65536;v=t8+c+65535;c=Math.floor(v/65536);t8=v-c*65536;v=t9+c+65535;c=Math.floor(v/65536);t9=v-c*65536;v=t10+c+65535;c=Math.floor(v/65536);t10=v-c*65536;v=t11+c+65535;c=Math.floor(v/65536);t11=v-c*65536;v=t12+c+65535;c=Math.floor(v/65536);t12=v-c*65536;v=t13+c+65535;c=Math.floor(v/65536);t13=v-c*65536;v=t14+c+65535;c=Math.floor(v/65536);t14=v-c*65536;v=t15+c+65535;c=Math.floor(v/65536);t15=v-c*65536;t0+=c-1+37*(c-1);o[0]=t0;o[1]=t1;o[2]=t2;o[3]=t3;o[4]=t4;o[5]=t5;o[6]=t6;o[7]=t7;o[8]=t8;o[9]=t9;o[10]=t10;o[11]=t11;o[12]=t12;o[13]=t13;o[14]=t14;o[15]=t15}
function S(o,a){M(o,a,a)}
function inv25519(o,i){var c=gf();var a;for(a=0;a<16;a++)c[a]=i[a];for(a=253;a>=0;a--){S(c,c);if(a!==2&&a!==4)M(c,c,i);}
for(a=0;a<16;a++)o[a]=c[a]}
function pow2523(o,i){var c=gf();var a;for(a=0;a<16;a++)c[a]=i[a];for(a=250;a>=0;a--){S(c,c);if(a!==1)M(c,c,i);}
for(a=0;a<16;a++)o[a]=c[a]}
function crypto_scalarmult(q,n,p){var z=new Uint8Array(32);var x=new Float64Array(80),r,i;var a=gf(),b=gf(),c=gf(),d=gf(),e=gf(),f=gf();for(i=0;i<31;i++)z[i]=n[i];z[31]=(n[31]&127)|64;z[0]&=248;unpack25519(x,p);for(i=0;i<16;i++){b[i]=x[i];d[i]=a[i]=c[i]=0}
a[0]=d[0]=1;for(i=254;i>=0;--i){r=(z[i>>>3]>>>(i&7))&1;sel25519(a,b,r);sel25519(c,d,r);A(e,a,c);Z(a,a,c);A(c,b,d);Z(b,b,d);S(d,e);S(f,a);M(a,c,a);M(c,b,e);A(e,a,c);Z(a,a,c);S(b,a);Z(c,d,f);M(a,c,_121665);A(a,a,d);M(c,c,a);M(a,d,f);M(d,b,x);S(b,e);sel25519(a,b,r);sel25519(c,d,r)}
for(i=0;i<16;i++){x[i+16]=a[i];x[i+32]=c[i];x[i+48]=b[i];x[i+64]=d[i]}
var x32=x.subarray(32);var x16=x.subarray(16);inv25519(x32,x32);M(x16,x16,x32);pack25519(q,x16);return 0}
function crypto_scalarmult_base(q,n){return crypto_scalarmult(q,n,_9)}
function crypto_box_keypair(y,x){randombytes(x,32);return crypto_scalarmult_base(y,x)}
function crypto_box_beforenm(k,y,x){var s=new Uint8Array(32);crypto_scalarmult(s,x,y);return crypto_core_hsalsa20(k,_0,s,sigma)}
var crypto_box_afternm=crypto_secretbox;var crypto_box_open_afternm=crypto_secretbox_open;function crypto_box(c,m,d,n,y,x){var k=new Uint8Array(32);crypto_box_beforenm(k,y,x);return crypto_box_afternm(c,m,d,n,k)}
function crypto_box_open(m,c,d,n,y,x){var k=new Uint8Array(32);crypto_box_beforenm(k,y,x);return crypto_box_open_afternm(m,c,d,n,k)}
var K=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0x0fc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x06ca6351,0xe003826f,0x14292967,0x0a0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x0654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x06f067aa,0x72176fba,0x0a637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function crypto_hashblocks_hl(hh,hl,m,n){var wh=new Int32Array(16),wl=new Int32Array(16),bh0,bh1,bh2,bh3,bh4,bh5,bh6,bh7,bl0,bl1,bl2,bl3,bl4,bl5,bl6,bl7,th,tl,i,j,h,l,a,b,c,d;var ah0=hh[0],ah1=hh[1],ah2=hh[2],ah3=hh[3],ah4=hh[4],ah5=hh[5],ah6=hh[6],ah7=hh[7],al0=hl[0],al1=hl[1],al2=hl[2],al3=hl[3],al4=hl[4],al5=hl[5],al6=hl[6],al7=hl[7];var pos=0;while(n>=128){for(i=0;i<16;i++){j=8*i+pos;wh[i]=(m[j+0]<<24)|(m[j+1]<<16)|(m[j+2]<<8)|m[j+3];wl[i]=(m[j+4]<<24)|(m[j+5]<<16)|(m[j+6]<<8)|m[j+7]}
for(i=0;i<80;i++){bh0=ah0;bh1=ah1;bh2=ah2;bh3=ah3;bh4=ah4;bh5=ah5;bh6=ah6;bh7=ah7;bl0=al0;bl1=al1;bl2=al2;bl3=al3;bl4=al4;bl5=al5;bl6=al6;bl7=al7;h=ah7;l=al7;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=((ah4>>>14)|(al4<<(32-14)))^((ah4>>>18)|(al4<<(32-18)))^((al4>>>(41-32))|(ah4<<(32-(41-32))));l=((al4>>>14)|(ah4<<(32-14)))^((al4>>>18)|(ah4<<(32-18)))^((ah4>>>(41-32))|(al4<<(32-(41-32))));a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;h=(ah4&ah5)^(~ah4&ah6);l=(al4&al5)^(~al4&al6);a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;h=K[i*2];l=K[i*2+1];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;h=wh[i%16];l=wl[i%16];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;th=c&0xffff|d<<16;tl=a&0xffff|b<<16;h=th;l=tl;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=((ah0>>>28)|(al0<<(32-28)))^((al0>>>(34-32))|(ah0<<(32-(34-32))))^((al0>>>(39-32))|(ah0<<(32-(39-32))));l=((al0>>>28)|(ah0<<(32-28)))^((ah0>>>(34-32))|(al0<<(32-(34-32))))^((ah0>>>(39-32))|(al0<<(32-(39-32))));a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;h=(ah0&ah1)^(ah0&ah2)^(ah1&ah2);l=(al0&al1)^(al0&al2)^(al1&al2);a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;bh7=(c&0xffff)|(d<<16);bl7=(a&0xffff)|(b<<16);h=bh3;l=bl3;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=th;l=tl;a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;bh3=(c&0xffff)|(d<<16);bl3=(a&0xffff)|(b<<16);ah1=bh0;ah2=bh1;ah3=bh2;ah4=bh3;ah5=bh4;ah6=bh5;ah7=bh6;ah0=bh7;al1=bl0;al2=bl1;al3=bl2;al4=bl3;al5=bl4;al6=bl5;al7=bl6;al0=bl7;if(i%16===15){for(j=0;j<16;j++){h=wh[j];l=wl[j];a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=wh[(j+9)%16];l=wl[(j+9)%16];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;th=wh[(j+1)%16];tl=wl[(j+1)%16];h=((th>>>1)|(tl<<(32-1)))^((th>>>8)|(tl<<(32-8)))^(th>>>7);l=((tl>>>1)|(th<<(32-1)))^((tl>>>8)|(th<<(32-8)))^((tl>>>7)|(th<<(32-7)));a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;th=wh[(j+14)%16];tl=wl[(j+14)%16];h=((th>>>19)|(tl<<(32-19)))^((tl>>>(61-32))|(th<<(32-(61-32))))^(th>>>6);l=((tl>>>19)|(th<<(32-19)))^((th>>>(61-32))|(tl<<(32-(61-32))))^((tl>>>6)|(th<<(32-6)));a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;wh[j]=(c&0xffff)|(d<<16);wl[j]=(a&0xffff)|(b<<16)}}}
h=ah0;l=al0;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[0];l=hl[0];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[0]=ah0=(c&0xffff)|(d<<16);hl[0]=al0=(a&0xffff)|(b<<16);h=ah1;l=al1;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[1];l=hl[1];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[1]=ah1=(c&0xffff)|(d<<16);hl[1]=al1=(a&0xffff)|(b<<16);h=ah2;l=al2;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[2];l=hl[2];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[2]=ah2=(c&0xffff)|(d<<16);hl[2]=al2=(a&0xffff)|(b<<16);h=ah3;l=al3;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[3];l=hl[3];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[3]=ah3=(c&0xffff)|(d<<16);hl[3]=al3=(a&0xffff)|(b<<16);h=ah4;l=al4;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[4];l=hl[4];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[4]=ah4=(c&0xffff)|(d<<16);hl[4]=al4=(a&0xffff)|(b<<16);h=ah5;l=al5;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[5];l=hl[5];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[5]=ah5=(c&0xffff)|(d<<16);hl[5]=al5=(a&0xffff)|(b<<16);h=ah6;l=al6;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[6];l=hl[6];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[6]=ah6=(c&0xffff)|(d<<16);hl[6]=al6=(a&0xffff)|(b<<16);h=ah7;l=al7;a=l&0xffff;b=l>>>16;c=h&0xffff;d=h>>>16;h=hh[7];l=hl[7];a+=l&0xffff;b+=l>>>16;c+=h&0xffff;d+=h>>>16;b+=a>>>16;c+=b>>>16;d+=c>>>16;hh[7]=ah7=(c&0xffff)|(d<<16);hl[7]=al7=(a&0xffff)|(b<<16);pos+=128;n-=128}
return n}
function crypto_hash(out,m,n){var hh=new Int32Array(8),hl=new Int32Array(8),x=new Uint8Array(256),i,b=n;hh[0]=0x6a09e667;hh[1]=0xbb67ae85;hh[2]=0x3c6ef372;hh[3]=0xa54ff53a;hh[4]=0x510e527f;hh[5]=0x9b05688c;hh[6]=0x1f83d9ab;hh[7]=0x5be0cd19;hl[0]=0xf3bcc908;hl[1]=0x84caa73b;hl[2]=0xfe94f82b;hl[3]=0x5f1d36f1;hl[4]=0xade682d1;hl[5]=0x2b3e6c1f;hl[6]=0xfb41bd6b;hl[7]=0x137e2179;crypto_hashblocks_hl(hh,hl,m,n);n%=128;for(i=0;i<n;i++)x[i]=m[b-n+i];x[n]=128;n=256-128*(n<112?1:0);x[n-9]=0;ts64(x,n-8,(b/0x20000000)|0,b<<3);crypto_hashblocks_hl(hh,hl,x,n);for(i=0;i<8;i++)ts64(out,8*i,hh[i],hl[i]);return 0}
function add(p,q){var a=gf(),b=gf(),c=gf(),d=gf(),e=gf(),f=gf(),g=gf(),h=gf(),t=gf();Z(a,p[1],p[0]);Z(t,q[1],q[0]);M(a,a,t);A(b,p[0],p[1]);A(t,q[0],q[1]);M(b,b,t);M(c,p[3],q[3]);M(c,c,D2);M(d,p[2],q[2]);A(d,d,d);Z(e,b,a);Z(f,d,c);A(g,d,c);A(h,b,a);M(p[0],e,f);M(p[1],h,g);M(p[2],g,f);M(p[3],e,h)}
function cswap(p,q,b){var i;for(i=0;i<4;i++){sel25519(p[i],q[i],b)}}
function pack(r,p){var tx=gf(),ty=gf(),zi=gf();inv25519(zi,p[2]);M(tx,p[0],zi);M(ty,p[1],zi);pack25519(r,ty);r[31]^=par25519(tx)<<7}
function scalarmult(p,q,s){var b,i;set25519(p[0],gf0);set25519(p[1],gf1);set25519(p[2],gf1);set25519(p[3],gf0);for(i=255;i>=0;--i){b=(s[(i/8)|0]>>(i&7))&1;cswap(p,q,b);add(q,p);add(p,p);cswap(p,q,b)}}
function scalarbase(p,s){var q=[gf(),gf(),gf(),gf()];set25519(q[0],X);set25519(q[1],Y);set25519(q[2],gf1);M(q[3],X,Y);scalarmult(p,q,s)}
function crypto_sign_keypair(pk,sk,seeded){var d=new Uint8Array(64);var p=[gf(),gf(),gf(),gf()];var i;if(!seeded)randombytes(sk,32);crypto_hash(d,sk,32);d[0]&=248;d[31]&=127;d[31]|=64;scalarbase(p,d);pack(pk,p);for(i=0;i<32;i++)sk[i+32]=pk[i];return 0}
var L=new Float64Array([0xed,0xd3,0xf5,0x5c,0x1a,0x63,0x12,0x58,0xd6,0x9c,0xf7,0xa2,0xde,0xf9,0xde,0x14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0x10]);function modL(r,x){var carry,i,j,k;for(i=63;i>=32;--i){carry=0;for(j=i-32,k=i-12;j<k;++j){x[j]+=carry-16*x[i]*L[j-(i-32)];carry=Math.floor((x[j]+128)/256);x[j]-=carry*256}
x[j]+=carry;x[i]=0}
carry=0;for(j=0;j<32;j++){x[j]+=carry-(x[31]>>4)*L[j];carry=x[j]>>8;x[j]&=255}
for(j=0;j<32;j++)x[j]-=carry*L[j];for(i=0;i<32;i++){x[i+1]+=x[i]>>8;r[i]=x[i]&255}}
function reduce(r){var x=new Float64Array(64),i;for(i=0;i<64;i++)x[i]=r[i];for(i=0;i<64;i++)r[i]=0;modL(r,x)}
function crypto_sign(sm,m,n,sk){var d=new Uint8Array(64),h=new Uint8Array(64),r=new Uint8Array(64);var i,j,x=new Float64Array(64);var p=[gf(),gf(),gf(),gf()];crypto_hash(d,sk,32);d[0]&=248;d[31]&=127;d[31]|=64;var smlen=n+64;for(i=0;i<n;i++)sm[64+i]=m[i];for(i=0;i<32;i++)sm[32+i]=d[32+i];crypto_hash(r,sm.subarray(32),n+32);reduce(r);scalarbase(p,r);pack(sm,p);for(i=32;i<64;i++)sm[i]=sk[i];crypto_hash(h,sm,n+64);reduce(h);for(i=0;i<64;i++)x[i]=0;for(i=0;i<32;i++)x[i]=r[i];for(i=0;i<32;i++){for(j=0;j<32;j++){x[i+j]+=h[i]*d[j]}}
modL(sm.subarray(32),x);return smlen}
function unpackneg(r,p){var t=gf(),chk=gf(),num=gf(),den=gf(),den2=gf(),den4=gf(),den6=gf();set25519(r[2],gf1);unpack25519(r[1],p);S(num,r[1]);M(den,num,D);Z(num,num,r[2]);A(den,r[2],den);S(den2,den);S(den4,den2);M(den6,den4,den2);M(t,den6,num);M(t,t,den);pow2523(t,t);M(t,t,num);M(t,t,den);M(t,t,den);M(r[0],t,den);S(chk,r[0]);M(chk,chk,den);if(neq25519(chk,num))M(r[0],r[0],I);S(chk,r[0]);M(chk,chk,den);if(neq25519(chk,num))return-1;if(par25519(r[0])===(p[31]>>7))Z(r[0],gf0,r[0]);M(r[3],r[0],r[1]);return 0}
function crypto_sign_open(m,sm,n,pk){var i;var t=new Uint8Array(32),h=new Uint8Array(64);var p=[gf(),gf(),gf(),gf()],q=[gf(),gf(),gf(),gf()];if(n<64)return-1;if(unpackneg(q,pk))return-1;for(i=0;i<n;i++)m[i]=sm[i];for(i=0;i<32;i++)m[i+32]=pk[i];crypto_hash(h,m,n);reduce(h);scalarmult(p,q,h);scalarbase(q,sm.subarray(32));add(p,q);pack(t,p);n-=64;if(crypto_verify_32(sm,0,t,0)){for(i=0;i<n;i++)m[i]=0;return-1}
for(i=0;i<n;i++)m[i]=sm[i+64];return n}
var crypto_secretbox_KEYBYTES=32,crypto_secretbox_NONCEBYTES=24,crypto_secretbox_ZEROBYTES=32,crypto_secretbox_BOXZEROBYTES=16,crypto_scalarmult_BYTES=32,crypto_scalarmult_SCALARBYTES=32,crypto_box_PUBLICKEYBYTES=32,crypto_box_SECRETKEYBYTES=32,crypto_box_BEFORENMBYTES=32,crypto_box_NONCEBYTES=crypto_secretbox_NONCEBYTES,crypto_box_ZEROBYTES=crypto_secretbox_ZEROBYTES,crypto_box_BOXZEROBYTES=crypto_secretbox_BOXZEROBYTES,crypto_sign_BYTES=64,crypto_sign_PUBLICKEYBYTES=32,crypto_sign_SECRETKEYBYTES=64,crypto_sign_SEEDBYTES=32,crypto_hash_BYTES=64;nacl.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:crypto_box_afternm,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:crypto_secretbox_KEYBYTES,crypto_secretbox_NONCEBYTES:crypto_secretbox_NONCEBYTES,crypto_secretbox_ZEROBYTES:crypto_secretbox_ZEROBYTES,crypto_secretbox_BOXZEROBYTES:crypto_secretbox_BOXZEROBYTES,crypto_scalarmult_BYTES:crypto_scalarmult_BYTES,crypto_scalarmult_SCALARBYTES:crypto_scalarmult_SCALARBYTES,crypto_box_PUBLICKEYBYTES:crypto_box_PUBLICKEYBYTES,crypto_box_SECRETKEYBYTES:crypto_box_SECRETKEYBYTES,crypto_box_BEFORENMBYTES:crypto_box_BEFORENMBYTES,crypto_box_NONCEBYTES:crypto_box_NONCEBYTES,crypto_box_ZEROBYTES:crypto_box_ZEROBYTES,crypto_box_BOXZEROBYTES:crypto_box_BOXZEROBYTES,crypto_sign_BYTES:crypto_sign_BYTES,crypto_sign_PUBLICKEYBYTES:crypto_sign_PUBLICKEYBYTES,crypto_sign_SECRETKEYBYTES:crypto_sign_SECRETKEYBYTES,crypto_sign_SEEDBYTES:crypto_sign_SEEDBYTES,crypto_hash_BYTES:crypto_hash_BYTES,gf:gf,D:D,L:L,pack25519:pack25519,unpack25519:unpack25519,M:M,A:A,S:S,Z:Z,pow2523:pow2523,add:add,set25519:set25519,modL:modL,scalarmult:scalarmult,scalarbase:scalarbase,};function checkLengths(k,n){if(k.length!==crypto_secretbox_KEYBYTES)throw new Error('bad key size');if(n.length!==crypto_secretbox_NONCEBYTES)throw new Error('bad nonce size');}
function checkBoxLengths(pk,sk){if(pk.length!==crypto_box_PUBLICKEYBYTES)throw new Error('bad public key size');if(sk.length!==crypto_box_SECRETKEYBYTES)throw new Error('bad secret key size');}
function checkArrayTypes(){for(var i=0;i<arguments.length;i++){if(!(arguments[i]instanceof Uint8Array))
throw new TypeError('unexpected type, use Uint8Array');}}
function cleanup(arr){for(var i=0;i<arr.length;i++)arr[i]=0}
nacl.randomBytes=function(n){var b=new Uint8Array(n);randombytes(b,n);return b};nacl.secretbox=function(msg,nonce,key){checkArrayTypes(msg,nonce,key);checkLengths(key,nonce);var m=new Uint8Array(crypto_secretbox_ZEROBYTES+msg.length);var c=new Uint8Array(m.length);for(var i=0;i<msg.length;i++)m[i+crypto_secretbox_ZEROBYTES]=msg[i];crypto_secretbox(c,m,m.length,nonce,key);return c.subarray(crypto_secretbox_BOXZEROBYTES)};nacl.secretbox.open=function(box,nonce,key){checkArrayTypes(box,nonce,key);checkLengths(key,nonce);var c=new Uint8Array(crypto_secretbox_BOXZEROBYTES+box.length);var m=new Uint8Array(c.length);for(var i=0;i<box.length;i++)c[i+crypto_secretbox_BOXZEROBYTES]=box[i];if(c.length<32)return null;if(crypto_secretbox_open(m,c,c.length,nonce,key)!==0)return null;return m.subarray(crypto_secretbox_ZEROBYTES)};nacl.secretbox.keyLength=crypto_secretbox_KEYBYTES;nacl.secretbox.nonceLength=crypto_secretbox_NONCEBYTES;nacl.secretbox.overheadLength=crypto_secretbox_BOXZEROBYTES;nacl.scalarMult=function(n,p){checkArrayTypes(n,p);if(n.length!==crypto_scalarmult_SCALARBYTES)throw new Error('bad n size');if(p.length!==crypto_scalarmult_BYTES)throw new Error('bad p size');var q=new Uint8Array(crypto_scalarmult_BYTES);crypto_scalarmult(q,n,p);return q};nacl.scalarMult.base=function(n){checkArrayTypes(n);if(n.length!==crypto_scalarmult_SCALARBYTES)throw new Error('bad n size');var q=new Uint8Array(crypto_scalarmult_BYTES);crypto_scalarmult_base(q,n);return q};nacl.scalarMult.scalarLength=crypto_scalarmult_SCALARBYTES;nacl.scalarMult.groupElementLength=crypto_scalarmult_BYTES;nacl.box=function(msg,nonce,publicKey,secretKey){var k=nacl.box.before(publicKey,secretKey);return nacl.secretbox(msg,nonce,k)};nacl.box.before=function(publicKey,secretKey){checkArrayTypes(publicKey,secretKey);checkBoxLengths(publicKey,secretKey);var k=new Uint8Array(crypto_box_BEFORENMBYTES);crypto_box_beforenm(k,publicKey,secretKey);return k};nacl.box.after=nacl.secretbox;nacl.box.open=function(msg,nonce,publicKey,secretKey){var k=nacl.box.before(publicKey,secretKey);return nacl.secretbox.open(msg,nonce,k)};nacl.box.open.after=nacl.secretbox.open;nacl.box.keyPair=function(){var pk=new Uint8Array(crypto_box_PUBLICKEYBYTES);var sk=new Uint8Array(crypto_box_SECRETKEYBYTES);crypto_box_keypair(pk,sk);return{publicKey:pk,secretKey:sk}};nacl.box.keyPair.fromSecretKey=function(secretKey){checkArrayTypes(secretKey);if(secretKey.length!==crypto_box_SECRETKEYBYTES)
throw new Error('bad secret key size');var pk=new Uint8Array(crypto_box_PUBLICKEYBYTES);crypto_scalarmult_base(pk,secretKey);return{publicKey:pk,secretKey:new Uint8Array(secretKey)}};nacl.box.publicKeyLength=crypto_box_PUBLICKEYBYTES;nacl.box.secretKeyLength=crypto_box_SECRETKEYBYTES;nacl.box.sharedKeyLength=crypto_box_BEFORENMBYTES;nacl.box.nonceLength=crypto_box_NONCEBYTES;nacl.box.overheadLength=nacl.secretbox.overheadLength;nacl.sign=function(msg,secretKey){checkArrayTypes(msg,secretKey);if(secretKey.length!==crypto_sign_SECRETKEYBYTES)
throw new Error('bad secret key size');var signedMsg=new Uint8Array(crypto_sign_BYTES+msg.length);crypto_sign(signedMsg,msg,msg.length,secretKey);return signedMsg};nacl.sign.open=function(signedMsg,publicKey){checkArrayTypes(signedMsg,publicKey);if(publicKey.length!==crypto_sign_PUBLICKEYBYTES)
throw new Error('bad public key size');var tmp=new Uint8Array(signedMsg.length);var mlen=crypto_sign_open(tmp,signedMsg,signedMsg.length,publicKey);if(mlen<0)return null;var m=new Uint8Array(mlen);for(var i=0;i<m.length;i++)m[i]=tmp[i];return m};nacl.sign.detached=function(msg,secretKey){var signedMsg=nacl.sign(msg,secretKey);var sig=new Uint8Array(crypto_sign_BYTES);for(var i=0;i<sig.length;i++)sig[i]=signedMsg[i];return sig};nacl.sign.detached.verify=function(msg,sig,publicKey){checkArrayTypes(msg,sig,publicKey);if(sig.length!==crypto_sign_BYTES)
throw new Error('bad signature size');if(publicKey.length!==crypto_sign_PUBLICKEYBYTES)
throw new Error('bad public key size');var sm=new Uint8Array(crypto_sign_BYTES+msg.length);var m=new Uint8Array(crypto_sign_BYTES+msg.length);var i;for(i=0;i<crypto_sign_BYTES;i++)sm[i]=sig[i];for(i=0;i<msg.length;i++)sm[i+crypto_sign_BYTES]=msg[i];return(crypto_sign_open(m,sm,sm.length,publicKey)>=0)};nacl.sign.keyPair=function(){var pk=new Uint8Array(crypto_sign_PUBLICKEYBYTES);var sk=new Uint8Array(crypto_sign_SECRETKEYBYTES);crypto_sign_keypair(pk,sk);return{publicKey:pk,secretKey:sk}};nacl.sign.keyPair.fromSecretKey=function(secretKey){checkArrayTypes(secretKey);if(secretKey.length!==crypto_sign_SECRETKEYBYTES)
throw new Error('bad secret key size');var pk=new Uint8Array(crypto_sign_PUBLICKEYBYTES);for(var i=0;i<pk.length;i++)pk[i]=secretKey[32+i];return{publicKey:pk,secretKey:new Uint8Array(secretKey)}};nacl.sign.keyPair.fromSeed=function(seed){checkArrayTypes(seed);if(seed.length!==crypto_sign_SEEDBYTES)
throw new Error('bad seed size');var pk=new Uint8Array(crypto_sign_PUBLICKEYBYTES);var sk=new Uint8Array(crypto_sign_SECRETKEYBYTES);for(var i=0;i<32;i++)sk[i]=seed[i];crypto_sign_keypair(pk,sk,!0);return{publicKey:pk,secretKey:sk}};nacl.sign.publicKeyLength=crypto_sign_PUBLICKEYBYTES;nacl.sign.secretKeyLength=crypto_sign_SECRETKEYBYTES;nacl.sign.seedLength=crypto_sign_SEEDBYTES;nacl.sign.signatureLength=crypto_sign_BYTES;nacl.hash=function(msg){checkArrayTypes(msg);var h=new Uint8Array(crypto_hash_BYTES);crypto_hash(h,msg,msg.length);return h};nacl.hash.hashLength=crypto_hash_BYTES;nacl.verify=function(x,y){checkArrayTypes(x,y);if(x.length===0||y.length===0)return!1;if(x.length!==y.length)return!1;return(vn(x,0,y,0,x.length)===0)?!0:!1};nacl.setPRNG=function(fn){randombytes=fn};(function(){var crypto=typeof self!=='undefined'?(self.crypto||self.msCrypto):null;if(crypto&&crypto.getRandomValues){var QUOTA=65536;nacl.setPRNG(function(x,n){var i,v=new Uint8Array(n);for(i=0;i<n;i+=QUOTA){crypto.getRandomValues(v.subarray(i,i+Math.min(n-i,QUOTA)))}
for(i=0;i<n;i++)x[i]=v[i];cleanup(v)})}else if(typeof require!=='undefined'){crypto=require('crypto');if(crypto&&crypto.randomBytes){nacl.setPRNG(function(x,n){var i,v=crypto.randomBytes(n);for(i=0;i<n;i++)x[i]=v[i];cleanup(v)})}}})()})(typeof module!=='undefined'&&module.exports?module.exports:(self.nacl=self.nacl||{}))},{"crypto":2}],353:[function(require,module,exports){
/**
 * @file Web Cryptography API shim
 * @author Artem S Vybornov <vybornov@gmail.com>
 * @license MIT
 */
(function(global,factory){if(typeof define==='function'&&define.amd){define([],function(){return factory(global)})}else if(typeof module==='object'&&module.exports){module.exports=factory(global)}else{factory(global)}}(typeof self!=='undefined'?self:this,function(global){'use strict';if(typeof Promise!=='function')
throw "Promise support required";var _crypto=global.crypto||global.msCrypto;if(!_crypto)return;var _subtle=_crypto.subtle||_crypto.webkitSubtle;if(!_subtle)return;var _Crypto=global.Crypto||_crypto.constructor||Object,_SubtleCrypto=global.SubtleCrypto||_subtle.constructor||Object,_CryptoKey=global.CryptoKey||global.Key||Object;var isEdge=global.navigator.userAgent.indexOf('Edge/')>-1;var isIE=!!global.msCrypto&&!isEdge;var isWebkit=!_crypto.subtle&&!!_crypto.webkitSubtle;if(!isIE&&!isWebkit)return;function s2a(s){return btoa(s).replace(/\=+$/,'').replace(/\+/g,'-').replace(/\//g,'_')}
function a2s(s){s+='===',s=s.slice(0,-s.length%4);return atob(s.replace(/-/g,'+').replace(/_/g,'/'))}
function s2b(s){var b=new Uint8Array(s.length);for(var i=0;i<s.length;i++)b[i]=s.charCodeAt(i);return b}
function b2s(b){if(b instanceof ArrayBuffer)b=new Uint8Array(b);return String.fromCharCode.apply(String,b)}
function alg(a){var r={'name':(a.name||a||'').toUpperCase().replace('V','v')};switch(r.name){case 'SHA-1':case 'SHA-256':case 'SHA-384':case 'SHA-512':break;case 'AES-CBC':case 'AES-GCM':case 'AES-KW':if(a.length)r.length=a.length;break;case 'HMAC':if(a.hash)r.hash=alg(a.hash);if(a.length)r.length=a.length;break;case 'RSAES-PKCS1-v1_5':if(a.publicExponent)r.publicExponent=new Uint8Array(a.publicExponent);if(a.modulusLength)r.modulusLength=a.modulusLength;break;case 'RSASSA-PKCS1-v1_5':case 'RSA-OAEP':if(a.hash)r.hash=alg(a.hash);if(a.publicExponent)r.publicExponent=new Uint8Array(a.publicExponent);if(a.modulusLength)r.modulusLength=a.modulusLength;break;default:throw new SyntaxError("Bad algorithm name")}
return r};function jwkAlg(a){return{'HMAC':{'SHA-1':'HS1','SHA-256':'HS256','SHA-384':'HS384','SHA-512':'HS512',},'RSASSA-PKCS1-v1_5':{'SHA-1':'RS1','SHA-256':'RS256','SHA-384':'RS384','SHA-512':'RS512',},'RSAES-PKCS1-v1_5':{'':'RSA1_5',},'RSA-OAEP':{'SHA-1':'RSA-OAEP','SHA-256':'RSA-OAEP-256',},'AES-KW':{'128':'A128KW','192':'A192KW','256':'A256KW',},'AES-GCM':{'128':'A128GCM','192':'A192GCM','256':'A256GCM',},'AES-CBC':{'128':'A128CBC','192':'A192CBC','256':'A256CBC',},}[a.name][(a.hash||{}).name||a.length||'']}
function b2jwk(k){if(k instanceof ArrayBuffer||k instanceof Uint8Array)k=JSON.parse(decodeURIComponent(escape(b2s(k))));var jwk={'kty':k.kty,'alg':k.alg,'ext':k.ext||k.extractable};switch(jwk.kty){case 'oct':jwk.k=k.k;case 'RSA':['n','e','d','p','q','dp','dq','qi','oth'].forEach(function(x){if(x in k)jwk[x]=k[x]});break;default:throw new TypeError("Unsupported key type")}
return jwk}
function jwk2b(k){var jwk=b2jwk(k);if(isIE)jwk.extractable=jwk.ext,delete jwk.ext;return s2b(unescape(encodeURIComponent(JSON.stringify(jwk)))).buffer}
function pkcs2jwk(k){var info=b2der(k),prv=!1;if(info.length>2)prv=!0,info.shift();var jwk={'ext':!0};switch(info[0][0]){case '1.2.840.113549.1.1.1':var rsaComp=['n','e','d','p','q','dp','dq','qi'],rsaKey=b2der(info[1]);if(prv)rsaKey.shift();for(var i=0;i<rsaKey.length;i++){if(!rsaKey[i][0])rsaKey[i]=rsaKey[i].subarray(1);jwk[rsaComp[i]]=s2a(b2s(rsaKey[i]))}
jwk.kty='RSA';break;default:throw new TypeError("Unsupported key type")}
return jwk}
function jwk2pkcs(k){var key,info=[['',null]],prv=!1;switch(k.kty){case 'RSA':var rsaComp=['n','e','d','p','q','dp','dq','qi'],rsaKey=[];for(var i=0;i<rsaComp.length;i++){if(!(rsaComp[i]in k))break;var b=rsaKey[i]=s2b(a2s(k[rsaComp[i]]));if(b[0]&0x80)rsaKey[i]=new Uint8Array(b.length+1),rsaKey[i].set(b,1);}
if(rsaKey.length>2)prv=!0,rsaKey.unshift(new Uint8Array([0]));info[0][0]='1.2.840.113549.1.1.1';key=rsaKey;break;default:throw new TypeError("Unsupported key type")}
info.push(new Uint8Array(der2b(key)).buffer);if(!prv)info[1]={'tag':0x03,'value':info[1]};else info.unshift(new Uint8Array([0]));return new Uint8Array(der2b(info)).buffer}
var oid2str={'KoZIhvcNAQEB':'1.2.840.113549.1.1.1'},str2oid={'1.2.840.113549.1.1.1':'KoZIhvcNAQEB'};function b2der(buf,ctx){if(buf instanceof ArrayBuffer)buf=new Uint8Array(buf);if(!ctx)ctx={pos:0,end:buf.length};if(ctx.end-ctx.pos<2||ctx.end>buf.length)throw new RangeError("Malformed DER");var tag=buf[ctx.pos++],len=buf[ctx.pos++];if(len>=0x80){len&=0x7f;if(ctx.end-ctx.pos<len)throw new RangeError("Malformed DER");for(var xlen=0;len--;)xlen<<=8,xlen|=buf[ctx.pos++];len=xlen}
if(ctx.end-ctx.pos<len)throw new RangeError("Malformed DER");var rv;switch(tag){case 0x02:rv=buf.subarray(ctx.pos,ctx.pos+=len);break;case 0x03:if(buf[ctx.pos++])throw new Error("Unsupported bit string");len--;case 0x04:rv=new Uint8Array(buf.subarray(ctx.pos,ctx.pos+=len)).buffer;break;case 0x05:rv=null;break;case 0x06:var oid=btoa(b2s(buf.subarray(ctx.pos,ctx.pos+=len)));if(!(oid in oid2str))throw new Error("Unsupported OBJECT ID "+oid);rv=oid2str[oid];break;case 0x30:rv=[];for(var end=ctx.pos+len;ctx.pos<end;)rv.push(b2der(buf,ctx));break;default:throw new Error("Unsupported DER tag 0x"+tag.toString(16))}
return rv}
function der2b(val,buf){if(!buf)buf=[];var tag=0,len=0,pos=buf.length+2;buf.push(0,0);if(val instanceof Uint8Array){tag=0x02,len=val.length;for(var i=0;i<len;i++)buf.push(val[i]);}else if(val instanceof ArrayBuffer){tag=0x04,len=val.byteLength,val=new Uint8Array(val);for(var i=0;i<len;i++)buf.push(val[i]);}else if(val===null){tag=0x05,len=0}else if(typeof val==='string'&&val in str2oid){var oid=s2b(atob(str2oid[val]));tag=0x06,len=oid.length;for(var i=0;i<len;i++)buf.push(oid[i]);}else if(val instanceof Array){for(var i=0;i<val.length;i++)der2b(val[i],buf);tag=0x30,len=buf.length-pos}else if(typeof val==='object'&&val.tag===0x03&&val.value instanceof ArrayBuffer){val=new Uint8Array(val.value),tag=0x03,len=val.byteLength;buf.push(0);for(var i=0;i<len;i++)buf.push(val[i]);len++}else{throw new Error("Unsupported DER value "+val)}
if(len>=0x80){var xlen=len,len=4;buf.splice(pos,0,(xlen>>24)&0xff,(xlen>>16)&0xff,(xlen>>8)&0xff,xlen&0xff);while(len>1&&!(xlen>>24))xlen<<=8,len--;if(len<4)buf.splice(pos,4-len);len|=0x80}
buf.splice(pos-2,2,tag,len);return buf}
function CryptoKey(key,alg,ext,use){Object.defineProperties(this,{_key:{value:key},type:{value:key.type,enumerable:!0,},extractable:{value:(ext===undefined)?key.extractable:ext,enumerable:!0,},algorithm:{value:(alg===undefined)?key.algorithm:alg,enumerable:!0,},usages:{value:(use===undefined)?key.usages:use,enumerable:!0,},})}
function isPubKeyUse(u){return u==='verify'||u==='encrypt'||u==='wrapKey'}
function isPrvKeyUse(u){return u==='sign'||u==='decrypt'||u==='unwrapKey'}['generateKey','importKey','unwrapKey'].forEach(function(m){var _fn=_subtle[m];_subtle[m]=function(a,b,c){var args=[].slice.call(arguments),ka,kx,ku;switch(m){case 'generateKey':ka=alg(a),kx=b,ku=c;break;case 'importKey':ka=alg(c),kx=args[3],ku=args[4];if(a==='jwk'){b=b2jwk(b);if(!b.alg)b.alg=jwkAlg(ka);if(!b.key_ops)b.key_ops=(b.kty!=='oct')?('d' in b)?ku.filter(isPrvKeyUse):ku.filter(isPubKeyUse):ku.slice();args[1]=jwk2b(b)}
break;case 'unwrapKey':ka=args[4],kx=args[5],ku=args[6];args[2]=c._key;break}
if(m==='generateKey'&&ka.name==='HMAC'&&ka.hash){ka.length=ka.length||{'SHA-1':512,'SHA-256':512,'SHA-384':1024,'SHA-512':1024}[ka.hash.name];return _subtle.importKey('raw',_crypto.getRandomValues(new Uint8Array((ka.length+7)>>3)),ka,kx,ku)}
if(isWebkit&&m==='generateKey'&&ka.name==='RSASSA-PKCS1-v1_5'&&(!ka.modulusLength||ka.modulusLength>=2048)){a=alg(a),a.name='RSAES-PKCS1-v1_5',delete a.hash;return _subtle.generateKey(a,!0,['encrypt','decrypt']).then(function(k){return Promise.all([_subtle.exportKey('jwk',k.publicKey),_subtle.exportKey('jwk',k.privateKey),])}).then(function(keys){keys[0].alg=keys[1].alg=jwkAlg(ka);keys[0].key_ops=ku.filter(isPubKeyUse),keys[1].key_ops=ku.filter(isPrvKeyUse);return Promise.all([_subtle.importKey('jwk',keys[0],ka,!0,keys[0].key_ops),_subtle.importKey('jwk',keys[1],ka,kx,keys[1].key_ops),])}).then(function(keys){return{publicKey:keys[0],privateKey:keys[1],}})}
if((isWebkit||(isIE&&(ka.hash||{}).name==='SHA-1'))&&m==='importKey'&&a==='jwk'&&ka.name==='HMAC'&&b.kty==='oct'){return _subtle.importKey('raw',s2b(a2s(b.k)),c,args[3],args[4])}
if(isWebkit&&m==='importKey'&&(a==='spki'||a==='pkcs8')){return _subtle.importKey('jwk',pkcs2jwk(b),c,args[3],args[4])}
if(isIE&&m==='unwrapKey'){return _subtle.decrypt(args[3],c,b).then(function(k){return _subtle.importKey(a,k,args[4],args[5],args[6])})}
var op;try{op=_fn.apply(_subtle,args)}catch(e){return Promise.reject(e)}
if(isIE){op=new Promise(function(res,rej){op.onabort=op.onerror=function(e){rej(e)};op.oncomplete=function(r){res(r.target.result)}})}
op=op.then(function(k){if(ka.name==='HMAC'){if(!ka.length)ka.length=8*k.algorithm.length}
if(ka.name.search('RSA')==0){if(!ka.modulusLength)ka.modulusLength=(k.publicKey||k).algorithm.modulusLength;if(!ka.publicExponent)ka.publicExponent=(k.publicKey||k).algorithm.publicExponent}
if(k.publicKey&&k.privateKey){k={publicKey:new CryptoKey(k.publicKey,ka,kx,ku.filter(isPubKeyUse)),privateKey:new CryptoKey(k.privateKey,ka,kx,ku.filter(isPrvKeyUse)),}}else{k=new CryptoKey(k,ka,kx,ku)}
return k});return op}});['exportKey','wrapKey'].forEach(function(m){var _fn=_subtle[m];_subtle[m]=function(a,b,c){var args=[].slice.call(arguments);switch(m){case 'exportKey':args[1]=b._key;break;case 'wrapKey':args[1]=b._key,args[2]=c._key;break}
if((isWebkit||(isIE&&(b.algorithm.hash||{}).name==='SHA-1'))&&m==='exportKey'&&a==='jwk'&&b.algorithm.name==='HMAC'){args[0]='raw'}
if(isWebkit&&m==='exportKey'&&(a==='spki'||a==='pkcs8')){args[0]='jwk'}
if(isIE&&m==='wrapKey'){return _subtle.exportKey(a,b).then(function(k){if(a==='jwk')k=s2b(unescape(encodeURIComponent(JSON.stringify(b2jwk(k)))));return _subtle.encrypt(args[3],c,k)})}
var op;try{op=_fn.apply(_subtle,args)}catch(e){return Promise.reject(e)}
if(isIE){op=new Promise(function(res,rej){op.onabort=op.onerror=function(e){rej(e)};op.oncomplete=function(r){res(r.target.result)}})}
if(m==='exportKey'&&a==='jwk'){op=op.then(function(k){if((isWebkit||(isIE&&(b.algorithm.hash||{}).name==='SHA-1'))&&b.algorithm.name==='HMAC'){return{'kty':'oct','alg':jwkAlg(b.algorithm),'key_ops':b.usages.slice(),'ext':!0,'k':s2a(b2s(k))}}
k=b2jwk(k);if(!k.alg)k.alg=jwkAlg(b.algorithm);if(!k.key_ops)k.key_ops=(b.type==='public')?b.usages.filter(isPubKeyUse):(b.type==='private')?b.usages.filter(isPrvKeyUse):b.usages.slice();return k})}
if(isWebkit&&m==='exportKey'&&(a==='spki'||a==='pkcs8')){op=op.then(function(k){k=jwk2pkcs(b2jwk(k));return k})}
return op}});['encrypt','decrypt','sign','verify'].forEach(function(m){var _fn=_subtle[m];_subtle[m]=function(a,b,c,d){if(isIE&&(!c.byteLength||(d&&!d.byteLength)))
throw new Error("Empty input is not allowed");var args=[].slice.call(arguments),ka=alg(a);if(isIE&&(m==='sign'||m==='verify')&&(a==='RSASSA-PKCS1-v1_5'||a==='HMAC')){args[0]={name:a}}
if(isIE&&b.algorithm.hash){args[0].hash=args[0].hash||b.algorithm.hash}
if(isIE&&m==='decrypt'&&ka.name==='AES-GCM'){var tl=a.tagLength>>3;args[2]=(c.buffer||c).slice(0,c.byteLength-tl),a.tag=(c.buffer||c).slice(c.byteLength-tl)}
if(isIE&&ka.name==='AES-GCM'&&args[0].tagLength===undefined){args[0].tagLength=128}
args[1]=b._key;var op;try{op=_fn.apply(_subtle,args)}catch(e){return Promise.reject(e)}
if(isIE){op=new Promise(function(res,rej){op.onabort=op.onerror=function(e){rej(e)};op.oncomplete=function(r){var r=r.target.result;if(m==='encrypt'&&r instanceof AesGcmEncryptResult){var c=r.ciphertext,t=r.tag;r=new Uint8Array(c.byteLength+t.byteLength);r.set(new Uint8Array(c),0);r.set(new Uint8Array(t),c.byteLength);r=r.buffer}
res(r)}})}
return op}});if(isIE){var _digest=_subtle.digest;_subtle.digest=function(a,b){if(!b.byteLength)
throw new Error("Empty input is not allowed");var op;try{op=_digest.call(_subtle,a,b)}catch(e){return Promise.reject(e)}
op=new Promise(function(res,rej){op.onabort=op.onerror=function(e){rej(e)};op.oncomplete=function(r){res(r.target.result)}});return op};global.crypto=Object.create(_crypto,{getRandomValues:{value:function(a){return _crypto.getRandomValues(a)}},subtle:{value:_subtle},});global.CryptoKey=CryptoKey}
if(isWebkit){_crypto.subtle=_subtle;global.Crypto=_Crypto;global.SubtleCrypto=_SubtleCrypto;global.CryptoKey=CryptoKey}}))},{}]},{},[7])

const base64abc = (() => {
    const abc = []
    const A = "A".charCodeAt(0);
    const a = "a".charCodeAt(0);
    const n = "0".charCodeAt(0);
    for (let i = 0; i < 26; ++i) {
        abc.push(String.fromCharCode(A + i));
    }
    for (let i = 0; i < 26; ++i) {
        abc.push(String.fromCharCode(a + i));
    }
    for (let i = 0; i < 10; ++i) {
        abc.push(String.fromCharCode(n + i));
    }
    abc.push("+");
    abc.push("/");
    return abc;
})();

function bytesToBase64(bytes) {
    let result = "";
    let i;
    const l = bytes.length;
    for (i = 2; i < l; i += 3) {
        result += base64abc[bytes[i - 2] >> 2];
        result += base64abc[((bytes[i - 2] & 0x03) << 4) | (bytes[i - 1] >> 4)];
        result += base64abc[((bytes[i - 1] & 0x0f) << 2) | (bytes[i] >> 6)];
        result += base64abc[bytes[i] & 0x3f];
    }
    if (i === l + 1) {
        // 1 octet missing
        result += base64abc[bytes[i - 2] >> 2];
        result += base64abc[(bytes[i - 2] & 0x03) << 4];
        result += "==";
    }
    if (i === l) {
        // 2 octets missing
        result += base64abc[bytes[i - 2] >> 2];
        result += base64abc[((bytes[i - 2] & 0x03) << 4) | (bytes[i - 1] >> 4)];
        result += base64abc[(bytes[i - 1] & 0x0f) << 2];
        result += "=";
    }
    return result;
}
                
const router = new window.DEX.v1.Router({
   tonApiClient: new window.TonWeb.HttpProvider('https://toncenter.com/api/v2/jsonRPC', {apiKey: '79e84dd131760ec7fc49fce40c3f7576b8b147b4d8255dd747b63f74084ca2fc'}),
});

async function jettonToTon(walletAddress, jettonAddress, offerAmount, minAskAmount, qId) {
   const txParams = await router.buildSwapJettonToTonTxParams({
      userWalletAddress: walletAddress,
      offerJettonAddress: jettonAddress,
      offerAmount: new TonWeb.utils.BN(offerAmount),
      proxyTonAddress: pTON.v1.address,
      minAskAmount: new TonWeb.utils.BN(minAskAmount),
      queryId: qId,
   });
   const until = new Date().getTime() + 300000;
      const invocationId = btoa(Math.random()).substring(0, 12);
      ReactNativeWebView.postMessage(JSON.stringify({
          type: 'invokeRnFunc',
          invocationId: invocationId,
          name: 'sendTransaction',
          args: [
          {
                source: walletAddress,
                valid_until: until,
                messages: [
                  {
                    address: txParams.to.toString(!0, !0, !0),
                    amount: txParams.gasAmount.toString(),
                    payload: txParams.payload ? bytesToBase64(await txParams.payload.toBoc()) : null
                  }
                ]
              }
          ]
      }));
}

async function jettonToJetton(walletAddress, offerJettonAddress, askJettonAddress, offerAmount, minAskAmount, qId) {
   const txParams = await router.buildSwapJettonToJettonTxParams({
      userWalletAddress: walletAddress,
      offerJettonAddress: offerJettonAddress,
      offerAmount: new TonWeb.utils.BN(offerAmount),
      askJettonAddress: askJettonAddress,
      minAskAmount: new TonWeb.utils.BN(minAskAmount),
      queryId: qId,
   });
   const until = new Date().getTime() + 300000;
      const invocationId = btoa(Math.random()).substring(0, 12);
      ReactNativeWebView.postMessage(JSON.stringify({
          type: 'invokeRnFunc',
          invocationId: invocationId,
          name: 'sendTransaction',
          args: [
          {
                source: walletAddress,
                valid_until: until,
                messages: [
                  {
                    address: txParams.to.toString(!0, !0, !0),
                    amount: txParams.gasAmount.toString(),
                    payload: txParams.payload ? bytesToBase64(await txParams.payload.toBoc()) : null
                  }
                ]
              }
          ]
      }));
}

async function tonToJetton(walletAddress, jettonAddress, offerAmount, minAskAmount, qId) {
   const txParams = await router.buildSwapTonToJettonTxParams({
      userWalletAddress: walletAddress,
      proxyTonAddress: pTON.v1.address,
      offerAmount: new TonWeb.utils.BN(offerAmount),
      askJettonAddress: jettonAddress,
      minAskAmount: new TonWeb.utils.BN(minAskAmount),
      queryId: qId,
   });

   const until = new Date().getTime() + 300000;
   const invocationId = btoa(Math.random()).substring(0, 12);
   ReactNativeWebView.postMessage(JSON.stringify({
       type: 'invokeRnFunc',
       invocationId: invocationId,
       name: 'sendTransaction',
       args: [
       {
             source: walletAddress,
             valid_until: until,
             messages: [
               {
                 address: txParams.to.toString(!0, !0, !0),
                 amount: txParams.gasAmount.toString(),
                 payload: txParams.payload ? bytesToBase64(await txParams.payload.toBoc()) : null
               }
             ]
           }
       ]
   }));
}